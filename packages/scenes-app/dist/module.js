/*! For license information please see module.js.LICENSE.txt */
define(["@emotion/css","@grafana/data","@grafana/runtime","@grafana/ui","lodash","react","react-dom","react-router-dom","rxjs"],((e,t,n,r,a,i,o,s,l)=>(()=>{var u,c,d={494:(e,t,n)=>{"use strict";let r;n.d(t,{Ay:()=>$,R1:()=>k,hF:()=>E,hW:()=>V,jL:()=>C}),e=n.hmd(e);const a=new Array(128).fill(void 0);function i(e){return a[e]}a.push(void 0,null,!0,!1);let o=0,s=null;function l(){return null!==s&&0!==s.byteLength||(s=new Uint8Array(r.memory.buffer)),s}const u="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},c="function"==typeof u.encodeInto?function(e,t){return u.encodeInto(e,t)}:function(e,t){const n=u.encode(e);return t.set(n),{read:e.length,written:n.length}};function d(e,t,n){if(void 0===n){const n=u.encode(e),r=t(n.length,1)>>>0;return l().subarray(r,r+n.length).set(n),o=n.length,r}let r=e.length,a=t(r,1)>>>0;const i=l();let s=0;for(;s<r;s++){const t=e.charCodeAt(s);if(t>127)break;i[a+s]=t}if(s!==r){0!==s&&(e=e.slice(s)),a=n(a,r,r=s+3*e.length,1)>>>0;const t=l().subarray(a+s,a+r);s+=c(e,t).written,a=n(a,r,s,1)>>>0}return o=s,a}function p(e){return null==e}let h=null;function f(){return null!==h&&0!==h.byteLength||(h=new Int32Array(r.memory.buffer)),h}let m=a.length;function g(e){const t=i(e);return function(e){e<132||(a[e]=m,m=e)}(e),t}function b(e){m===a.length&&a.push(a.length+1);const t=m;return m=a[t],a[t]=e,t}const y="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};function v(e,t){return e>>>=0,y.decode(l().subarray(e,e+t))}"undefined"!=typeof TextDecoder&&y.decode();let w=null;function O(){return null!==w&&0!==w.byteLength||(w=new Float64Array(r.memory.buffer)),w}let S=null;function _(e){const t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){const t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){const t=e.length;let n="[";t>0&&(n+=_(e[0]));for(let r=1;r<t;r++)n+=", "+_(e[r]);return n+="]",n}const n=/\[object ([^\]]+)\]/.exec(toString.call(e));let r;if(!(n.length>1))return toString.call(e);if(r=n[1],"Object"==r)try{return"Object("+JSON.stringify(e)+")"}catch(e){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:r}let x=null;function P(){return null!==x&&0!==x.byteLength||(x=new Uint32Array(r.memory.buffer)),x}function C(e,t){const n=function(e,t){const n=t(4*e.length,4)>>>0;return P().set(e,n/4),o=e.length,n}(e,r.__wbindgen_malloc),a=o,i=r.ets(n,a,p(t)?0:b(t));return I.__wrap(i)}function E(e,t){try{const u=r.__wbindgen_add_to_stack_pointer(-16),c=function(e,t){const n=t(8*e.length,8)>>>0;return O().set(e,n/8),o=e.length,n}(e,r.__wbindgen_malloc),d=o;r.seasonalities(u,c,d,p(t)?0:b(t));var n=f()[u/4+0],a=f()[u/4+1],i=(s=n,l=a,s>>>=0,P().subarray(s/4,s/4+l)).slice();return r.__wbindgen_free(n,4*a,4),i}finally{r.__wbindgen_add_to_stack_pointer(16)}var s,l}function j(e,t){try{return e.apply(this,t)}catch(e){r.__wbindgen_exn_store(b(e))}}"undefined"==typeof FinalizationRegistry||new FinalizationRegistry((e=>r.__wbg_autoets_free(e>>>0)));const D="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>r.__wbg_changepointdetector_free(e>>>0)));class k{static __wrap(e){e>>>=0;const t=Object.create(k.prototype);return t.__wbg_ptr=e,D.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,D.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_changepointdetector_free(e)}static normalGamma(e){try{const a=r.__wbindgen_add_to_stack_pointer(-16);r.changepointdetector_normalGamma(a,p(e)?0:b(e));var t=f()[a/4+0],n=f()[a/4+1];if(f()[a/4+2])throw g(n);return k.__wrap(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}static defaultArgpcp(e){try{const a=r.__wbindgen_add_to_stack_pointer(-16);r.changepointdetector_defaultArgpcp(a,p(e)?0:b(e));var t=f()[a/4+0],n=f()[a/4+1];if(f()[a/4+2])throw g(n);return k.__wrap(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}detectChangepoints(e){return g(r.changepointdetector_detectChangepoints(this.__wbg_ptr,b(e)))}}const T="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>r.__wbg_loadedoutlierdetector_free(e>>>0)));class R{static __wrap(e){e>>>=0;const t=Object.create(R.prototype);return t.__wbg_ptr=e,T.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,T.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_loadedoutlierdetector_free(e)}detect(){return g(r.loadedoutlierdetector_detect(this.__wbg_ptr))}updateDetector(e){try{const n=r.__wbindgen_add_to_stack_pointer(-16);r.loadedoutlierdetector_updateDetector(n,this.__wbg_ptr,b(e));var t=f()[n/4+0];if(f()[n/4+1])throw g(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}}const A="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>r.__wbg_mstl_free(e>>>0)));class I{static __wrap(e){e>>>=0;const t=Object.create(I.prototype);return t.__wbg_ptr=e,A.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,A.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_mstl_free(e)}fit(e){try{const n=r.__wbindgen_add_to_stack_pointer(-16);r.mstl_fit(n,this.__wbg_ptr,b(e));var t=f()[n/4+0];if(f()[n/4+1])throw g(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}predict(e,t){try{const i=r.__wbindgen_add_to_stack_pointer(-16);r.mstl_predict(i,this.__wbg_ptr,e,!p(t),p(t)?0:t);var n=f()[i/4+0],a=f()[i/4+1];if(f()[i/4+2])throw g(a);return g(n)}finally{r.__wbindgen_add_to_stack_pointer(16)}}predictInSample(e){try{const a=r.__wbindgen_add_to_stack_pointer(-16);r.mstl_predictInSample(a,this.__wbg_ptr,!p(e),p(e)?0:e);var t=f()[a/4+0],n=f()[a/4+1];if(f()[a/4+2])throw g(n);return g(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}}const M="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>r.__wbg_outlierdetector_free(e>>>0)));class V{static __wrap(e){e>>>=0;const t=Object.create(V.prototype);return t.__wbg_ptr=e,M.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,M.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_outlierdetector_free(e)}static dbscan(e){try{const a=r.__wbindgen_add_to_stack_pointer(-16);r.outlierdetector_dbscan(a,b(e));var t=f()[a/4+0],n=f()[a/4+1];if(f()[a/4+2])throw g(n);return V.__wrap(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}detect(e,t){return g(r.outlierdetector_detect(this.__wbg_ptr,b(e),t))}preprocess(e,t){const n=r.outlierdetector_preprocess(this.__wbg_ptr,b(e),t);return R.__wrap(n)}}function F(){const t={wbg:{}};return t.wbg.__wbindgen_string_get=function(e,t){const n=i(t),a="string"==typeof n?n:void 0;var s=p(a)?0:d(a,r.__wbindgen_malloc,r.__wbindgen_realloc),l=o;f()[e/4+1]=l,f()[e/4+0]=s},t.wbg.__wbindgen_object_drop_ref=function(e){g(e)},t.wbg.__wbindgen_is_bigint=function(e){return"bigint"==typeof i(e)},t.wbg.__wbindgen_bigint_from_u64=function(e){return b(BigInt.asUintN(64,e))},t.wbg.__wbindgen_jsval_eq=function(e,t){return i(e)===i(t)},t.wbg.__wbindgen_error_new=function(e,t){return b(new Error(v(e,t)))},t.wbg.__wbindgen_boolean_get=function(e){const t=i(e);return"boolean"==typeof t?t?1:0:2},t.wbg.__wbindgen_is_string=function(e){return"string"==typeof i(e)},t.wbg.__wbindgen_number_get=function(e,t){const n=i(t),r="number"==typeof n?n:void 0;O()[e/8+1]=p(r)?0:r,f()[e/4+0]=!p(r)},t.wbg.__wbindgen_is_object=function(e){const t=i(e);return"object"==typeof t&&null!==t},t.wbg.__wbindgen_is_undefined=function(e){return void 0===i(e)},t.wbg.__wbindgen_in=function(e,t){return i(e)in i(t)},t.wbg.__wbindgen_object_clone_ref=function(e){return b(i(e))},t.wbg.__wbindgen_string_new=function(e,t){return b(v(e,t))},t.wbg.__wbg_new_abda76e883ba8a5f=function(){return b(new Error)},t.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const n=d(i(t).stack,r.__wbindgen_malloc,r.__wbindgen_realloc),a=o;f()[e/4+1]=a,f()[e/4+0]=n},t.wbg.__wbg_error_f851667af71bcfc6=function(e,t){let n,a;try{n=e,a=t,console.error(v(e,t))}finally{r.__wbindgen_free(n,a,1)}},t.wbg.__wbg_crypto_1d1f22824a6a080c=function(e){return b(i(e).crypto)},t.wbg.__wbg_process_4a72847cc503995b=function(e){return b(i(e).process)},t.wbg.__wbg_versions_f686565e586dd935=function(e){return b(i(e).versions)},t.wbg.__wbg_node_104a2ff8d6ea03a2=function(e){return b(i(e).node)},t.wbg.__wbg_require_cca90b1a94a0255b=function(){return j((function(){return b(e.require)}),arguments)},t.wbg.__wbindgen_is_function=function(e){return"function"==typeof i(e)},t.wbg.__wbg_msCrypto_eb05e62b530a1508=function(e){return b(i(e).msCrypto)},t.wbg.__wbg_randomFillSync_5c9c955aa56b6049=function(){return j((function(e,t){i(e).randomFillSync(g(t))}),arguments)},t.wbg.__wbg_getRandomValues_3aa56aa6edec874c=function(){return j((function(e,t){i(e).getRandomValues(i(t))}),arguments)},t.wbg.__wbindgen_jsval_loose_eq=function(e,t){return i(e)==i(t)},t.wbg.__wbindgen_as_number=function(e){return+i(e)},t.wbg.__wbindgen_number_new=function(e){return b(e)},t.wbg.__wbg_getwithrefkey_edc2c8960f0f1191=function(e,t){return b(i(e)[i(t)])},t.wbg.__wbg_set_f975102236d3c502=function(e,t,n){i(e)[g(t)]=g(n)},t.wbg.__wbg_String_b9412f8799faab3e=function(e,t){const n=d(String(i(t)),r.__wbindgen_malloc,r.__wbindgen_realloc),a=o;f()[e/4+1]=a,f()[e/4+0]=n},t.wbg.__wbg_get_bd8e338fbd5f5cc8=function(e,t){return b(i(e)[t>>>0])},t.wbg.__wbg_length_cd7af8117672b8b8=function(e){return i(e).length},t.wbg.__wbg_new_16b304a2cfa7ff4a=function(){return b(new Array)},t.wbg.__wbg_newnoargs_e258087cd0daa0ea=function(e,t){return b(new Function(v(e,t)))},t.wbg.__wbg_call_27c0f87801dedf93=function(){return j((function(e,t){return b(i(e).call(i(t)))}),arguments)},t.wbg.__wbg_new_72fb9a18b5ae2624=function(){return b(new Object)},t.wbg.__wbg_self_ce0dbfc45cf2f5be=function(){return j((function(){return b(self.self)}),arguments)},t.wbg.__wbg_window_c6fb939a7f436783=function(){return j((function(){return b(window.window)}),arguments)},t.wbg.__wbg_globalThis_d1e6af4856ba331b=function(){return j((function(){return b(globalThis.globalThis)}),arguments)},t.wbg.__wbg_global_207b558942527489=function(){return j((function(){return b(n.g.global)}),arguments)},t.wbg.__wbg_set_d4638f722068f043=function(e,t,n){i(e)[t>>>0]=g(n)},t.wbg.__wbg_instanceof_ArrayBuffer_836825be07d4c9d2=function(e){let t;try{t=i(e)instanceof ArrayBuffer}catch(e){t=!1}return t},t.wbg.__wbg_call_b3ca7c6051f9bec1=function(){return j((function(e,t,n){return b(i(e).call(i(t),i(n)))}),arguments)},t.wbg.__wbg_isSafeInteger_f7b04ef02296c4d2=function(e){return Number.isSafeInteger(i(e))},t.wbg.__wbg_entries_95cc2c823b285a09=function(e){return b(Object.entries(i(e)))},t.wbg.__wbg_buffer_12d079cc21e14bdb=function(e){return b(i(e).buffer)},t.wbg.__wbg_newwithbyteoffsetandlength_aa4a17c33a06e5cb=function(e,t,n){return b(new Uint8Array(i(e),t>>>0,n>>>0))},t.wbg.__wbg_new_63b92bc8671ed464=function(e){return b(new Uint8Array(i(e)))},t.wbg.__wbg_set_a47bac70306a19a7=function(e,t,n){i(e).set(i(t),n>>>0)},t.wbg.__wbg_length_c20a40f15020d68a=function(e){return i(e).length},t.wbg.__wbg_new_5e4931c0e7b0d773=function(e){return b(new Float64Array(i(e)))},t.wbg.__wbg_set_cb4cf3c3a46bcdd2=function(e,t,n){i(e).set(i(t),n>>>0)},t.wbg.__wbg_length_0382220548385255=function(e){return i(e).length},t.wbg.__wbg_instanceof_Uint8Array_2b3bbecd033d19f6=function(e){let t;try{t=i(e)instanceof Uint8Array}catch(e){t=!1}return t},t.wbg.__wbg_newwithlength_e9b4878cebadb3d3=function(e){return b(new Uint8Array(e>>>0))},t.wbg.__wbg_subarray_a1f73cd4b5b42fe1=function(e,t,n){return b(i(e).subarray(t>>>0,n>>>0))},t.wbg.__wbindgen_bigint_get_as_i64=function(e,t){const n=i(t),a="bigint"==typeof n?n:void 0;(null!==S&&0!==S.byteLength||(S=new BigInt64Array(r.memory.buffer)),S)[e/8+1]=p(a)?BigInt(0):a,f()[e/4+0]=!p(a)},t.wbg.__wbindgen_debug_string=function(e,t){const n=d(_(i(t)),r.__wbindgen_malloc,r.__wbindgen_realloc),a=o;f()[e/4+1]=a,f()[e/4+0]=n},t.wbg.__wbindgen_throw=function(e,t){throw new Error(v(e,t))},t.wbg.__wbindgen_memory=function(){return b(r.memory)},t}async function L(e){if(void 0!==r)return r;void 0===e&&(e=new URL(n(720),n.b));const t=F();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:a,module:i}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return function(e,t){return r=e.exports,L.__wbindgen_wasm_module=t,S=null,w=null,h=null,x=null,s=null,r.__wbindgen_start(),r}(a,i)}const $=L},859:(e,t,n)=>{"use strict";function r(e){var t,n,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(a&&(a+=" "),a+=n);else for(t in e)e[t]&&(a&&(a+=" "),a+=t);return a}function a(){for(var e,t,n=0,a="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(a&&(a+=" "),a+=t);return a}n.r(t),n.d(t,{clsx:()=>a,default:()=>i});const i=a},150:function(e,t){!function(e){"use strict";function t(e){return function(t,n,r,a,i,o,s){return e(t,n,s)}}function n(e){return function(t,n,r,a){if(!t||!n||"object"!=typeof t||"object"!=typeof n)return e(t,n,r,a);var i=a.get(t),o=a.get(n);if(i&&o)return i===n&&o===t;a.set(t,n),a.set(n,t);var s=e(t,n,r,a);return a.delete(t),a.delete(n),s}}function r(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n}function a(e){return e.constructor===Object||null==e.constructor}function i(e){return"function"==typeof e.then}function o(e,t){return e===t||e!=e&&t!=t}var s=Object.prototype.toString;function l(e){var t=e.areArraysEqual,n=e.areDatesEqual,r=e.areMapsEqual,l=e.areObjectsEqual,u=e.areRegExpsEqual,c=e.areSetsEqual,d=(0,e.createIsNestedEqual)(p);function p(e,p,h){if(e===p)return!0;if(!e||!p||"object"!=typeof e||"object"!=typeof p)return e!=e&&p!=p;if(a(e)&&a(p))return l(e,p,d,h);var f=Array.isArray(e),m=Array.isArray(p);if(f||m)return f===m&&t(e,p,d,h);var g=s.call(e);return g===s.call(p)&&("[object Date]"===g?n(e,p,d,h):"[object RegExp]"===g?u(e,p,d,h):"[object Map]"===g?r(e,p,d,h):"[object Set]"===g?c(e,p,d,h):"[object Object]"===g||"[object Arguments]"===g?!i(e)&&!i(p)&&l(e,p,d,h):("[object Boolean]"===g||"[object Number]"===g||"[object String]"===g)&&o(e.valueOf(),p.valueOf()))}return p}function u(e,t,n,r){var a=e.length;if(t.length!==a)return!1;for(;a-- >0;)if(!n(e[a],t[a],a,a,e,t,r))return!1;return!0}var c=n(u);function d(e,t){return o(e.valueOf(),t.valueOf())}function p(e,t,n,r){var a=e.size===t.size;if(!a)return!1;if(!e.size)return!0;var i={},o=0;return e.forEach((function(s,l){if(a){var u=!1,c=0;t.forEach((function(a,d){u||i[c]||!(u=n(l,d,o,c,e,t,r)&&n(s,a,l,d,e,t,r))||(i[c]=!0),c++})),o++,a=u}})),a}var h=n(p),f=Object.prototype.hasOwnProperty;function m(e,t,n,r){var a,i=Object.keys(e),o=i.length;if(Object.keys(t).length!==o)return!1;for(;o-- >0;){if("_owner"===(a=i[o])){var s=!!e.$$typeof,l=!!t.$$typeof;if((s||l)&&s!==l)return!1}if(!f.call(t,a)||!n(e[a],t[a],a,a,e,t,r))return!1}return!0}var g=n(m);function b(e,t){return e.source===t.source&&e.flags===t.flags}function y(e,t,n,r){var a=e.size===t.size;if(!a)return!1;if(!e.size)return!0;var i={};return e.forEach((function(o,s){if(a){var l=!1,u=0;t.forEach((function(a,c){l||i[u]||!(l=n(o,a,s,c,e,t,r))||(i[u]=!0),u++})),a=l}})),a}var v=n(y),w=Object.freeze({areArraysEqual:u,areDatesEqual:d,areMapsEqual:p,areObjectsEqual:m,areRegExpsEqual:b,areSetsEqual:y,createIsNestedEqual:t}),O=Object.freeze({areArraysEqual:c,areDatesEqual:d,areMapsEqual:h,areObjectsEqual:g,areRegExpsEqual:b,areSetsEqual:v,createIsNestedEqual:t}),S=l(w);var _=l(r(w,{createIsNestedEqual:function(){return o}}));var x=l(O);var P=l(r(O,{createIsNestedEqual:function(){return o}}));e.circularDeepEqual=function(e,t){return x(e,t,new WeakMap)},e.circularShallowEqual=function(e,t){return P(e,t,new WeakMap)},e.createCustomCircularEqual=function(e){var t=l(r(O,e(O)));return function(e,n,r){return void 0===r&&(r=new WeakMap),t(e,n,r)}},e.createCustomEqual=function(e){return l(r(w,e(w)))},e.deepEqual=function(e,t){return S(e,t,void 0)},e.sameValueZeroEqual=o,e.shallowEqual=function(e,t){return _(e,t,void 0)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},856:(e,t,n)=>{"use strict";var r=n(183);function a(){}function i(){}i.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,i,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:a};return n.PropTypes=n,n}},217:(e,t,n)=>{e.exports=n(856)()},183:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},105:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraggableCore",{enumerable:!0,get:function(){return c.default}}),t.default=void 0;var r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=h(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=a?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(n(959)),a=p(n(217)),i=p(n(398)),o=p(n(859)),s=n(691),l=n(272),u=n(214),c=p(n(634)),d=p(n(350));function p(e){return e&&e.__esModule?e:{default:e}}function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(h=function(e){return e?n:t})(e)}function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)}function m(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class g extends r.Component{static getDerivedStateFromProps(e,t){let{position:n}=e,{prevPropsPosition:r}=t;return!n||r&&n.x===r.x&&n.y===r.y?null:((0,d.default)("Draggable: getDerivedStateFromProps %j",{position:n,prevPropsPosition:r}),{x:n.x,y:n.y,prevPropsPosition:{...n}})}constructor(e){super(e),m(this,"onDragStart",((e,t)=>{if((0,d.default)("Draggable: onDragStart: %j",t),!1===this.props.onStart(e,(0,l.createDraggableData)(this,t)))return!1;this.setState({dragging:!0,dragged:!0})})),m(this,"onDrag",((e,t)=>{if(!this.state.dragging)return!1;(0,d.default)("Draggable: onDrag: %j",t);const n=(0,l.createDraggableData)(this,t),r={x:n.x,y:n.y,slackX:0,slackY:0};if(this.props.bounds){const{x:e,y:t}=r;r.x+=this.state.slackX,r.y+=this.state.slackY;const[a,i]=(0,l.getBoundPosition)(this,r.x,r.y);r.x=a,r.y=i,r.slackX=this.state.slackX+(e-r.x),r.slackY=this.state.slackY+(t-r.y),n.x=r.x,n.y=r.y,n.deltaX=r.x-this.state.x,n.deltaY=r.y-this.state.y}if(!1===this.props.onDrag(e,n))return!1;this.setState(r)})),m(this,"onDragStop",((e,t)=>{if(!this.state.dragging)return!1;if(!1===this.props.onStop(e,(0,l.createDraggableData)(this,t)))return!1;(0,d.default)("Draggable: onDragStop: %j",t);const n={dragging:!1,slackX:0,slackY:0};if(Boolean(this.props.position)){const{x:e,y:t}=this.props.position;n.x=e,n.y=t}this.setState(n)})),this.state={dragging:!1,dragged:!1,x:e.position?e.position.x:e.defaultPosition.x,y:e.position?e.position.y:e.defaultPosition.y,prevPropsPosition:{...e.position},slackX:0,slackY:0,isElementSVG:!1},!e.position||e.onDrag||e.onStop||console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){void 0!==window.SVGElement&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var e,t;return null!==(e=null===(t=this.props)||void 0===t||null===(t=t.nodeRef)||void 0===t?void 0:t.current)&&void 0!==e?e:i.default.findDOMNode(this)}render(){const{axis:e,bounds:t,children:n,defaultPosition:a,defaultClassName:i,defaultClassNameDragging:u,defaultClassNameDragged:d,position:p,positionOffset:h,scale:m,...g}=this.props;let b={},y=null;const v=!Boolean(p)||this.state.dragging,w=p||a,O={x:(0,l.canDragX)(this)&&v?this.state.x:w.x,y:(0,l.canDragY)(this)&&v?this.state.y:w.y};this.state.isElementSVG?y=(0,s.createSVGTransform)(O,h):b=(0,s.createCSSTransform)(O,h);const S=(0,o.default)(n.props.className||"",i,{[u]:this.state.dragging,[d]:this.state.dragged});return r.createElement(c.default,f({},g,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),r.cloneElement(r.Children.only(n),{className:S,style:{...n.props.style,...b},transform:y}))}}t.default=g,m(g,"displayName","Draggable"),m(g,"propTypes",{...c.default.propTypes,axis:a.default.oneOf(["both","x","y","none"]),bounds:a.default.oneOfType([a.default.shape({left:a.default.number,right:a.default.number,top:a.default.number,bottom:a.default.number}),a.default.string,a.default.oneOf([!1])]),defaultClassName:a.default.string,defaultClassNameDragging:a.default.string,defaultClassNameDragged:a.default.string,defaultPosition:a.default.shape({x:a.default.number,y:a.default.number}),positionOffset:a.default.shape({x:a.default.oneOfType([a.default.number,a.default.string]),y:a.default.oneOfType([a.default.number,a.default.string])}),position:a.default.shape({x:a.default.number,y:a.default.number}),className:u.dontSetMe,style:u.dontSetMe,transform:u.dontSetMe}),m(g,"defaultProps",{...c.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})},634:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=a?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(n(959)),a=c(n(217)),i=c(n(398)),o=n(691),s=n(272),l=n(214),u=c(n(350));function c(e){return e&&e.__esModule?e:{default:e}}function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}function p(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const h={start:"touchstart",move:"touchmove",stop:"touchend"},f={start:"mousedown",move:"mousemove",stop:"mouseup"};let m=f;class g extends r.Component{constructor(){super(...arguments),p(this,"dragging",!1),p(this,"lastX",NaN),p(this,"lastY",NaN),p(this,"touchIdentifier",null),p(this,"mounted",!1),p(this,"handleDragStart",(e=>{if(this.props.onMouseDown(e),!this.props.allowAnyClick&&"number"==typeof e.button&&0!==e.button)return!1;const t=this.findDOMNode();if(!t||!t.ownerDocument||!t.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:n}=t;if(this.props.disabled||!(e.target instanceof n.defaultView.Node)||this.props.handle&&!(0,o.matchesSelectorAndParentsTo)(e.target,this.props.handle,t)||this.props.cancel&&(0,o.matchesSelectorAndParentsTo)(e.target,this.props.cancel,t))return;"touchstart"===e.type&&e.preventDefault();const r=(0,o.getTouchIdentifier)(e);this.touchIdentifier=r;const a=(0,s.getControlPosition)(e,r,this);if(null==a)return;const{x:i,y:l}=a,c=(0,s.createCoreData)(this,i,l);(0,u.default)("DraggableCore: handleDragStart: %j",c),(0,u.default)("calling",this.props.onStart),!1!==this.props.onStart(e,c)&&!1!==this.mounted&&(this.props.enableUserSelectHack&&(0,o.addUserSelectStyles)(n),this.dragging=!0,this.lastX=i,this.lastY=l,(0,o.addEvent)(n,m.move,this.handleDrag),(0,o.addEvent)(n,m.stop,this.handleDragStop))})),p(this,"handleDrag",(e=>{const t=(0,s.getControlPosition)(e,this.touchIdentifier,this);if(null==t)return;let{x:n,y:r}=t;if(Array.isArray(this.props.grid)){let e=n-this.lastX,t=r-this.lastY;if([e,t]=(0,s.snapToGrid)(this.props.grid,e,t),!e&&!t)return;n=this.lastX+e,r=this.lastY+t}const a=(0,s.createCoreData)(this,n,r);if((0,u.default)("DraggableCore: handleDrag: %j",a),!1!==this.props.onDrag(e,a)&&!1!==this.mounted)this.lastX=n,this.lastY=r;else try{this.handleDragStop(new MouseEvent("mouseup"))}catch(e){const t=document.createEvent("MouseEvents");t.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(t)}})),p(this,"handleDragStop",(e=>{if(!this.dragging)return;const t=(0,s.getControlPosition)(e,this.touchIdentifier,this);if(null==t)return;let{x:n,y:r}=t;if(Array.isArray(this.props.grid)){let e=n-this.lastX||0,t=r-this.lastY||0;[e,t]=(0,s.snapToGrid)(this.props.grid,e,t),n=this.lastX+e,r=this.lastY+t}const a=(0,s.createCoreData)(this,n,r);if(!1===this.props.onStop(e,a)||!1===this.mounted)return!1;const i=this.findDOMNode();i&&this.props.enableUserSelectHack&&(0,o.removeUserSelectStyles)(i.ownerDocument),(0,u.default)("DraggableCore: handleDragStop: %j",a),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,i&&((0,u.default)("DraggableCore: Removing handlers"),(0,o.removeEvent)(i.ownerDocument,m.move,this.handleDrag),(0,o.removeEvent)(i.ownerDocument,m.stop,this.handleDragStop))})),p(this,"onMouseDown",(e=>(m=f,this.handleDragStart(e)))),p(this,"onMouseUp",(e=>(m=f,this.handleDragStop(e)))),p(this,"onTouchStart",(e=>(m=h,this.handleDragStart(e)))),p(this,"onTouchEnd",(e=>(m=h,this.handleDragStop(e))))}componentDidMount(){this.mounted=!0;const e=this.findDOMNode();e&&(0,o.addEvent)(e,h.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const e=this.findDOMNode();if(e){const{ownerDocument:t}=e;(0,o.removeEvent)(t,f.move,this.handleDrag),(0,o.removeEvent)(t,h.move,this.handleDrag),(0,o.removeEvent)(t,f.stop,this.handleDragStop),(0,o.removeEvent)(t,h.stop,this.handleDragStop),(0,o.removeEvent)(e,h.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,o.removeUserSelectStyles)(t)}}findDOMNode(){var e,t;return null!==(e=this.props)&&void 0!==e&&e.nodeRef?null===(t=this.props)||void 0===t||null===(t=t.nodeRef)||void 0===t?void 0:t.current:i.default.findDOMNode(this)}render(){return r.cloneElement(r.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}}t.default=g,p(g,"displayName","DraggableCore"),p(g,"propTypes",{allowAnyClick:a.default.bool,children:a.default.node.isRequired,disabled:a.default.bool,enableUserSelectHack:a.default.bool,offsetParent:function(e,t){if(e[t]&&1!==e[t].nodeType)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:a.default.arrayOf(a.default.number),handle:a.default.string,cancel:a.default.string,nodeRef:a.default.object,onStart:a.default.func,onDrag:a.default.func,onStop:a.default.func,onMouseDown:a.default.func,scale:a.default.number,className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe}),p(g,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1})},460:(e,t,n)=>{"use strict";const{default:r,DraggableCore:a}=n(105);e.exports=r,e.exports.default=r,e.exports.DraggableCore=a},691:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addClassName=u,t.addEvent=function(e,t,n,r){if(!e)return;const a={capture:!0,...r};e.addEventListener?e.addEventListener(t,n,a):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},t.addUserSelectStyles=function(e){if(!e)return;let t=e.getElementById("react-draggable-style-el");t||(t=e.createElement("style"),t.type="text/css",t.id="react-draggable-style-el",t.innerHTML=".react-draggable-transparent-selection *::-moz-selection {all: inherit;}\n",t.innerHTML+=".react-draggable-transparent-selection *::selection {all: inherit;}\n",e.getElementsByTagName("head")[0].appendChild(t)),e.body&&u(e.body,"react-draggable-transparent-selection")},t.createCSSTransform=function(e,t){const n=l(e,t,"px");return{[(0,a.browserPrefixToKey)("transform",a.default)]:n}},t.createSVGTransform=function(e,t){return l(e,t,"")},t.getTouch=function(e,t){return e.targetTouches&&(0,r.findInArray)(e.targetTouches,(e=>t===e.identifier))||e.changedTouches&&(0,r.findInArray)(e.changedTouches,(e=>t===e.identifier))},t.getTouchIdentifier=function(e){return e.targetTouches&&e.targetTouches[0]?e.targetTouches[0].identifier:e.changedTouches&&e.changedTouches[0]?e.changedTouches[0].identifier:void 0},t.getTranslation=l,t.innerHeight=function(e){let t=e.clientHeight;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,r.int)(n.paddingTop),t-=(0,r.int)(n.paddingBottom),t},t.innerWidth=function(e){let t=e.clientWidth;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,r.int)(n.paddingLeft),t-=(0,r.int)(n.paddingRight),t},t.matchesSelector=s,t.matchesSelectorAndParentsTo=function(e,t,n){let r=e;do{if(s(r,t))return!0;if(r===n)return!1;r=r.parentNode}while(r);return!1},t.offsetXYFromParent=function(e,t,n){const r=t===t.ownerDocument.body?{left:0,top:0}:t.getBoundingClientRect();return{x:(e.clientX+t.scrollLeft-r.left)/n,y:(e.clientY+t.scrollTop-r.top)/n}},t.outerHeight=function(e){let t=e.clientHeight;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,r.int)(n.borderTopWidth),t+=(0,r.int)(n.borderBottomWidth),t},t.outerWidth=function(e){let t=e.clientWidth;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,r.int)(n.borderLeftWidth),t+=(0,r.int)(n.borderRightWidth),t},t.removeClassName=c,t.removeEvent=function(e,t,n,r){if(!e)return;const a={capture:!0,...r};e.removeEventListener?e.removeEventListener(t,n,a):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null},t.removeUserSelectStyles=function(e){if(e)try{if(e.body&&c(e.body,"react-draggable-transparent-selection"),e.selection)e.selection.empty();else{const t=(e.defaultView||window).getSelection();t&&"Caret"!==t.type&&t.removeAllRanges()}}catch(e){}};var r=n(214),a=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(n(628));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}let o="";function s(e,t){return o||(o=(0,r.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],(function(t){return(0,r.isFunction)(e[t])}))),!!(0,r.isFunction)(e[o])&&e[o](t)}function l(e,t,n){let{x:r,y:a}=e,i="translate(".concat(r).concat(n,",").concat(a).concat(n,")");if(t){const e="".concat("string"==typeof t.x?t.x:t.x+n),r="".concat("string"==typeof t.y?t.y:t.y+n);i="translate(".concat(e,", ").concat(r,")")+i}return i}function u(e,t){e.classList?e.classList.add(t):e.className.match(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)")))||(e.className+=" ".concat(t))}function c(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)"),"g"),"")}},628:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.browserPrefixToKey=a,t.browserPrefixToStyle=function(e,t){return t?"-".concat(t.toLowerCase(),"-").concat(e):e},t.default=void 0,t.getPrefix=r;const n=["Moz","Webkit","O","ms"];function r(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"transform";if("undefined"==typeof window)return"";const r=null===(e=window.document)||void 0===e||null===(e=e.documentElement)||void 0===e?void 0:e.style;if(!r)return"";if(t in r)return"";for(let e=0;e<n.length;e++)if(a(t,n[e])in r)return n[e];return""}function a(e,t){return t?"".concat(t).concat(function(e){let t="",n=!0;for(let r=0;r<e.length;r++)n?(t+=e[r].toUpperCase(),n=!1):"-"===e[r]?n=!0:t+=e[r];return t}(e)):e}t.default=r()},350:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){}},272:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canDragX=function(e){return"both"===e.props.axis||"x"===e.props.axis},t.canDragY=function(e){return"both"===e.props.axis||"y"===e.props.axis},t.createCoreData=function(e,t,n){const a=!(0,r.isNum)(e.lastX),o=i(e);return a?{node:o,deltaX:0,deltaY:0,lastX:t,lastY:n,x:t,y:n}:{node:o,deltaX:t-e.lastX,deltaY:n-e.lastY,lastX:e.lastX,lastY:e.lastY,x:t,y:n}},t.createDraggableData=function(e,t){const n=e.props.scale;return{node:t.node,x:e.state.x+t.deltaX/n,y:e.state.y+t.deltaY/n,deltaX:t.deltaX/n,deltaY:t.deltaY/n,lastX:e.state.x,lastY:e.state.y}},t.getBoundPosition=function(e,t,n){if(!e.props.bounds)return[t,n];let{bounds:o}=e.props;o="string"==typeof o?o:function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}(o);const s=i(e);if("string"==typeof o){const{ownerDocument:e}=s,t=e.defaultView;let n;if(n="parent"===o?s.parentNode:e.querySelector(o),!(n instanceof t.HTMLElement))throw new Error('Bounds selector "'+o+'" could not find an element.');const i=n,l=t.getComputedStyle(s),u=t.getComputedStyle(i);o={left:-s.offsetLeft+(0,r.int)(u.paddingLeft)+(0,r.int)(l.marginLeft),top:-s.offsetTop+(0,r.int)(u.paddingTop)+(0,r.int)(l.marginTop),right:(0,a.innerWidth)(i)-(0,a.outerWidth)(s)-s.offsetLeft+(0,r.int)(u.paddingRight)-(0,r.int)(l.marginRight),bottom:(0,a.innerHeight)(i)-(0,a.outerHeight)(s)-s.offsetTop+(0,r.int)(u.paddingBottom)-(0,r.int)(l.marginBottom)}}return(0,r.isNum)(o.right)&&(t=Math.min(t,o.right)),(0,r.isNum)(o.bottom)&&(n=Math.min(n,o.bottom)),(0,r.isNum)(o.left)&&(t=Math.max(t,o.left)),(0,r.isNum)(o.top)&&(n=Math.max(n,o.top)),[t,n]},t.getControlPosition=function(e,t,n){const r="number"==typeof t?(0,a.getTouch)(e,t):null;if("number"==typeof t&&!r)return null;const o=i(n),s=n.props.offsetParent||o.offsetParent||o.ownerDocument.body;return(0,a.offsetXYFromParent)(r||e,s,n.props.scale)},t.snapToGrid=function(e,t,n){return[Math.round(t/e[0])*e[0],Math.round(n/e[1])*e[1]]};var r=n(214),a=n(691);function i(e){const t=e.findDOMNode();if(!t)throw new Error("<DraggableCore>: Unmounted during event!");return t}},214:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dontSetMe=function(e,t,n){if(e[t])return new Error("Invalid prop ".concat(t," passed to ").concat(n," - do not set this, set it on the child."))},t.findInArray=function(e,t){for(let n=0,r=e.length;n<r;n++)if(t.apply(t,[e[n],n,e]))return e[n]},t.int=function(e){return parseInt(e,10)},t.isFunction=function(e){return"function"==typeof e||"[object Function]"===Object.prototype.toString.call(e)},t.isNum=function(e){return"number"==typeof e&&!isNaN(e)}},598:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=d(n(959)),a=d(n(217)),i=n(460),o=n(134),s=n(0),l=n(664),u=n(184),c=d(n(135));function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class h extends r.default.Component{constructor(){super(...arguments),p(this,"state",{resizing:null,dragging:null,className:""}),p(this,"elementRef",r.default.createRef()),p(this,"onDragStart",((e,t)=>{let{node:n}=t;const{onDragStart:r,transformScale:a}=this.props;if(!r)return;const i={top:0,left:0},{offsetParent:o}=n;if(!o)return;const s=o.getBoundingClientRect(),u=n.getBoundingClientRect(),c=u.left/a,d=s.left/a,p=u.top/a,h=s.top/a;i.left=c-d+o.scrollLeft,i.top=p-h+o.scrollTop,this.setState({dragging:i});const{x:f,y:m}=(0,l.calcXY)(this.getPositionParams(),i.top,i.left,this.props.w,this.props.h);return r.call(this,this.props.i,f,m,{e,node:n,newPosition:i})})),p(this,"onDrag",((e,t)=>{let{node:n,deltaX:r,deltaY:a}=t;const{onDrag:i}=this.props;if(!i)return;if(!this.state.dragging)throw new Error("onDrag called before onDragStart.");let o=this.state.dragging.top+a,s=this.state.dragging.left+r;const{isBounded:u,i:c,w:d,h:p,containerWidth:h}=this.props,f=this.getPositionParams();if(u){const{offsetParent:e}=n;if(e){const{margin:t,rowHeight:n,containerPadding:r}=this.props,a=e.clientHeight-(0,l.calcGridItemWHPx)(p,n,t[1]);o=(0,l.clamp)(o-r[1],0,a);const i=(0,l.calcGridColWidth)(f),u=h-(0,l.calcGridItemWHPx)(d,i,t[0]);s=(0,l.clamp)(s-r[0],0,u)}}const m={top:o,left:s};this.setState({dragging:m});const{x:g,y:b}=(0,l.calcXY)(f,o,s,d,p);return i.call(this,c,g,b,{e,node:n,newPosition:m})})),p(this,"onDragStop",((e,t)=>{let{node:n}=t;const{onDragStop:r}=this.props;if(!r)return;if(!this.state.dragging)throw new Error("onDragEnd called before onDragStart.");const{w:a,h:i,i:o}=this.props,{left:s,top:u}=this.state.dragging,c={top:u,left:s};this.setState({dragging:null});const{x:d,y:p}=(0,l.calcXY)(this.getPositionParams(),u,s,a,i);return r.call(this,o,d,p,{e,node:n,newPosition:c})})),p(this,"onResizeStop",((e,t,n)=>this.onResizeHandler(e,t,n,"onResizeStop"))),p(this,"onResizeStart",((e,t,n)=>this.onResizeHandler(e,t,n,"onResizeStart"))),p(this,"onResize",((e,t,n)=>this.onResizeHandler(e,t,n,"onResize")))}shouldComponentUpdate(e,t){if(this.props.children!==e.children)return!0;if(this.props.droppingPosition!==e.droppingPosition)return!0;const n=(0,l.calcGridItemPosition)(this.getPositionParams(this.props),this.props.x,this.props.y,this.props.w,this.props.h,this.state),r=(0,l.calcGridItemPosition)(this.getPositionParams(e),e.x,e.y,e.w,e.h,t);return!(0,s.fastPositionEqual)(n,r)||this.props.useCSSTransforms!==e.useCSSTransforms}componentDidMount(){this.moveDroppingItem({})}componentDidUpdate(e){this.moveDroppingItem(e)}moveDroppingItem(e){const{droppingPosition:t}=this.props;if(!t)return;const n=this.elementRef.current;if(!n)return;const r=e.droppingPosition||{left:0,top:0},{dragging:a}=this.state,i=a&&t.left!==r.left||t.top!==r.top;if(a){if(i){const e=t.left-a.left,r=t.top-a.top;this.onDrag(t.e,{node:n,deltaX:e,deltaY:r})}}else this.onDragStart(t.e,{node:n,deltaX:t.left,deltaY:t.top})}getPositionParams(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return{cols:e.cols,containerPadding:e.containerPadding,containerWidth:e.containerWidth,margin:e.margin,maxRows:e.maxRows,rowHeight:e.rowHeight}}createStyle(e){const{usePercentages:t,containerWidth:n,useCSSTransforms:r}=this.props;let a;return r?a=(0,s.setTransform)(e):(a=(0,s.setTopLeft)(e),t&&(a.left=(0,s.perc)(e.left/n),a.width=(0,s.perc)(e.width/n))),a}mixinDraggable(e,t){return r.default.createElement(i.DraggableCore,{disabled:!t,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,handle:this.props.handle,cancel:".react-resizable-handle"+(this.props.cancel?","+this.props.cancel:""),scale:this.props.transformScale,nodeRef:this.elementRef},e)}curryResizeHandler(e,t){return(n,r)=>t(n,r,e)}mixinResizable(e,t,n){const{cols:a,minW:i,minH:s,maxW:u,maxH:c,transformScale:d,resizeHandles:p,resizeHandle:h}=this.props,f=this.getPositionParams(),m=(0,l.calcGridItemPosition)(f,0,0,a,0).width,g=(0,l.calcGridItemPosition)(f,0,0,i,s),b=(0,l.calcGridItemPosition)(f,0,0,u,c),y=[g.width,g.height],v=[Math.min(b.width,m),Math.min(b.height,1/0)];return r.default.createElement(o.Resizable,{draggableOpts:{disabled:!n},className:n?void 0:"react-resizable-hide",width:t.width,height:t.height,minConstraints:y,maxConstraints:v,onResizeStop:this.curryResizeHandler(t,this.onResizeStop),onResizeStart:this.curryResizeHandler(t,this.onResizeStart),onResize:this.curryResizeHandler(t,this.onResize),transformScale:d,resizeHandles:p,handle:h},e)}onResizeHandler(e,t,n,r){let{node:a,size:i,handle:o}=t;const u=this.props[r];if(!u)return;const{x:c,y:d,i:p,maxH:h,minH:f,containerWidth:m}=this.props,{minW:g,maxW:b}=this.props;let y=i;a&&(y=(0,s.resizeItemInDirection)(o,n,i,m),this.setState({resizing:"onResizeStop"===r?null:y}));let{w:v,h:w}=(0,l.calcWH)(this.getPositionParams(),y.width,y.height,c,d,o);v=(0,l.clamp)(v,Math.max(g,1),b),w=(0,l.clamp)(w,f,h),u.call(this,p,v,w,{e,node:a,size:y,handle:o})}render(){const{x:e,y:t,w:n,h:a,isDraggable:i,isResizable:o,droppingPosition:s,useCSSTransforms:u}=this.props,d=(0,l.calcGridItemPosition)(this.getPositionParams(),e,t,n,a,this.state),p=r.default.Children.only(this.props.children);let h=r.default.cloneElement(p,{ref:this.elementRef,className:(0,c.default)("react-grid-item",p.props.className,this.props.className,{static:this.props.static,resizing:Boolean(this.state.resizing),"react-draggable":i,"react-draggable-dragging":Boolean(this.state.dragging),dropping:Boolean(s),cssTransforms:u}),style:{...this.props.style,...p.props.style,...this.createStyle(d)}});return h=this.mixinResizable(h,d,o),h=this.mixinDraggable(h,i),h}}t.default=h,p(h,"propTypes",{children:a.default.element,cols:a.default.number.isRequired,containerWidth:a.default.number.isRequired,rowHeight:a.default.number.isRequired,margin:a.default.array.isRequired,maxRows:a.default.number.isRequired,containerPadding:a.default.array.isRequired,x:a.default.number.isRequired,y:a.default.number.isRequired,w:a.default.number.isRequired,h:a.default.number.isRequired,minW:function(e,t){const n=e[t];return"number"!=typeof n?new Error("minWidth not Number"):n>e.w||n>e.maxW?new Error("minWidth larger than item width/maxWidth"):void 0},maxW:function(e,t){const n=e[t];return"number"!=typeof n?new Error("maxWidth not Number"):n<e.w||n<e.minW?new Error("maxWidth smaller than item width/minWidth"):void 0},minH:function(e,t){const n=e[t];return"number"!=typeof n?new Error("minHeight not Number"):n>e.h||n>e.maxH?new Error("minHeight larger than item height/maxHeight"):void 0},maxH:function(e,t){const n=e[t];return"number"!=typeof n?new Error("maxHeight not Number"):n<e.h||n<e.minH?new Error("maxHeight smaller than item height/minHeight"):void 0},i:a.default.string.isRequired,resizeHandles:u.resizeHandleAxesType,resizeHandle:u.resizeHandleType,onDragStop:a.default.func,onDragStart:a.default.func,onDrag:a.default.func,onResizeStop:a.default.func,onResizeStart:a.default.func,onResize:a.default.func,isDraggable:a.default.bool.isRequired,isResizable:a.default.bool.isRequired,isBounded:a.default.bool.isRequired,static:a.default.bool,useCSSTransforms:a.default.bool.isRequired,transformScale:a.default.number,className:a.default.string,handle:a.default.string,cancel:a.default.string,droppingPosition:a.default.shape({e:a.default.object.isRequired,left:a.default.number.isRequired,top:a.default.number.isRequired})}),p(h,"defaultProps",{className:"",cancel:"",handle:"",minH:1,minW:1,maxH:1/0,maxW:1/0,transformScale:1})},548:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=a?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(n(959)),a=n(150),i=c(n(135)),o=n(0),s=n(664),l=c(n(598)),u=c(n(184));function c(e){return e&&e.__esModule?e:{default:e}}function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}function p(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const h="react-grid-layout";let f=!1;try{f=/firefox/i.test(navigator.userAgent)}catch(e){}class m extends r.Component{constructor(){super(...arguments),p(this,"state",{activeDrag:null,layout:(0,o.synchronizeLayoutWithChildren)(this.props.layout,this.props.children,this.props.cols,(0,o.compactType)(this.props),this.props.allowOverlap),mounted:!1,oldDragItem:null,oldLayout:null,oldResizeItem:null,resizing:!1,droppingDOMNode:null,children:[]}),p(this,"dragEnterCounter",0),p(this,"onDragStart",((e,t,n,r)=>{let{e:a,node:i}=r;const{layout:s}=this.state,l=(0,o.getLayoutItem)(s,e);if(!l)return;const u={w:l.w,h:l.h,x:l.x,y:l.y,placeholder:!0,i:e};return this.setState({oldDragItem:(0,o.cloneLayoutItem)(l),oldLayout:s,activeDrag:u}),this.props.onDragStart(s,l,l,null,a,i)})),p(this,"onDrag",((e,t,n,r)=>{let{e:a,node:i}=r;const{oldDragItem:s}=this.state;let{layout:l}=this.state;const{cols:u,allowOverlap:c,preventCollision:d}=this.props,p=(0,o.getLayoutItem)(l,e);if(!p)return;const h={w:p.w,h:p.h,x:p.x,y:p.y,placeholder:!0,i:e};l=(0,o.moveElement)(l,p,t,n,!0,d,(0,o.compactType)(this.props),u,c),this.props.onDrag(l,s,p,h,a,i),this.setState({layout:c?l:(0,o.compact)(l,(0,o.compactType)(this.props),u),activeDrag:h})})),p(this,"onDragStop",((e,t,n,r)=>{let{e:a,node:i}=r;if(!this.state.activeDrag)return;const{oldDragItem:s}=this.state;let{layout:l}=this.state;const{cols:u,preventCollision:c,allowOverlap:d}=this.props,p=(0,o.getLayoutItem)(l,e);if(!p)return;l=(0,o.moveElement)(l,p,t,n,!0,c,(0,o.compactType)(this.props),u,d);const h=d?l:(0,o.compact)(l,(0,o.compactType)(this.props),u);this.props.onDragStop(h,s,p,null,a,i);const{oldLayout:f}=this.state;this.setState({activeDrag:null,layout:h,oldDragItem:null,oldLayout:null}),this.onLayoutMaybeChanged(h,f)})),p(this,"onResizeStart",((e,t,n,r)=>{let{e:a,node:i}=r;const{layout:s}=this.state,l=(0,o.getLayoutItem)(s,e);l&&(this.setState({oldResizeItem:(0,o.cloneLayoutItem)(l),oldLayout:this.state.layout,resizing:!0}),this.props.onResizeStart(s,l,l,null,a,i))})),p(this,"onResize",((e,t,n,r)=>{let{e:a,node:i,size:s,handle:l}=r;const{oldResizeItem:u}=this.state,{layout:c}=this.state,{cols:d,preventCollision:p,allowOverlap:h}=this.props;let f,m,g,b=!1;const[y,v]=(0,o.withLayoutItem)(c,e,(e=>{let r;return m=e.x,g=e.y,-1!==["sw","w","nw","n","ne"].indexOf(l)&&(-1!==["sw","nw","w"].indexOf(l)&&(m=e.x+(e.w-t),t=e.x!==m&&m<0?e.w:t,m=m<0?0:m),-1!==["ne","n","nw"].indexOf(l)&&(g=e.y+(e.h-n),n=e.y!==g&&g<0?e.h:n,g=g<0?0:g),b=!0),p&&!h&&(r=(0,o.getAllCollisions)(c,{...e,w:t,h:n,x:m,y:g}).filter((t=>t.i!==e.i)).length>0,r&&(g=e.y,n=e.h,m=e.x,t=e.w,b=!1)),e.w=t,e.h=n,e}));if(!v)return;if(f=y,b){const e=!0;f=(0,o.moveElement)(y,v,m,g,e,this.props.preventCollision,(0,o.compactType)(this.props),d,h)}const w={w:v.w,h:v.h,x:v.x,y:v.y,static:!0,i:e};this.props.onResize(f,u,v,w,a,i),this.setState({layout:h?f:(0,o.compact)(f,(0,o.compactType)(this.props),d),activeDrag:w})})),p(this,"onResizeStop",((e,t,n,r)=>{let{e:a,node:i}=r;const{layout:s,oldResizeItem:l}=this.state,{cols:u,allowOverlap:c}=this.props,d=(0,o.getLayoutItem)(s,e),p=c?s:(0,o.compact)(s,(0,o.compactType)(this.props),u);this.props.onResizeStop(p,l,d,null,a,i);const{oldLayout:h}=this.state;this.setState({activeDrag:null,layout:p,oldResizeItem:null,oldLayout:null,resizing:!1}),this.onLayoutMaybeChanged(p,h)})),p(this,"onDragOver",(e=>{if(e.preventDefault(),e.stopPropagation(),f&&!e.nativeEvent.target?.classList.contains(h))return!1;const{droppingItem:t,onDropDragOver:n,margin:a,cols:i,rowHeight:o,maxRows:l,width:u,containerPadding:c,transformScale:d}=this.props,p=n?.(e);if(!1===p)return this.state.droppingDOMNode&&this.removeDroppingPlaceholder(),!1;const m={...t,...p},{layout:g}=this.state,b=e.currentTarget.getBoundingClientRect(),y=e.clientX-b.left,v=e.clientY-b.top,w={left:y/d,top:v/d,e};if(this.state.droppingDOMNode){if(this.state.droppingPosition){const{left:e,top:t}=this.state.droppingPosition;(e!=y||t!=v)&&this.setState({droppingPosition:w})}}else{const e={cols:i,margin:a,maxRows:l,rowHeight:o,containerWidth:u,containerPadding:c||a},t=(0,s.calcXY)(e,v,y,m.w,m.h);this.setState({droppingDOMNode:r.createElement("div",{key:m.i}),droppingPosition:w,layout:[...g,{...m,x:t.x,y:t.y,static:!1,isDraggable:!0}]})}})),p(this,"removeDroppingPlaceholder",(()=>{const{droppingItem:e,cols:t}=this.props,{layout:n}=this.state,r=(0,o.compact)(n.filter((t=>t.i!==e.i)),(0,o.compactType)(this.props),t,this.props.allowOverlap);this.setState({layout:r,droppingDOMNode:null,activeDrag:null,droppingPosition:void 0})})),p(this,"onDragLeave",(e=>{e.preventDefault(),e.stopPropagation(),this.dragEnterCounter--,0===this.dragEnterCounter&&this.removeDroppingPlaceholder()})),p(this,"onDragEnter",(e=>{e.preventDefault(),e.stopPropagation(),this.dragEnterCounter++})),p(this,"onDrop",(e=>{e.preventDefault(),e.stopPropagation();const{droppingItem:t}=this.props,{layout:n}=this.state,r=n.find((e=>e.i===t.i));this.dragEnterCounter=0,this.removeDroppingPlaceholder(),this.props.onDrop(n,r,e)}))}componentDidMount(){this.setState({mounted:!0}),this.onLayoutMaybeChanged(this.state.layout,this.props.layout)}static getDerivedStateFromProps(e,t){let n;return t.activeDrag?null:((0,a.deepEqual)(e.layout,t.propsLayout)&&e.compactType===t.compactType?(0,o.childrenEqual)(e.children,t.children)||(n=t.layout):n=e.layout,n?{layout:(0,o.synchronizeLayoutWithChildren)(n,e.children,e.cols,(0,o.compactType)(e),e.allowOverlap),compactType:e.compactType,children:e.children,propsLayout:e.layout}:null)}shouldComponentUpdate(e,t){return this.props.children!==e.children||!(0,o.fastRGLPropsEqual)(this.props,e,a.deepEqual)||this.state.activeDrag!==t.activeDrag||this.state.mounted!==t.mounted||this.state.droppingPosition!==t.droppingPosition}componentDidUpdate(e,t){if(!this.state.activeDrag){const e=this.state.layout,n=t.layout;this.onLayoutMaybeChanged(e,n)}}containerHeight(){if(!this.props.autoSize)return;const e=(0,o.bottom)(this.state.layout),t=this.props.containerPadding?this.props.containerPadding[1]:this.props.margin[1];return e*this.props.rowHeight+(e-1)*this.props.margin[1]+2*t+"px"}onLayoutMaybeChanged(e,t){t||(t=this.state.layout),(0,a.deepEqual)(t,e)||this.props.onLayoutChange(e)}placeholder(){const{activeDrag:e}=this.state;if(!e)return null;const{width:t,cols:n,margin:a,containerPadding:i,rowHeight:o,maxRows:s,useCSSTransforms:u,transformScale:c}=this.props;return r.createElement(l.default,{w:e.w,h:e.h,x:e.x,y:e.y,i:e.i,className:"react-grid-placeholder "+(this.state.resizing?"placeholder-resizing":""),containerWidth:t,cols:n,margin:a,containerPadding:i||a,maxRows:s,rowHeight:o,isDraggable:!1,isResizable:!1,isBounded:!1,useCSSTransforms:u,transformScale:c},r.createElement("div",null))}processGridItem(e,t){if(!e||!e.key)return;const n=(0,o.getLayoutItem)(this.state.layout,String(e.key));if(!n)return null;const{width:a,cols:i,margin:s,containerPadding:u,rowHeight:c,maxRows:d,isDraggable:p,isResizable:h,isBounded:f,useCSSTransforms:m,transformScale:g,draggableCancel:b,draggableHandle:y,resizeHandles:v,resizeHandle:w}=this.props,{mounted:O,droppingPosition:S}=this.state,_="boolean"==typeof n.isDraggable?n.isDraggable:!n.static&&p,x="boolean"==typeof n.isResizable?n.isResizable:!n.static&&h,P=n.resizeHandles||v,C=_&&f&&!1!==n.isBounded;return r.createElement(l.default,{containerWidth:a,cols:i,margin:s,containerPadding:u||s,maxRows:d,rowHeight:c,cancel:b,handle:y,onDragStop:this.onDragStop,onDragStart:this.onDragStart,onDrag:this.onDrag,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,isDraggable:_,isResizable:x,isBounded:C,useCSSTransforms:m&&O,usePercentages:!O,transformScale:g,w:n.w,h:n.h,x:n.x,y:n.y,i:n.i,minH:n.minH,minW:n.minW,maxH:n.maxH,maxW:n.maxW,static:n.static,droppingPosition:t?S:void 0,resizeHandles:P,resizeHandle:w},e)}render(){const{className:e,style:t,isDroppable:n,innerRef:a}=this.props,s=(0,i.default)(h,e),l={height:this.containerHeight(),...t};return r.createElement("div",{ref:a,className:s,style:l,onDrop:n?this.onDrop:o.noop,onDragLeave:n?this.onDragLeave:o.noop,onDragEnter:n?this.onDragEnter:o.noop,onDragOver:n?this.onDragOver:o.noop},r.Children.map(this.props.children,(e=>this.processGridItem(e))),n&&this.state.droppingDOMNode&&this.processGridItem(this.state.droppingDOMNode,!0),this.placeholder())}}t.default=m,p(m,"displayName","ReactGridLayout"),p(m,"propTypes",u.default),p(m,"defaultProps",{autoSize:!0,cols:12,className:"",style:{},draggableHandle:"",draggableCancel:"",containerPadding:null,rowHeight:150,maxRows:1/0,layout:[],margin:[10,10],isBounded:!1,isDraggable:!0,isResizable:!0,allowOverlap:!1,isDroppable:!1,useCSSTransforms:!0,transformScale:1,verticalCompact:!0,compactType:"vertical",preventCollision:!1,droppingItem:{i:"__dropping-elem__",h:1,w:1},resizeHandles:["se"],onLayoutChange:o.noop,onDragStart:o.noop,onDrag:o.noop,onDragStop:o.noop,onResizeStart:o.noop,onResize:o.noop,onResizeStop:o.noop,onDrop:o.noop,onDropDragOver:o.noop})},184:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resizeHandleType=t.resizeHandleAxesType=t.default=void 0;var r=i(n(217)),a=i(n(959));function i(e){return e&&e.__esModule?e:{default:e}}const o=t.resizeHandleAxesType=r.default.arrayOf(r.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),s=t.resizeHandleType=r.default.oneOfType([r.default.node,r.default.func]);t.default={className:r.default.string,style:r.default.object,width:r.default.number,autoSize:r.default.bool,cols:r.default.number,draggableCancel:r.default.string,draggableHandle:r.default.string,verticalCompact:function(e){e.verticalCompact},compactType:r.default.oneOf(["vertical","horizontal"]),layout:function(e){var t=e.layout;void 0!==t&&n(0).validateLayout(t,"layout")},margin:r.default.arrayOf(r.default.number),containerPadding:r.default.arrayOf(r.default.number),rowHeight:r.default.number,maxRows:r.default.number,isBounded:r.default.bool,isDraggable:r.default.bool,isResizable:r.default.bool,allowOverlap:r.default.bool,preventCollision:r.default.bool,useCSSTransforms:r.default.bool,transformScale:r.default.number,isDroppable:r.default.bool,resizeHandles:o,resizeHandle:s,onLayoutChange:r.default.func,onDragStart:r.default.func,onDrag:r.default.func,onDragStop:r.default.func,onResizeStart:r.default.func,onResize:r.default.func,onResizeStop:r.default.func,onDrop:r.default.func,droppingItem:r.default.shape({i:r.default.string.isRequired,w:r.default.number.isRequired,h:r.default.number.isRequired}),children:function(e,t){const n=e[t],r={};a.default.Children.forEach(n,(function(e){if(null!=e?.key){if(r[e.key])throw new Error('Duplicate child key "'+e.key+'" found! This will cause problems in ReactGridLayout.');r[e.key]=!0}}))},innerRef:r.default.any}},46:(e,t,n)=>{"use strict";t.default=void 0;var r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=a?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(n(959)),a=u(n(217)),i=n(150),o=n(0),s=n(218),l=u(n(548));function u(e){return e&&e.__esModule?e:{default:e}}function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(this,arguments)}function p(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const h=e=>Object.prototype.toString.call(e);function f(e,t){return null==e?null:Array.isArray(e)?e:e[t]}class m extends r.Component{constructor(){super(...arguments),p(this,"state",this.generateInitialState()),p(this,"onLayoutChange",(e=>{this.props.onLayoutChange(e,{...this.props.layouts,[this.state.breakpoint]:e})}))}generateInitialState(){const{width:e,breakpoints:t,layouts:n,cols:r}=this.props,a=(0,s.getBreakpointFromWidth)(t,e),i=(0,s.getColsFromBreakpoint)(a,r),o=!1===this.props.verticalCompact?null:this.props.compactType;return{layout:(0,s.findOrGenerateResponsiveLayout)(n,t,a,a,i,o),breakpoint:a,cols:i}}static getDerivedStateFromProps(e,t){if(!(0,i.deepEqual)(e.layouts,t.layouts)){const{breakpoint:n,cols:r}=t;return{layout:(0,s.findOrGenerateResponsiveLayout)(e.layouts,e.breakpoints,n,n,r,e.compactType),layouts:e.layouts}}return null}componentDidUpdate(e){this.props.width==e.width&&this.props.breakpoint===e.breakpoint&&(0,i.deepEqual)(this.props.breakpoints,e.breakpoints)&&(0,i.deepEqual)(this.props.cols,e.cols)||this.onWidthChange(e)}onWidthChange(e){const{breakpoints:t,cols:n,layouts:r,compactType:a}=this.props,i=this.props.breakpoint||(0,s.getBreakpointFromWidth)(this.props.breakpoints,this.props.width),l=this.state.breakpoint,u=(0,s.getColsFromBreakpoint)(i,n),c={...r};if(l!==i||e.breakpoints!==t||e.cols!==n){l in c||(c[l]=(0,o.cloneLayout)(this.state.layout));let e=(0,s.findOrGenerateResponsiveLayout)(c,t,i,l,u,a);e=(0,o.synchronizeLayoutWithChildren)(e,this.props.children,u,a,this.props.allowOverlap),c[i]=e,this.props.onBreakpointChange(i,u),this.props.onLayoutChange(e,c),this.setState({breakpoint:i,layout:e,cols:u})}const d=f(this.props.margin,i),p=f(this.props.containerPadding,i);this.props.onWidthChange(this.props.width,d,u,p)}render(){const{breakpoint:e,breakpoints:t,cols:n,layouts:a,margin:i,containerPadding:o,onBreakpointChange:s,onLayoutChange:u,onWidthChange:c,...p}=this.props;return r.createElement(l.default,d({},p,{margin:f(i,this.state.breakpoint),containerPadding:f(o,this.state.breakpoint),onLayoutChange:this.onLayoutChange,layout:this.state.layout,cols:this.state.cols}))}}t.default=m,p(m,"propTypes",{breakpoint:a.default.string,breakpoints:a.default.object,allowOverlap:a.default.bool,cols:a.default.object,margin:a.default.oneOfType([a.default.array,a.default.object]),containerPadding:a.default.oneOfType([a.default.array,a.default.object]),layouts(e,t){if("[object Object]"!==h(e[t]))throw new Error("Layout property must be an object. Received: "+h(e[t]));Object.keys(e[t]).forEach((t=>{if(!(t in e.breakpoints))throw new Error("Each key in layouts must align with a key in breakpoints.");(0,o.validateLayout)(e.layouts[t],"layouts."+t)}))},width:a.default.number.isRequired,onBreakpointChange:a.default.func,onLayoutChange:a.default.func,onWidthChange:a.default.func}),p(m,"defaultProps",{breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},containerPadding:{lg:null,md:null,sm:null,xs:null,xxs:null},layouts:{},margin:[10,10],allowOverlap:!1,onBreakpointChange:o.noop,onLayoutChange:o.noop,onWidthChange:o.noop})},664:(e,t)=>{"use strict";function n(e){const{margin:t,containerPadding:n,containerWidth:r,cols:a}=e;return(r-t[0]*(a-1)-2*n[0])/a}function r(e,t,n){return Number.isFinite(e)?Math.round(t*e+Math.max(0,e-1)*n):e}function a(e,t,n){return Math.max(Math.min(e,n),t)}Object.defineProperty(t,"__esModule",{value:!0}),t.calcGridColWidth=n,t.calcGridItemPosition=function(e,t,a,i,o,s){const{margin:l,containerPadding:u,rowHeight:c}=e,d=n(e),p={};return s&&s.resizing?(p.width=Math.round(s.resizing.width),p.height=Math.round(s.resizing.height)):(p.width=r(i,d,l[0]),p.height=r(o,c,l[1])),s&&s.dragging?(p.top=Math.round(s.dragging.top),p.left=Math.round(s.dragging.left)):s&&s.resizing&&"number"==typeof s.resizing.top&&"number"==typeof s.resizing.left?(p.top=Math.round(s.resizing.top),p.left=Math.round(s.resizing.left)):(p.top=Math.round((c+l[1])*a+u[1]),p.left=Math.round((d+l[0])*t+u[0])),p},t.calcGridItemWHPx=r,t.calcWH=function(e,t,r,i,o,s){const{margin:l,maxRows:u,cols:c,rowHeight:d}=e,p=n(e);let h=Math.round((t+l[0])/(p+l[0])),f=Math.round((r+l[1])/(d+l[1])),m=a(h,0,c-i),g=a(f,0,u-o);return-1!==["sw","w","nw"].indexOf(s)&&(m=a(h,0,c)),-1!==["nw","n","ne"].indexOf(s)&&(g=a(f,0,u)),{w:m,h:g}},t.calcXY=function(e,t,r,i,o){const{margin:s,containerPadding:l,cols:u,rowHeight:c,maxRows:d}=e,p=n(e);let h=Math.round((r-l[0])/(p+s[0])),f=Math.round((t-l[1])/(c+s[1]));return h=a(h,0,u-i),f=a(f,0,d-o),{x:h,y:f}},t.clamp=a},647:(e,t,n)=>{"use strict";t.default=function(e){var t;return t=class extends r.Component{constructor(){super(...arguments),c(this,"state",{width:1280}),c(this,"elementRef",r.createRef()),c(this,"mounted",!1),c(this,"resizeObserver",void 0)}componentDidMount(){this.mounted=!0,this.resizeObserver=new i.default((e=>{if(this.elementRef.current instanceof HTMLElement){const t=e[0].contentRect.width;this.setState({width:t})}}));const e=this.elementRef.current;e instanceof HTMLElement&&this.resizeObserver.observe(e)}componentWillUnmount(){this.mounted=!1;const e=this.elementRef.current;e instanceof HTMLElement&&this.resizeObserver.unobserve(e),this.resizeObserver.disconnect()}render(){const{measureBeforeMount:t,...n}=this.props;return t&&!this.mounted?r.createElement("div",{className:(0,o.default)(this.props.className,d),style:this.props.style,ref:this.elementRef}):r.createElement(e,u({innerRef:this.elementRef},n,this.state))}},c(t,"defaultProps",{measureBeforeMount:!1}),c(t,"propTypes",{measureBeforeMount:a.default.bool}),t};var r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=a?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(n(959)),a=s(n(217)),i=s(n(909)),o=s(n(135));function s(e){return e&&e.__esModule?e:{default:e}}function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function c(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const d="react-grid-layout"},324:e=>{e.exports=function(e,t,n){return e===t||e.className===t.className&&n(e.style,t.style)&&e.width===t.width&&e.autoSize===t.autoSize&&e.cols===t.cols&&e.draggableCancel===t.draggableCancel&&e.draggableHandle===t.draggableHandle&&n(e.verticalCompact,t.verticalCompact)&&n(e.compactType,t.compactType)&&n(e.layout,t.layout)&&n(e.margin,t.margin)&&n(e.containerPadding,t.containerPadding)&&e.rowHeight===t.rowHeight&&e.maxRows===t.maxRows&&e.isBounded===t.isBounded&&e.isDraggable===t.isDraggable&&e.isResizable===t.isResizable&&e.allowOverlap===t.allowOverlap&&e.preventCollision===t.preventCollision&&e.useCSSTransforms===t.useCSSTransforms&&e.transformScale===t.transformScale&&e.isDroppable===t.isDroppable&&n(e.resizeHandles,t.resizeHandles)&&n(e.resizeHandle,t.resizeHandle)&&e.onLayoutChange===t.onLayoutChange&&e.onDragStart===t.onDragStart&&e.onDrag===t.onDrag&&e.onDragStop===t.onDragStop&&e.onResizeStart===t.onResizeStart&&e.onResize===t.onResize&&e.onResizeStop===t.onResizeStop&&e.onDrop===t.onDrop&&n(e.droppingItem,t.droppingItem)&&n(e.innerRef,t.innerRef)}},218:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findOrGenerateResponsiveLayout=function(e,t,n,i,o,s){if(e[n])return(0,r.cloneLayout)(e[n]);let l=e[i];const u=a(t),c=u.slice(u.indexOf(n));for(let t=0,n=c.length;t<n;t++){const n=c[t];if(e[n]){l=e[n];break}}return l=(0,r.cloneLayout)(l||[]),(0,r.compact)((0,r.correctBounds)(l,{cols:o}),s,o)},t.getBreakpointFromWidth=function(e,t){const n=a(e);let r=n[0];for(let a=1,i=n.length;a<i;a++){const i=n[a];t>e[i]&&(r=i)}return r},t.getColsFromBreakpoint=function(e,t){if(!t[e])throw new Error("ResponsiveReactGridLayout: `cols` entry for breakpoint "+e+" is missing!");return t[e]},t.sortBreakpoints=a;var r=n(0);function a(e){return Object.keys(e).sort((function(t,n){return e[t]-e[n]}))}},0:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bottom=l,t.childrenEqual=function(e,t){return(0,a.deepEqual)(i.default.Children.map(e,(e=>e?.key)),i.default.Children.map(t,(e=>e?.key)))&&(0,a.deepEqual)(i.default.Children.map(e,(e=>e?.props["data-grid"])),i.default.Children.map(t,(e=>e?.props["data-grid"])))},t.cloneLayout=u,t.cloneLayoutItem=d,t.collides=p,t.compact=h,t.compactItem=g,t.compactType=function(e){const{verticalCompact:t,compactType:n}=e||{};return!1===t?null:n},t.correctBounds=b,t.fastPositionEqual=function(e,t){return e.left===t.left&&e.top===t.top&&e.width===t.width&&e.height===t.height},t.fastRGLPropsEqual=void 0,t.getAllCollisions=w,t.getFirstCollision=v,t.getLayoutItem=y,t.getStatics=O,t.modifyLayout=c,t.moveElement=S,t.moveElementAwayFromCollision=_,t.noop=void 0,t.perc=function(e){return 100*e+"%"},t.resizeItemInDirection=function(e,t,n,r){const a=R[e];return a?a(t,{...t,...n},r):n},t.setTopLeft=function(e){let{top:t,left:n,width:r,height:a}=e;return{top:`${t}px`,left:`${n}px`,width:`${r}px`,height:`${a}px`,position:"absolute"}},t.setTransform=function(e){let{top:t,left:n,width:r,height:a}=e;const i=`translate(${n}px,${t}px)`;return{transform:i,WebkitTransform:i,MozTransform:i,msTransform:i,OTransform:i,width:`${r}px`,height:`${a}px`,position:"absolute"}},t.sortLayoutItems=A,t.sortLayoutItemsByColRow=M,t.sortLayoutItemsByRowCol=I,t.synchronizeLayoutWithChildren=function(e,t,n,r,a){e=e||[];const s=[];i.default.Children.forEach(t,(t=>{if(null==t?.key)return;const n=y(e,String(t.key)),r=t.props["data-grid"];n&&null==r?s.push(d(n)):r?(o||V([r],"ReactGridLayout.children"),s.push(d({...r,i:t.key}))):s.push(d({w:1,h:1,x:0,y:l(s),i:String(t.key)}))}));const u=b(s,{cols:n});return a?u:h(u,r,n)},t.validateLayout=V,t.withLayoutItem=function(e,t,n){let r=y(e,t);return r?(r=n(d(r)),[e=c(e,r),r]):[e,null]};var r,a=n(150),i=(r=n(959))&&r.__esModule?r:{default:r};const o=!0,s=!1;function l(e){let t,n=0;for(let r=0,a=e.length;r<a;r++)t=e[r].y+e[r].h,t>n&&(n=t);return n}function u(e){const t=Array(e.length);for(let n=0,r=e.length;n<r;n++)t[n]=d(e[n]);return t}function c(e,t){const n=Array(e.length);for(let r=0,a=e.length;r<a;r++)t.i===e[r].i?n[r]=t:n[r]=e[r];return n}function d(e){return{w:e.w,h:e.h,x:e.x,y:e.y,i:e.i,minW:e.minW,maxW:e.maxW,minH:e.minH,maxH:e.maxH,moved:Boolean(e.moved),static:Boolean(e.static),isDraggable:e.isDraggable,isResizable:e.isResizable,resizeHandles:e.resizeHandles,isBounded:e.isBounded}}function p(e,t){return!(e.i===t.i||e.x+e.w<=t.x||e.x>=t.x+t.w||e.y+e.h<=t.y||e.y>=t.y+t.h)}function h(e,t,n,r){const a=O(e),i=A(e,t),o=Array(e.length);for(let s=0,l=i.length;s<l;s++){let l=d(i[s]);l.static||(l=g(a,l,t,n,i,r),a.push(l)),o[e.indexOf(i[s])]=l,l.moved=!1}return o}t.fastRGLPropsEqual=n(324);const f={x:"w",y:"h"};function m(e,t,n,r){const a=f[r];t[r]+=1;for(let i=e.map((e=>e.i)).indexOf(t.i)+1;i<e.length;i++){const o=e[i];if(!o.static){if(o.y>t.y+t.h)break;p(t,o)&&m(e,o,n+t[a],r)}}t[r]=n}function g(e,t,n,r,a,i){const o="horizontal"===n;if("vertical"===n)for(t.y=Math.min(l(e),t.y);t.y>0&&!v(e,t);)t.y--;else if(o)for(;t.x>0&&!v(e,t);)t.x--;let s;for(;(s=v(e,t))&&(null!==n||!i);)if(o?m(a,t,s.x+s.w,"x"):m(a,t,s.y+s.h,"y"),o&&t.x+t.w>r)for(t.x=r-t.w,t.y++;t.x>0&&!v(e,t);)t.x--;return t.y=Math.max(t.y,0),t.x=Math.max(t.x,0),t}function b(e,t){const n=O(e);for(let r=0,a=e.length;r<a;r++){const a=e[r];if(a.x+a.w>t.cols&&(a.x=t.cols-a.w),a.x<0&&(a.x=0,a.w=t.cols),a.static)for(;v(n,a);)a.y++;else n.push(a)}return e}function y(e,t){for(let n=0,r=e.length;n<r;n++)if(e[n].i===t)return e[n]}function v(e,t){for(let n=0,r=e.length;n<r;n++)if(p(e[n],t))return e[n]}function w(e,t){return e.filter((e=>p(e,t)))}function O(e){return e.filter((e=>e.static))}function S(e,t,n,r,a,i,o,s,l){if(t.static&&!0!==t.isDraggable)return e;if(t.y===r&&t.x===n)return e;F(`Moving element ${t.i} to [${String(n)},${String(r)}] from [${t.x},${t.y}]`);const c=t.x,d=t.y;"number"==typeof n&&(t.x=n),"number"==typeof r&&(t.y=r),t.moved=!0;let p=A(e,o);("vertical"===o&&"number"==typeof r?d>=r:"horizontal"===o&&"number"==typeof n&&c>=n)&&(p=p.reverse());const h=w(p,t),f=h.length>0;if(f&&l)return u(e);if(f&&i)return F(`Collision prevented on ${t.i}, reverting.`),t.x=c,t.y=d,t.moved=!1,e;for(let n=0,r=h.length;n<r;n++){const r=h[n];F(`Resolving collision between ${t.i} at [${t.x},${t.y}] and ${r.i} at [${r.x},${r.y}]`),r.moved||(e=r.static?_(e,r,t,a,o,s):_(e,t,r,a,o,s))}return e}function _(e,t,n,r,a,i){const o="horizontal"===a,s="vertical"===a,l=t.static;if(r){r=!1;const u={x:o?Math.max(t.x-n.w,0):n.x,y:s?Math.max(t.y-n.h,0):n.y,w:n.w,h:n.h,i:"-1"},c=v(e,u),d=c&&c.y+c.h>t.y,p=c&&t.x+t.w>c.x;if(!c)return F(`Doing reverse collision on ${n.i} up to [${u.x},${u.y}].`),S(e,n,o?u.x:void 0,s?u.y:void 0,r,l,a,i);if(d&&s)return S(e,n,void 0,t.y+1,r,l,a,i);if(d&&null==a)return t.y=n.y,n.y=n.y+n.h,e;if(p&&o)return S(e,t,n.x,void 0,r,l,a,i)}const u=o?n.x+1:void 0,c=s?n.y+1:void 0;return null==u&&null==c?e:S(e,n,o?n.x+1:void 0,s?n.y+1:void 0,r,l,a,i)}const x=(e,t,n,r)=>e+n>r?t:n,P=(e,t,n)=>e<0?t:n,C=e=>Math.max(0,e),E=e=>Math.max(0,e),j=(e,t,n)=>{let{left:r,height:a,width:i}=t;const o=e.top-(a-e.height);return{left:r,width:i,height:P(o,e.height,a),top:E(o)}},D=(e,t,n)=>{let{top:r,left:a,height:i,width:o}=t;return{top:r,height:i,width:x(e.left,e.width,o,n),left:C(a)}},k=(e,t,n)=>{let{top:r,height:a,width:i}=t;const o=e.left-(i-e.width);return{height:a,width:o<0?e.width:x(e.left,e.width,i,n),top:E(r),left:C(o)}},T=(e,t,n)=>{let{top:r,left:a,height:i,width:o}=t;return{width:o,left:a,height:P(r,e.height,i),top:E(r)}},R={n:j,ne:function(){return j(arguments.length<=0?void 0:arguments[0],D(...arguments))},e:D,se:function(){return T(arguments.length<=0?void 0:arguments[0],D(...arguments))},s:T,sw:function(){return T(arguments.length<=0?void 0:arguments[0],k(...arguments))},w:k,nw:function(){return j(arguments.length<=0?void 0:arguments[0],k(...arguments))}};function A(e,t){return"horizontal"===t?M(e):"vertical"===t?I(e):e}function I(e){return e.slice(0).sort((function(e,t){return e.y>t.y||e.y===t.y&&e.x>t.x?1:e.y===t.y&&e.x===t.x?0:-1}))}function M(e){return e.slice(0).sort((function(e,t){return e.x>t.x||e.x===t.x&&e.y>t.y?1:-1}))}function V(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Layout";const n=["x","y","w","h"];if(!Array.isArray(e))throw new Error(t+" must be an array!");for(let r=0,a=e.length;r<a;r++){const a=e[r];for(let e=0;e<n.length;e++){const i=n[e],o=a[i];if("number"!=typeof o||Number.isNaN(o))throw new Error(`ReactGridLayout: ${t}[${r}].${i} must be a number! Received: ${o} (${typeof o})`)}if(void 0!==a.i&&"string"!=typeof a.i)throw new Error(`ReactGridLayout: ${t}[${r}].i must be a string! Received: ${a.i} (${typeof a.i})`)}}function F(){s&&console.log(...arguments)}t.noop=()=>{}},206:(e,t,n)=>{e.exports=n(548).default,e.exports.utils=n(0),e.exports.calculateUtils=n(664),e.exports.Responsive=n(46).default,e.exports.Responsive.utils=n(218),e.exports.WidthProvider=n(647).default},135:e=>{function t(e){var n,r,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(n=0;n<i;n++)e[n]&&(r=t(e[n]))&&(a&&(a+=" "),a+=r)}else for(r in e)e[r]&&(a&&(a+=" "),a+=r);return a}function n(){for(var e,n,r=0,a="",i=arguments.length;r<i;r++)(e=arguments[r])&&(n=t(e))&&(a&&(a+=" "),a+=n);return a}e.exports=n,e.exports.clsx=n},700:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=a?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(n(959)),a=n(460),i=n(448),o=n(51),s=["children","className","draggableOpts","width","height","handle","handleSize","lockAspectRatio","axis","minConstraints","maxConstraints","onResize","onResizeStop","onResizeStart","resizeHandles","transformScale"];function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}var f=function(e){var t,n;function o(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).handleRefs={},t.lastHandleRect=null,t.slack=null,t}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,h(t,n);var l=o.prototype;return l.componentWillUnmount=function(){this.resetData()},l.resetData=function(){this.lastHandleRect=this.slack=null},l.runConstraints=function(e,t){var n=this.props,r=n.minConstraints,a=n.maxConstraints,i=n.lockAspectRatio;if(!r&&!a&&!i)return[e,t];if(i){var o=this.props.width/this.props.height,s=e-this.props.width,l=t-this.props.height;Math.abs(s)>Math.abs(l*o)?t=e/o:e=t*o}var u=e,c=t,d=this.slack||[0,0],p=d[0],h=d[1];return e+=p,t+=h,r&&(e=Math.max(r[0],e),t=Math.max(r[1],t)),a&&(e=Math.min(a[0],e),t=Math.min(a[1],t)),this.slack=[p+(u-e),h+(c-t)],[e,t]},l.resizeHandler=function(e,t){var n=this;return function(r,a){var i=a.node,o=a.deltaX,s=a.deltaY;"onResizeStart"===e&&n.resetData();var l=("both"===n.props.axis||"x"===n.props.axis)&&"n"!==t&&"s"!==t,u=("both"===n.props.axis||"y"===n.props.axis)&&"e"!==t&&"w"!==t;if(l||u){var c=t[0],d=t[t.length-1],p=i.getBoundingClientRect();null!=n.lastHandleRect&&("w"===d&&(o+=p.left-n.lastHandleRect.left),"n"===c&&(s+=p.top-n.lastHandleRect.top)),n.lastHandleRect=p,"w"===d&&(o=-o),"n"===c&&(s=-s);var h=n.props.width+(l?o/n.props.transformScale:0),f=n.props.height+(u?s/n.props.transformScale:0),m=n.runConstraints(h,f);h=m[0],f=m[1];var g=h!==n.props.width||f!==n.props.height,b="function"==typeof n.props[e]?n.props[e]:null;b&&!("onResize"===e&&!g)&&(null==r.persist||r.persist(),b(r,{node:i,size:{width:h,height:f},handle:t})),"onResizeStop"===e&&n.resetData()}}},l.renderResizeHandle=function(e,t){var n=this.props.handle;if(!n)return r.createElement("span",{className:"react-resizable-handle react-resizable-handle-"+e,ref:t});if("function"==typeof n)return n(e,t);var a=d({ref:t},"string"==typeof n.type?{}:{handleAxis:e});return r.cloneElement(n,a)},l.render=function(){var e=this,t=this.props,n=t.children,o=t.className,l=t.draggableOpts,c=(t.width,t.height,t.handle,t.handleSize,t.lockAspectRatio,t.axis,t.minConstraints,t.maxConstraints,t.onResize,t.onResizeStop,t.onResizeStart,t.resizeHandles),p=(t.transformScale,function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(t,s));return(0,i.cloneElement)(n,d(d({},p),{},{className:(o?o+" ":"")+"react-resizable",children:[].concat(n.props.children,c.map((function(t){var n,i=null!=(n=e.handleRefs[t])?n:e.handleRefs[t]=r.createRef();return r.createElement(a.DraggableCore,u({},l,{nodeRef:i,key:"resizableHandle-"+t,onStop:e.resizeHandler("onResizeStop",t),onStart:e.resizeHandler("onResizeStart",t),onDrag:e.resizeHandler("onResize",t)}),e.renderResizeHandle(t,i))})))}))},o}(r.Component);t.default=f,f.propTypes=o.resizableProps,f.defaultProps={axis:"both",handleSize:[20,20],lockAspectRatio:!1,minConstraints:[20,20],maxConstraints:[1/0,1/0],resizeHandles:["se"],transformScale:1}},215:(e,t,n)=>{"use strict";t.default=void 0;var r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=a?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(n(959)),a=l(n(217)),i=l(n(700)),o=n(51),s=["handle","handleSize","onResize","onResizeStart","onResizeStop","draggableOpts","minConstraints","maxConstraints","lockAspectRatio","axis","width","height","resizeHandles","style","transformScale"];function l(e){return e&&e.__esModule?e:{default:e}}function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}var m=function(e){var t,n;function a(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={width:t.props.width,height:t.props.height,propsWidth:t.props.width,propsHeight:t.props.height},t.onResize=function(e,n){var r=n.size;t.props.onResize?(null==e.persist||e.persist(),t.setState(r,(function(){return t.props.onResize&&t.props.onResize(e,n)}))):t.setState(r)},t}return n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,f(t,n),a.getDerivedStateFromProps=function(e,t){return t.propsWidth!==e.width||t.propsHeight!==e.height?{width:e.width,height:e.height,propsWidth:e.width,propsHeight:e.height}:null},a.prototype.render=function(){var e=this.props,t=e.handle,n=e.handleSize,a=(e.onResize,e.onResizeStart),o=e.onResizeStop,l=e.draggableOpts,u=e.minConstraints,d=e.maxConstraints,h=e.lockAspectRatio,f=e.axis,m=(e.width,e.height,e.resizeHandles),g=e.style,b=e.transformScale,y=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,s);return r.createElement(i.default,{axis:f,draggableOpts:l,handle:t,handleSize:n,height:this.state.height,lockAspectRatio:h,maxConstraints:d,minConstraints:u,onResizeStart:a,onResize:this.onResize,onResizeStop:o,resizeHandles:m,transformScale:b,width:this.state.width},r.createElement("div",c({},y,{style:p(p({},g),{},{width:this.state.width+"px",height:this.state.height+"px"})})))},a}(r.Component);t.default=m,m.propTypes=p(p({},o.resizableProps),{},{children:a.default.element})},51:(e,t,n)=>{"use strict";t.__esModule=!0,t.resizableProps=void 0;var r,a=(r=n(217))&&r.__esModule?r:{default:r};n(460);var i={axis:a.default.oneOf(["both","x","y","none"]),className:a.default.string,children:a.default.element.isRequired,draggableOpts:a.default.shape({allowAnyClick:a.default.bool,cancel:a.default.string,children:a.default.node,disabled:a.default.bool,enableUserSelectHack:a.default.bool,offsetParent:a.default.node,grid:a.default.arrayOf(a.default.number),handle:a.default.string,nodeRef:a.default.object,onStart:a.default.func,onDrag:a.default.func,onStop:a.default.func,onMouseDown:a.default.func,scale:a.default.number}),height:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i=t[0];return"both"===i.axis||"y"===i.axis?(r=a.default.number).isRequired.apply(r,t):a.default.number.apply(a.default,t)},handle:a.default.oneOfType([a.default.node,a.default.func]),handleSize:a.default.arrayOf(a.default.number),lockAspectRatio:a.default.bool,maxConstraints:a.default.arrayOf(a.default.number),minConstraints:a.default.arrayOf(a.default.number),onResizeStop:a.default.func,onResizeStart:a.default.func,onResize:a.default.func,resizeHandles:a.default.arrayOf(a.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),transformScale:a.default.number,width:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i=t[0];return"both"===i.axis||"x"===i.axis?(r=a.default.number).isRequired.apply(r,t):a.default.number.apply(a.default,t)}};t.resizableProps=i},448:(e,t,n)=>{"use strict";t.__esModule=!0,t.cloneElement=function(e,t){return t.style&&e.props.style&&(t.style=o(o({},e.props.style),t.style)),t.className&&e.props.className&&(t.className=e.props.className+" "+t.className),a.default.cloneElement(e,t)};var r,a=(r=n(959))&&r.__esModule?r:{default:r};function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},134:(e,t,n)=>{"use strict";e.exports=function(){throw new Error("Don't instantiate Resizable directly! Use require('react-resizable').Resizable")},e.exports.Resizable=n(700).default,e.exports.ResizableBox=n(215).default},909:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>_});var r=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var n=-1;return e.some((function(e,r){return e[0]===t&&(n=r,!0)})),n}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var n=e(this.__entries__,t),r=this.__entries__[n];return r&&r[1]},t.prototype.set=function(t,n){var r=e(this.__entries__,t);~r?this.__entries__[r][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,r=e(n,t);~r&&n.splice(r,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,r=this.__entries__;n<r.length;n++){var a=r[n];e.call(t,a[1],a[0])}},t}()}(),a="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,i=void 0!==n.g&&n.g.Math===Math?n.g:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),o="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(i):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)},s=["top","right","bottom","left","width","height","size","weight"],l="undefined"!=typeof MutationObserver,u=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e){var t=!1,n=!1,r=0;function a(){t&&(t=!1,e()),n&&s()}function i(){o(a)}function s(){var e=Date.now();if(t){if(e-r<2)return;n=!0}else t=!0,n=!1,setTimeout(i,20);r=e}return s}(this.refresh.bind(this))}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){a&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),l?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){a&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=void 0===t?"":t;s.some((function(e){return!!~n.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),c=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var a=r[n];Object.defineProperty(e,a,{value:t[a],enumerable:!1,writable:!1,configurable:!0})}return e},d=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||i},p=b(0,0,0,0);function h(e){return parseFloat(e)||0}function f(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(t,n){return t+h(e["border-"+n+"-width"])}),0)}var m="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof d(e).SVGGraphicsElement}:function(e){return e instanceof d(e).SVGElement&&"function"==typeof e.getBBox};function g(e){return a?m(e)?function(e){var t=e.getBBox();return b(0,0,t.width,t.height)}(e):function(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return p;var r=d(e).getComputedStyle(e),a=function(e){for(var t={},n=0,r=["top","right","bottom","left"];n<r.length;n++){var a=r[n],i=e["padding-"+a];t[a]=h(i)}return t}(r),i=a.left+a.right,o=a.top+a.bottom,s=h(r.width),l=h(r.height);if("border-box"===r.boxSizing&&(Math.round(s+i)!==t&&(s-=f(r,"left","right")+i),Math.round(l+o)!==n&&(l-=f(r,"top","bottom")+o)),!function(e){return e===d(e).document.documentElement}(e)){var u=Math.round(s+i)-t,c=Math.round(l+o)-n;1!==Math.abs(u)&&(s-=u),1!==Math.abs(c)&&(l-=c)}return b(a.left,a.top,s,l)}(e):p}function b(e,t,n,r){return{x:e,y:t,width:n,height:r}}var y=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=b(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=g(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),v=function(e,t){var n,r,a,i,o,s,l,u=(r=(n=t).x,a=n.y,i=n.width,o=n.height,s="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,l=Object.create(s.prototype),c(l,{x:r,y:a,width:i,height:o,top:a,right:r+i,bottom:o+a,left:r}),l);c(this,{target:e,contentRect:u})},w=function(){function e(e,t,n){if(this.activeObservations_=[],this.observations_=new r,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=n}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof d(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new y(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof d(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new v(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),O="undefined"!=typeof WeakMap?new WeakMap:new r,S=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=u.getInstance(),r=new w(t,n,this);O.set(this,r)};["observe","unobserve","disconnect"].forEach((function(e){S.prototype[e]=function(){var t;return(t=O.get(this))[e].apply(t,arguments)}}));const _=void 0!==i.ResizeObserver?i.ResizeObserver:S},720:(e,t,n)=>{"use strict";e.exports=n.p+"da1ddf82b1124a99aaa5.wasm"},89:t=>{"use strict";t.exports=e},781:e=>{"use strict";e.exports=t},531:e=>{"use strict";e.exports=n},7:e=>{"use strict";e.exports=r},241:e=>{"use strict";e.exports=a},959:e=>{"use strict";e.exports=i},398:e=>{"use strict";e.exports=o},806:e=>{"use strict";e.exports=s},269:e=>{"use strict";e.exports=l}},p={};function h(e){var t=p[e];if(void 0!==t)return t.exports;var n=p[e]={id:e,loaded:!1,exports:{}};return d[e].call(n.exports,n,n.exports,h),n.loaded=!0,n.exports}h.m=d,h.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return h.d(t,{a:t}),t},c=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,h.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var n=Object.create(null);h.r(n);var r={};u=u||[null,c({}),c([]),c(c)];for(var a=2&t&&e;"object"==typeof a&&!~u.indexOf(a);a=c(a))Object.getOwnPropertyNames(a).forEach((t=>r[t]=()=>e[t]));return r.default=()=>e,h.d(n,r),n},h.d=(e,t)=>{for(var n in t)h.o(t,n)&&!h.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},h.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),h.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),h.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),h.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},h.p="public/plugins/grafana-scenes-app/",h.b=document.baseURI||self.location.href;var f={};return(()=>{"use strict";h.r(f),h.d(f,{plugin:()=>rk});var e=h(781),t=h(959),n=h.t(t,2),r=h.n(t);const a=r().createContext(null);var i=h(806);const o=`/a/${JSON.parse('{"id":"grafana-scenes-app"}').id}`;var s;!function(e){e.Home="",e.Demos="demos",e.GrafanaMonitoring="grafana-monitoring",e.ReactDemo="react-only"}(s||(s={}));const l={uid:"gdev-testdata",type:"testdata"};function u(e){return`${o}/${e}`}function c(e){return`${u(s.Demos)}/${e}`}var d=h(531),p=Object.defineProperty,m=Object.getOwnPropertySymbols,g=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable,y=(e,t,n)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function v(t,n,r){const a=((e,t)=>{for(var n in t||(t={}))g.call(t,n)&&y(e,n,t[n]);if(m)for(var n of m(t))b.call(t,n)&&y(e,n,t[n]);return e})({},n);if(r)for(const e of Object.keys(a))r.includes(e)||delete a[e];return e.urlUtil.renderUrl(e.locationUtil.assureBaseUrl(t),a)}function w(e,t){return r().createElement(e.Component,{model:e,routeProps:t})}var O=Object.defineProperty,S=Object.defineProperties,_=Object.getOwnPropertyDescriptors,x=Object.getOwnPropertySymbols,P=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable,E=(e,t,n)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const j=new Map;var D=h(269);const k={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let T;const R=new Uint8Array(16);function A(){if(!T&&(T="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!T))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return T(R)}const I=[];for(let e=0;e<256;++e)I.push((e+256).toString(16).slice(1));const M=function(e,t,n){if(k.randomUUID&&!t&&!e)return k.randomUUID();const r=(e=e||{}).random||(e.rng||A)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return(I[e[t+0]]+I[e[t+1]]+I[e[t+2]]+I[e[t+3]]+"-"+I[e[t+4]]+I[e[t+5]]+"-"+I[e[t+6]]+I[e[t+7]]+"-"+I[e[t+8]]+I[e[t+9]]+"-"+I[e[t+10]]+I[e[t+11]]+I[e[t+12]]+I[e[t+13]]+I[e[t+14]]+I[e[t+15]]).toLowerCase()}(r)};var V=Object.defineProperty,F=Object.defineProperties,L=Object.getOwnPropertyDescriptors,$=Object.getOwnPropertySymbols,z=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable,N=(e,t,n)=>t in e?V(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function q(e){var n,a=e,{model:i}=a,o=((e,t)=>{var n={};for(var r in e)z.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&$)for(var r of $(e))t.indexOf(r)<0&&B.call(e,r)&&(n[r]=e[r]);return n})(a,["model"]);const s=null!=(n=i.constructor.Component)?n:W,[l,u]=(0,t.useState)(0);return(0,t.useEffect)((()=>{const e=i.activate();return u((e=>e+1)),e}),[i]),i.isActive||i.renderBeforeActivation?r().createElement(s,(c=((e,t)=>{for(var n in t||(t={}))z.call(t,n)&&N(e,n,t[n]);if($)for(var n of $(t))B.call(t,n)&&N(e,n,t[n]);return e})({},o),F(c,L({model:i})))):null;var c}const H=r().memo(q);function W(e){return null}class U extends e.BusEventWithPayload{}U.type="scene-object-state-change";class G extends e.BusEventWithPayload{}G.type="scene-object-user-action";var Q,K=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};class Y{resolve(){return K(this,e=Q,"read from private field"),e.get(this);var e}constructor(e){var t,n;((e,t)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,void 0)})(this,Q),n=e,K(this,t=Q,"write to private field"),t.set(this,n)}}Q=new WeakMap;var Z=Object.defineProperty,X=Object.getOwnPropertySymbols,J=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable,te=(e,t,n)=>t in e?Z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ne=(e,t)=>{for(var n in t||(t={}))J.call(t,n)&&te(e,n,t[n]);if(X)for(var n of X(t))ee.call(t,n)&&te(e,n,t[n]);return e};class re{get state(){return this._state}get isActive(){return this._isActive}get renderBeforeActivation(){return this._renderBeforeActivation}get parent(){return this._parent}get variableDependency(){return this._variableDependency}get urlSync(){return this._urlSync}get Component(){return H}_setParent(e){ie(e,(e=>{e._parent&&e._parent!==this&&console.warn("SceneObject already has a parent set that is different from the new parent. You cannot share the same SceneObject instance in multiple scenes or in multiple different places of the same scene graph. Use SceneObject.clone() to duplicate a SceneObject or store a state key reference and use sceneGraph.findObject to locate it.",e,this),e._parent=this}))}clearParent(){this._parent=void 0}subscribeToState(e){return this._events.subscribe(U,(t=>{t.payload.changedObject===this&&e(t.payload.newState,t.payload.prevState)}))}subscribeToEvent(e,t){return this._events.subscribe(e,t)}setState(e){const t=this._state,n=ne(ne({},this._state),e);this._state=Object.freeze(n),this._setParent(e),this._handleActivationOfChangedStateProps(t,n),this.publishEvent(new U({prevState:t,newState:n,partialUpdate:e,changedObject:this}),!0)}_handleActivationOfChangedStateProps(e,t){this.isActive&&(e.$behaviors!==t.$behaviors&&this._handleChangedBehaviors(e.$behaviors,t.$behaviors),e.$data!==t.$data&&this._handleChangedStateActivation(e.$data,t.$data),e.$variables!==t.$variables&&this._handleChangedStateActivation(e.$variables,t.$variables),e.$timeRange!==t.$timeRange&&this._handleChangedStateActivation(e.$timeRange,t.$timeRange))}_handleChangedStateActivation(e,t){if(e){const t=this._deactivationHandlers.get(e);t&&(t(),this._deactivationHandlers.delete(e))}t&&this._deactivationHandlers.set(t,t.activate())}_handleChangedBehaviors(e,t){if(e)for(const n of e)if(!t||!t.includes(n)){const e=this._deactivationHandlers.get(n);e&&(e(),this._deactivationHandlers.delete(n))}if(t)for(const n of t)e&&e.includes(n)||this._activateBehavior(n)}publishEvent(e,t){this._events.publish(e),t&&this.parent&&this.parent.publishEvent(e,t)}getRoot(){return this._parent?this._parent.getRoot():this}_internalActivate(){this._isActive=!0;const{$data:e,$variables:t,$timeRange:n,$behaviors:r}=this.state;if(this._activationHandlers.forEach((e=>{const t=e();t&&this._deactivationHandlers.set(t,t)})),n&&!n.isActive&&this._deactivationHandlers.set(n,n.activate()),t&&!t.isActive&&this._deactivationHandlers.set(t,t.activate()),e&&!e.isActive&&this._deactivationHandlers.set(e,e.activate()),r)for(const e of r)this._activateBehavior(e)}_activateBehavior(e){if(e instanceof re)this._deactivationHandlers.set(e,e.activate());else if("function"==typeof e){const t=e(this);t&&this._deactivationHandlers.set(e,t)}}activate(){this.isActive||this._internalActivate(),this._refCount++;let e=!1;return()=>{if(this._refCount--,e)throw new Error("SceneObject cancelation handler returned by activate() called a second time");e=!0,0===this._refCount&&this._internalDeactivate()}}_internalDeactivate(){this._isActive=!1;for(let e of this._deactivationHandlers.values())e();this._deactivationHandlers.clear(),this._events.removeAllListeners(),this._subs.unsubscribe(),this._subs=new D.Subscription}useState(){return ae(this)}forceRender(){this.setState({})}clone(e){return function(e,t){const n=pe(e.state,t);return new e.constructor(n)}(this,e)}addActivationHandler(e){this._activationHandlers.push(e)}forEachChild(e){ie(this.state,e)}getRef(){return this._ref||(this._ref=new Y(this)),this._ref}constructor(t){this._isActive=!1,this._activationHandlers=[],this._deactivationHandlers=new Map,this._subs=new D.Subscription,this._refCount=0,this._renderBeforeActivation=!1,t.key||(t.key=M()),this._events=new e.EventBusSrv,this._state=Object.freeze(t),this._setParent(this._state)}}function ae(e,n){var r;const[a,i]=(0,t.useState)(e.state),o=e.state,s=null!=(r=null==n?void 0:n.shouldActivateOrKeepAlive)&&r;return(0,t.useEffect)((()=>{let t;s&&(t=e.activate());const n=e.subscribeToState((e=>{i(e)}));return e.state!==o&&i(e.state),()=>{n.unsubscribe(),t&&t()}}),[e,s]),e.state}function ie(e,t){for(const n of Object.values(e))if(n instanceof re&&t(n),Array.isArray(n))for(const e of n)e instanceof re&&t(e)}var oe=Object.defineProperty,se=Object.getOwnPropertySymbols,le=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable,ce=(e,t,n)=>t in e?oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,de=(e,t)=>{for(var n in t||(t={}))le.call(t,n)&&ce(e,n,t[n]);if(se)for(var n of se(t))ue.call(t,n)&&ce(e,n,t[n]);return e};function pe(e,t){const n=de({},e);Object.assign(n,t);for(const e in n){if(t&&void 0!==t[e])continue;const r=n[e];if(r instanceof re&&(n[e]=r.clone()),r instanceof Y)console.warn("Cloning object with SceneObjectRef");else if(Array.isArray(r)){const t=[];for(const e of r)e instanceof re?t.push(e.clone()):t.push(e);n[e]=t}}return n}function he(e,t){let n,r=e;for(;r&&!n;)n=t(r),r=r.parent;return n}class fe extends e.DataSourceApi{testDatasource(){return Promise.resolve({})}constructor(t,n){super({name:"RuntimeDataSource-"+t,uid:n,type:t,id:1,readOnly:!0,jsonData:{},access:"direct",meta:{id:t,name:"RuntimeDataSource-"+t,type:e.PluginType.datasource,info:{author:{name:""},description:"",links:[],logos:{large:"",small:""},screenshots:[],updated:"",version:""},module:"",baseUrl:""}})}}const me=new Map;var ge=h(241);function be(e,t){const n=t.state.$variables;if(!n)return t.parent?be(e,t.parent):null;return n.getByName(e)||(t.parent?be(e,t.parent):null)}var ye=(e=>(e.AlertStates="alertStates",e.Annotations="annotations",e.Series="series",e))(ye||{}),ve=(e=>(e.Ascending="Ascending",e.Descending="Descending",e))(ve||{}),we=(e=>(e.Bars="bars",e.Line="line",e.Points="points",e))(we||{}),Oe=(e=>(e.Linear="linear",e.Smooth="smooth",e.StepAfter="stepAfter",e.StepBefore="stepBefore",e))(Oe||{}),Se=(e=>(e.Hue="hue",e.None="none",e.Opacity="opacity",e.Scheme="scheme",e))(Se||{}),_e=(e=>(e.None="none",e.Normal="normal",e.Percent="percent",e))(_e||{}),xe=(e=>(e.Hidden="hidden",e.List="list",e.Table="table",e))(xe||{}),Pe=(e=>(e.Auto="auto",e.Horizontal="horizontal",e.Vertical="vertical",e))(Pe||{}),Ce=(e=>(e.Area="area",e.Line="line",e.None="none",e))(Ce||{}),Ee=(e=>(e.Auto="auto",e.Name="name",e.None="none",e.Value="value",e.ValueAndName="value_and_name",e))(Ee||{}),je=(e=>(e.Multi="multi",e.None="none",e.Single="single",e))(je||{}),De=(e=>(e.Basic="basic",e.Gradient="gradient",e.Lcd="lcd",e))(De||{}),ke=(e=>(e.Auto="auto",e.BasicGauge="basic",e.ColorBackground="color-background",e.ColorBackgroundSolid="color-background-solid",e.ColorText="color-text",e.Custom="custom",e.DataLinks="data-links",e.Gauge="gauge",e.GradientGauge="gradient-gauge",e.Image="image",e.JSONView="json-view",e.LcdGauge="lcd-gauge",e.Sparkline="sparkline",e))(ke||{}),Te=(e=>(e.CSV="csv",e.Date="date",e.Distributed="distributed",e.DoubleQuote="doublequote",e.Glob="glob",e.HTML="html",e.JSON="json",e.Lucene="lucene",e.PercentEncode="percentencode",e.Pipe="pipe",e.QueryParam="queryparam",e.Raw="raw",e.Regex="regex",e.SQLString="sqlstring",e.SingleQuote="singlequote",e.Text="text",e.UriEncode="uriencode",e))(Te||{}),Re=(e=>(e.exact="exact",e.none="none",e.numbers="numbers",e.signature="signature",e))(Re||{});ke.Auto;var Ae=(e=>(e.NotStarted="NotStarted",e.Loading="Loading",e.Streaming="Streaming",e.Done="Done",e.Error="Error",e))(Ae||{}),Ie=Object.defineProperty,Me=Object.getOwnPropertySymbols,Ve=Object.prototype.hasOwnProperty,Fe=Object.prototype.propertyIsEnumerable,Le=(e,t,n)=>t in e?Ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class $e extends re{getResultsStream(){const e={origin:this,data:this.state.data};return(0,D.of)(e)}constructor(e){super(((e,t)=>{for(var n in t||(t={}))Ve.call(t,n)&&Le(e,n,t[n]);if(Me)for(var n of Me(t))Fe.call(t,n)&&Le(e,n,t[n]);return e})({data:ze},e))}}const ze={state:Ae.Done,series:[],timeRange:(0,e.getDefaultTimeRange)()};class Be{getKeys(){return"function"==typeof this._keys?this._keys():this._keys}getUrlState(){return this._sceneObject.getUrlState()}updateFromUrl(e){this._sceneObject.updateFromUrl(e)}performBrowserHistoryAction(e){this._nextChangeShouldAddHistoryStep=!0,e(),this._nextChangeShouldAddHistoryStep=!1}shouldCreateHistoryStep(e){return this._nextChangeShouldAddHistoryStep}constructor(e,t){this._sceneObject=e,this._nextChangeShouldAddHistoryStep=!1,this._keys=t.keys}}const Ne=/^\d+[yYmMsSwWhHdD]$/;function qe(t){if("string"!=typeof t)return null;if(-1!==t.indexOf("now"))return t;if(Ne.test(t))return t;if(8===t.length){const n=(0,e.toUtc)(t,"YYYYMMDD");if(n.isValid())return n.toISOString()}else if(15===t.length){const n=(0,e.toUtc)(t,"YYYYMMDDTHHmmss");if(n.isValid())return n.toISOString()}else if(19===t.length){const n=(0,e.toUtc)(t,"YYYY-MM-DD HH:mm:ss");if(n.isValid())return n.toISOString()}else if(24===t.length)return(0,e.toUtc)(t).toISOString();const n=parseInt(t,10);return isNaN(n)?null:(0,e.toUtc)(n).toISOString()}function He(t,n,r,a,i,o){const s=i&&"now"===n,l=Date.now();o&&function(t){t!==We&&(We=t,(0,e.setWeekStart)(t))}(o);const u=(t,n)=>e.dateMath.toDateTime?e.dateMath.toDateTime(t,n):e.dateMath.parse(t,n.roundUp,n.timezone,n.fiscalYearStartMonth);return{to:u(s?"now-"+i:n,{roundUp:!0,timezone:r,fiscalYearStartMonth:a,now:l}),from:u(t,{roundUp:!1,timezone:r,fiscalYearStartMonth:a,now:l}),raw:{from:t,to:n}}}let We;function Ue(t,n,r){return(0,e.isDateTime)(t)?t.isValid():e.dateMath.isMathString(t)?e.dateMath.isValid(t):(0,e.dateTimeParse)(t,{roundUp:n,timeZone:r}).isValid()}var Ge=Object.defineProperty,Qe=Object.getOwnPropertySymbols,Ke=Object.prototype.hasOwnProperty,Ye=Object.prototype.propertyIsEnumerable,Ze=(e,t,n)=>t in e?Ge(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Xe extends re{_onActivate(){if(!this.state.timeZone){const e=this.getTimeZoneSource();e!==this&&this._subs.add(e.subscribeToState(((e,t)=>{void 0!==e.timeZone&&e.timeZone!==t.timeZone&&this.refreshRange(0)})))}return e.rangeUtil.isRelativeTimeRange(this.state.value.raw)&&this.refreshIfStale(),()=>{this.state.weekStart&&(0,e.setWeekStart)(d.config.bootData.user.weekStart)}}refreshIfStale(){var e,t,n,r;let a;void 0!==(null==(t=null==(e=this.state)?void 0:e.refreshOnActivate)?void 0:t.percent)&&(a=this.calculatePercentOfInterval(this.state.refreshOnActivate.percent)),void 0!==(null==(r=null==(n=this.state)?void 0:n.refreshOnActivate)?void 0:r.afterMs)&&(a=Math.min(this.state.refreshOnActivate.afterMs,null!=a?a:1/0)),void 0!==a&&this.refreshRange(a)}getTimeZoneSource(){if(!this.parent||!this.parent.parent)return this;return he(this.parent.parent,(e=>{if(e.state.$timeRange&&e.state.$timeRange.state.timeZone)return e.state.$timeRange}))||this}refreshRange(t){var n;const r=He(this.state.from,this.state.to,null!=(n=this.state.timeZone)?n:(0,e.getTimeZone)(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay,this.state.weekStart);r.to.diff(this.state.value.to,"milliseconds")>=t&&this.setState({value:r})}calculatePercentOfInterval(e){const t=this.state.value.to.diff(this.state.value.from,"milliseconds");return Math.ceil(t/e)}getTimeZone(){if(this.state.timeZone)return this.state.timeZone;const t=this.getTimeZoneSource();return t!==this?t.state.timeZone:(0,e.getTimeZone)()}getUrlState(){const e=d.locationService.getSearchObject(),t={from:this.state.from,to:this.state.to,timezone:this.getTimeZone()};return e.time&&e["time.window"]&&(t.time=null,t["time.window"]=null),t}updateFromUrl(t){var n,r,a;const i={};let o=qe(t.from),s=qe(t.to);if(t.time&&t["time.window"]){const n=function(t,n){const r=isNaN(Date.parse(t))?parseInt(t,10):Date.parse(t);let a;return a=n.match(/^\d+$/)&&parseInt(n,10)?parseInt(n,10):e.rangeUtil.intervalToMs(n),{from:(0,e.toUtc)(r-a/2).toISOString(),to:(0,e.toUtc)(r+a/2).toISOString()}}(Array.isArray(t.time)?t.time[0]:t.time,Array.isArray(t["time.window"])?t["time.window"][0]:t["time.window"]);n.from&&Ue(n.from)&&(o=n.from),n.to&&Ue(n.to)&&(s=n.to)}if(o&&Ue(o)&&(i.from=o),s&&Ue(s)&&(i.to=s),"string"==typeof t.timezone&&(i.timeZone=""!==t.timezone?t.timezone:void 0),0!==Object.keys(i).length)return i.value=He(null!=(n=i.from)?n:this.state.from,null!=(r=i.to)?r:this.state.to,null!=(a=i.timeZone)?a:this.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay,this.state.weekStart),this.setState(i)}constructor(t={}){var n;const r=t.from&&Ue(t.from)?t.from:"now-6h",a=t.to&&Ue(t.to)?t.to:"now",i=t.timeZone;super(((e,t)=>{for(var n in t||(t={}))Ke.call(t,n)&&Ze(e,n,t[n]);if(Qe)for(var n of Qe(t))Ye.call(t,n)&&Ze(e,n,t[n]);return e})({from:r,to:a,timeZone:i,value:He(r,a,i||(0,e.getTimeZone)(),t.fiscalYearStartMonth,t.UNSAFE_nowDelay,t.weekStart),refreshOnActivate:null!=(n=t.refreshOnActivate)?n:{percent:10}},t)),this._urlSync=new Be(this,{keys:["from","to","timezone","time","time.window"]}),this.onTimeRangeChange=e=>{const t={};"string"==typeof e.raw.from?t.from=e.raw.from:t.from=e.raw.from.toISOString(),"string"==typeof e.raw.to?t.to=e.raw.to:t.to=e.raw.to.toISOString(),t.value=He(t.from,t.to,this.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay,this.state.weekStart),t.from===this.state.from&&t.to===this.state.to||this._urlSync.performBrowserHistoryAction((()=>{this.setState(t)}))},this.onTimeZoneChange=e=>{this._urlSync.performBrowserHistoryAction((()=>{this.setState({timeZone:e})}))},this.onRefresh=()=>{this.refreshRange(0),this.publishEvent(new d.RefreshEvent,!0)},this.addActivationHandler(this._onActivate.bind(this))}}const Je=new $e,et=new Xe,tt=new class extends re{getByName(e){}isVariableLoadingOrWaitingToUpdate(e){return!1}constructor(){super({variables:[]})}};function nt(e){var t;return null!=(t=he(e,(e=>e.state.$timeRange)))?t:et}class rt extends e.BusEventWithPayload{}function at(e){return"object"==typeof e&&"formatter"in e}rt.type="scene-variable-changed-value";let it,ot={};function st(e){return ot[e]||(ot[e]=(0,ge.property)(e))}class lt{getValue(e){let{value:t}=this.state,n=t.value;return n=e?st(e)(t.value):t.value,"string"===n||"number"===n||"boolean"===n?n:String(n)}getValueText(){const{value:e}=this.state;return null!=e.text?String(e.text):String(e)}constructor(e,t){this.state={name:e,value:t,type:"scopedvar"}}}const ut=new e.Registry((()=>{const t=[{id:Te.Lucene,name:"Lucene",description:"Values are lucene escaped and multi-valued variables generate an OR expression",formatter:e=>"string"==typeof e?ct(e):Array.isArray(e)?0===e.length?"__empty__":"("+(0,ge.map)(e,(e=>'"'+ct(e)+'"')).join(" OR ")+")":ct(`${e}`)},{id:Te.Raw,name:"raw",description:"Keep value as is",formatter:e=>String(e)},{id:Te.Regex,name:"Regex",description:"Values are regex escaped and multi-valued variables generate a (<value>|<value>) expression",formatter:t=>{if("string"==typeof t)return(0,e.escapeRegex)(t);if(Array.isArray(t)){const n=t.map((t=>"string"==typeof t?(0,e.escapeRegex)(t):(0,e.escapeRegex)(String(t))));return 1===n.length?n[0]:"("+n.join("|")+")"}return(0,e.escapeRegex)(`${t}`)}},{id:Te.Pipe,name:"Pipe",description:"Values are separated by | character",formatter:e=>"string"==typeof e?e:Array.isArray(e)?e.join("|"):`${e}`},{id:Te.Distributed,name:"Distributed",description:"Multiple values are formatted like variable=value",formatter:(e,t,n)=>"string"==typeof e?e:Array.isArray(e)?(e=(0,ge.map)(e,((e,t)=>0!==t?n.state.name+"="+e:e)),e.join(",")):`${e}`},{id:Te.CSV,name:"Csv",description:"Comma-separated values",formatter:e=>"string"==typeof e?e:(0,ge.isArray)(e)?e.join(","):String(e)},{id:Te.HTML,name:"HTML",description:"HTML escaping of values",formatter:t=>"string"==typeof t?e.textUtil.escapeHtml(t):(0,ge.isArray)(t)?e.textUtil.escapeHtml(t.join(", ")):e.textUtil.escapeHtml(String(t))},{id:Te.JSON,name:"JSON",description:"JSON stringify value",formatter:e=>"string"==typeof e?e:JSON.stringify(e)},{id:Te.PercentEncode,name:"Percent encode",description:"Useful for URL escaping values",formatter:e=>(0,ge.isArray)(e)?dt("{"+e.join(",")+"}"):dt(e)},{id:Te.SingleQuote,name:"Single quote",description:"Single quoted values",formatter:e=>{const t=new RegExp("'","g");if((0,ge.isArray)(e))return(0,ge.map)(e,(e=>`'${(0,ge.replace)(e,t,"\\'")}'`)).join(",");let n="string"==typeof e?e:String(e);return`'${(0,ge.replace)(n,t,"\\'")}'`}},{id:Te.DoubleQuote,name:"Double quote",description:"Double quoted values",formatter:e=>{const t=new RegExp('"',"g");if((0,ge.isArray)(e))return(0,ge.map)(e,(e=>`"${(0,ge.replace)(e,t,'\\"')}"`)).join(",");let n="string"==typeof e?e:String(e);return`"${(0,ge.replace)(n,t,'\\"')}"`}},{id:Te.SQLString,name:"SQL string",description:"SQL string quoting and commas for use in IN statements and other scenarios",formatter:gt},{id:Te.Date,name:"Date",description:"Format date in different ways",formatter:(t,n)=>{var r;let a=NaN;if("number"==typeof t?a=t:"string"==typeof t&&(a=parseInt(t,10)),isNaN(a))return"NaN";const i=null!=(r=n[0])?r:"iso";switch(i){case"ms":return String(t);case"seconds":return`${Math.round(a/1e3)}`;case"iso":return(0,e.dateTime)(a).toISOString();default:return(n||[]).length>1?(0,e.dateTime)(a).format(n.join(":")):(0,e.dateTime)(a).format(i)}}},{id:Te.Glob,name:"Glob",description:"Format multi-valued variables using glob syntax, example {value1,value2}",formatter:e=>(0,ge.isArray)(e)&&e.length>1?"{"+e.join(",")+"}":String(e)},{id:Te.Text,name:"Text",description:"Format variables in their text representation. Example in multi-variable scenario A + B + C.",formatter:(e,t,n)=>n.getValueText?n.getValueText():String(e)},{id:Te.QueryParam,name:"Query parameter",description:"Format variables as URL parameters. Example in multi-variable scenario A + B + C => var-foo=A&var-foo=B&var-foo=C.",formatter:(t,n,r)=>{if(r.urlSync){const t=r.urlSync.getUrlState();return e.urlUtil.toUrlParams(t)}return Array.isArray(t)?t.map((e=>ft(r.state.name,e))).join("&"):ft(r.state.name,t)}},{id:Te.UriEncode,name:"Percent encode as URI",description:"Useful for URL escaping values, taking into URI syntax characters",formatter:e=>(0,ge.isArray)(e)?pt("{"+e.join(",")+"}"):pt(e)}];return t}));function ct(e){return!1===isNaN(+e)?e:e.replace(/([\!\*\+\-\=<>\s\&\|\(\)\[\]\{\}\^\~\?\:\\/"])/g,"\\$1")}function dt(e){return"object"==typeof e&&(e=String(e)),ht(encodeURIComponent(e))}const pt=e=>ht(encodeURI(String(e))),ht=e=>e.replace(/[!'()*]/g,(e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()));function ft(e,t){return`var-${e}=${dt(t)}`}const mt={"'":"''",'"':'\\"'};function gt(e){const t=new RegExp("'|\"","g");if((0,ge.isArray)(e))return(0,ge.map)(e,(e=>`'${(0,ge.replace)(e,t,(e=>{var t;return null!=(t=mt[e])?t:""}))}'`)).join(",");let n="string"==typeof e?e:String(e);return`'${(0,ge.replace)(n,t,(e=>{var t;return null!=(t=mt[e])?t:""}))}'`}const bt="All",yt="$__all",vt="$__auto",wt=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;class Ot{formatter(){return this._value}constructor(e){this._value=e}}class St{getValue(){const e=nt(this._sceneObject);return"__from"===this.state.name?e.state.value.from.valueOf():e.state.value.to.valueOf()}getValueText(){const t=nt(this._sceneObject);return"__from"===this.state.name?(0,e.dateTimeFormat)(t.state.value.from,{timeZone:t.getTimeZone()}):(0,e.dateTimeFormat)(t.state.value.to,{timeZone:t.getTimeZone()})}constructor(e,t){this.state={name:e,type:"time_macro"},this._sceneObject=t}}class _t{getValue(){var e;const t=$u(this._sceneObject);if(t){const n=null==(e=t.state.data)?void 0:e.request;return n?"__interval_ms"===this.state.name?n.intervalMs:n.interval:this.state.match}return this.state.match}constructor(e,t,n){this.state={name:e,type:"time_macro",match:n},this._sceneObject=t}}function xt(e,t){e.setState(t)}function Pt(){return d.useLocationService?(0,d.useLocationService)():d.locationService}class Ct extends re{validateAndUpdate(){return this.getValueOptions({}).pipe((0,D.map)((e=>(this.updateValueGivenNewOptions(e),{}))))}onCancel(){this.setStateHelper({loading:!1});const e=this.parent;null==e||e.cancel(this)}updateValueGivenNewOptions(e){const{value:t,text:n,options:r}=this.state,a=this.getStateUpdateGivenNewOptions(e,t,n);this.interceptStateUpdateAfterValidation(a),this.setStateHelper(a),(a.value!==t||a.text!==n||this.hasAllValue()&&!(0,ge.isEqual)(e,r))&&this.publishEvent(new rt(this),!0)}getStateUpdateGivenNewOptions(e,t,n){const r={options:e,loading:!1,value:t,text:n};if(0===e.length)return this.state.defaultToAll||this.state.includeAll?(r.value=yt,r.text=bt):this.state.isMulti?(r.value=[],r.text=[]):(r.value="",r.text=""),r;if(this.hasAllValue())return this.state.includeAll?r.text=bt:(r.value=e[0].value,r.text=e[0].label,this.state.isMulti&&(r.value=[r.value],r.text=[r.text])),r;if(this.state.isMulti){const a=(Array.isArray(t)?t:[t]).filter((t=>e.find((e=>e.value===t)))),i=a.map((t=>e.find((e=>e.value===t)).label));if(0===a.length){const t=this.getDefaultMultiState(e);r.value=t.value,r.text=t.text}else(0,ge.isEqual)(a,t)||(r.value=a),(0,ge.isEqual)(i,n)||(r.text=i);return r}let a=function(e,t,n){let r;for(const a of n){if(a.value===e)return a;a.label===t&&(r=a)}return r}(t,n,e);return a?(r.text=a.label,r.value=a.value):this.state.defaultToAll?(r.value=yt,r.text=bt):(r.value=e[0].value,r.text=e[0].label),r}interceptStateUpdateAfterValidation(e){const t=e.value===yt&&this.state.text===bt;this.skipNextValidation&&e.value!==this.state.value&&e.text!==this.state.text&&!t&&(e.value=this.state.value,e.text=this.state.text),this.skipNextValidation=!1}getValue(){return this.hasAllValue()?this.state.allValue?new jt(this.state.allValue,this):new jt(".*",this):this.state.value}getValueText(){return this.hasAllValue()?bt:Array.isArray(this.state.text)?this.state.text.join(" + "):String(this.state.text)}hasAllValue(){const e=this.state.value;return e===yt||Array.isArray(e)&&e[0]===yt}getDefaultMultiState(e){return this.state.defaultToAll?{value:[yt],text:[bt]}:e.length>0?{value:[e[0].value],text:[e[0].label]}:{value:[],text:[]}}changeValueTo(e,t){if(e!==this.state.value||t!==this.state.text){if(t||(t=Array.isArray(e)?e.map((e=>this.findLabelTextForValue(e))):this.findLabelTextForValue(e)),Array.isArray(e)){if(0===e.length){const n=this.getDefaultMultiState(this.state.options);e=n.value,t=n.text}e[e.length-1]===yt?(e=[yt],t=[bt]):e[0]===yt&&e.length>1&&(e.shift(),Array.isArray(t)&&t.shift())}(0,ge.isEqual)(e,this.state.value)&&(0,ge.isEqual)(t,this.state.text)||(this.setStateHelper({value:e,text:t,loading:!1}),this.publishEvent(new rt(this),!0))}}findLabelTextForValue(e){if(e===yt)return bt;const t=this.state.options.find((t=>t.value===e));if(t)return t.label;const n=this.state.options.find((t=>t.label===e));return n?n.label:e}setStateHelper(e){xt(this,e)}getOptionsForSelect(){let e=this.state.options;return this.state.includeAll&&(e=[{value:yt,label:bt},...e]),Array.isArray(this.state.value)||e.find((e=>e.value===this.state.value))||(e=[{value:this.state.value,label:String(this.state.text)},...e]),e}refreshOptions(){this.getValueOptions({}).subscribe((e=>{this.updateValueGivenNewOptions(e)}))}constructor(){super(...arguments),this._urlSync=new Et(this)}}class Et{getKey(){return`var-${this._sceneObject.state.name}`}getKeys(){return this._sceneObject.state.skipUrlSync?[]:[this.getKey()]}getUrlState(){if(this._sceneObject.state.skipUrlSync)return{};let e=null,t=this._sceneObject.state.value;return e=Array.isArray(t)?t.map(String):this._sceneObject.state.isMulti?[String(t)]:String(t),{[this.getKey()]:e}}updateFromUrl(e){let t=e[this.getKey()];null!=t&&(this._sceneObject.state.includeAll&&(t=function(e){return(0,ge.isArray)(e)&&e[0]===bt?[yt]:e===bt?yt:e}(t)),this._sceneObject.state.allValue&&this._sceneObject.state.allValue===t&&(t=yt),this._sceneObject.isActive||(this._sceneObject.skipNextValidation=!0),this._sceneObject.changeValueTo(t))}constructor(e){this._sceneObject=e}}class jt{formatter(e){return e===Te.Text?bt:e===Te.PercentEncode?ut.get(Te.PercentEncode).formatter(this._value,[],this._variable):e===Te.QueryParam?ut.get(Te.QueryParam).formatter(bt,[],this._variable):this._value}constructor(e,t){this._value=e,this._variable=t}}function Dt(e,t={}){if(e.state.$variables)for(const n of e.state.$variables.state.variables)n.state.skipUrlSync||t[n.state.name]||(t[n.state.name]=n);return e.parent&&Dt(e.parent,t),t}var kt=Object.defineProperty,Tt=Object.defineProperties,Rt=Object.getOwnPropertyDescriptors,At=Object.getOwnPropertySymbols,It=Object.prototype.hasOwnProperty,Mt=Object.prototype.propertyIsEnumerable,Vt=(e,t,n)=>t in e?kt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const Ft=(0,e.getDisplayProcessor)();class Lt{formatter(e){if(!e)return this._urlQueryParams;const t=e.split(":");if("exclude"===t[0]&&t.length>1){const e=new URLSearchParams(this._urlQueryParams);for(const n of t[1].split(","))e.delete(n);return`?${e}`}if("include"===t[0]&&t.length>1){const e=new URLSearchParams(this._urlQueryParams),n=t[1].split(",");for(const t of e.keys())n.includes(t)||e.delete(t);return`?${e}`}return this._urlQueryParams}constructor(e){this._urlQueryParams=e}}const $t=new Map([[e.DataLinkBuiltInVars.includeVars,class{getValue(){const e=Dt(this._sceneObject),t=ut.get(Te.QueryParam),n=[];for(const r of Object.keys(e)){const a=e[r];if(a instanceof Ct&&a.hasAllValue()&&!a.state.allValue){n.push(t.formatter(yt,[],a));continue}const i=a.getValue();i&&(at(i)?n.push(i.formatter(Te.QueryParam)):n.push(t.formatter(i,[],a)))}return new Ot(n.join("&"))}getValueText(){return""}constructor(e,t){this.state={name:e,type:"url_variable"},this._sceneObject=t}}],[e.DataLinkBuiltInVars.keepTime,class{getValue(){var t;const n=null==(t=nt(this._sceneObject).urlSync)?void 0:t.getUrlState();return"browser"===(null==n?void 0:n.timezone)&&(n.timezone=Intl.DateTimeFormat().resolvedOptions().timeZone),new Ot(e.urlUtil.toUrlParams(n))}getValueText(){return""}constructor(e,t){this.state={name:e,type:"url_variable"},this._sceneObject=t}}],["__value",class{getValue(t){var n,r;const a=null==(n=this._scopedVars)?void 0:n.__dataContext;if(!a)return this._match;const{frame:i,rowIndex:o,field:s,calculatedValue:l}=a.value;if(l)switch(t){case"numeric":case"raw":return l.numeric;case"time":return"";default:return(0,e.formattedValueToString)(l)}if(null==o)return this._match;if("time"===t){const t=i.fields.find((t=>t.type===e.FieldType.time));return t?t.values.get(o):void 0}if(!s)return this._match;const u=s.values.get(o);if("raw"===t)return u;const c=(null!=(r=s.display)?r:Ft)(u);return"numeric"===t?c.numeric:(0,e.formattedValueToString)(c)}getValueText(){return""}constructor(e,t,n,r){this._match=n,this._scopedVars=r,this.state={name:e,type:"__value"}}}],["__data",class{getValue(t){var n,r;const a=null==(n=this._scopedVars)?void 0:n.__dataContext;if(!a||!t)return this._match;const{frame:i,rowIndex:o}=a.value;if(void 0===o||void 0===t)return this._match;const s={name:i.name,refId:i.refId,fields:(0,e.getFieldDisplayValuesProxy)({frame:i,rowIndex:o})};return null!=(r=st(t)(s))?r:""}getValueText(){return""}constructor(e,t,n,r){this._match=n,this._scopedVars=r,this.state={name:e,type:"__data"}}}],["__series",class{getValue(t){var n;const r=null==(n=this._scopedVars)?void 0:n.__dataContext;if(!r||!t)return this._match;if("name"!==t)return this._match;const{frame:a,frameIndex:i}=r.value;return(0,e.getFrameDisplayName)(a,i)}getValueText(){return""}constructor(e,t,n,r){this._match=n,this._scopedVars=r,this.state={name:e,type:"__series"}}}],["__field",class{getValue(t){var n,r;const a=null==(n=this._scopedVars)?void 0:n.__dataContext;if(!a||!t)return this._match;if(void 0===t||""===t)return this._match;const{frame:i,field:o,data:s}=a.value,l=function(t,n,r){return new Proxy({},{get:(a,i)=>{return"name"===i?t.name:"displayName"===i?(0,e.getFieldDisplayName)(t,n,r):"labels"===i||"formattedLabels"===i?t.labels?(o=((e,t)=>{for(var n in t||(t={}))It.call(t,n)&&Vt(e,n,t[n]);if(At)for(var n of At(t))Mt.call(t,n)&&Vt(e,n,t[n]);return e})({},t.labels),s={__values:Object.values(t.labels).sort().join(", "),toString:()=>(0,e.formatLabels)(t.labels,"",!0)},Tt(o,Rt(s))):"":void 0;var o,s}})}(o,i,s);return null!=(r=st(t)(l))?r:""}getValueText(){return""}constructor(e,t,n,r){this._match=n,this._scopedVars=r,this.state={name:e,type:"__field"}}}],["__url",class{getValue(e){var t;const n=d.locationService.getLocation(),r=null!=(t=d.config.appSubUrl)?t:"";switch(null!=e?e:""){case"params":return new Lt(n.search);case"path":return r+n.pathname;default:return r+n.pathname+n.search}}getValueText(){return""}constructor(e,t){this.state={name:e,type:"url_macro"}}}],["__from",St],["__to",St],["__timezone",class{getValue(){const e=nt(this._sceneObject).getTimeZone();return"browser"===e?Intl.DateTimeFormat().resolvedOptions().timeZone:e}getValueText(){return this.getValue()}constructor(e,t){this.state={name:e,type:"time_macro"},this._sceneObject=t}}],["__user",class{getValue(e){const t=d.config.bootData.user;switch(e){case"login":return t.login;case"email":return t.email;default:return String(t.id)}}getValueText(){return""}constructor(e,t){this.state={name:e,type:"user_macro"}}}],["__org",class{getValue(e){const t=d.config.bootData.user;return"name"===e?t.orgName:String(t.orgId)}getValueText(){return""}constructor(e,t){this.state={name:e,type:"org_macro"}}}],["__interval",_t],["__interval_ms",_t]]);function zt(e,t,n,r,a){return t&&"string"==typeof t?(wt.lastIndex=0,t.replace(wt,((t,i,o,s,l,u,c)=>{const d=i||o||l,p=s||c||r,h=function(e,t,n,r){if(n&&n.hasOwnProperty(e)){const t=n[e];if(t)return function(e,t){return it?(it.state.name=e,it.state.value=t):it=new lt(e,t),it}(e,t)}const a=be(e,r);if(a)return a;const i=$t.get(e);return i?new i(e,r,t,n):null}(d,t,n,e);if(!h)return a&&a.push({match:t,variableName:d,fieldPath:u,format:p,value:t,found:!1}),t;const f=function(e,t,n,r){if(null==n)return"";if(at(n))return zt(e,n.formatter(r));if(Array.isArray(n)||"object"!=typeof n||(n=`${n}`),"function"==typeof r)return r(n,{name:t.state.name,type:t.state.type,multi:t.state.isMulti,includeAll:t.state.includeAll});let a=[];r?(a=r.split(":"),a.length>1?(r=a[0],a=a.slice(1)):a=[]):r=Te.Glob;let i=ut.getIfExists(r);return i||(console.error(`Variable format ${r} not found. Using glob format as fallback.`),i=ut.get(Te.Glob)),i.formatter(n,a,t)}(e,h,h.getValue(u),p);return a&&a.push({match:t,variableName:d,fieldPath:u,format:p,value:f,found:f!==t}),f}))):null!=t?t:""}function Bt(e){return void 0!==e.useState}function Nt(e){return"enrichDataRequest"in e}function qt(e){return"isDataLayer"in e}var Ht,Wt=(e,t,n)=>(((e,t)=>{if(!t.has(e))throw TypeError("Cannot read from private field")})(e,t),n?n.call(e):t.get(e));class Ut extends re{queryStarted(e){Wt(this,Ht).add(e),this.changeRunningQueryCount(1),this.state.isRunning||this.setState({isRunning:!0})}queryCompleted(e){Wt(this,Ht).has(e)&&(Wt(this,Ht).delete(e),this.changeRunningQueryCount(-1),0===Wt(this,Ht).size&&this.setState({isRunning:!1}))}changeRunningQueryCount(e){var t;window.__grafanaRunningQueryCount=(null!=(t=window.__grafanaRunningQueryCount)?t:0)+e}cancelAll(){var e;for(const t of Wt(this,Ht).values())null==(e=t.cancel)||e.call(t)}constructor(){super({isRunning:!1}),this.isQueryController=!0,((e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)})(this,Ht,new Set),this.addActivationHandler((()=>()=>Wt(this,Ht).clear()))}}function Gt(e,t,...n){let r=!1;"undefined"!=typeof window&&(r="true"===localStorage.getItem("grafana.debug.scenes")),r&&console.log(`${e}: `,t,...n)}function Qt(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function Kt(e,t){return Yt.apply(this,arguments)}function Yt(){var e;return e=function*(e,t){if(null==e?void 0:e.uid){const t=me.get(e.uid);if(t)return t}return e&&e.query?e:yield(0,d.getDataSourceSrv)().get(e,t)},Yt=function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){Qt(i,r,a,o,s,"next",e)}function s(e){Qt(i,r,a,o,s,"throw",e)}o(void 0)}))},Yt.apply(this,arguments)}Ht=new WeakMap;class Zt{recordCurrentDependencyValuesForSceneObject(e){if(this.clearValues(),e.variableDependency)for(const t of e.variableDependency.getNames()){const n=Hu.lookupVariable(t,e);n&&this._values.set(n.state.name,n.getValue())}}cloneAndRecordCurrentValuesForSceneObject(e){const t=new Zt;return t.recordCurrentDependencyValuesForSceneObject(e),t}clearValues(){this._values.clear()}hasValues(){return!!this._values}recordCurrentValue(e){this._values.set(e.state.name,e.getValue())}hasRecordedValue(e){return this._values.has(e.state.name)}hasValueChanged(e){return!(!this._values.has(e.state.name)||ql(this._values.get(e.state.name),e.getValue()))}hasDependenciesChanged(e){if(!this._values)return!1;if(!e.variableDependency)return!1;for(const t of e.variableDependency.getNames()){const n=Hu.lookupVariable(t,e);if(!n)continue;const r=n.state.name;if(n&&this._values.has(r)&&!ql(this._values.get(r),n.getValue()))return!0}return!1}constructor(){this._values=new Map}}function Xt(e){return"object"==typeof e&&"getExtraQueries"in e}var Jt=Object.defineProperty,en=Object.defineProperties,tn=Object.getOwnPropertyDescriptors,nn=Object.getOwnPropertySymbols,rn=Object.prototype.hasOwnProperty,an=Object.prototype.propertyIsEnumerable,on=(e,t,n)=>t in e?Jt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const sn=(e,t)=>(0,D.of)(t);var ln=Object.defineProperty,un=Object.defineProperties,cn=Object.getOwnPropertyDescriptors,dn=Object.getOwnPropertySymbols,pn=Object.prototype.hasOwnProperty,hn=Object.prototype.propertyIsEnumerable,fn=(e,t,n)=>t in e?ln(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,mn=(e,t)=>{for(var n in t||(t={}))pn.call(t,n)&&fn(e,n,t[n]);if(dn)for(var n of dn(t))hn.call(t,n)&&fn(e,n,t[n]);return e},gn=(e,t)=>un(e,cn(t));const bn=0;function yn(e){const t=e.getRoot();return Nt(t)?t.enrichDataRequest(e):null}let vn,wn=new Set;function On(e){return t=>{const n=Hu.getQueryController(e.origin);return n?new D.Observable((r=>{e.cancel||(e.cancel=()=>r.complete()),n.queryStarted(e);let a=!1;const i=t.subscribe({next:t=>{a||t.state===Ae.Loading||(a=!0,n.queryCompleted(e)),r.next(t)},error:e=>r.error(e),complete:()=>{r.complete()}});return()=>{i.unsubscribe(),a||n.queryCompleted(e)}})):t}}const Sn=new Set;var _n=h(7);const xn={RadioButton:{container:"data-testid radio-button"},Breadcrumbs:{breadcrumb:e=>`data-testid ${e} breadcrumb`},TimePicker:{openButton:"data-testid TimePicker Open Button",overlayContent:"data-testid TimePicker Overlay Content",fromField:"data-testid Time Range from field",toField:"data-testid Time Range to field",applyTimeRange:"data-testid TimePicker submit button",copyTimeRange:"data-testid TimePicker copy button",pasteTimeRange:"data-testid TimePicker paste button",calendar:{label:"data-testid Time Range calendar",openButton:"data-testid Open time range calendar",closeButton:"data-testid Close time range Calendar"},absoluteTimeRangeTitle:"data-testid-absolute-time-range-narrow"},DataSourcePermissions:{form:()=>'form[name="addPermission"]',roleType:"Role to add new permission to",rolePicker:"Built-in role picker",permissionLevel:"Permission Level"},DateTimePicker:{input:"data-testid date-time-input"},DataSource:{TestData:{QueryTab:{scenarioSelectContainer:"Test Data Query scenario select container",scenarioSelect:"Test Data Query scenario select",max:"TestData max",min:"TestData min",noise:"TestData noise",seriesCount:"TestData series count",spread:"TestData spread",startValue:"TestData start value",drop:"TestData drop values"}},DataSourceHttpSettings:{urlInput:"data-testid Datasource HTTP settings url"},Jaeger:{traceIDInput:"Trace ID"},Prometheus:{configPage:{connectionSettings:"Data source connection URL",manageAlerts:"prometheus-alerts-manager",scrapeInterval:"data-testid scrape interval",queryTimeout:"data-testid query timeout",defaultEditor:"data-testid default editor",disableMetricLookup:"disable-metric-lookup",prometheusType:"data-testid prometheus type",prometheusVersion:"data-testid prometheus version",cacheLevel:"data-testid cache level",incrementalQuerying:"prometheus-incremental-querying",queryOverlapWindow:"data-testid query overlap window",disableRecordingRules:"disable-recording-rules",customQueryParameters:"data-testid custom query parameters",httpMethod:"data-testid http method",exemplarsAddButton:"data-testid Add exemplar config button",internalLinkSwitch:"data-testid Internal link switch",codeModeMetricNamesSuggestionLimit:"data-testid code mode metric names suggestion limit"},queryEditor:{explain:"data-testid prometheus explain switch wrapper",editorToggle:"data-testid QueryEditorModeToggle",options:"data-testid prometheus options",legend:"data-testid prometheus legend wrapper",format:"data-testid prometheus format",step:"prometheus-step",type:"data-testid prometheus type",exemplars:"prometheus-exemplars",builder:{metricSelect:"data-testid metric select",hints:"data-testid prometheus hints",metricsExplorer:"data-testid metrics explorer",queryAdvisor:"data-testid query advisor"},code:{queryField:"data-testid prometheus query field",metricsCountInfo:"data-testid metrics count disclaimer",metricsBrowser:{openButton:"data-testid open metrics browser",selectMetric:"data-testid select a metric",seriesLimit:"data-testid series limit",metricList:"data-testid metric list",labelNamesFilter:"data-testid label names filter",labelValuesFilter:"data-testid label values filter",useQuery:"data-testid use query",useAsRateQuery:"data-testid use as rate query",validateSelector:"data-testid validate selector",clear:"data-testid clear"}}},exemplarMarker:"data-testid Exemplar marker",variableQueryEditor:{queryType:"data-testid query type",labelnames:{metricRegex:"data-testid label names metric regex"},labelValues:{labelSelect:"data-testid label values label select"},metricNames:{metricRegex:"data-testid metric names metric regex"},varQueryResult:"data-testid variable query result",seriesQuery:"data-testid prometheus series query",classicQuery:"data-testid prometheus classic query"},annotations:{minStep:"prometheus-annotation-min-step",title:"data-testid prometheus annotation title",tags:"data-testid prometheus annotation tags",text:"data-testid prometheus annotation text",seriesValueAsTimestamp:"data-testid prometheus annotation series value as timestamp"}}},Menu:{MenuComponent:e=>`${e} menu`,MenuGroup:e=>`${e} menu group`,MenuItem:e=>`${e} menu item`,SubMenu:{container:"data-testid SubMenu container",icon:"data-testid SubMenu icon"}},Panels:{Panel:{title:e=>`data-testid Panel header ${e}`,content:"data-testid panel content",headerItems:e=>`data-testid Panel header item ${e}`,menuItems:e=>`data-testid Panel menu item ${e}`,menu:e=>`data-testid Panel menu ${e}`,containerByTitle:e=>`${e} panel`,headerCornerInfo:e=>`Panel header ${e}`,status:e=>`data-testid Panel status ${e}`,loadingBar:()=>"Panel loading bar",HoverWidget:{container:"data-testid hover-header-container",dragIcon:"data-testid drag-icon"},PanelDataErrorMessage:"data-testid Panel data error message"},Visualization:{Graph:{container:"Graph container",VisualizationTab:{legendSection:"Legend section"},Legend:{legendItemAlias:e=>`gpl alias ${e}`,showLegendSwitch:"gpl show legend"},xAxis:{labels:()=>"div.flot-x-axis > div.flot-tick-label"}},BarGauge:{value:"Bar gauge value",valueV2:"data-testid Bar gauge value"},PieChart:{svgSlice:"data testid Pie Chart Slice"},Text:{container:()=>".markdown-html"},Table:{header:"table header",footer:"table-footer",body:"data-testid table body"}}},VizLegend:{seriesName:e=>`data-testid VizLegend series ${e}`},Drawer:{General:{title:e=>`Drawer title ${e}`,expand:"Drawer expand",contract:"Drawer contract",close:"data-testid Drawer close",rcContentWrapper:()=>".rc-drawer-content-wrapper",subtitle:"data-testid drawer subtitle"},DashboardSaveDrawer:{saveButton:"data-testid Save dashboard drawer button",saveAsButton:"data-testid Save as dashboard drawer button",saveAsTitleInput:"Save dashboard title field"}},PanelEditor:{General:{content:"data-testid Panel editor content"},OptionsPane:{content:"data-testid Panel editor option pane content",select:"Panel editor option pane select",fieldLabel:e=>`${e} field property editor`,fieldInput:e=>`data-testid Panel editor option pane field input ${e}`},DataPane:{content:"data-testid Panel editor data pane content"},applyButton:"data-testid Apply changes and go back to dashboard",toggleVizPicker:"data-testid toggle-viz-picker",toggleVizOptions:"data-testid toggle-viz-options",toggleTableView:"data-testid toggle-table-view",showZoomField:"Map controls Show zoom control field property editor",showAttributionField:"Map controls Show attribution field property editor",showScaleField:"Map controls Show scale field property editor",showMeasureField:"Map controls Show measure tools field property editor",showDebugField:"Map controls Show debug field property editor",measureButton:"show measure tools"},PanelInspector:{Data:{content:"Panel inspector Data content"},Stats:{content:"Panel inspector Stats content"},Json:{content:"data-testid Panel inspector Json content"},Query:{content:"Panel inspector Query content",refreshButton:"Panel inspector Query refresh button",jsonObjectKeys:()=>".json-formatter-key"}},Tab:{title:e=>`data-testid Tab ${e}`,active:()=>'[class*="-activeTabStyle"]'},RefreshPicker:{runButton:"RefreshPicker run button",intervalButton:"RefreshPicker interval button",runButtonV2:"data-testid RefreshPicker run button",intervalButtonV2:"data-testid RefreshPicker interval button"},QueryTab:{content:"Query editor tab content",queryInspectorButton:"Query inspector button",queryHistoryButton:"data-testid query-history-button",addQuery:"data-testid query-tab-add-query",queryGroupTopSection:"data-testid query group top section",addExpression:"data-testid query-tab-add-expression"},QueryHistory:{queryText:"Query text"},QueryEditorRows:{rows:"Query editor row"},QueryEditorRow:{actionButton:e=>`data-testid ${e}`,title:e=>`Query editor row title ${e}`,container:e=>`Query editor row ${e}`},AlertTab:{content:"data-testid Alert editor tab content"},AlertRules:{groupToggle:"data-testid group-collapse-toggle",toggle:"data-testid collapse-toggle",expandedContent:"data-testid expanded-content",previewButton:"data-testid alert-rule preview-button",ruleNameField:"data-testid alert-rule name-field",newFolderButton:"data-testid alert-rule new-folder-button",newFolderNameField:"data-testid alert-rule name-folder-name-field",newFolderNameCreateButton:"data-testid alert-rule name-folder-name-create-button",newEvaluationGroupButton:"data-testid alert-rule new-evaluation-group-button",newEvaluationGroupName:"data-testid alert-rule new-evaluation-group-name",newEvaluationGroupInterval:"data-testid alert-rule new-evaluation-group-interval",newEvaluationGroupCreate:"data-testid alert-rule new-evaluation-group-create-button"},Alert:{alert:e=>`Alert ${e}`,alertV2:e=>`data-testid Alert ${e}`},TransformTab:{content:"data-testid Transform editor tab content",newTransform:e=>`data-testid New transform ${e}`,transformationEditor:e=>`data-testid Transformation editor ${e}`,transformationEditorDebugger:e=>`data-testid Transformation editor debugger ${e}`},Transforms:{card:e=>`data-testid New transform ${e}`,disableTransformationButton:"data-testid Disable transformation button",Reduce:{modeLabel:"data-testid Transform mode label",calculationsLabel:"data-testid Transform calculations label"},SpatialOperations:{actionLabel:"root Action field property editor",locationLabel:"root Location Mode field property editor",location:{autoOption:"Auto location option",coords:{option:"Coords location option",latitudeFieldLabel:"root Latitude field field property editor",longitudeFieldLabel:"root Longitude field field property editor"},geohash:{option:"Geohash location option",geohashFieldLabel:"root Geohash field field property editor"},lookup:{option:"Lookup location option",lookupFieldLabel:"root Lookup field field property editor",gazetteerFieldLabel:"root Gazetteer field property editor"}}},searchInput:"data-testid search transformations",noTransformationsMessage:"data-testid no transformations message",addTransformationButton:"data-testid add transformation button",removeAllTransformationsButton:"data-testid remove all transformations button"},NavBar:{Configuration:{button:"Configuration"},Toggle:{button:"data-testid Toggle menu"},Reporting:{button:"Reporting"}},NavMenu:{Menu:"data-testid navigation mega-menu",item:"data-testid Nav menu item"},NavToolbar:{container:"data-testid Nav toolbar",shareDashboard:"data-testid Share dashboard",markAsFavorite:"data-testid Mark as favorite",editDashboard:{editButton:"data-testid Edit dashboard button",saveButton:"data-testid Save dashboard button",exitButton:"data-testid Exit edit mode button",settingsButton:"data-testid Dashboard settings",addRowButton:"data-testid Add row button",addLibraryPanelButton:"data-testid Add a panel from the panel library button",addVisualizationButton:"data-testid Add new visualization menu item",pastePanelButton:"data-testid Paste panel button",discardChangesButton:"data-testid Discard changes button",discardLibraryPanelButton:"data-testid Discard library panel button",unlinkLibraryPanelButton:"data-testid Unlink library panel button",saveLibraryPanelButton:"data-testid Save library panel button",backToDashboardButton:"data-testid Back to dashboard button"}},PageToolbar:{container:()=>".page-toolbar",item:e=>`${e}`,itemButton:e=>`data-testid ${e}`},QueryEditorToolbarItem:{button:e=>`QueryEditor toolbar item button ${e}`},BackButton:{backArrow:"data-testid Go Back"},OptionsGroup:{group:e=>e?`data-testid Options group ${e}`:"data-testid Options group",toggle:e=>e?`data-testid Options group ${e} toggle`:"data-testid Options group toggle"},PluginVisualization:{item:e=>`Plugin visualization item ${e}`,current:()=>'[class*="-currentVisualizationItem"]'},Select:{option:"data-testid Select option",toggleAllOptions:"data-testid toggle all options",input:()=>'input[id*="time-options-input"]',singleValue:()=>'div[class*="-singleValue"]'},FieldConfigEditor:{content:"Field config editor content"},OverridesConfigEditor:{content:"Field overrides editor content"},FolderPicker:{container:"Folder picker select container",containerV2:"data-testid Folder picker select container",input:"data-testid folder-picker-input"},ReadonlyFolderPicker:{container:"data-testid Readonly folder picker select container"},DataSourcePicker:{container:"data-testid Data source picker select container",input:()=>'input[id="data-source-picker"]',inputV2:"data-testid Select a data source",dataSourceList:"data-testid Data source list dropdown",advancedModal:{dataSourceList:"data-testid Data source list",builtInDataSourceList:"data-testid Built in data source list"}},TimeZonePicker:{container:"Time zone picker select container",containerV2:"data-testid Time zone picker select container",changeTimeSettingsButton:"data-testid Time zone picker Change time settings button"},WeekStartPicker:{container:"Choose starting day of the week",containerV2:"data-testid Choose starting day of the week",placeholder:"Choose starting day of the week"},TraceViewer:{spanBar:"data-testid SpanBar--wrapper"},QueryField:{container:"data-testid Query field"},QueryBuilder:{queryPatterns:"data-testid Query patterns",labelSelect:"data-testid Select label",inputSelect:"data-testid Select label-input",valueSelect:"data-testid Select value",matchOperatorSelect:"data-testid Select match operator"},ValuePicker:{button:e=>`data-testid Value picker button ${e}`,select:e=>`data-testid Value picker select ${e}`},Search:{section:"Search section",sectionV2:"data-testid Search section",items:"Search items",itemsV2:"data-testid Search items",cards:"data-testid Search cards",collapseFolder:e=>`data-testid Collapse folder ${e}`,expandFolder:e=>`data-testid Expand folder ${e}`,dashboardItem:e=>`${xn.Search.dashboardItems} ${e}`,dashboardCard:e=>`data-testid Search card ${e}`,folderHeader:e=>`data-testid Folder header ${e}`,folderContent:e=>`data-testid Folder content ${e}`,dashboardItems:"data-testid Dashboard search item"},DashboardLinks:{container:"data-testid Dashboard link container",dropDown:"data-testid Dashboard link dropdown",link:"data-testid Dashboard link"},LoadingIndicator:{icon:"data-testid Loading indicator"},CallToActionCard:{button:e=>`Call to action button ${e}`,buttonV2:e=>`data-testid Call to action button ${e}`},DataLinksContextMenu:{singleLink:"data-testid Data link"},CodeEditor:{container:"data-testid Code editor container"},ReactMonacoEditor:{editorLazy:"data-testid ReactMonacoEditor editorLazy"},DashboardImportPage:{textarea:"data-testid-import-dashboard-textarea",submit:"data-testid-load-dashboard"},ImportDashboardForm:{name:"data-testid-import-dashboard-title",submit:"data-testid-import-dashboard-submit"},PanelAlertTabContent:{content:"data-testid Unified alert editor tab content"},VisualizationPreview:{card:e=>`data-testid suggestion-${e}`},ColorSwatch:{name:"data-testid-colorswatch"},DashboardRow:{title:e=>`data-testid dashboard-row-title-${e}`},UserProfile:{profileSaveButton:"data-testid-user-profile-save",preferencesSaveButton:"data-testid-shared-prefs-save",orgsTable:"data-testid-user-orgs-table",sessionsTable:"data-testid-user-sessions-table",extensionPointTabs:"data-testid-extension-point-tabs",extensionPointTab:e=>`data-testid-extension-point-tab-${e}`},FileUpload:{inputField:"data-testid-file-upload-input-field",fileNameSpan:"data-testid-file-upload-file-name"},DebugOverlay:{wrapper:"debug-overlay"},OrgRolePicker:{input:"Role"},AnalyticsToolbarButton:{button:"Dashboard insights"},Variables:{variableOption:"data-testid variable-option",variableLinkWrapper:"data-testid variable-link-wrapper"},Annotations:{annotationsTypeInput:"data-testid annotations-type-input",annotationsChoosePanelInput:"data-testid choose-panels-input",editor:{testButton:"data-testid annotations-test-button",resultContainer:"data-testid annotations-query-result-container"}},Tooltip:{container:"data-testid tooltip"},ReturnToPrevious:{buttonGroup:"data-testid dismissable button group",backButton:"data-testid back",dismissButton:"data-testid dismiss"},SQLQueryEditor:{selectColumn:"data-testid select-column",selectAggregation:"data-testid select-aggregation",selectAlias:"data-testid select-alias",filterConjunction:"data-testid filter-conjunction",filterField:"data-testid filter-field",filterOperator:"data-testid filter-operator",headerTableSelector:"data-testid header-table-selector",headerFilterSwitch:"data-testid header-filter-switch",headerGroupSwitch:"data-testid header-group-switch",headerOrderSwitch:"data-testid header-order-switch",headerPreviewSwitch:"data-testid header-preview-switch"},EntityNotFound:{container:"data-testid entity-not-found"}},Pn={Login:{url:"/login",username:"data-testid Username input field",password:"data-testid Password input field",submit:"data-testid Login button",skip:"data-testid Skip change password button"},Home:{url:"/"},DataSource:{name:"data-testid Data source settings page name input field",delete:"Data source settings page Delete button",readOnly:"data-testid Data source settings page read only message",saveAndTest:"data-testid Data source settings page Save and Test button",alert:"data-testid Data source settings page Alert"},DataSources:{url:"/datasources",dataSources:e=>`Data source list item ${e}`},EditDataSource:{url:e=>`/datasources/edit/${e}`,settings:"Datasource settings page basic settings"},AddDataSource:{url:"/datasources/new",dataSourcePlugins:e=>`Data source plugin item ${e}`,dataSourcePluginsV2:e=>`Add new data source ${e}`},ConfirmModal:{delete:"data-testid Confirm Modal Danger Button"},AddDashboard:{url:"/dashboard/new",itemButton:e=>`data-testid ${e}`,addNewPanel:"data-testid Add new panel",addNewRow:"data-testid Add new row",addNewPanelLibrary:"data-testid Add new panel from panel library"},Dashboard:{url:e=>`/d/${e}`,DashNav:{nav:"Dashboard navigation",navV2:"data-testid Dashboard navigation",publicDashboardTag:"data-testid public dashboard tag",shareButton:"data-testid share-button",scrollContainer:"data-testid Dashboard canvas scroll container",newShareButton:{container:"data-testid new share button",shareLink:"data-testid new share link-button",arrowMenu:"data-testid new share button arrow menu",menu:{container:"data-testid new share button menu",shareInternally:"data-testid new share button share internally",shareExternally:"data-testid new share button share externally",shareSnapshot:"data-testid new share button share snapshot"}},NewExportButton:{container:"data-testid new export button",arrowMenu:"data-testid new export button arrow menu",Menu:{container:"data-testid new export button menu",exportAsJson:"data-testid new export button export as json"}},playlistControls:{prev:"data-testid playlist previous dashboard button",stop:"data-testid playlist stop dashboard button",next:"data-testid playlist next dashboard button"}},Controls:"data-testid dashboard controls",SubMenu:{submenu:"Dashboard submenu",submenuItem:"data-testid template variable",submenuItemLabels:e=>`data-testid Dashboard template variables submenu Label ${e}`,submenuItemValueDropDownValueLinkTexts:e=>`data-testid Dashboard template variables Variable Value DropDown value link text ${e}`,submenuItemValueDropDownDropDown:"Variable options",submenuItemValueDropDownOptionTexts:e=>`data-testid Dashboard template variables Variable Value DropDown option text ${e}`,Annotations:{annotationsWrapper:"data-testid annotation-wrapper",annotationLabel:e=>`data-testid Dashboard annotations submenu Label ${e}`,annotationToggle:e=>`data-testid Dashboard annotations submenu Toggle ${e}`}},Settings:{Actions:{close:"data-testid dashboard-settings-close"},General:{deleteDashBoard:"data-testid Dashboard settings page delete dashboard button",sectionItems:e=>`Dashboard settings section item ${e}`,saveDashBoard:"Dashboard settings aside actions Save button",saveAsDashBoard:"Dashboard settings aside actions Save As button",timezone:"Time zone picker select container",title:"General"},Annotations:{List:{addAnnotationCTA:xn.CallToActionCard.button("Add annotation query"),addAnnotationCTAV2:xn.CallToActionCard.buttonV2("Add annotation query"),annotations:"data-testid list-annotations"},Settings:{name:"data-testid Annotations settings name input"},NewAnnotation:{panelFilterSelect:"data-testid annotations-panel-filter",showInLabel:"data-testid show-in-label",previewInDashboard:"data-testid annotations-preview",delete:"data-testid annotations-delete",apply:"data-testid annotations-apply",enable:"data-testid annotation-enable",hide:"data-testid annotation-hide"}},Variables:{List:{addVariableCTA:xn.CallToActionCard.button("Add variable"),addVariableCTAV2:xn.CallToActionCard.buttonV2("Add variable"),newButton:"Variable editor New variable button",table:"Variable editor Table",tableRowNameFields:e=>`Variable editor Table Name field ${e}`,tableRowDefinitionFields:e=>`Variable editor Table Definition field ${e}`,tableRowArrowUpButtons:e=>`Variable editor Table ArrowUp button ${e}`,tableRowArrowDownButtons:e=>`Variable editor Table ArrowDown button ${e}`,tableRowDuplicateButtons:e=>`Variable editor Table Duplicate button ${e}`,tableRowRemoveButtons:e=>`Variable editor Table Remove button ${e}`},Edit:{General:{headerLink:"Variable editor Header link",modeLabelNew:"Variable editor Header mode New",modeLabelEdit:"Variable editor Header mode Edit",generalNameInput:"Variable editor Form Name field",generalNameInputV2:"data-testid Variable editor Form Name field",generalTypeSelect:"Variable editor Form Type select",generalTypeSelectV2:"data-testid Variable editor Form Type select",generalLabelInput:"Variable editor Form Label field",generalLabelInputV2:"data-testid Variable editor Form Label field",generalHideSelect:"Variable editor Form Hide select",generalHideSelectV2:"data-testid Variable editor Form Hide select",selectionOptionsMultiSwitch:"data-testid Variable editor Form Multi switch",selectionOptionsIncludeAllSwitch:"data-testid Variable editor Form IncludeAll switch",selectionOptionsCustomAllInput:"data-testid Variable editor Form IncludeAll field",previewOfValuesOption:"data-testid Variable editor Preview of Values option",submitButton:"data-testid Variable editor Run Query button",applyButton:"data-testid Variable editor Apply button"},QueryVariable:{queryOptionsDataSourceSelect:xn.DataSourcePicker.inputV2,queryOptionsRefreshSelect:"Variable editor Form Query Refresh select",queryOptionsRefreshSelectV2:"data-testid Variable editor Form Query Refresh select",queryOptionsRegExInput:"Variable editor Form Query RegEx field",queryOptionsRegExInputV2:"data-testid Variable editor Form Query RegEx field",queryOptionsSortSelect:"Variable editor Form Query Sort select",queryOptionsSortSelectV2:"data-testid Variable editor Form Query Sort select",queryOptionsQueryInput:"data-testid Variable editor Form Default Variable Query Editor textarea",valueGroupsTagsEnabledSwitch:"Variable editor Form Query UseTags switch",valueGroupsTagsTagsQueryInput:"Variable editor Form Query TagsQuery field",valueGroupsTagsTagsValuesQueryInput:"Variable editor Form Query TagsValuesQuery field"},ConstantVariable:{constantOptionsQueryInput:"Variable editor Form Constant Query field",constantOptionsQueryInputV2:"data-testid Variable editor Form Constant Query field"},DatasourceVariable:{datasourceSelect:"data-testid datasource variable datasource type"},TextBoxVariable:{textBoxOptionsQueryInput:"Variable editor Form TextBox Query field",textBoxOptionsQueryInputV2:"data-testid Variable editor Form TextBox Query field"},CustomVariable:{customValueInput:"data-testid custom-variable-input"},IntervalVariable:{intervalsValueInput:"data-testid interval variable intervals input",autoEnabledCheckbox:"data-testid interval variable auto value checkbox",stepCountIntervalSelect:"data-testid interval variable step count input",minIntervalInput:"data-testid interval variable mininum interval input"},GroupByVariable:{dataSourceSelect:xn.DataSourcePicker.inputV2,infoText:"data-testid group by variable info text",modeToggle:"data-testid group by variable mode toggle"},AdHocFiltersVariable:{datasourceSelect:xn.DataSourcePicker.inputV2,infoText:"data-testid ad-hoc filters variable info text",modeToggle:"data-testid ad-hoc filters variable mode toggle"}}}},Annotations:{marker:"data-testid annotation-marker"},Rows:{Repeated:{ConfigSection:{warningMessage:"data-testid Repeated rows warning message"}}}},Dashboards:{url:"/dashboards",dashboards:e=>`Dashboard search item ${e}`},SaveDashboardAsModal:{newName:"Save dashboard title field",save:"Save dashboard button"},SaveDashboardModal:{save:"Dashboard settings Save Dashboard Modal Save button",saveVariables:"Dashboard settings Save Dashboard Modal Save variables checkbox",saveTimerange:"Dashboard settings Save Dashboard Modal Save timerange checkbox",saveRefresh:"Dashboard settings Save Dashboard Modal Save refresh checkbox"},SharePanelModal:{linkToRenderedImage:"Link to rendered image"},ShareDashboardModal:{PublicDashboard:{WillBePublicCheckbox:"data-testid public dashboard will be public checkbox",LimitedDSCheckbox:"data-testid public dashboard limited datasources checkbox",CostIncreaseCheckbox:"data-testid public dashboard cost may increase checkbox",PauseSwitch:"data-testid public dashboard pause switch",EnableAnnotationsSwitch:"data-testid public dashboard on off switch for annotations",CreateButton:"data-testid public dashboard create button",DeleteButton:"data-testid public dashboard delete button",CopyUrlInput:"data-testid public dashboard copy url input",CopyUrlButton:"data-testid public dashboard copy url button",SettingsDropdown:"data-testid public dashboard settings dropdown",TemplateVariablesWarningAlert:"data-testid public dashboard disabled template variables alert",UnsupportedDataSourcesWarningAlert:"data-testid public dashboard unsupported data sources alert",NoUpsertPermissionsWarningAlert:"data-testid public dashboard no upsert permissions alert",EnableTimeRangeSwitch:"data-testid public dashboard on off switch for time range",EmailSharingConfiguration:{Container:"data-testid email sharing config container",ShareType:"data-testid public dashboard share type",EmailSharingInput:"data-testid public dashboard email sharing input",EmailSharingInviteButton:"data-testid public dashboard email sharing invite button",EmailSharingList:"data-testid public dashboard email sharing list",DeleteEmail:"data-testid public dashboard delete email button",ReshareLink:"data-testid public dashboard reshare link button"}},SnapshotScene:{url:e=>`/dashboard/snapshot/${e}`,PublishSnapshot:"data-testid publish snapshot button",CopyUrlButton:"data-testid snapshot copy url button",CopyUrlInput:"data-testid snapshot copy url input"}},ShareDashboardDrawer:{ShareInternally:{container:"data-testid share internally drawer container",lockTimeRangeSwitch:"data-testid share internally lock time range switch",shortenUrlSwitch:"data-testid share internally shorten url switch",copyUrlButton:"data-testid share internally copy url button"},ShareExternally:{container:"data-testid share externally drawer container",publicAlert:"data-testid public share alert",emailSharingAlert:"data-testid email share alert",shareTypeSelect:"data-testid share externally share type select",Creation:{PublicShare:{createButton:"data-testid public share dashboard create button",cancelButton:"data-testid public share dashboard cancel button"},EmailShare:{createButton:"data-testid email share dashboard create button",cancelButton:"data-testid email share dashboard cancel button"},willBePublicCheckbox:"data-testid share dashboard will be public checkbox"},Configuration:{enableTimeRangeSwitch:"data-testid share externally enable time range switch",enableAnnotationsSwitch:"data-testid share externally enable annotations switch",copyUrlButton:"data-testid share externally copy url button",revokeAccessButton:"data-testid share externally revoke access button",toggleAccessButton:"data-testid share externally pause or resume access button"}},ShareSnapshot:{url:e=>`/dashboard/snapshot/${e}`,container:"data-testid share snapshot drawer container",publishSnapshot:"data-testid share snapshot publish button",copyUrlButton:"data-testid share snapshot copy url button"}},ExportDashboardDrawer:{ExportAsJson:{container:"data-testid export as json drawer container",codeEditor:"data-testid export as json code editor",exportExternallyToggle:"data-testid export as json externally switch",saveToFileButton:"data-testid export as json save to file button",copyToClipboardButton:"data-testid export as json copy to clipboard button",cancelButton:"data-testid export as json cancel button"}},PublicDashboard:{page:"public-dashboard-page",NotAvailable:{container:"public-dashboard-not-available",title:"public-dashboard-title",pausedDescription:"public-dashboard-paused-description"},footer:"public-dashboard-footer"},PublicDashboardScene:{loadingPage:"public-dashboard-scene-loading-page",page:"public-dashboard-scene-page",controls:"public-dashboard-controls"},RequestViewAccess:{form:"request-view-access-form",recipientInput:"request-view-access-recipient-input",submitButton:"request-view-access-submit-button"},PublicDashboardConfirmAccess:{submitButton:"data-testid confirm-access-submit-button"},Explore:{url:"/explore",General:{container:"data-testid Explore",graph:"Explore Graph",table:"Explore Table",scrollView:"data-testid explorer scroll view"},QueryHistory:{container:"data-testid QueryHistory"}},SoloPanel:{url:e=>`/d-solo/${e}`},PluginsList:{page:"Plugins list page",list:"Plugins list",listItem:"Plugins list item",signatureErrorNotice:"data-testid Unsigned plugins notice"},PluginPage:{page:"Plugin page",signatureInfo:"data-testid Plugin signature info",disabledInfo:"data-testid Plugin disabled info"},PlaylistForm:{name:"Playlist name",interval:"Playlist interval",itemDelete:"data-testid playlist-form-delete-item"},BrowseDashboards:{table:{body:"data-testid browse-dashboards-table",row:e=>`data-testid browse dashboards row ${e}`,checkbox:e=>`data-testid ${e} checkbox`},NewFolderForm:{form:"data-testid new folder form",nameInput:"data-testid new-folder-name-input",createButton:"data-testid new-folder-create-button"}},Search:{url:"/?search=openn",FolderView:{url:"/?search=open&layout=folders"}},PublicDashboards:{ListItem:{linkButton:"public-dashboard-link-button",configButton:"public-dashboard-configuration-button",trashcanButton:"public-dashboard-remove-button",pauseSwitch:"data-testid public dashboard pause switch"}},UserListPage:{tabs:{allUsers:"data-testid all-users-tab",orgUsers:"data-testid org-users-tab",anonUserDevices:"data-testid anon-user-devices-tab",publicDashboardsUsers:"data-testid public-dashboards-users-tab",users:"data-testid users-tab"},org:{url:"/org/users"},admin:{url:"/admin/users"},publicDashboards:{container:"data-testid public-dashboards-users-list"},UserListAdminPage:{container:"data-testid user-list-admin-page"},UsersListPage:{container:"data-testid users-list-page"},UserAnonListPage:{container:"data-testid user-anon-list-page"},UsersListPublicDashboardsPage:{container:"data-testid users-list-public-dashboards-page",DashboardsListModal:{listItem:e=>`data-testid dashboards-list-item-${e}`}}},ProfilePage:{url:"/profile"}},Cn={pages:Pn,components:xn};var En=h(89);function jn(e,t=!1){let n=e;t&&(n=[{value:yt,label:bt},...n]);const r=ru(n.map((e=>e.label)));return e=>r(e).map((e=>n[e]))}var Dn=Object.defineProperty,kn=Object.defineProperties,Tn=Object.getOwnPropertyDescriptors,Rn=Object.getOwnPropertySymbols,An=Object.prototype.hasOwnProperty,In=Object.prototype.propertyIsEnumerable,Mn=(e,t,n)=>t in e?Dn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const Vn=()=>!0,Fn=e=>"$__all"!==e.value,Ln=(e,t)=>e.length===t.filter(Fn).length?_n.ToggleAllState.allSelected:0===e.length||1===e.length&&e[0]&&"$__all"===e[0].value?_n.ToggleAllState.noneSelected:_n.ToggleAllState.indeterminate;function $n({model:e}){const{value:n,text:a,key:i,options:o,includeAll:s,isReadOnly:l,allowCustomValue:u=!0}=e.useState(),[c,d]=(0,t.useState)(""),[p,h]=(0,t.useState)(!1),f=function(e,t){return{value:e,label:null!=t?t:String(e)}}(n,String(a)),m=(0,t.useMemo)((()=>jn(o,s)),[o,s])(c);return r().createElement(_n.Select,{id:i,isValidNewOption:e=>e.trim().length>0,placeholder:"Select value",width:"auto",disabled:l,value:f,inputValue:c,allowCustomValue:u,virtualized:!0,filterOption:Vn,tabSelectsValue:!1,onInputChange:(t,{action:n})=>"input-change"===n?(d(t),e.onSearchChange&&e.onSearchChange(t),t):t,onOpenMenu:()=>{p&&d(String(a))},onCloseMenu:()=>{d("")},options:m,"data-testid":Cn.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${n}`),onChange:t=>{e.changeValueTo(t.value,t.label),p!==t.__isNew__&&h(t.__isNew__)}})}function zn({model:e}){const{value:n,options:a,key:i,maxVisibleValues:o,noValueOnClear:s,includeAll:l,isReadOnly:u,allowCustomValue:c=!0}=e.useState(),d=(0,t.useMemo)((()=>(0,ge.isArray)(n)?n:[n]),[n]),[p,h]=(0,t.useState)(d),[f,m]=(0,t.useState)(""),g=(0,t.useMemo)((()=>jn(a,l)),[a,l]);(0,t.useEffect)((()=>{h(d)}),[d]);const b=a.length>0?"Select value":"",y=g(f);return r().createElement(_n.MultiSelect,{id:i,placeholder:b,width:"auto",inputValue:f,disabled:u,value:p,noMultiValueWrap:!0,maxVisibleValues:null!=o?o:5,tabSelectsValue:!1,virtualized:!0,allowCustomValue:c,toggleAllOptions:{enabled:!0,optionsFilter:Fn,determineToggleAllState:Ln},options:y,closeMenuOnSelect:!1,components:{Option:Bn},isClearable:!0,hideSelectedOptions:!1,onInputChange:(t,{action:n})=>"input-change"===n?(m(t),e.onSearchChange&&e.onSearchChange(t),t):"input-blur"===n?(m(""),""):f,onBlur:()=>{e.changeValueTo(p)},filterOption:Vn,"data-testid":Cn.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${p}`),onChange:(t,n)=>{"clear"===n.action&&s&&e.changeValueTo([]),h(t.map((e=>e.value)))}})}const Bn=({children:e,data:t,innerProps:n,innerRef:a,isFocused:i,isSelected:o,indeterminate:s,renderOptionLabel:l})=>{var u;const c=((e,t)=>{var n={};for(var r in e)An.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&Rn)for(var r of Rn(e))t.indexOf(r)<0&&In.call(e,r)&&(n[r]=e[r]);return n})(n,["onMouseMove","onMouseOver"]),d=(0,_n.useTheme2)(),p=(0,_n.getSelectStyles)(d),h=(0,_n.useStyles2)(Nn);return r().createElement("div",(f=((e,t)=>{for(var n in t||(t={}))An.call(t,n)&&Mn(e,n,t[n]);if(Rn)for(var n of Rn(t))In.call(t,n)&&Mn(e,n,t[n]);return e})({ref:a,className:(0,En.cx)(p.option,i&&p.optionFocused)},c),m={"data-testid":"data-testid Select option",title:t.title},kn(f,Tn(m))),r().createElement("div",{className:h.checkbox},r().createElement(_n.Checkbox,{indeterminate:s,value:o})),r().createElement("div",{className:p.optionBody,"data-testid":Cn.pages.Dashboard.SubMenu.submenuItemValueDropDownOptionTexts(null!=(u=t.label)?u:String(t.value))},r().createElement("span",null,e)));var f,m};Bn.displayName="SelectMenuOptions";const Nn=e=>({checkbox:(0,En.css)({marginRight:e.spacing(2)})});function qn(e){return e.state.isMulti?r().createElement(zn,{model:e}):r().createElement($n,{model:e})}class Hn{getKey(){return`var-${this._sceneObject.state.name}`}getKeys(){return this._sceneObject.state.skipUrlSync?[]:[this.getKey()]}getUrlState(){return this._sceneObject.state.skipUrlSync?{}:{[this.getKey()]:(e=this._sceneObject.state.value,t=this._sceneObject.state.text,e=Array.isArray(e)?e:[e],t=Array.isArray(t)?t:[t],e.map(((e,n)=>{if(null==e)return"";e=String(e);let r=t[n];return r=null==r?e:String(r),Jl(e,r)})))};var e,t}updateFromUrl(e){let t=e[this.getKey()];if(null!=t){this._sceneObject.isActive||(this._sceneObject.skipNextValidation=!0);const{values:e,texts:r}=(n=t,(n=Array.isArray(n)?n:[n]).reduce(((e,t)=>{const[n,r]=(null!=t?t:"").split(",");return e.values.push(Xl(n)),e.texts.push(Xl(null!=r?r:n)),e}),{values:[],texts:[]}));this._sceneObject.changeValueTo(e,r)}var n}constructor(e){this._sceneObject=e}}function Wn(e){const t=e.getRoot();return"enrichFiltersRequest"in t?t.enrichFiltersRequest(e):null}var Un,Gn=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};class Qn{toString(){}get value(){return this}constructor(e){((e,t)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,void 0)})(this,Un),this.text="__sceneObject",this.valueOf=()=>{return Gn(this,e=Un,"read from private field"),e.get(this);var e},((e,t,n)=>{Gn(e,t,"write to private field"),t.set(e,n)})(this,Un,e)}}function Kn(e){return function(e){const t=e.match(/^(\d+)\.(\d+)\.(\d+)/);if(!t)return!1;const n=parseInt(t[1],10),r=parseInt(t[2],10),a=parseInt(t[3],10);return 11===n?0===r&&a>=4||1===r&&a>=2||r>1:10===n?4===r&&a>=8||r>=5:n>11}(d.config.buildInfo.version)?new Qn(e):{value:e,text:"__sceneObject"}}function Yn(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function Zn(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){Yn(i,r,a,o,s,"next",e)}function s(e){Yn(i,r,a,o,s,"throw",e)}o(void 0)}))}}Un=new WeakMap;var Xn=Object.defineProperty,Jn=Object.defineProperties,er=Object.getOwnPropertyDescriptors,tr=Object.getOwnPropertySymbols,nr=Object.prototype.hasOwnProperty,rr=Object.prototype.propertyIsEnumerable,ar=(e,t,n)=>t in e?Xn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ir=(e,t)=>{for(var n in t||(t={}))nr.call(t,n)&&ar(e,n,t[n]);if(tr)for(var n of tr(t))rr.call(t,n)&&ar(e,n,t[n]);return e};class or extends Ct{validateAndUpdate(){return this.getValueOptions({}).pipe((0,D.map)((e=>(this._updateValueGivenNewOptions(e),{}))))}_updateValueGivenNewOptions(e){const{value:t,text:n}=this.state,r={options:e,loading:!1,value:null!=t?t:[],text:null!=n?n:[]};this.setState(r)}getValueOptions(e){return this.state.defaultOptions?(0,D.of)(this.state.defaultOptions.map((e=>({label:e.text,value:String(e.value),group:e.group})))):(this.setState({loading:!0,error:null}),(0,D.from)(Kt(this.state.datasource,{__sceneObject:Kn(this)})).pipe((0,D.mergeMap)((e=>(0,D.from)(this._getKeys(e)).pipe((0,D.tap)((e=>{tu(e)&&this.setState({error:e.error.message})})),(0,D.map)((e=>eu(e))),(0,D.take)(1),(0,D.mergeMap)((e=>{const t=e.map((e=>({label:e.text,value:e.value?String(e.value):e.text,group:e.group})));return(0,D.of)(t)})))))))}getDefaultMultiState(e){return{value:[],text:[]}}constructor(e){var t;super((t=ir({isMulti:!0,name:"",value:[],text:[],options:[],datasource:null,baseFilters:[],applyMode:"auto",layout:"horizontal",type:"groupby"},e),Jn(t,er({noValueOnClear:!0})))),this.isLazy=!0,this._urlSync=new Hn(this);var n=this;this._getKeys=function(){var e=Zn((function*(e){var t,r,a;const i=yield null==(r=(t=n.state).getTagKeysProvider)?void 0:r.call(t,n,null);if(i&&i.replace)return i.values;if(n.state.defaultOptions)return n.state.defaultOptions.concat(eu(null!=(a=null==i?void 0:i.values)?a:[]));if(!e.getTagKeys)return[];const o=Kl(n),s=n.state.baseFilters||[],l=Hu.getTimeRange(n).state.value,u=yield e.getTagKeys(ir({filters:s,queries:o,timeRange:l},Wn(n)));tu(u)&&n.setState({error:u.error.message});let c=eu(u);i&&(c=c.concat(eu(i.values)));const d=n.state.tagKeyRegexFilter;return d&&(c=c.filter((e=>e.text.match(d)))),c}));return function(t){return e.apply(this,arguments)}}(),"auto"===this.state.applyMode&&this.addActivationHandler((()=>(Sn.add(this),()=>Sn.delete(this))))}}or.Component=function({model:e}){const{value:n,text:a,key:i,isMulti:o=!0,maxVisibleValues:s,noValueOnClear:l,options:u,includeAll:c,allowCustomValue:d=!0}=e.useState(),p=(0,t.useMemo)((()=>{const e=(0,ge.isArray)(n)?n:[n],t=(0,ge.isArray)(a)?a:[a];return e.map(((e,n)=>{var r;return{value:e,label:String(null!=(r=t[n])?r:e)}}))}),[n,a]),[h,f]=(0,t.useState)(!1),[m,g]=(0,t.useState)(!1),[b,y]=(0,t.useState)(""),[v,w]=(0,t.useState)(p),O=(0,t.useMemo)((()=>jn(u,c)),[u,c]);(0,t.useEffect)((()=>{w(p)}),[p]);const S=(t,{action:n})=>"input-change"===n?(y(t),e.onSearchChange&&e.onSearchChange(t),t):"input-blur"===n?(y(""),""):b,_=(0,t.useMemo)((()=>nu(O(b).map(lr))),[O,b]);return o?r().createElement(_n.MultiSelect,{"aria-label":"Group by selector","data-testid":`GroupBySelect-${i}`,id:i,placeholder:"Select value",width:"auto",allowCustomValue:d,inputValue:b,value:v,noMultiValueWrap:!0,maxVisibleValues:null!=s?s:5,tabSelectsValue:!1,virtualized:!0,options:_,filterOption:sr,closeMenuOnSelect:!1,isOpen:m,isClearable:!0,hideSelectedOptions:!1,isLoading:h,components:{Option:Bn},onInputChange:S,onBlur:()=>{e.changeValueTo(v.map((e=>e.value)),v.map((e=>e.label)))},onChange:(t,n)=>{"clear"===n.action&&l&&e.changeValueTo([]),w(t)},onOpenMenu:Zn((function*(){f(!0),yield(0,D.lastValueFrom)(e.validateAndUpdate()),f(!1),g(!0)})),onCloseMenu:()=>{g(!1)}}):r().createElement(_n.Select,{"aria-label":"Group by selector","data-testid":`GroupBySelect-${i}`,id:i,placeholder:"Select value",width:"auto",inputValue:b,value:v,allowCustomValue:d,noMultiValueWrap:!0,maxVisibleValues:null!=s?s:5,tabSelectsValue:!1,virtualized:!0,options:_,filterOption:sr,closeMenuOnSelect:!0,isOpen:m,isClearable:!0,hideSelectedOptions:!1,noValueOnClear:!0,isLoading:h,onInputChange:S,onChange:(t,n)=>{if("clear"===n.action)return w([]),void(l&&e.changeValueTo([]));(null==t?void 0:t.value)&&(w([t]),e.changeValueTo([t.value],t.label?[t.label]:void 0))},onOpenMenu:Zn((function*(){f(!0),yield(0,D.lastValueFrom)(e.validateAndUpdate()),f(!1),g(!0)})),onCloseMenu:()=>{g(!1)}})};const sr=()=>!0;function lr(e){const{label:t,value:n,group:r}=e,a={label:t,value:n};return r&&(a.group=r),a}function ur(e){return r().createElement(_n.Tooltip,{content:"Cancel query"},r().createElement(_n.Icon,{className:"spin-clockwise",name:"sync",size:"xs",role:"button",onMouseDown:t=>{e.onCancel(t)}}))}function cr(e){const t=(0,_n.useStyles2)(dr),n=(0,_n.useTheme2)(),a="vertical"===e.layout,i=Boolean(e.isLoading)?r().createElement("div",{style:{marginLeft:n.spacing(1),marginTop:"-1px"},"aria-label":Cn.components.LoadingIndicator.icon},r().createElement(ur,{onCancel:t=>{var n;t.preventDefault(),t.stopPropagation(),null==(n=e.onCancel)||n.call(e)}})):null;let o=null;e.error&&(o=r().createElement(_n.Tooltip,{content:e.error,placement:"bottom"},r().createElement(_n.Icon,{className:t.errorIcon,name:"exclamation-triangle"})));let s=null;e.description&&(s=r().createElement(_n.Tooltip,{content:e.description,placement:a?"top":"bottom"},r().createElement(_n.Icon,{className:t.normalIcon,name:"info-circle"})));const l="string"==typeof e.label?Cn.pages.Dashboard.SubMenu.submenuItemLabels(e.label):"";let u;return u=a?r().createElement("label",{className:t.verticalLabel,"data-testid":l,htmlFor:e.htmlFor},e.label,s,o,e.icon&&r().createElement(_n.Icon,{name:e.icon,className:t.normalIcon}),i,e.onRemove&&r().createElement(_n.IconButton,{variant:"secondary",size:"xs",name:"times",onClick:e.onRemove,tooltip:"Remove"})):r().createElement("label",{className:t.horizontalLabel,"data-testid":l,htmlFor:e.htmlFor},o,e.icon&&r().createElement(_n.Icon,{name:e.icon,className:t.normalIcon}),e.label,s,i),u}const dr=e=>({horizontalLabel:(0,En.css)({background:e.isDark?e.colors.background.primary:e.colors.background.secondary,display:"flex",alignItems:"center",padding:e.spacing(0,1),fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.bodySmall.fontSize,height:e.spacing(e.components.height.md),lineHeight:e.spacing(e.components.height.md),borderRadius:e.shape.borderRadius(1),border:`1px solid ${e.components.input.borderColor}`,position:"relative",right:-1,whiteSpace:"nowrap",gap:e.spacing(.5)}),verticalLabel:(0,En.css)({display:"flex",alignItems:"center",fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.bodySmall.fontSize,lineHeight:e.typography.bodySmall.lineHeight,whiteSpace:"nowrap",marginBottom:e.spacing(.5),gap:e.spacing(1)}),errorIcon:(0,En.css)({color:e.colors.error.text}),normalIcon:(0,En.css)({color:e.colors.text.secondary})});function pr(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function hr(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){pr(i,r,a,o,s,"next",e)}function s(e){pr(i,r,a,o,s,"throw",e)}o(void 0)}))}}var fr=Object.defineProperty,mr=Object.getOwnPropertySymbols,gr=Object.prototype.hasOwnProperty,br=Object.prototype.propertyIsEnumerable,yr=(e,t,n)=>t in e?fr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function vr(e,t){return""!==e?{value:e,label:t||e}:null}const wr=()=>!0;function Or({filter:e,model:n}){var a,i,o,s,l;const u=(0,_n.useStyles2)(Sr),[c,d]=(0,t.useState)([]),[p,h]=(0,t.useState)([]),[f,m]=(0,t.useState)(!1),[g,b]=(0,t.useState)(!1),[y,v]=(0,t.useState)(!1),[w,O]=(0,t.useState)(!1),[S,_]=(0,t.useState)(!1),[x,P]=(0,t.useState)(""),[C,E]=(0,t.useState)(!1),[j,D]=(0,t.useState)(e.values?e.values.map(((t,n)=>{var r;return vr(t,null==(r=e.valueLabels)?void 0:r[n])})):[]),k=pl(e.operator),T=vr(e.key,e.keyLabel),R=vr(e.value,null==(a=e.valueLabels)?void 0:a[0]),A=(0,t.useMemo)((()=>function(e){const t=ru(e.map((e=>{var t;return null!=(t=e.label)?t:String(e.value)})));return n=>t(n).map((t=>e[t]))}(p)),[p]),I=(0,t.useMemo)((()=>nu(A(x))),[A,x]),M={isMulti:!0,value:j,components:{Option:Bn},hideSelectedOptions:!1,closeMenuOnSelect:!1,openMenuOnFocus:!1,onChange:e=>{D(e),e.some((e=>e.__isNew__))&&P("")},onBlur:()=>{var t,r;n._updateFilter(e,{value:null!=(r=null==(t=j[0])?void 0:t.value)?r:"",values:j.map((e=>e.value)),valueLabels:j.map((e=>e.label))})}},V=r().createElement(_n.Select,((e,t)=>{for(var n in t||(t={}))gr.call(t,n)&&yr(e,n,t[n]);if(mr)for(var n of mr(t))br.call(t,n)&&yr(e,n,t[n]);return e})({virtualized:!0,allowCustomValue:null==(i=n.state.allowCustomValue)||i,isValidNewOption:e=>e.trim().length>0,allowCreateWhileLoading:!0,createOptionPosition:"first",formatCreateLabel:e=>`Use custom value: ${e}`,disabled:n.state.readOnly,className:(0,En.cx)(u.value,w?u.widthWhenOpen:void 0),width:"auto",value:R,filterOption:wr,placeholder:"Select value",options:I,inputValue:x,onInputChange:(e,{action:t})=>("input-change"===t&&P(e),e),onChange:t=>{n._updateFilter(e,{value:t.value,valueLabels:t.label?[t.label]:[t.value]}),C!==t.__isNew__&&E(t.__isNew__)},isOpen:w&&!g,isLoading:g,openMenuOnFocus:!0,onOpenMenu:hr((function*(){var t;b(!0),O(!0);const r=yield n._getValuesFor(e);b(!1),h(r),C&&P(null!=(t=null==R?void 0:R.label)?t:"")})),onCloseMenu:()=>{O(!1),P("")}},k&&M)),F=r().createElement(_n.Select,{key:g?"loading":"loaded",disabled:n.state.readOnly,className:(0,En.cx)(u.key,y?u.widthWhenOpen:void 0),width:"auto",allowCustomValue:null==(o=n.state.allowCustomValue)||o,value:T,placeholder:"Select label",options:nu(c),onChange:t=>{n._updateFilter(e,{key:t.value,keyLabel:t.label,value:"",valueLabels:[""],values:void 0}),D([])},autoFocus:""===e.key,isOpen:y&&!f,isLoading:f,onOpenMenu:hr((function*(){v(!0),m(!0);const t=yield n._getKeys(e.key);m(!1),d(t)})),onCloseMenu:()=>{v(!1)},onBlur:()=>{""===e.key&&n._removeFilter(e)},openMenuOnFocus:!0}),L=r().createElement(_n.Select,{className:(0,En.cx)(u.operator,{[u.widthWhenOpen]:S}),value:e.operator,disabled:n.state.readOnly,options:n._getOperators(),onChange:t=>{var r,a;const i=e.operator,o=t.value,s={operator:o};pl(i)&&!pl(o)?(s.value="",s.valueLabels=[""],s.values=void 0,D([])):!pl(i)&&pl(o)&&e.value&&(s.values=[e.value],D([{value:e.value,label:null!=(a=null==(r=e.valueLabels)?void 0:r[0])?a:e.value}])),n._updateFilter(e,s)},onOpenMenu:()=>{_(!0)},onCloseMenu:()=>{_(!1)}});if("vertical"===n.state.layout){if(e.key){const t=r().createElement(cr,{layout:"vertical",label:null!=(s=e.key)?s:"",onRemove:()=>n._removeFilter(e)});return r().createElement(_n.Field,{label:t,"data-testid":`AdHocFilter-${e.key}`,className:u.field},r().createElement("div",{className:u.wrapper},L,V))}return r().createElement(_n.Field,{label:"Select label","data-testid":`AdHocFilter-${e.key}`,className:u.field},F)}return r().createElement("div",{className:u.wrapper,"data-testid":`AdHocFilter-${e.key}`},F,L,V,r().createElement(_n.Button,{variant:"secondary","aria-label":"Remove filter",title:"Remove filter",className:u.removeButton,icon:"times","data-testid":`AdHocFilter-remove-${null!=(l=e.key)?l:""}`,onClick:()=>n._removeFilter(e)}))}const Sr=e=>({field:(0,En.css)({marginBottom:0}),wrapper:(0,En.css)({display:"flex","> *":{"&:not(:first-child)":{marginLeft:-1},"&:first-child":{borderTopRightRadius:0,borderBottomRightRadius:0},"&:last-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:first-child):not(:last-child)":{borderRadius:0},position:"relative",zIndex:0,"&:hover":{zIndex:1},"&:focus-within":{zIndex:2}}}),widthWhenOpen:(0,En.css)({minWidth:e.spacing(16)}),value:(0,En.css)({flexBasis:"content",flexShrink:1,minWidth:"90px"}),key:(0,En.css)({flexBasis:"content",minWidth:"90px",flexShrink:1}),operator:(0,En.css)({flexShrink:0,flexBasis:"content"}),removeButton:(0,En.css)({paddingLeft:e.spacing(1.5),paddingRight:e.spacing(1.5),borderLeft:"none",width:e.spacing(3),marginRight:e.spacing(1),boxSizing:"border-box",position:"relative",left:"1px"})});function _r({model:e,addFilterButtonText:t}){const{_wip:n}=e.useState();return n?r().createElement(Or,{filter:n,model:e}):r().createElement(_n.Button,{variant:"secondary",icon:"plus",title:"Add filter","aria-label":"Add filter","data-testid":"AdHocFilter-add",onClick:()=>e._addWip()},t)}class xr{getKey(){return`var-${this._variable.state.name}`}getKeys(){return[this.getKey()]}getUrlState(){const e=this._variable.state.filters;if(0===e.length)return{[this.getKey()]:[""]};const t=e.filter(dl).map((e=>function(e){var t;const n=[Jl(e.key,e.keyLabel),e.operator];return pl(e.operator)?e.values.forEach(((t,r)=>{var a;n.push(Jl(t,null==(a=e.valueLabels)?void 0:a[r]))})):n.push(Jl(e.value,null==(t=e.valueLabels)?void 0:t[0])),n}(e).map(Yl).join("|")));return{[this.getKey()]:t}}updateFromUrl(e){const t=e[this.getKey()];if(null==t)return;const n=function(e){if(Array.isArray(e))return e.map(Pr).filter(Cr);const t=Pr(e);return null===t?[]:[t]}(t);this._variable.setState({filters:n})}constructor(e){this._variable=e}}function Pr(e){if("string"!=typeof e||0===e.length)return null;const[t,n,r,a,...i]=e.split("|").reduce(((e,t)=>{const[n,r]=t.split(",");return e.push(n,null!=r?r:n),e}),[]).map(Xl);return{key:t,keyLabel:n,operator:r,value:i[0],values:pl(r)?i.filter(((e,t)=>t%2==0)):void 0,valueLabels:i.filter(((e,t)=>t%2==1)),condition:""}}function Cr(e){return null!==e&&"string"==typeof e.key&&"string"==typeof e.value}function Er(){return"undefined"!=typeof window}function jr(e){return Tr(e)?(e.nodeName||"").toLowerCase():"#document"}function Dr(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function kr(e){var t;return null==(t=(Tr(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function Tr(e){return!!Er()&&(e instanceof Node||e instanceof Dr(e).Node)}function Rr(e){return!!Er()&&(e instanceof Element||e instanceof Dr(e).Element)}function Ar(e){return!!Er()&&(e instanceof HTMLElement||e instanceof Dr(e).HTMLElement)}function Ir(e){return!(!Er()||"undefined"==typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof Dr(e).ShadowRoot)}function Mr(e){const{overflow:t,overflowX:n,overflowY:r,display:a}=Br(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(a)}function Vr(e){return["table","td","th"].includes(jr(e))}function Fr(e){return[":popover-open",":modal"].some((t=>{try{return e.matches(t)}catch(e){return!1}}))}function Lr(e){const t=$r(),n=Rr(e)?Br(e):e;return"none"!==n.transform||"none"!==n.perspective||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some((e=>(n.willChange||"").includes(e)))||["paint","layout","strict","content"].some((e=>(n.contain||"").includes(e)))}function $r(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function zr(e){return["html","body","#document"].includes(jr(e))}function Br(e){return Dr(e).getComputedStyle(e)}function Nr(e){return Rr(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function qr(e){if("html"===jr(e))return e;const t=e.assignedSlot||e.parentNode||Ir(e)&&e.host||kr(e);return Ir(t)?t.host:t}function Hr(e){const t=qr(e);return zr(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ar(t)&&Mr(t)?t:Hr(t)}function Wr(e,t,n){var r;void 0===t&&(t=[]),void 0===n&&(n=!0);const a=Hr(e),i=a===(null==(r=e.ownerDocument)?void 0:r.body),o=Dr(a);if(i){const e=function(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}(o);return t.concat(o,o.visualViewport||[],Mr(a)?a:[],e&&n?Wr(e):[])}return t.concat(a,Wr(a,[],n))}function Ur(e){let t=e.activeElement;for(;null!=(null==(n=t)||null==(n=n.shadowRoot)?void 0:n.activeElement);){var n;t=t.shadowRoot.activeElement}return t}function Gr(e,t){if(!e||!t)return!1;const n=null==t.getRootNode?void 0:t.getRootNode();if(e.contains(t))return!0;if(n&&Ir(n)){let n=t;for(;n;){if(e===n)return!0;n=n.parentNode||n.host}}return!1}function Qr(){const e=navigator.userAgentData;return null!=e&&e.platform?e.platform:navigator.platform}function Kr(){const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?e.brands.map((e=>{let{brand:t,version:n}=e;return t+"/"+n})).join(" "):navigator.userAgent}function Yr(e){return!(0!==e.mozInputSource||!e.isTrusted)||(Jr()&&e.pointerType?"click"===e.type&&1===e.buttons:0===e.detail&&!e.pointerType)}function Zr(e){return!Kr().includes("jsdom/")&&(!Jr()&&0===e.width&&0===e.height||Jr()&&1===e.width&&1===e.height&&0===e.pressure&&0===e.detail&&"mouse"===e.pointerType||e.width<1&&e.height<1&&0===e.pressure&&0===e.detail&&"touch"===e.pointerType)}function Xr(){return/apple/i.test(navigator.vendor)}function Jr(){const e=/android/i;return e.test(Qr())||e.test(Kr())}function ea(e){return(null==e?void 0:e.ownerDocument)||document}function ta(e,t){if(null==t)return!1;if("composedPath"in e)return e.composedPath().includes(t);const n=e;return null!=n.target&&t.contains(n.target)}function na(e){return"composedPath"in e?e.composedPath()[0]:e.target}function ra(e){e.preventDefault(),e.stopPropagation()}function aa(e){return!!e&&"combobox"===e.getAttribute("role")&&function(e){return Ar(e)&&e.matches("input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])")}(e)}const ia=Math.min,oa=Math.max,sa=Math.round,la=Math.floor,ua=e=>({x:e,y:e}),ca={left:"right",right:"left",bottom:"top",top:"bottom"},da={start:"end",end:"start"};function pa(e,t){return"function"==typeof e?e(t):e}function ha(e){return e.split("-")[0]}function fa(e){return e.split("-")[1]}function ma(e){return"y"===e?"height":"width"}function ga(e){return["top","bottom"].includes(ha(e))?"y":"x"}function ba(e){return"x"===ga(e)?"y":"x"}function ya(e){return e.replace(/start|end/g,(e=>da[e]))}function va(e){return e.replace(/left|right|bottom|top/g,(e=>ca[e]))}function wa(e){const{x:t,y:n,width:r,height:a}=e;return{width:r,height:a,top:n,left:t,right:t+r,bottom:n+a,x:t,y:n}}var Oa=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"].join(","),Sa="undefined"==typeof Element,_a=Sa?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,xa=!Sa&&Element.prototype.getRootNode?function(e){var t;return null==e||null===(t=e.getRootNode)||void 0===t?void 0:t.call(e)}:function(e){return null==e?void 0:e.ownerDocument},Pa=function e(t,n){var r;void 0===n&&(n=!0);var a=null==t||null===(r=t.getAttribute)||void 0===r?void 0:r.call(t,"inert");return""===a||"true"===a||n&&t&&e(t.parentNode)},Ca=function e(t,n,r){for(var a=[],i=Array.from(t);i.length;){var o=i.shift();if(!Pa(o,!1))if("SLOT"===o.tagName){var s=o.assignedElements(),l=e(s.length?s:o.children,!0,r);r.flatten?a.push.apply(a,l):a.push({scopeParent:o,candidates:l})}else{_a.call(o,Oa)&&r.filter(o)&&(n||!t.includes(o))&&a.push(o);var u=o.shadowRoot||"function"==typeof r.getShadowRoot&&r.getShadowRoot(o),c=!Pa(u,!1)&&(!r.shadowRootFilter||r.shadowRootFilter(o));if(u&&c){var d=e(!0===u?o.children:u.children,!0,r);r.flatten?a.push.apply(a,d):a.push({scopeParent:o,candidates:d})}else i.unshift.apply(i,o.children)}}return a},Ea=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},ja=function(e){if(!e)throw new Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||function(e){var t,n=null==e||null===(t=e.getAttribute)||void 0===t?void 0:t.call(e,"contenteditable");return""===n||"true"===n}(e))&&!Ea(e)?0:e.tabIndex},Da=function(e,t){return e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex},ka=function(e){return"INPUT"===e.tagName},Ta=function(e){var t=e.getBoundingClientRect(),n=t.width,r=t.height;return 0===n&&0===r},Ra=function(e,t){return!(t.disabled||Pa(t)||function(e){return ka(e)&&"hidden"===e.type}(t)||function(e,t){var n=t.displayCheck,r=t.getShadowRoot;if("hidden"===getComputedStyle(e).visibility)return!0;var a=_a.call(e,"details>summary:first-of-type")?e.parentElement:e;if(_a.call(a,"details:not([open]) *"))return!0;if(n&&"full"!==n&&"legacy-full"!==n){if("non-zero-area"===n)return Ta(e)}else{if("function"==typeof r){for(var i=e;e;){var o=e.parentElement,s=xa(e);if(o&&!o.shadowRoot&&!0===r(o))return Ta(e);e=e.assignedSlot?e.assignedSlot:o||s===e.ownerDocument?o:s.host}e=i}if(function(e){var t,n,r,a,i=e&&xa(e),o=null===(t=i)||void 0===t?void 0:t.host,s=!1;if(i&&i!==e)for(s=!!(null!==(n=o)&&void 0!==n&&null!==(r=n.ownerDocument)&&void 0!==r&&r.contains(o)||null!=e&&null!==(a=e.ownerDocument)&&void 0!==a&&a.contains(e));!s&&o;){var l,u,c;s=!(null===(u=o=null===(l=i=xa(o))||void 0===l?void 0:l.host)||void 0===u||null===(c=u.ownerDocument)||void 0===c||!c.contains(o))}return s}(e))return!e.getClientRects().length;if("legacy-full"!==n)return!0}return!1}(t,e)||function(e){return"DETAILS"===e.tagName&&Array.prototype.slice.apply(e.children).some((function(e){return"SUMMARY"===e.tagName}))}(t)||function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var t=e.parentElement;t;){if("FIELDSET"===t.tagName&&t.disabled){for(var n=0;n<t.children.length;n++){var r=t.children.item(n);if("LEGEND"===r.tagName)return!!_a.call(t,"fieldset[disabled] *")||!r.contains(e)}return!0}t=t.parentElement}return!1}(t))},Aa=function(e,t){return!(function(e){return function(e){return ka(e)&&"radio"===e.type}(e)&&!function(e){if(!e.name)return!0;var t,n=e.form||xa(e),r=function(e){return n.querySelectorAll('input[type="radio"][name="'+e+'"]')};if("undefined"!=typeof window&&void 0!==window.CSS&&"function"==typeof window.CSS.escape)t=r(window.CSS.escape(e.name));else try{t=r(e.name)}catch(e){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",e.message),!1}var a=function(e,t){for(var n=0;n<e.length;n++)if(e[n].checked&&e[n].form===t)return e[n]}(t,e.form);return!a||a===e}(e)}(t)||ja(t)<0||!Ra(e,t))},Ia=function(e){var t=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(t)||t>=0)},Ma=function e(t){var n=[],r=[];return t.forEach((function(t,a){var i=!!t.scopeParent,o=i?t.scopeParent:t,s=function(e,t){var n=ja(e);return n<0&&t&&!Ea(e)?0:n}(o,i),l=i?e(t.candidates):o;0===s?i?n.push.apply(n,l):n.push(o):r.push({documentOrder:a,tabIndex:s,item:t,isScope:i,content:l})})),r.sort(Da).reduce((function(e,t){return t.isScope?e.push.apply(e,t.content):e.push(t.content),e}),[]).concat(n)},Va=function(e,t){var n;return n=(t=t||{}).getShadowRoot?Ca([e],t.includeContainer,{filter:Aa.bind(null,t),flatten:!1,getShadowRoot:t.getShadowRoot,shadowRootFilter:Ia}):function(e,t,n){if(Pa(e))return[];var r=Array.prototype.slice.apply(e.querySelectorAll(Oa));return t&&_a.call(e,Oa)&&r.unshift(e),r.filter(n)}(e,t.includeContainer,Aa.bind(null,t)),Ma(n)},Fa=h(398);function La(e,t,n){let{reference:r,floating:a}=e;const i=ga(t),o=ba(t),s=ma(o),l=ha(t),u="y"===i,c=r.x+r.width/2-a.width/2,d=r.y+r.height/2-a.height/2,p=r[s]/2-a[s]/2;let h;switch(l){case"top":h={x:c,y:r.y-a.height};break;case"bottom":h={x:c,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-a.width,y:d};break;default:h={x:r.x,y:r.y}}switch(fa(t)){case"start":h[o]-=p*(n&&u?-1:1);break;case"end":h[o]+=p*(n&&u?-1:1)}return h}async function $a(e,t){var n;void 0===t&&(t={});const{x:r,y:a,platform:i,rects:o,elements:s,strategy:l}=e,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:p=!1,padding:h=0}=pa(t,e),f=function(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}(h),m=s[p?"floating"===d?"reference":"floating":d],g=wa(await i.getClippingRect({element:null==(n=await(null==i.isElement?void 0:i.isElement(m)))||n?m:m.contextElement||await(null==i.getDocumentElement?void 0:i.getDocumentElement(s.floating)),boundary:u,rootBoundary:c,strategy:l})),b="floating"===d?{...o.floating,x:r,y:a}:o.reference,y=await(null==i.getOffsetParent?void 0:i.getOffsetParent(s.floating)),v=await(null==i.isElement?void 0:i.isElement(y))&&await(null==i.getScale?void 0:i.getScale(y))||{x:1,y:1},w=wa(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:b,offsetParent:y,strategy:l}):b);return{top:(g.top-w.top+f.top)/v.y,bottom:(w.bottom-g.bottom+f.bottom)/v.y,left:(g.left-w.left+f.left)/v.x,right:(w.right-g.right+f.right)/v.x}}function za(e){const t=Br(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=Ar(e),i=a?e.offsetWidth:n,o=a?e.offsetHeight:r,s=sa(n)!==i||sa(r)!==o;return s&&(n=i,r=o),{width:n,height:r,$:s}}function Ba(e){return Rr(e)?e:e.contextElement}function Na(e){const t=Ba(e);if(!Ar(t))return ua(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:i}=za(t);let o=(i?sa(n.width):n.width)/r,s=(i?sa(n.height):n.height)/a;return o&&Number.isFinite(o)||(o=1),s&&Number.isFinite(s)||(s=1),{x:o,y:s}}const qa=ua(0);function Ha(e){const t=Dr(e);return $r()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:qa}function Wa(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1);const a=e.getBoundingClientRect(),i=Ba(e);let o=ua(1);t&&(r?Rr(r)&&(o=Na(r)):o=Na(e));const s=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==Dr(e))&&t}(i,n,r)?Ha(i):ua(0);let l=(a.left+s.x)/o.x,u=(a.top+s.y)/o.y,c=a.width/o.x,d=a.height/o.y;if(i){const e=Dr(i),t=r&&Rr(r)?Dr(r):r;let n=e,a=n.frameElement;for(;a&&r&&t!==n;){const e=Na(a),t=a.getBoundingClientRect(),r=Br(a),i=t.left+(a.clientLeft+parseFloat(r.paddingLeft))*e.x,o=t.top+(a.clientTop+parseFloat(r.paddingTop))*e.y;l*=e.x,u*=e.y,c*=e.x,d*=e.y,l+=i,u+=o,n=Dr(a),a=n.frameElement}}return wa({width:c,height:d,x:l,y:u})}const Ua=[":popover-open",":modal"];function Ga(e){return Ua.some((t=>{try{return e.matches(t)}catch(e){return!1}}))}function Qa(e){return Wa(kr(e)).left+Nr(e).scrollLeft}function Ka(e,t,n){let r;if("viewport"===t)r=function(e,t){const n=Dr(e),r=kr(e),a=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,s=0,l=0;if(a){i=a.width,o=a.height;const e=$r();(!e||e&&"fixed"===t)&&(s=a.offsetLeft,l=a.offsetTop)}return{width:i,height:o,x:s,y:l}}(e,n);else if("document"===t)r=function(e){const t=kr(e),n=Nr(e),r=e.ownerDocument.body,a=oa(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=oa(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+Qa(e);const s=-n.scrollTop;return"rtl"===Br(r).direction&&(o+=oa(t.clientWidth,r.clientWidth)-a),{width:a,height:i,x:o,y:s}}(kr(e));else if(Rr(t))r=function(e,t){const n=Wa(e,!0,"fixed"===t),r=n.top+e.clientTop,a=n.left+e.clientLeft,i=Ar(e)?Na(e):ua(1);return{width:e.clientWidth*i.x,height:e.clientHeight*i.y,x:a*i.x,y:r*i.y}}(t,n);else{const n=Ha(e);r={...t,x:t.x-n.x,y:t.y-n.y}}return wa(r)}function Ya(e,t){const n=qr(e);return!(n===t||!Rr(n)||zr(n))&&("fixed"===Br(n).position||Ya(n,t))}function Za(e,t,n){const r=Ar(t),a=kr(t),i="fixed"===n,o=Wa(e,!0,i,t);let s={scrollLeft:0,scrollTop:0};const l=ua(0);if(r||!r&&!i)if(("body"!==jr(t)||Mr(a))&&(s=Nr(t)),r){const e=Wa(t,!0,i,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else a&&(l.x=Qa(a));return{x:o.left+s.scrollLeft-l.x,y:o.top+s.scrollTop-l.y,width:o.width,height:o.height}}function Xa(e){return"static"===Br(e).position}function Ja(e,t){return Ar(e)&&"fixed"!==Br(e).position?t?t(e):e.offsetParent:null}function ei(e,t){const n=Dr(e);if(Ga(e))return n;if(!Ar(e)){let t=qr(e);for(;t&&!zr(t);){if(Rr(t)&&!Xa(t))return t;t=qr(t)}return n}let r=Ja(e,t);for(;r&&Vr(r)&&Xa(r);)r=Ja(r,t);return r&&zr(r)&&Xa(r)&&!Lr(r)?n:r||function(e){let t=qr(e);for(;Ar(t)&&!zr(t);){if(Lr(t))return t;if(Fr(t))return null;t=qr(t)}return null}(e)||n}const ti={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:r,strategy:a}=e;const i="fixed"===a,o=kr(r),s=!!t&&Ga(t.floating);if(r===o||s&&i)return n;let l={scrollLeft:0,scrollTop:0},u=ua(1);const c=ua(0),d=Ar(r);if((d||!d&&!i)&&(("body"!==jr(r)||Mr(o))&&(l=Nr(r)),Ar(r))){const e=Wa(r);u=Na(r),c.x=e.x+r.clientLeft,c.y=e.y+r.clientTop}return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-l.scrollLeft*u.x+c.x,y:n.y*u.y-l.scrollTop*u.y+c.y}},getDocumentElement:kr,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:r,strategy:a}=e;const i="clippingAncestors"===n?Ga(t)?[]:function(e,t){const n=t.get(e);if(n)return n;let r=Wr(e,[],!1).filter((e=>Rr(e)&&"body"!==jr(e))),a=null;const i="fixed"===Br(e).position;let o=i?qr(e):e;for(;Rr(o)&&!zr(o);){const t=Br(o),n=Lr(o);n||"fixed"!==t.position||(a=null),(i?!n&&!a:!n&&"static"===t.position&&a&&["absolute","fixed"].includes(a.position)||Mr(o)&&!n&&Ya(e,o))?r=r.filter((e=>e!==o)):a=t,o=qr(o)}return t.set(e,r),r}(t,this._c):[].concat(n),o=[...i,r],s=o[0],l=o.reduce(((e,n)=>{const r=Ka(t,n,a);return e.top=oa(r.top,e.top),e.right=ia(r.right,e.right),e.bottom=ia(r.bottom,e.bottom),e.left=oa(r.left,e.left),e}),Ka(t,s,a));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},getOffsetParent:ei,getElementRects:async function(e){const t=this.getOffsetParent||ei,n=this.getDimensions,r=await n(e.floating);return{reference:Za(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=za(e);return{width:t,height:n}},getScale:Na,isElement:Rr,isRTL:function(e){return"rtl"===Br(e).direction}};function ni(e,t,n,r){void 0===r&&(r={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:o="function"==typeof ResizeObserver,layoutShift:s="function"==typeof IntersectionObserver,animationFrame:l=!1}=r,u=Ba(e),c=a||i?[...u?Wr(u):[],...Wr(t)]:[];c.forEach((e=>{a&&e.addEventListener("scroll",n,{passive:!0}),i&&e.addEventListener("resize",n)}));const d=u&&s?function(e,t){let n,r=null;const a=kr(e);function i(){var e;clearTimeout(n),null==(e=r)||e.disconnect(),r=null}return function o(s,l){void 0===s&&(s=!1),void 0===l&&(l=1),i();const{left:u,top:c,width:d,height:p}=e.getBoundingClientRect();if(s||t(),!d||!p)return;const h={rootMargin:-la(c)+"px "+-la(a.clientWidth-(u+d))+"px "+-la(a.clientHeight-(c+p))+"px "+-la(u)+"px",threshold:oa(0,ia(1,l))||1};let f=!0;function m(e){const t=e[0].intersectionRatio;if(t!==l){if(!f)return o();t?o(!1,t):n=setTimeout((()=>{o(!1,1e-7)}),1e3)}f=!1}try{r=new IntersectionObserver(m,{...h,root:a.ownerDocument})}catch(e){r=new IntersectionObserver(m,h)}r.observe(e)}(!0),i}(u,n):null;let p,h=-1,f=null;o&&(f=new ResizeObserver((e=>{let[r]=e;r&&r.target===u&&f&&(f.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame((()=>{var e;null==(e=f)||e.observe(t)}))),n()})),u&&!l&&f.observe(u),f.observe(t));let m=l?Wa(e):null;return l&&function t(){const r=Wa(e);!m||r.x===m.x&&r.y===m.y&&r.width===m.width&&r.height===m.height||n(),m=r,p=requestAnimationFrame(t)}(),n(),()=>{var e;c.forEach((e=>{a&&e.removeEventListener("scroll",n),i&&e.removeEventListener("resize",n)})),null==d||d(),null==(e=f)||e.disconnect(),f=null,l&&cancelAnimationFrame(p)}}const ri=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:a,y:i,placement:o,middlewareData:s}=t,l=await async function(e,t){const{placement:n,platform:r,elements:a}=e,i=await(null==r.isRTL?void 0:r.isRTL(a.floating)),o=ha(n),s=fa(n),l="y"===ga(n),u=["left","top"].includes(o)?-1:1,c=i&&l?-1:1,d=pa(t,e);let{mainAxis:p,crossAxis:h,alignmentAxis:f}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return s&&"number"==typeof f&&(h="end"===s?-1*f:f),l?{x:h*c,y:p*u}:{x:p*u,y:h*c}}(t,e);return o===(null==(n=s.offset)?void 0:n.placement)&&null!=(r=s.arrow)&&r.alignmentOffset?{}:{x:a+l.x,y:i+l.y,data:{...l,placement:o}}}}},ai=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:a,middlewareData:i,rects:o,initialPlacement:s,platform:l,elements:u}=t,{mainAxis:c=!0,crossAxis:d=!0,fallbackPlacements:p,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:f="none",flipAlignment:m=!0,...g}=pa(e,t);if(null!=(n=i.arrow)&&n.alignmentOffset)return{};const b=ha(a),y=ha(s)===s,v=await(null==l.isRTL?void 0:l.isRTL(u.floating)),w=p||(y||!m?[va(s)]:function(e){const t=va(e);return[ya(e),t,ya(t)]}(s));p||"none"===f||w.push(...function(e,t,n,r){const a=fa(e);let i=function(e,t,n){const r=["left","right"],a=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(e){case"top":case"bottom":return n?t?a:r:t?r:a;case"left":case"right":return t?i:o;default:return[]}}(ha(e),"start"===n,r);return a&&(i=i.map((e=>e+"-"+a)),t&&(i=i.concat(i.map(ya)))),i}(s,m,f,v));const O=[s,...w],S=await $a(t,g),_=[];let x=(null==(r=i.flip)?void 0:r.overflows)||[];if(c&&_.push(S[b]),d){const e=function(e,t,n){void 0===n&&(n=!1);const r=fa(e),a=ba(e),i=ma(a);let o="x"===a?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[i]>t.floating[i]&&(o=va(o)),[o,va(o)]}(a,o,v);_.push(S[e[0]],S[e[1]])}if(x=[...x,{placement:a,overflows:_}],!_.every((e=>e<=0))){var P,C;const e=((null==(P=i.flip)?void 0:P.index)||0)+1,t=O[e];if(t)return{data:{index:e,overflows:x},reset:{placement:t}};let n=null==(C=x.filter((e=>e.overflows[0]<=0)).sort(((e,t)=>e.overflows[1]-t.overflows[1]))[0])?void 0:C.placement;if(!n)switch(h){case"bestFit":{var E;const e=null==(E=x.map((e=>[e.placement,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:E[0];e&&(n=e);break}case"initialPlacement":n=s}if(a!==n)return{reset:{placement:n}}}return{}}}},ii=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:a,elements:i}=t,{apply:o=()=>{},...s}=pa(e,t),l=await $a(t,s),u=ha(n),c=fa(n),d="y"===ga(n),{width:p,height:h}=r.floating;let f,m;"top"===u||"bottom"===u?(f=u,m=c===(await(null==a.isRTL?void 0:a.isRTL(i.floating))?"start":"end")?"left":"right"):(m=u,f="end"===c?"top":"bottom");const g=h-l[f],b=p-l[m],y=!t.middlewareData.shift;let v=g,w=b;if(d){const e=p-l.left-l.right;w=c||y?ia(b,e):e}else{const e=h-l.top-l.bottom;v=c||y?ia(g,e):e}if(y&&!c){const e=oa(l.left,0),t=oa(l.right,0),n=oa(l.top,0),r=oa(l.bottom,0);d?w=p-2*(0!==e||0!==t?e+t:oa(l.left,l.right)):v=h-2*(0!==n||0!==r?n+r:oa(l.top,l.bottom))}await o({...t,availableWidth:w,availableHeight:v});const O=await a.getDimensions(i.floating);return p!==O.width||h!==O.height?{reset:{rects:!0}}:{}}}},oi=(e,t,n)=>{const r=new Map,a={platform:ti,...n},i={...a.platform,_c:r};return(async(e,t,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:i=[],platform:o}=n,s=i.filter(Boolean),l=await(null==o.isRTL?void 0:o.isRTL(t));let u=await o.getElementRects({reference:e,floating:t,strategy:a}),{x:c,y:d}=La(u,r,l),p=r,h={},f=0;for(let n=0;n<s.length;n++){const{name:i,fn:m}=s[n],{x:g,y:b,data:y,reset:v}=await m({x:c,y:d,initialPlacement:r,placement:p,strategy:a,middlewareData:h,rects:u,platform:o,elements:{reference:e,floating:t}});c=null!=g?g:c,d=null!=b?b:d,h={...h,[i]:{...h[i],...y}},v&&f<=50&&(f++,"object"==typeof v&&(v.placement&&(p=v.placement),v.rects&&(u=!0===v.rects?await o.getElementRects({reference:e,floating:t,strategy:a}):v.rects),({x:c,y:d}=La(u,p,l))),n=-1)}return{x:c,y:d,placement:p,strategy:a,middlewareData:h}})(e,t,{...a,platform:i})};var si="undefined"!=typeof document?t.useLayoutEffect:t.useEffect;function li(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;let n,r,a;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;0!=r--;)if(!li(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;0!=r--;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;0!=r--;){const n=a[r];if(!("_owner"===n&&e.$$typeof||li(e[n],t[n])))return!1}return!0}return e!=e&&t!=t}function ui(e){return"undefined"==typeof window?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function ci(e,t){const n=ui(e);return Math.round(t*n)/n}function di(e){const n=t.useRef(e);return si((()=>{n.current=e})),n}const pi=(e,t)=>({...ri(e),options:[e,t]}),hi=(e,t)=>({...ai(e),options:[e,t]}),fi=(e,t)=>({...ii(e),options:[e,t]}),mi={...n},gi=mi.useInsertionEffect||(e=>e());function bi(e){const n=t.useRef((()=>{}));return gi((()=>{n.current=e})),t.useCallback((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return null==n.current?void 0:n.current(...t)}),[])}const yi="ArrowUp",vi="ArrowDown",wi="ArrowLeft",Oi="ArrowRight";function Si(e,t,n){return Math.floor(e/t)!==n}function _i(e,t){return t<0||t>=e.current.length}function xi(e,t){return Ci(e,{disabledIndices:t})}function Pi(e,t){return Ci(e,{decrement:!0,startingIndex:e.current.length,disabledIndices:t})}function Ci(e,t){let{startingIndex:n=-1,decrement:r=!1,disabledIndices:a,amount:i=1}=void 0===t?{}:t;const o=e.current;let s=n;do{s+=r?-i:i}while(s>=0&&s<=o.length-1&&Di(o,s,a));return s}function Ei(e,t,n,r,a){if(-1===e)return-1;const i=n.indexOf(e),o=t[e];switch(a){case"tl":return i;case"tr":return o?i+o.width-1:i;case"bl":return o?i+(o.height-1)*r:i;case"br":return n.lastIndexOf(e)}}function ji(e,t){return t.flatMap(((t,n)=>e.includes(t)?[n]:[]))}function Di(e,t,n){if(n)return n.includes(t);const r=e[t];return null==r||r.hasAttribute("disabled")||"true"===r.getAttribute("aria-disabled")}let ki=0;function Ti(e,t){void 0===t&&(t={});const{preventScroll:n=!1,cancelPrevious:r=!0,sync:a=!1}=t;r&&cancelAnimationFrame(ki);const i=()=>null==e?void 0:e.focus({preventScroll:n});a?i():ki=requestAnimationFrame(i)}var Ri="undefined"!=typeof document?t.useLayoutEffect:t.useEffect;function Ai(){return Ai=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ai.apply(this,arguments)}let Ii=!1,Mi=0;const Vi=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+Mi++,Fi=mi.useId||function(){const[e,n]=t.useState((()=>Ii?Vi():void 0));return Ri((()=>{null==e&&n(Vi())}),[]),t.useEffect((()=>{Ii=!0}),[]),e};const Li=t.createContext(null),$i=t.createContext(null),zi=()=>{var e;return(null==(e=t.useContext(Li))?void 0:e.id)||null},Bi=()=>t.useContext($i);function Ni(e){return"data-floating-ui-"+e}function qi(e){const n=(0,t.useRef)(e);return Ri((()=>{n.current=e})),n}function Hi(e,t){let n=e.filter((e=>{var n;return e.parentId===t&&(null==(n=e.context)?void 0:n.open)})),r=n;for(;r.length;)r=e.filter((e=>{var t;return null==(t=r)?void 0:t.some((t=>{var n;return e.parentId===t.id&&(null==(n=e.context)?void 0:n.open)}))})),n=n.concat(r);return n}let Wi=new WeakMap,Ui=new WeakSet,Gi={},Qi=0;const Ki=e=>e&&(e.host||Ki(e.parentNode));function Yi(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);const r=ea(e[0]).body;return function(e,t,n,r){const a="data-floating-ui-inert",i=r?"inert":n?"aria-hidden":null,o=(s=t,e.map((e=>{if(s.contains(e))return e;const t=Ki(e);return s.contains(t)?t:null})).filter((e=>null!=e)));var s;const l=new Set,u=new Set(o),c=[];Gi[a]||(Gi[a]=new WeakMap);const d=Gi[a];return o.forEach((function e(t){t&&!l.has(t)&&(l.add(t),t.parentNode&&e(t.parentNode))})),function e(t){t&&!u.has(t)&&[].forEach.call(t.children,(t=>{if("script"!==jr(t))if(l.has(t))e(t);else{const e=i?t.getAttribute(i):null,n=null!==e&&"false"!==e,r=(Wi.get(t)||0)+1,o=(d.get(t)||0)+1;Wi.set(t,r),d.set(t,o),c.push(t),1===r&&n&&Ui.add(t),1===o&&t.setAttribute(a,""),!n&&i&&t.setAttribute(i,"true")}}))}(t),l.clear(),Qi++,()=>{c.forEach((e=>{const t=(Wi.get(e)||0)-1,n=(d.get(e)||0)-1;Wi.set(e,t),d.set(e,n),t||(!Ui.has(e)&&i&&e.removeAttribute(i),Ui.delete(e)),n||e.removeAttribute(a)})),Qi--,Qi||(Wi=new WeakMap,Wi=new WeakMap,Ui=new WeakSet,Gi={})}}(e.concat(Array.from(r.querySelectorAll("[aria-live]"))),r,t,n)}const Zi=()=>({getShadowRoot:!0,displayCheck:"function"==typeof ResizeObserver&&ResizeObserver.toString().includes("[native code]")?"full":"none"});function Xi(e,t){const n=Va(e,Zi());"prev"===t&&n.reverse();const r=n.indexOf(Ur(ea(e)));return n.slice(r+1)[0]}function Ji(){return Xi(document.body,"next")}function eo(){return Xi(document.body,"prev")}function to(e,t){const n=t||e.currentTarget,r=e.relatedTarget;return!r||!Gr(n,r)}function no(e){Va(e,Zi()).forEach((e=>{e.dataset.tabindex=e.getAttribute("tabindex")||"",e.setAttribute("tabindex","-1")}))}function ro(e){e.querySelectorAll("[data-tabindex]").forEach((e=>{const t=e.dataset.tabindex;delete e.dataset.tabindex,t?e.setAttribute("tabindex",t):e.removeAttribute("tabindex")}))}const ao={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"fixed",whiteSpace:"nowrap",width:"1px",top:0,left:0};function io(e){"Tab"===e.key&&(e.target,clearTimeout(void 0))}const oo=t.forwardRef((function(e,n){const[r,a]=t.useState();Ri((()=>(Xr()&&a("button"),document.addEventListener("keydown",io),()=>{document.removeEventListener("keydown",io)})),[]);const i={ref:n,tabIndex:0,role:r,"aria-hidden":!r||void 0,[Ni("focus-guard")]:"",style:ao};return t.createElement("span",Ai({},e,i))})),so=t.createContext(null),lo=Ni("portal");function uo(e){const{children:n,id:r,root:a=null,preserveTabOrder:i=!0}=e,o=function(e){void 0===e&&(e={});const{id:n,root:r}=e,a=Fi(),i=co(),[o,s]=t.useState(null),l=t.useRef(null);return Ri((()=>()=>{null==o||o.remove(),queueMicrotask((()=>{l.current=null}))}),[o]),Ri((()=>{if(!a)return;if(l.current)return;const e=n?document.getElementById(n):null;if(!e)return;const t=document.createElement("div");t.id=a,t.setAttribute(lo,""),e.appendChild(t),l.current=t,s(t)}),[n,a]),Ri((()=>{if(!a)return;if(l.current)return;let e=r||(null==i?void 0:i.portalNode);e&&!Rr(e)&&(e=e.current),e=e||document.body;let t=null;n&&(t=document.createElement("div"),t.id=n,e.appendChild(t));const o=document.createElement("div");o.id=a,o.setAttribute(lo,""),e=t||e,e.appendChild(o),l.current=o,s(o)}),[n,r,a,i]),o}({id:r,root:a}),[s,l]=t.useState(null),u=t.useRef(null),c=t.useRef(null),d=t.useRef(null),p=t.useRef(null),h=null==s?void 0:s.modal,f=null==s?void 0:s.open,m=!!s&&!s.modal&&s.open&&i&&!(!a&&!o);return t.useEffect((()=>{if(o&&i&&!h)return o.addEventListener("focusin",e,!0),o.addEventListener("focusout",e,!0),()=>{o.removeEventListener("focusin",e,!0),o.removeEventListener("focusout",e,!0)};function e(e){o&&to(e)&&("focusin"===e.type?ro:no)(o)}}),[o,i,h]),t.useEffect((()=>{o&&(f||ro(o))}),[f,o]),t.createElement(so.Provider,{value:t.useMemo((()=>({preserveTabOrder:i,beforeOutsideRef:u,afterOutsideRef:c,beforeInsideRef:d,afterInsideRef:p,portalNode:o,setFocusManagerState:l})),[i,o])},m&&o&&t.createElement(oo,{"data-type":"outside",ref:u,onFocus:e=>{if(to(e,o)){var t;null==(t=d.current)||t.focus()}else{const e=eo()||(null==s?void 0:s.refs.domReference.current);null==e||e.focus()}}}),m&&o&&t.createElement("span",{"aria-owns":o.id,style:ao}),o&&Fa.createPortal(n,o),m&&o&&t.createElement(oo,{"data-type":"outside",ref:c,onFocus:e=>{if(to(e,o)){var t;null==(t=p.current)||t.focus()}else{const t=Ji()||(null==s?void 0:s.refs.domReference.current);null==t||t.focus(),(null==s?void 0:s.closeOnFocusOut)&&(null==s||s.onOpenChange(!1,e.nativeEvent,"focus-out"))}}}))}const co=()=>t.useContext(so),po="data-floating-ui-focusable";function ho(e){return e?e.hasAttribute(po)?e:e.querySelector("["+po+"]")||e:null}let fo=[];function mo(e){fo=fo.filter((e=>e.isConnected));let t=e;if(t&&"body"!==jr(t)){if(!function(e,t){if(t=t||{},!e)throw new Error("No node provided");return!1!==_a.call(e,Oa)&&Aa(t,e)}(t,Zi())){const e=Va(t,Zi())[0];e&&(t=e)}fo.push(t),fo.length>20&&(fo=fo.slice(-20))}}function go(){return fo.slice().reverse().find((e=>e.isConnected))}const bo=t.forwardRef((function(e,n){return t.createElement("button",Ai({},e,{type:"button",ref:n,tabIndex:-1,style:ao}))}));function yo(e){const{context:n,children:r,disabled:a=!1,order:i=["content"],guards:o=!0,initialFocus:s=0,returnFocus:l=!0,restoreFocus:u=!1,modal:c=!0,visuallyHiddenDismiss:d=!1,closeOnFocusOut:p=!0}=e,{open:h,refs:f,nodeId:m,onOpenChange:g,events:b,dataRef:y,floatingId:v,elements:{domReference:w,floating:O}}=n,S="number"==typeof s&&s<0,_=aa(w)&&S,x="undefined"==typeof HTMLElement||!("inert"in HTMLElement.prototype)||o,P=qi(i),C=qi(s),E=qi(l),j=Bi(),D=co(),k=t.useRef(null),T=t.useRef(null),R=t.useRef(!1),A=t.useRef(!1),I=t.useRef(-1),M=null!=D,V=ho(O),F=bi((function(e){return void 0===e&&(e=V),e?Va(e,Zi()):[]})),L=bi((e=>{const t=F(e);return P.current.map((e=>w&&"reference"===e?w:V&&"floating"===e?V:t)).filter(Boolean).flat()}));function $(e){return!a&&d&&c?t.createElement(bo,{ref:"start"===e?k:T,onClick:e=>g(!1,e.nativeEvent)},"string"==typeof d?d:"Dismiss"):null}t.useEffect((()=>{R.current=!1}),[a]),t.useEffect((()=>{if(a)return;if(!c)return;function e(e){if("Tab"===e.key){Gr(V,Ur(ea(V)))&&0===F().length&&!_&&ra(e);const t=L(),n=na(e);"reference"===P.current[0]&&n===w&&(ra(e),e.shiftKey?Ti(t[t.length-1]):Ti(t[1])),"floating"===P.current[1]&&n===V&&e.shiftKey&&(ra(e),Ti(t[0]))}}const t=ea(V);return t.addEventListener("keydown",e),()=>{t.removeEventListener("keydown",e)}}),[a,w,V,c,P,_,F,L]),t.useEffect((()=>{if(!a&&O)return O.addEventListener("focusin",e),()=>{O.removeEventListener("focusin",e)};function e(e){const t=na(e),n=F().indexOf(t);-1!==n&&(I.current=n)}}),[a,O,F]),t.useEffect((()=>{if(!a&&p)return O&&Ar(w)?(w.addEventListener("focusout",t),w.addEventListener("pointerdown",e),O.addEventListener("focusout",t),()=>{w.removeEventListener("focusout",t),w.removeEventListener("pointerdown",e),O.removeEventListener("focusout",t)}):void 0;function e(){A.current=!0,setTimeout((()=>{A.current=!1}))}function t(e){const t=e.relatedTarget;queueMicrotask((()=>{const n=!(Gr(w,t)||Gr(O,t)||Gr(t,O)||Gr(null==D?void 0:D.portalNode,t)||null!=t&&t.hasAttribute(Ni("focus-guard"))||j&&(Hi(j.nodesRef.current,m).find((e=>{var n,r;return Gr(null==(n=e.context)?void 0:n.elements.floating,t)||Gr(null==(r=e.context)?void 0:r.elements.domReference,t)}))||function(e,t){var n;let r=[],a=null==(n=e.find((e=>e.id===t)))?void 0:n.parentId;for(;a;){const t=e.find((e=>e.id===a));a=null==t?void 0:t.parentId,t&&(r=r.concat(t))}return r}(j.nodesRef.current,m).find((e=>{var n,r;return(null==(n=e.context)?void 0:n.elements.floating)===t||(null==(r=e.context)?void 0:r.elements.domReference)===t}))));if(u&&n&&Ur(ea(V))===ea(V).body){Ar(V)&&V.focus();const e=I.current,t=F(),n=t[e]||t[t.length-1]||V;Ar(n)&&n.focus()}!_&&c||!t||!n||A.current||t===go()||(R.current=!0,g(!1,e,"focus-out"))}))}}),[a,w,O,V,c,m,j,D,g,p,u,F,_]),t.useEffect((()=>{var e;if(a)return;const t=Array.from((null==D||null==(e=D.portalNode)?void 0:e.querySelectorAll("["+Ni("portal")+"]"))||[]);if(O){const e=[O,...t,k.current,T.current,P.current.includes("reference")||_?w:null].filter((e=>null!=e)),n=c||_?Yi(e,x,!x):Yi(e);return()=>{n()}}}),[a,w,O,c,P,D,_,x]),Ri((()=>{if(a||!Ar(V))return;const e=Ur(ea(V));queueMicrotask((()=>{const t=L(V),n=C.current,r=("number"==typeof n?t[n]:n.current)||V,a=Gr(V,e);S||a||!h||Ti(r,{preventScroll:r===V})}))}),[a,h,V,S,L,C]),Ri((()=>{if(a||!V)return;let e=!1;const t=ea(V),n=Ur(t);let r=y.current.openEvent;function i(t){let{open:n,reason:a,event:i,nested:o}=t;n&&(r=i),"escape-key"===a&&f.domReference.current&&mo(f.domReference.current),"hover"===a&&"mouseleave"===i.type&&(R.current=!0),"outside-press"===a&&(o?(R.current=!1,e=!0):R.current=!(Yr(i)||Zr(i)))}mo(n),b.on("openchange",i);const o=t.createElement("span");return o.setAttribute("tabindex","-1"),o.setAttribute("aria-hidden","true"),Object.assign(o.style,ao),M&&w&&w.insertAdjacentElement("afterend",o),()=>{b.off("openchange",i);const n=Ur(t),a=Gr(O,n)||j&&Hi(j.nodesRef.current,m).some((e=>{var t;return Gr(null==(t=e.context)?void 0:t.elements.floating,n)}));(a||r&&["click","mousedown"].includes(r.type))&&f.domReference.current&&mo(f.domReference.current);const s=go()||o;queueMicrotask((()=>{E.current&&!R.current&&Ar(s)&&(s===n||n===t.body||a)&&s.focus({preventScroll:e}),o.remove()}))}}),[a,O,V,E,y,f,b,j,m,M,w]),Ri((()=>{if(!a&&D)return D.setFocusManagerState({modal:c,closeOnFocusOut:p,open:h,onOpenChange:g,refs:f}),()=>{D.setFocusManagerState(null)}}),[a,D,c,h,g,f,p]),Ri((()=>{if(a)return;if(!V)return;if("function"!=typeof MutationObserver)return;if(S)return;const e=()=>{const e=V.getAttribute("tabindex"),t=F(),n=Ur(ea(O)),r=t.indexOf(n);-1!==r&&(I.current=r),P.current.includes("floating")||n!==f.domReference.current&&0===t.length?"0"!==e&&V.setAttribute("tabindex","0"):"-1"!==e&&V.setAttribute("tabindex","-1")};e();const t=new MutationObserver(e);return t.observe(V,{childList:!0,subtree:!0,attributes:!0}),()=>{t.disconnect()}}),[a,O,V,f,P,F,S]);const z=!a&&x&&(!c||!_)&&(M||c);return t.createElement(t.Fragment,null,z&&t.createElement(oo,{"data-type":"inside",ref:null==D?void 0:D.beforeInsideRef,onFocus:e=>{if(c){const e=L();Ti("reference"===i[0]?e[0]:e[e.length-1])}else if(null!=D&&D.preserveTabOrder&&D.portalNode)if(R.current=!1,to(e,D.portalNode)){const e=Ji()||w;null==e||e.focus()}else{var t;null==(t=D.beforeOutsideRef.current)||t.focus()}}}),!_&&$("start"),r,$("end"),z&&t.createElement(oo,{"data-type":"inside",ref:null==D?void 0:D.afterInsideRef,onFocus:e=>{if(c)Ti(L()[0]);else if(null!=D&&D.preserveTabOrder&&D.portalNode)if(p&&(R.current=!0),to(e,D.portalNode)){const e=eo()||w;null==e||e.focus()}else{var t;null==(t=D.afterOutsideRef.current)||t.focus()}}}))}const vo={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},wo={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},Oo=e=>{var t,n;return{escapeKey:"boolean"==typeof e?e:null!=(t=null==e?void 0:e.escapeKey)&&t,outsidePress:"boolean"==typeof e?e:null==(n=null==e?void 0:e.outsidePress)||n}};function So(e,n){void 0===n&&(n={});const{open:r,onOpenChange:a,elements:i,dataRef:o}=e,{enabled:s=!0,escapeKey:l=!0,outsidePress:u=!0,outsidePressEvent:c="pointerdown",referencePress:d=!1,referencePressEvent:p="pointerdown",ancestorScroll:h=!1,bubbles:f,capture:m}=n,g=Bi(),b=bi("function"==typeof u?u:()=>!1),y="function"==typeof u?b:u,v=t.useRef(!1),w=t.useRef(!1),{escapeKey:O,outsidePress:S}=Oo(f),{escapeKey:_,outsidePress:x}=Oo(m),P=t.useRef(!1),C=bi((e=>{var t;if(!r||!s||!l||"Escape"!==e.key)return;if(P.current)return;const n=null==(t=o.current.floatingContext)?void 0:t.nodeId,i=g?Hi(g.nodesRef.current,n):[];if(!O&&(e.stopPropagation(),i.length>0)){let e=!0;if(i.forEach((t=>{var n;null==(n=t.context)||!n.open||t.context.dataRef.current.__escapeKeyBubbles||(e=!1)})),!e)return}a(!1,function(e){return"nativeEvent"in e}(e)?e.nativeEvent:e,"escape-key")})),E=bi((e=>{var t;const n=()=>{var t;C(e),null==(t=na(e))||t.removeEventListener("keydown",n)};null==(t=na(e))||t.addEventListener("keydown",n)})),j=bi((e=>{var t;const n=v.current;v.current=!1;const r=w.current;if(w.current=!1,"click"===c&&r)return;if(n)return;if("function"==typeof y&&!y(e))return;const s=na(e),l="["+Ni("inert")+"]",u=ea(i.floating).querySelectorAll(l);let d=Rr(s)?s:null;for(;d&&!zr(d);){const e=qr(d);if(zr(e)||!Rr(e))break;d=e}if(u.length&&Rr(s)&&!s.matches("html,body")&&!Gr(s,i.floating)&&Array.from(u).every((e=>!Gr(d,e))))return;if(Ar(s)&&T){const t=s.clientWidth>0&&s.scrollWidth>s.clientWidth,n=s.clientHeight>0&&s.scrollHeight>s.clientHeight;let r=n&&e.offsetX>s.clientWidth;if(n&&"rtl"===Br(s).direction&&(r=e.offsetX<=s.offsetWidth-s.clientWidth),r||t&&e.offsetY>s.clientHeight)return}const p=null==(t=o.current.floatingContext)?void 0:t.nodeId,h=g&&Hi(g.nodesRef.current,p).some((t=>{var n;return ta(e,null==(n=t.context)?void 0:n.elements.floating)}));if(ta(e,i.floating)||ta(e,i.domReference)||h)return;const f=g?Hi(g.nodesRef.current,p):[];if(f.length>0){let e=!0;if(f.forEach((t=>{var n;null==(n=t.context)||!n.open||t.context.dataRef.current.__outsidePressBubbles||(e=!1)})),!e)return}a(!1,e,"outside-press")})),D=bi((e=>{var t;const n=()=>{var t;j(e),null==(t=na(e))||t.removeEventListener(c,n)};null==(t=na(e))||t.addEventListener(c,n)}));t.useEffect((()=>{if(!r||!s)return;o.current.__escapeKeyBubbles=O,o.current.__outsidePressBubbles=S;let e=-1;function t(e){a(!1,e,"ancestor-scroll")}function n(){window.clearTimeout(e),P.current=!0}function u(){e=window.setTimeout((()=>{P.current=!1}),$r()?5:0)}const d=ea(i.floating);l&&(d.addEventListener("keydown",_?E:C,_),d.addEventListener("compositionstart",n),d.addEventListener("compositionend",u)),y&&d.addEventListener(c,x?D:j,x);let p=[];return h&&(Rr(i.domReference)&&(p=Wr(i.domReference)),Rr(i.floating)&&(p=p.concat(Wr(i.floating))),!Rr(i.reference)&&i.reference&&i.reference.contextElement&&(p=p.concat(Wr(i.reference.contextElement)))),p=p.filter((e=>{var t;return e!==(null==(t=d.defaultView)?void 0:t.visualViewport)})),p.forEach((e=>{e.addEventListener("scroll",t,{passive:!0})})),()=>{l&&(d.removeEventListener("keydown",_?E:C,_),d.removeEventListener("compositionstart",n),d.removeEventListener("compositionend",u)),y&&d.removeEventListener(c,x?D:j,x),p.forEach((e=>{e.removeEventListener("scroll",t)})),window.clearTimeout(e)}}),[o,i,l,y,c,r,a,h,s,O,S,C,_,E,j,x,D]),t.useEffect((()=>{v.current=!1}),[y,c]);const k=t.useMemo((()=>({onKeyDown:C,[vo[p]]:e=>{d&&a(!1,e.nativeEvent,"reference-press")}})),[C,a,d,p]),T=t.useMemo((()=>({onKeyDown:C,onMouseDown(){w.current=!0},onMouseUp(){w.current=!0},[wo[c]]:()=>{v.current=!0}})),[C,c]);return t.useMemo((()=>s?{reference:k,floating:T}:{}),[s,k,T])}function _o(e){void 0===e&&(e={});const{nodeId:n}=e,r=function(e){const{open:n=!1,onOpenChange:r,elements:a}=e,i=Fi(),o=t.useRef({}),[s]=t.useState((()=>function(){const e=new Map;return{emit(t,n){var r;null==(r=e.get(t))||r.forEach((e=>e(n)))},on(t,n){e.set(t,[...e.get(t)||[],n])},off(t,n){var r;e.set(t,(null==(r=e.get(t))?void 0:r.filter((e=>e!==n)))||[])}}}())),l=null!=zi(),[u,c]=t.useState(a.reference),d=bi(((e,t,n)=>{o.current.openEvent=e?t:void 0,s.emit("openchange",{open:e,event:t,reason:n,nested:l}),null==r||r(e,t,n)})),p=t.useMemo((()=>({setPositionReference:c})),[]),h=t.useMemo((()=>({reference:u||a.reference||null,floating:a.floating||null,domReference:a.reference})),[u,a.reference,a.floating]);return t.useMemo((()=>({dataRef:o,open:n,onOpenChange:d,elements:h,events:s,floatingId:i,refs:p})),[n,d,h,s,i,p])}({...e,elements:{reference:null,floating:null,...e.elements}}),a=e.rootContext||r,i=a.elements,[o,s]=t.useState(null),[l,u]=t.useState(null),c=(null==i?void 0:i.reference)||o,d=t.useRef(null),p=Bi();Ri((()=>{c&&(d.current=c)}),[c]);const h=function(e){void 0===e&&(e={});const{placement:n="bottom",strategy:r="absolute",middleware:a=[],platform:i,elements:{reference:o,floating:s}={},transform:l=!0,whileElementsMounted:u,open:c}=e,[d,p]=t.useState({x:0,y:0,strategy:r,placement:n,middlewareData:{},isPositioned:!1}),[h,f]=t.useState(a);li(h,a)||f(a);const[m,g]=t.useState(null),[b,y]=t.useState(null),v=t.useCallback((e=>{e!==_.current&&(_.current=e,g(e))}),[]),w=t.useCallback((e=>{e!==x.current&&(x.current=e,y(e))}),[]),O=o||m,S=s||b,_=t.useRef(null),x=t.useRef(null),P=t.useRef(d),C=null!=u,E=di(u),j=di(i),D=di(c),k=t.useCallback((()=>{if(!_.current||!x.current)return;const e={placement:n,strategy:r,middleware:h};j.current&&(e.platform=j.current),oi(_.current,x.current,e).then((e=>{const t={...e,isPositioned:!1!==D.current};T.current&&!li(P.current,t)&&(P.current=t,Fa.flushSync((()=>{p(t)})))}))}),[h,n,r,j,D]);si((()=>{!1===c&&P.current.isPositioned&&(P.current.isPositioned=!1,p((e=>({...e,isPositioned:!1}))))}),[c]);const T=t.useRef(!1);si((()=>(T.current=!0,()=>{T.current=!1})),[]),si((()=>{if(O&&(_.current=O),S&&(x.current=S),O&&S){if(E.current)return E.current(O,S,k);k()}}),[O,S,k,E,C]);const R=t.useMemo((()=>({reference:_,floating:x,setReference:v,setFloating:w})),[v,w]),A=t.useMemo((()=>({reference:O,floating:S})),[O,S]),I=t.useMemo((()=>{const e={position:r,left:0,top:0};if(!A.floating)return e;const t=ci(A.floating,d.x),n=ci(A.floating,d.y);return l?{...e,transform:"translate("+t+"px, "+n+"px)",...ui(A.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:t,top:n}}),[r,l,A.floating,d.x,d.y]);return t.useMemo((()=>({...d,update:k,refs:R,elements:A,floatingStyles:I})),[d,k,R,A,I])}({...e,elements:{...i,...l&&{reference:l}}}),f=t.useCallback((e=>{const t=Rr(e)?{getBoundingClientRect:()=>e.getBoundingClientRect(),contextElement:e}:e;u(t),h.refs.setReference(t)}),[h.refs]),m=t.useCallback((e=>{(Rr(e)||null===e)&&(d.current=e,s(e)),(Rr(h.refs.reference.current)||null===h.refs.reference.current||null!==e&&!Rr(e))&&h.refs.setReference(e)}),[h.refs]),g=t.useMemo((()=>({...h.refs,setReference:m,setPositionReference:f,domReference:d})),[h.refs,m,f]),b=t.useMemo((()=>({...h.elements,domReference:c})),[h.elements,c]),y=t.useMemo((()=>({...h,...a,refs:g,elements:b,nodeId:n})),[h,g,b,n,a]);return Ri((()=>{a.dataRef.current.floatingContext=y;const e=null==p?void 0:p.nodesRef.current.find((e=>e.id===n));e&&(e.context=y)})),t.useMemo((()=>({...h,context:y,refs:g,elements:b})),[h,g,b,y])}const xo="active",Po="selected";function Co(e,t,n){const r=new Map,a="item"===n;let i=e;if(a&&e){const{[xo]:t,[Po]:n,...r}=e;i=r}return{..."floating"===n&&{tabIndex:-1,[po]:""},...i,...t.map((t=>{const r=t?t[n]:null;return"function"==typeof r?e?r(e):null:r})).concat(e).reduce(((e,t)=>t?(Object.entries(t).forEach((t=>{let[n,i]=t;var o;a&&[xo,Po].includes(n)||(0===n.indexOf("on")?(r.has(n)||r.set(n,[]),"function"==typeof i&&(null==(o=r.get(n))||o.push(i),e[n]=function(){for(var e,t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];return null==(e=r.get(n))?void 0:e.map((e=>e(...a))).find((e=>void 0!==e))})):e[n]=i)})),e):e),{})}}function Eo(e){void 0===e&&(e=[]);const n=e.map((e=>null==e?void 0:e.reference)),r=e.map((e=>null==e?void 0:e.floating)),a=e.map((e=>null==e?void 0:e.item)),i=t.useCallback((t=>Co(t,e,"reference")),n),o=t.useCallback((t=>Co(t,e,"floating")),r),s=t.useCallback((t=>Co(t,e,"item")),a);return t.useMemo((()=>({getReferenceProps:i,getFloatingProps:o,getItemProps:s})),[i,o,s])}let jo=!1;function Do(e,t,n){switch(e){case"vertical":return t;case"horizontal":return n;default:return t||n}}function ko(e,t){return Do(t,e===yi||e===vi,e===wi||e===Oi)}function To(e,t,n){return Do(t,e===vi,n?e===wi:e===Oi)||"Enter"===e||" "===e||""===e}function Ro(e,t,n){return Do(t,n?e===Oi:e===wi,e===yi)}function Ao(e,n){const{open:r,onOpenChange:a,elements:i}=e,{listRef:o,activeIndex:s,onNavigate:l=()=>{},enabled:u=!0,selectedIndex:c=null,allowEscape:d=!1,loop:p=!1,nested:h=!1,rtl:f=!1,virtual:m=!1,focusItemOnOpen:g="auto",focusItemOnHover:b=!0,openOnArrowKeyDown:y=!0,disabledIndices:v,orientation:w="vertical",cols:O=1,scrollItemIntoView:S=!0,virtualItemRef:_,itemSizes:x,dense:P=!1}=n,C=qi(ho(i.floating)),E=zi(),j=Bi(),D=bi(l),k=t.useRef(g),T=t.useRef(null!=c?c:-1),R=t.useRef(null),A=t.useRef(!0),I=t.useRef(D),M=t.useRef(!!i.floating),V=t.useRef(r),F=t.useRef(!1),L=t.useRef(!1),$=qi(v),z=qi(r),B=qi(S),N=qi(c),[q,H]=t.useState(),[W,U]=t.useState(),G=bi((function(e,t,n){function r(e){m?(H(e.id),null==j||j.events.emit("virtualfocus",e),_&&(_.current=e)):Ti(e,{preventScroll:!0,sync:!(!Qr().toLowerCase().startsWith("mac")||navigator.maxTouchPoints||!Xr())&&(jo||F.current)})}void 0===n&&(n=!1);const a=e.current[t.current];a&&r(a),requestAnimationFrame((()=>{const i=e.current[t.current]||a;if(!i)return;a||r(i);const o=B.current;o&&K&&(n||!A.current)&&(null==i.scrollIntoView||i.scrollIntoView("boolean"==typeof o?{block:"nearest",inline:"nearest"}:o))}))}));Ri((()=>{document.createElement("div").focus({get preventScroll(){return jo=!0,!1}})}),[]),Ri((()=>{u&&(r&&i.floating?k.current&&null!=c&&(L.current=!0,T.current=c,D(c)):M.current&&(T.current=-1,I.current(null)))}),[u,r,i.floating,c,D]),Ri((()=>{if(u&&r&&i.floating)if(null==s){if(F.current=!1,null!=N.current)return;if(M.current&&(T.current=-1,G(o,T)),(!V.current||!M.current)&&k.current&&(null!=R.current||!0===k.current&&null==R.current)){let e=0;const t=()=>{null==o.current[0]?(e<2&&(e?requestAnimationFrame:queueMicrotask)(t),e++):(T.current=null==R.current||To(R.current,w,f)||h?xi(o,$.current):Pi(o,$.current),R.current=null,D(T.current))};t()}}else _i(o,s)||(T.current=s,G(o,T,L.current),L.current=!1)}),[u,r,i.floating,s,N,h,o,w,f,D,G,$]),Ri((()=>{var e;if(!u||i.floating||!j||m||!M.current)return;const t=j.nodesRef.current,n=null==(e=t.find((e=>e.id===E)))||null==(e=e.context)?void 0:e.elements.floating,r=Ur(ea(i.floating)),a=t.some((e=>e.context&&Gr(e.context.elements.floating,r)));n&&!a&&A.current&&n.focus({preventScroll:!0})}),[u,i.floating,j,E,m]),Ri((()=>{if(u&&j&&m&&!E)return j.events.on("virtualfocus",e),()=>{j.events.off("virtualfocus",e)};function e(e){U(e.id),_&&(_.current=e)}}),[u,j,m,E,_]),Ri((()=>{I.current=D,M.current=!!i.floating})),Ri((()=>{r||(R.current=null)}),[r]),Ri((()=>{V.current=r}),[r]);const Q=null!=s,K=t.useMemo((()=>{function e(e){if(!r)return;const t=o.current.indexOf(e);-1!==t&&D(t)}const t={onFocus(t){let{currentTarget:n}=t;e(n)},onClick:e=>{let{currentTarget:t}=e;return t.focus({preventScroll:!0})},...b&&{onMouseMove(t){let{currentTarget:n}=t;e(n)},onPointerLeave(e){let{pointerType:t}=e;A.current&&"touch"!==t&&(T.current=-1,G(o,T),D(null),m||Ti(C.current,{preventScroll:!0}))}}};return t}),[r,C,G,b,o,D,m]),Y=bi((e=>{if(A.current=!1,F.current=!0,229===e.which)return;if(!z.current&&e.currentTarget===C.current)return;if(h&&Ro(e.key,w,f))return ra(e),a(!1,e.nativeEvent,"list-navigation"),void(Ar(i.domReference)&&!m&&i.domReference.focus());const t=T.current,n=xi(o,v),s=Pi(o,v);if("Home"===e.key&&(ra(e),T.current=n,D(T.current)),"End"===e.key&&(ra(e),T.current=s,D(T.current)),O>1){const t=x||Array.from({length:o.current.length},(()=>({width:1,height:1}))),r=function(e,t,n){const r=[];let a=0;return e.forEach(((e,i)=>{let{width:o,height:s}=e,l=!1;for(n&&(a=0);!l;){const e=[];for(let n=0;n<o;n++)for(let r=0;r<s;r++)e.push(a+n+r*t);a%t+o<=t&&e.every((e=>null==r[e]))?(e.forEach((e=>{r[e]=i})),l=!0):a++}})),[...r]}(t,O,P),a=r.findIndex((e=>null!=e&&!Di(o.current,e,v))),i=r.reduce(((e,t,n)=>null==t||Di(o.current,t,v)?e:n),-1),l=r[function(e,t){let{event:n,orientation:r,loop:a,cols:i,disabledIndices:o,minIndex:s,maxIndex:l,prevIndex:u,stopEvent:c=!1}=t,d=u;if(n.key===yi){if(c&&ra(n),-1===u)d=l;else if(d=Ci(e,{startingIndex:d,amount:i,decrement:!0,disabledIndices:o}),a&&(u-i<s||d<0)){const e=u%i,t=l%i,n=l-(t-e);d=t===e?l:t>e?n:n-i}_i(e,d)&&(d=u)}if(n.key===vi&&(c&&ra(n),-1===u?d=s:(d=Ci(e,{startingIndex:u,amount:i,disabledIndices:o}),a&&u+i>l&&(d=Ci(e,{startingIndex:u%i-i,amount:i,disabledIndices:o}))),_i(e,d)&&(d=u)),"both"===r){const t=la(u/i);n.key===Oi&&(c&&ra(n),u%i!=i-1?(d=Ci(e,{startingIndex:u,disabledIndices:o}),a&&Si(d,i,t)&&(d=Ci(e,{startingIndex:u-u%i-1,disabledIndices:o}))):a&&(d=Ci(e,{startingIndex:u-u%i-1,disabledIndices:o})),Si(d,i,t)&&(d=u)),n.key===wi&&(c&&ra(n),u%i!=0?(d=Ci(e,{startingIndex:u,decrement:!0,disabledIndices:o}),a&&Si(d,i,t)&&(d=Ci(e,{startingIndex:u+(i-u%i),decrement:!0,disabledIndices:o}))):a&&(d=Ci(e,{startingIndex:u+(i-u%i),decrement:!0,disabledIndices:o})),Si(d,i,t)&&(d=u));const r=la(l/i)===t;_i(e,d)&&(d=a&&r?n.key===wi?l:Ci(e,{startingIndex:u-u%i-1,disabledIndices:o}):u)}return d}({current:r.map((e=>null!=e?o.current[e]:null))},{event:e,orientation:w,loop:p,cols:O,disabledIndices:ji([...v||o.current.map(((e,t)=>Di(o.current,t)?t:void 0)),void 0],r),minIndex:a,maxIndex:i,prevIndex:Ei(T.current>s?n:T.current,t,r,O,e.key===vi?"bl":e.key===Oi?"tr":"tl"),stopEvent:!0})];if(null!=l&&(T.current=l,D(T.current)),"both"===w)return}if(ko(e.key,w)){if(ra(e),r&&!m&&Ur(e.currentTarget.ownerDocument)===e.currentTarget)return T.current=To(e.key,w,f)?n:s,void D(T.current);To(e.key,w,f)?T.current=p?t>=s?d&&t!==o.current.length?-1:n:Ci(o,{startingIndex:t,disabledIndices:v}):Math.min(s,Ci(o,{startingIndex:t,disabledIndices:v})):T.current=p?t<=n?d&&-1!==t?o.current.length:s:Ci(o,{startingIndex:t,decrement:!0,disabledIndices:v}):Math.max(n,Ci(o,{startingIndex:t,decrement:!0,disabledIndices:v})),_i(o,T.current)?D(null):D(T.current)}})),Z=t.useMemo((()=>m&&r&&Q&&{"aria-activedescendant":W||q}),[m,r,Q,W,q]),X=t.useMemo((()=>({"aria-orientation":"both"===w?void 0:w,...!aa(i.domReference)&&Z,onKeyDown:Y,onPointerMove(){A.current=!0}})),[Z,Y,i.domReference,w]),J=t.useMemo((()=>{function e(e){"auto"===g&&Yr(e.nativeEvent)&&(k.current=!0)}return{...Z,onKeyDown(e){A.current=!1;const t=e.key.startsWith("Arrow"),n=["Home","End"].includes(e.key),i=t||n,s=function(e,t,n){return Do(t,n?e===wi:e===Oi,e===vi)}(e.key,w,f),l=Ro(e.key,w,f),u=ko(e.key,w),d=(h?s:u)||"Enter"===e.key||""===e.key.trim();if(m&&r){const t=null==j?void 0:j.nodesRef.current.find((e=>null==e.parentId)),r=j&&t?function(e,t){let n,r=-1;return function t(a,i){i>r&&(n=a,r=i),Hi(e,a).forEach((e=>{t(e.id,i+1)}))}(t,0),e.find((e=>e.id===n))}(j.nodesRef.current,t.id):null;if(i&&r&&_){const t=new KeyboardEvent("keydown",{key:e.key,bubbles:!0});if(s||l){var p,g;const n=(null==(p=r.context)?void 0:p.elements.domReference)===e.currentTarget,a=l&&!n?null==(g=r.context)?void 0:g.elements.domReference:s?o.current.find((e=>(null==e?void 0:e.id)===q)):null;a&&(ra(e),a.dispatchEvent(t),U(void 0))}var b;if((u||n)&&r.context&&r.context.open&&r.parentId&&e.currentTarget!==r.context.elements.domReference)return ra(e),void(null==(b=r.context.elements.domReference)||b.dispatchEvent(t))}return Y(e)}(r||y||!t)&&(d&&(R.current=h&&u?null:e.key),h?s&&(ra(e),r?(T.current=xi(o,$.current),D(T.current)):a(!0,e.nativeEvent,"list-navigation")):u&&(null!=c&&(T.current=c),ra(e),!r&&y?a(!0,e.nativeEvent,"list-navigation"):Y(e),r&&D(T.current)))},onFocus(){r&&!m&&D(null)},onPointerDown:function(e){k.current=g,"auto"===g&&Zr(e.nativeEvent)&&(k.current=!0)},onMouseDown:e,onClick:e}}),[q,Z,Y,$,g,o,h,D,a,r,y,w,f,c,j,m,_]);return t.useMemo((()=>u?{reference:J,floating:X,item:K}:{}),[u,J,X,K])}const Io=new Map([["select","listbox"],["combobox","listbox"],["label",!1]]);function Mo(e,n){var r;void 0===n&&(n={});const{open:a,floatingId:i}=e,{enabled:o=!0,role:s="dialog"}=n,l=null!=(r=Io.get(s))?r:s,u=Fi(),c=null!=zi(),d=t.useMemo((()=>"tooltip"===l||"label"===s?{["aria-"+("label"===s?"labelledby":"describedby")]:a?i:void 0}:{"aria-expanded":a?"true":"false","aria-haspopup":"alertdialog"===l?"dialog":l,"aria-controls":a?i:void 0,..."listbox"===l&&{role:"combobox"},..."menu"===l&&{id:u},..."menu"===l&&c&&{role:"menuitem"},..."select"===s&&{"aria-autocomplete":"none"},..."combobox"===s&&{"aria-autocomplete":"list"}}),[l,i,c,a,u,s]),p=t.useMemo((()=>{const e={id:i,...l&&{role:l}};return"tooltip"===l||"label"===s?e:{...e,..."menu"===l&&{"aria-labelledby":u}}}),[l,i,u,s]),h=t.useCallback((e=>{let{active:t,selected:n}=e;const r={role:"option",...t&&{id:i+"-option"}};switch(s){case"select":return{...r,"aria-selected":t&&n};case"combobox":return{...r,...t&&{"aria-selected":!0}}}return{}}),[i,s]);return t.useMemo((()=>o?{reference:d,floating:p,item:h}:{}),[o,d,p,h])}function Vo(e,t,n){let r,a=n.initialDeps??[];return()=>{var i,o,s,l;let u;n.key&&(null==(i=n.debug)?void 0:i.call(n))&&(u=Date.now());const c=e(),d=c.length!==a.length||c.some(((e,t)=>a[t]!==e));if(!d)return r;let p;if(a=c,n.key&&(null==(o=n.debug)?void 0:o.call(n))&&(p=Date.now()),r=t(...c),n.key&&(null==(s=n.debug)?void 0:s.call(n))){const e=Math.round(100*(Date.now()-u))/100,t=Math.round(100*(Date.now()-p))/100,r=t/16,a=(e,t)=>{for(e=String(e);e.length<t;)e=" "+e;return e};console.info(`%c ${a(t,5)} /${a(e,5)} ms`,`\n            font-size: .6rem;\n            font-weight: bold;\n            color: hsl(${Math.max(0,Math.min(120-120*r,120))}deg 100% 31%);`,null==n?void 0:n.key)}return null==(l=null==n?void 0:n.onChange)||l.call(n,r),r}}function Fo(e,t){if(void 0===e)throw new Error("Unexpected undefined"+(t?`: ${t}`:""));return e}const Lo=(e,t,n)=>{let r;return function(...a){e.clearTimeout(r),r=e.setTimeout((()=>t.apply(this,a)),n)}},$o=e=>e,zo=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let e=t;e<=n;e++)r.push(e);return r},Bo=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const a=e=>{const{width:n,height:r}=e;t({width:Math.round(n),height:Math.round(r)})};if(a(n.getBoundingClientRect()),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver((e=>{const t=e[0];if(null==t?void 0:t.borderBoxSize){const e=t.borderBoxSize[0];if(e)return void a({width:e.inlineSize,height:e.blockSize})}a(n.getBoundingClientRect())}));return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},No={passive:!0},qo="undefined"==typeof window||"onscrollend"in window,Ho=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let a=0;const i=qo?()=>{}:Lo(r,(()=>{t(a,!1)}),e.options.isScrollingResetDelay),o=r=>()=>{const{horizontal:o,isRtl:s}=e.options;a=o?n.scrollLeft*(s?-1:1):n.scrollTop,i(),t(a,r)},s=o(!0),l=o(!1);return l(),n.addEventListener("scroll",s,No),n.addEventListener("scrollend",l,No),()=>{n.removeEventListener("scroll",s),n.removeEventListener("scrollend",l)}},Wo=(e,t,n)=>{if(null==t?void 0:t.borderBoxSize){const e=t.borderBoxSize[0];if(e)return Math.round(e[n.options.horizontal?"inlineSize":"blockSize"])}return Math.round(e.getBoundingClientRect()[n.options.horizontal?"width":"height"])},Uo=(e,{adjustments:t=0,behavior:n},r)=>{var a,i;const o=e+t;null==(i=null==(a=r.scrollElement)?void 0:a.scrollTo)||i.call(a,{[r.options.horizontal?"left":"top"]:o,behavior:n})};class Go{constructor(e){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let e=null;const t=()=>e||(this.targetWindow&&this.targetWindow.ResizeObserver?e=new this.targetWindow.ResizeObserver((e=>{e.forEach((e=>{this._measureElement(e.target,e)}))})):null);return{disconnect:()=>{var e;return null==(e=t())?void 0:e.disconnect()},observe:e=>{var n;return null==(n=t())?void 0:n.observe(e,{box:"border-box"})},unobserve:e=>{var n;return null==(n=t())?void 0:n.unobserve(e)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach((([t,n])=>{void 0===n&&delete e[t]})),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:$o,rangeExtractor:zo,onChange:()=>{},measureElement:Wo,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,...e}},this.notify=(e,t)=>{var n,r;const{startIndex:a,endIndex:i}=this.range??{startIndex:void 0,endIndex:void 0},o=this.calculateRange();(e||a!==(null==o?void 0:o.startIndex)||i!==(null==o?void 0:o.endIndex))&&(null==(r=(n=this.options).onChange)||r.call(n,this,t))},this.cleanup=()=>{this.unsubs.filter(Boolean).forEach((e=>e())),this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.observer.disconnect(),this.elementsCache.clear()},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var e;const t=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==t){if(this.cleanup(),!t)return void this.notify(!1,!1);this.scrollElement=t,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=(null==(e=this.scrollElement)?void 0:e.window)??null,this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,(e=>{this.scrollRect=e,this.notify(!1,!1)}))),this.unsubs.push(this.options.observeElementOffset(this,((e,t)=>{this.scrollAdjustments=0,this.scrollDirection=t?this.getScrollOffset()<e?"forward":"backward":null,this.scrollOffset=e;const n=this.isScrolling;this.isScrolling=t,this.notify(n!==t,t)})))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??("function"==typeof this.options.initialOffset?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(e,t)=>{const n=new Map,r=new Map;for(let a=t-1;a>=0;a--){const t=e[a];if(n.has(t.lane))continue;const i=r.get(t.lane);if(null==i||t.end>i.end?r.set(t.lane,t):t.end<i.end&&n.set(t.lane,!0),n.size===this.options.lanes)break}return r.size===this.options.lanes?Array.from(r.values()).sort(((e,t)=>e.end===t.end?e.index-t.index:e.end-t.end))[0]:void 0},this.getMeasurementOptions=Vo((()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled]),((e,t,n,r,a)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:t,scrollMargin:n,getItemKey:r,enabled:a})),{key:!1}),this.getMeasurements=Vo((()=>[this.getMeasurementOptions(),this.itemSizeCache]),(({count:e,paddingStart:t,scrollMargin:n,getItemKey:r,enabled:a},i)=>{var o;if(!a)return this.measurementsCache=[],this.itemSizeCache.clear(),[];0===this.measurementsCache.length&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach((e=>{this.itemSizeCache.set(e.key,e.size)})));const s=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const l=this.measurementsCache.slice(0,s);for(let a=s;a<e;a++){let e=null==(o=this.measurementsCache[a])?void 0:o.measureElement;e||(e=e=>{const t=r(a),n=this.elementsCache.get(t);e?(n!==e&&(n&&this.observer.unobserve(n),this.observer.observe(e),this.elementsCache.set(t,e)),e.isConnected&&this.resizeItem(a,this.options.measureElement(e,void 0,this))):n&&(this.observer.unobserve(n),this.elementsCache.delete(t))});const s=r(a),u=1===this.options.lanes?l[a-1]:this.getFurthestMeasurement(l,a),c=u?u.end+this.options.gap:t+n,d=i.get(s),p="number"==typeof d?d:this.options.estimateSize(a),h=c+p,f=u?u.lane:a%this.options.lanes;l[a]={index:a,start:c,size:p,end:h,key:s,lane:f,measureElement:e}}return this.measurementsCache=l,l}),{key:!1,debug:()=>this.options.debug}),this.calculateRange=Vo((()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset()]),((e,t,n)=>this.range=e.length>0&&t>0?function({measurements:e,outerSize:t,scrollOffset:n}){const r=e.length-1,a=Qo(0,r,(t=>e[t].start),n);let i=a;for(;i<r&&e[i].end<n+t;)i++;return{startIndex:a,endIndex:i}}({measurements:e,outerSize:t,scrollOffset:n}):null),{key:!1,debug:()=>this.options.debug}),this.getIndexes=Vo((()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count]),((e,t,n,r)=>null===t?[]:e({startIndex:t.startIndex,endIndex:t.endIndex,overscan:n,count:r})),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const t=this.options.indexAttribute,n=e.getAttribute(t);return n?parseInt(n,10):(console.warn(`Missing attribute name '${t}={index}' on measured element.`),-1)},this._measureElement=(e,t)=>{const n=this.indexFromElement(e),r=this.getMeasurements()[n];if(!r||!e.isConnected)return void this.elementsCache.forEach(((t,n)=>{t===e&&(this.observer.unobserve(e),this.elementsCache.delete(n))}));const a=this.elementsCache.get(r.key);a!==e&&(a&&this.observer.unobserve(a),this.observer.observe(e),this.elementsCache.set(r.key,e)),this.resizeItem(n,this.options.measureElement(e,t,this))},this.resizeItem=(e,t)=>{const n=this.getMeasurements()[e];if(!n)return;const r=t-(this.itemSizeCache.get(n.key)??n.size);0!==r&&((void 0!==this.shouldAdjustScrollPositionOnItemSizeChange?this.shouldAdjustScrollPositionOnItemSizeChange(n,r,this):n.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=r,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(n.index),this.itemSizeCache=new Map(this.itemSizeCache.set(n.key,t)),this.notify(!0,!1))},this.measureElement=e=>{e&&this._measureElement(e,void 0)},this.getVirtualItems=Vo((()=>[this.getIndexes(),this.getMeasurements()]),((e,t)=>{const n=[];for(let r=0,a=e.length;r<a;r++){const a=t[e[r]];n.push(a)}return n}),{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const t=this.getMeasurements();if(0!==t.length)return Fo(t[Qo(0,t.length-1,(e=>Fo(t[e]).start),e)])},this.getOffsetForAlignment=(e,t)=>{const n=this.getSize(),r=this.getScrollOffset();"auto"===t&&(t=e<=r?"start":e>=r+n?"end":"start"),"start"===t||("end"===t?e-=n:"center"===t&&(e-=n/2));const a=this.options.horizontal?"scrollWidth":"scrollHeight",i=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[a]:this.scrollElement[a]:0)-n;return Math.max(Math.min(i,e),0)},this.getOffsetForIndex=(e,t="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const n=this.getMeasurements()[e];if(!n)return;const r=this.getSize(),a=this.getScrollOffset();if("auto"===t)if(n.end>=a+r-this.options.scrollPaddingEnd)t="end";else{if(!(n.start<=a+this.options.scrollPaddingStart))return[a,t];t="start"}const i="end"===t?n.end+this.options.scrollPaddingEnd:n.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(i,t),t]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{null!==this.scrollToIndexTimeoutId&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:t="start",behavior:n}={})=>{this.cancelScrollToIndex(),"smooth"===n&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,t),{adjustments:void 0,behavior:n})},this.scrollToIndex=(e,{align:t="auto",behavior:n}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),"smooth"===n&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const r=this.getOffsetForIndex(e,t);if(!r)return;const[a,i]=r;this._scrollToOffset(a,{adjustments:void 0,behavior:n}),"smooth"!==n&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout((()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(e))){const[a]=Fo(this.getOffsetForIndex(e,i));t=a,r=this.getScrollOffset(),Math.abs(t-r)<1||this.scrollToIndex(e,{align:i,behavior:n})}else this.scrollToIndex(e,{align:i,behavior:n});var t,r})))},this.scrollBy=(e,{behavior:t}={})=>{this.cancelScrollToIndex(),"smooth"===t&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+e,{adjustments:void 0,behavior:t})},this.getTotalSize=()=>{var e;const t=this.getMeasurements();let n;return n=0===t.length?this.options.paddingStart:1===this.options.lanes?(null==(e=t[t.length-1])?void 0:e.end)??0:Math.max(...t.slice(-this.options.lanes).map((e=>e.end))),n-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(e,{adjustments:t,behavior:n})=>{this.options.scrollToFn(e,{behavior:n,adjustments:t},this)},this.measure=()=>{var e,t;this.itemSizeCache=new Map,null==(t=(e=this.options).onChange)||t.call(e,this,!1)},this.setOptions(e)}}const Qo=(e,t,n,r)=>{for(;e<=t;){const a=(e+t)/2|0,i=n(a);if(i<r)e=a+1;else{if(!(i>r))return a;t=a-1}}return e>0?e-1:0},Ko="undefined"!=typeof document?t.useLayoutEffect:t.useEffect;function Yo(e){return function(e){const n=t.useReducer((()=>({})),{})[1],r={...e,onChange:(t,r)=>{var a;r?(0,Fa.flushSync)(n):n(),null==(a=e.onChange)||a.call(e,t,r)}},[a]=t.useState((()=>new Go(r)));return a.setOptions(r),t.useEffect((()=>a._didMount()),[]),Ko((()=>a._willUpdate())),a}({observeElementRect:Bo,observeElementOffset:Ho,scrollToFn:Uo,...e})}var Zo=Object.defineProperty,Xo=Object.getOwnPropertySymbols,Jo=Object.prototype.hasOwnProperty,es=Object.prototype.propertyIsEnumerable,ts=(e,t,n)=>t in e?Zo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const ns=(0,t.forwardRef)((function(e,n){var a=e,{children:i,active:o,addGroupBottomBorder:s,isMultiValueEdit:l,checked:u}=a,c=((e,t)=>{var n={};for(var r in e)Jo.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&Xo)for(var r of Xo(e))t.indexOf(r)<0&&es.call(e,r)&&(n[r]=e[r]);return n})(a,["children","active","addGroupBottomBorder","isMultiValueEdit","checked"]);const d=(0,_n.useStyles2)(rs),p=(0,t.useId)();return r().createElement("div",((e,t)=>{for(var n in t||(t={}))Jo.call(t,n)&&ts(e,n,t[n]);if(Xo)for(var n of Xo(t))es.call(t,n)&&ts(e,n,t[n]);return e})({ref:n,role:"option",id:p,"aria-selected":o,className:(0,En.cx)(d.option,o&&d.optionFocused,s&&d.groupBottomBorder)},c),r().createElement("div",{className:d.optionBody,"data-testid":`data-testid ad hoc filter option value ${i}`},r().createElement("span",null,l?r().createElement(_n.Checkbox,{tabIndex:-1,checked:u,className:d.checkbox}):null,i)))})),rs=e=>({option:(0,En.css)({label:"grafana-select-option",top:0,left:0,width:"100%",position:"absolute",padding:e.spacing(1),display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer","&:hover":{background:e.colors.action.hover,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${e.colors.primary.border}`}}}),optionFocused:(0,En.css)({label:"grafana-select-option-focused",background:e.colors.action.focus,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${e.colors.primary.border}`}}),optionBody:(0,En.css)({label:"grafana-select-option-body",display:"flex",fontWeight:e.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),groupBottomBorder:(0,En.css)({borderBottom:`1px solid ${e.colors.border.weak}`}),checkbox:(0,En.css)({paddingRight:e.spacing(.5)}),multiValueApplyWrapper:(0,En.css)({position:"fixed",top:0,left:0,display:"flex",backgroundColor:e.colors.background.primary,color:e.colors.text.primary,boxShadow:e.shadows.z2,overflowY:"auto",zIndex:e.zIndex.dropdown,gap:e.spacing(1.5),padding:`${e.spacing(1.5)} ${e.spacing(1)}`})}),as=()=>r().createElement(ns,{onClick:e=>e.stopPropagation()},"Loading options..."),is=()=>r().createElement(ns,{onClick:e=>e.stopPropagation()},"No options found"),os=({handleFetchOptions:e})=>r().createElement(ns,{onClick:e},"An error has occurred fetching labels. Click to retry"),ss=({onApply:e,floatingElement:t,maxOptionWidth:n,menuHeight:a})=>{const i=(0,_n.useStyles2)(rs),o=null==t?void 0:t.getBoundingClientRect();return r().createElement("div",{className:i.multiValueApplyWrapper,style:{width:`${n}px`,transform:`translate(${null==o?void 0:o.left}px,${o?o.top+a:0}px)`}},r().createElement(_n.Button,{onClick:e,size:"sm",tabIndex:-1},"Apply"))},ls={key:"operator",operator:"value",value:"key"},us=(e,t,n,r,a)=>cs(ls[e],t,"value"===e?n:void 0,r,a),cs=(e,t,n,r,a)=>{t(e),null==n||n(void 0,a),setTimeout((()=>null==r?void 0:r.focus()))},ds=({filterInputType:e,item:t,filter:n,setFilterMultiValues:r})=>{var a,i,o,s,l;if("key"===e)return{key:t.value,keyLabel:t.label?t.label:t.value};if("value"===e)return{value:t.value,valueLabels:[t.label?t.label:t.value]};if("operator"===e){if(pl(n.operator)&&!pl(t.value))return r([]),{operator:t.value,valueLabels:[(null==(a=n.valueLabels)?void 0:a[0])||(null==(i=n.values)?void 0:i[0])||n.value],values:void 0};if(pl(t.value)&&!pl(n.operator)){const e=[(null==(o=n.valueLabels)?void 0:o[0])||(null==(s=n.values)?void 0:s[0])||n.value],a=[n.value];return a[0]&&r([{value:a[0],label:null!=(l=null==e?void 0:e[0])?l:a[0]}]),{operator:t.value,valueLabels:e,values:a}}}return{[e]:t.value}},ps="Filter by label values",hs=(e,t,n,r)=>{var a;return"key"===t?ps:"value"===t?n?"Edit values":(null==(a=e.valueLabels)?void 0:a[0])||"":e[t]&&!r?`${e[t]}`:ps},fs=({populateInputOnEdit:e,item:t,filterInputType:n,setInputValue:r,filter:a})=>{e&&!pl(t.value||"")&&"value"===ls[n]?r((null==a?void 0:a.value)||""):r("")};var ms=Object.defineProperty,gs=Object.defineProperties,bs=Object.getOwnPropertyDescriptors,ys=Object.getOwnPropertySymbols,vs=Object.prototype.hasOwnProperty,ws=Object.prototype.propertyIsEnumerable,Os=(e,t,n)=>t in e?ms(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ss=(e,t)=>{for(var n in t||(t={}))vs.call(t,n)&&Os(e,n,t[n]);if(ys)for(var n of ys(t))ws.call(t,n)&&Os(e,n,t[n]);return e};const _s=({item:e,handleRemoveMultiValue:n,index:a,handleEditMultiValuePill:i})=>{var o,s;const l=(0,_n.useStyles2)(xs),u=(0,t.useCallback)((t=>{t.stopPropagation(),t.preventDefault(),i(e)}),[i,e]),c=(0,t.useCallback)((e=>{"Enter"===e.key&&u(e)}),[u]),d=(0,t.useCallback)((t=>{t.stopPropagation(),t.preventDefault(),n(e)}),[n,e]),p=(0,t.useCallback)((e=>{"Enter"===e.key&&d(e)}),[d]);return r().createElement("div",{className:(0,En.cx)(l.basePill,l.valuePill),onClick:u,onKeyDown:c,tabIndex:0,id:`${e.value}-${a}`},null!=(o=e.label)?o:e.value,r().createElement(_n.Button,{onClick:d,onKeyDownCapture:p,fill:"text",size:"sm",variant:"secondary",className:l.removeButton,tooltip:`Remove filter value - ${null!=(s=e.label)?s:e.value}`},r().createElement(_n.Icon,{name:"times",size:"md",id:`${e.value}-${a}-close-icon`})))},xs=e=>{return{basePill:(0,En.css)((t=Ss({display:"flex",alignItems:"center",background:e.colors.action.disabledBackground,border:`1px solid ${e.colors.border.weak}`,padding:e.spacing(.125,1,.125,1),color:e.colors.text.primary,overflow:"hidden",whiteSpace:"nowrap",minHeight:e.spacing(2.75)},e.typography.bodySmall),n={cursor:"pointer"},gs(t,bs(n)))),valuePill:(0,En.css)({background:e.colors.action.selected,padding:e.spacing(.125,0,.125,1)}),removeButton:(0,En.css)({marginInline:e.spacing(.5),height:"100%",padding:0,cursor:"pointer","&:hover":{color:e.colors.text.primary}})};var t,n};function Ps(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}var Cs=Object.defineProperty,Es=Object.defineProperties,js=Object.getOwnPropertyDescriptors,Ds=Object.getOwnPropertySymbols,ks=Object.prototype.hasOwnProperty,Ts=Object.prototype.propertyIsEnumerable,Rs=(e,t,n)=>t in e?Cs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,As=(e,t)=>{for(var n in t||(t={}))ks.call(t,n)&&Rs(e,n,t[n]);if(Ds)for(var n of Ds(t))Ts.call(t,n)&&Rs(e,n,t[n]);return e},Is=(e,t)=>Es(e,js(t));const Ms=(0,t.forwardRef)((function({filter:e,model:n,isAlwaysWip:a,handleChangeViewMode:i,focusOnWipInputRef:o,populateInputOnEdit:s},l){var u,c,d,p;const[h,f]=(0,t.useState)(!1),[m,g]=(0,t.useState)([]),[b,y]=(0,t.useState)(!1),[v,w]=(0,t.useState)(!1),[O,S]=(0,t.useState)(""),[_,x]=(0,t.useState)(null),[P,C]=(0,t.useState)(a?"key":"value"),[E,j]=(0,t.useState)(!a&&"value"===P),D=(0,_n.useStyles2)(Vs),[k,T]=(0,t.useState)([]),[R,A]=(0,t.useState)({}),I=null==(u=n.state.allowCustomValue)||u,M=(0,t.useRef)(null),V=pl((null==e?void 0:e.operator)||""),F=V&&"value"===P,L=(0,t.useId)(),$=(0,t.useRef)([]),z=(0,t.useRef)([]),B=(0,t.useRef)(a?"key":"value"),N=(0,t.useMemo)((()=>function(e){const t=ru(e.map((e=>{var t;return null!=(t=e.label)?t:e.value})));return(n,r)=>("operator"===r&&""!==n&&(n=`"${n}"`),t(n).map((t=>e[t])))}(m)),[m]),q=(0,t.useMemo)((()=>!a&&n.state.filters.at(-1)===e),[e,a,n.state.filters]),H=(0,t.useCallback)((()=>{a&&(n._addWip(),C("key"),S(""))}),[n,a]),W=(0,t.useCallback)(((e,t,n,r)=>{if(n.length){const r=[],a=[];n.forEach((e=>{var t;r.push(null!=(t=e.label)?t:e.value),a.push(e.value)})),e._updateFilter(t,{valueLabels:r,values:a,value:a[0]}),T([])}r||setTimeout((()=>{var e;return null==(e=K.domReference.current)?void 0:e.focus()}))}),[]),U=(0,t.useCallback)((e=>{T((t=>t.some((t=>t.value===e.value))?t.filter((t=>t.value!==e.value)):[...t,e]))}),[]),G=(0,t.useCallback)(((t,r,a)=>{f(t),a&&["outside-press","escape-key"].includes(a)&&(F&&W(n,e,k),H(),null==i||i())}),[e,k,i,W,H,F,n]),Q=(0,t.useMemo)((()=>[L,...k.reduce(((e,t,n)=>[...e,`${t.value}-${n}`,`${t.value}-${n}-close-icon`]),[])]),[L,k]),{refs:K,floatingStyles:Y,context:Z,getReferenceProps:X,getFloatingProps:J,getItemProps:ee}=(({open:e,onOpenChange:t,activeIndex:n,setActiveIndex:r,outsidePressIdsToIgnore:a,listRef:i,disabledIndicesRef:o})=>{const{refs:s,floatingStyles:l,context:u}=_o({whileElementsMounted:ni,open:e,onOpenChange:t,placement:"bottom-start",middleware:[pi(10),hi({padding:10}),fi({apply({availableHeight:e,availableWidth:t,elements:n}){n.floating.style.maxHeight=`${Math.min(300,e)}px`,n.floating.style.maxWidth=`${t}px`},padding:10})],strategy:"fixed"}),c=Mo(u,{role:"listbox"}),d=So(u,{outsidePress:e=>{var t;if(e.currentTarget instanceof Element){const n=e.currentTarget;let r=n.id;if("path"===n.nodeName&&(r=(null==(t=n.parentElement)?void 0:t.id)||""),a.includes(r))return!1}return!0}}),p=Ao(u,{listRef:i,activeIndex:n,onNavigate:r,virtual:!0,loop:!0,disabledIndices:o.current}),{getReferenceProps:h,getFloatingProps:f,getItemProps:m}=Eo([c,d,p]);return{refs:s,floatingStyles:l,context:u,getReferenceProps:h,getFloatingProps:f,getItemProps:m}})({open:h,onOpenChange:G,activeIndex:_,setActiveIndex:x,outsidePressIdsToIgnore:Q,listRef:$,disabledIndicesRef:z});(0,t.useImperativeHandle)(l,(()=>()=>{var e;return null==(e=K.domReference.current)?void 0:e.focus()}),[K.domReference]);const te=(0,t.useCallback)((e=>{T((t=>t.filter((t=>t.value!==e.value)))),setTimeout((()=>{var e;return null==(e=K.domReference.current)?void 0:e.focus()}))}),[K.domReference]),ne=(e=>e.flatMap((e=>e.options?[e,...e.options]:[e])))(nu(N(E?"":O,P)));I&&"operator"!==P&&O&&ne.push({value:O.trim(),label:O.trim(),isCustom:!0});const re=((e,t,n)=>{var r,a,i,o;let s=182;const l=[],u=[];for(let t=0;t<e.length;t++){l.push(null),(null==(r=e[t])?void 0:r.options)&&u.push(t);let n=null!=(i=null!=(a=e[t].label)?a:e[t].value)?i:"",c=8;8*n.length<6*((null==(o=e[t].description)?void 0:o.length)||0)&&(n=e[t].description,c=6);const d=(e[t].isCustom?n.length+18:n.length)*c+16;d>s&&(s=d)}return t.current=[...l],n.current=[...u],s})(ne,$,z),ae=(0,t.useCallback)(function(){var t,r=(t=function*(t){var r;w(!1),y(!0),g([]);let a=[];try{if("key"===t?a=yield n._getKeys(null):"operator"===t?a=n._getOperators():"value"===t&&(a=yield n._getValuesFor(e)),B.current!==t)return;g(a),(null==(r=a[0])?void 0:r.group)?x(1):x(0)}catch(e){w(!0)}y(!1)},function(){var e=this,n=arguments;return new Promise((function(r,a){var i=t.apply(e,n);function o(e){Ps(i,r,a,o,s,"next",e)}function s(e){Ps(i,r,a,o,s,"throw",e)}o(void 0)}))});return function(e){return r.apply(this,arguments)}}(),[e,n]),ie=Yo({count:ne.length,getScrollElement:()=>K.floating.current,estimateSize:e=>ne[e].description?60:38,overscan:5}),oe=(0,t.useCallback)(((t,r)=>{if("Backspace"===t.key&&!O){if("value"===P)return r&&k.length?void T((e=>{const t=[...e];return t.splice(-1,1),t})):void C("operator");null==o||o(),n._handleComboboxBackspace(e),a&&H()}}),[O,P,n,e,a,k.length,H,o]),se=(0,t.useCallback)(((t,r)=>{var a;"Tab"!==t.key||t.shiftKey||(r&&(t.preventDefault(),W(n,e,k),null==(a=K.domReference.current)||a.focus()),null==i||i(),H())}),[e,k,i,W,H,n,K.domReference]),le=(0,t.useCallback)(((t,r)=>{"Tab"===t.key&&t.shiftKey&&(r&&(t.preventDefault(),W(n,e,k,!0)),null==i||i(),H())}),[e,k,i,W,H,n]),ue=(0,t.useCallback)(((t,r)=>{if("Enter"===t.key&&null!=_){if(!ne[_])return;const t=ne[_];r?(U(t),S("")):(n._updateFilter(e,ds({filterInputType:P,item:t,filter:e,setFilterMultiValues:T})),fs({populateInputOnEdit:s,item:t,filterInputType:P,setInputValue:S,filter:e}),us(P,C,i,K.domReference.current,!q&&void 0),x(null),q&&(null==o||o()))}}),[_,ne,U,n,e,P,s,i,K.domReference,q,o]),ce=(0,t.useCallback)((e=>{var t;const n=e.label||e.value;T((t=>t.filter((t=>t.value!==e.value)))),j(!0),S(n),null==(t=K.domReference.current)||t.focus(),setTimeout((()=>{var e;null==(e=K.domReference.current)||e.select()}))}),[K.domReference]);(0,t.useEffect)((()=>{h&&ae(P)}),[h,P]),(0,t.useEffect)((()=>{var t,n;if(!a){if(V&&(null==(t=null==e?void 0:e.values)?void 0:t.length)){const t=e.values.reduce(((t,n,r)=>{var a;return[...t,{label:(null==(a=e.valueLabels)?void 0:a[r])||n,value:n}]}),[]);T(t)}!V&&s&&(S((null==e?void 0:e.value)||""),setTimeout((()=>{var e;null==(e=K.domReference.current)||e.select()}))),null==(n=K.domReference.current)||n.focus()}}),[]),(0,t.useEffect)((()=>{F&&k&&setTimeout((()=>A({})))}),[k,F]),(0,t.useLayoutEffect)((()=>{B.current&&(B.current=P)}),[P]),(0,t.useLayoutEffect)((()=>{var e,t;null!==_&&ie.range&&(_>(null==(e=ie.range)?void 0:e.endIndex)||_<(null==(t=ie.range)?void 0:t.startIndex))&&ie.scrollToIndex(_)}),[_,ie]);const de=null!=(c=null==e?void 0:e.keyLabel)?c:null==e?void 0:e.key;return r().createElement("div",{className:D.comboboxWrapper},e?r().createElement("div",{className:D.pillWrapper},(null==e?void 0:e.key)?r().createElement("div",{className:(0,En.cx)(D.basePill,D.keyPill)},de):null,(null==e?void 0:e.key)&&(null==e?void 0:e.operator)&&"operator"!==P?r().createElement("div",{id:L,className:(0,En.cx)(D.basePill,D.operatorPill,L),role:"button","aria-label":"Edit filter operator",tabIndex:0,onClick:e=>{e.stopPropagation(),S(""),cs("operator",C,void 0,K.domReference.current)},onKeyDown:e=>{le(e,V),"Enter"===e.key&&(S(""),cs("operator",C,void 0,K.domReference.current))}},e.operator):null,r().createElement("div",{ref:M}),F?k.map(((e,t)=>r().createElement(_s,{key:`${e.value}-${t}`,item:e,index:t,handleRemoveMultiValue:te,handleEditMultiValuePill:ce}))):null):null,r().createElement("input",Is(As({},X({ref:K.setReference,onChange:function(e){const t=e.target.value;S(t),x(0),E&&j(!1)},value:O,placeholder:hs(e,P,F,a),"aria-autocomplete":"list",onKeyDown(e){h?("operator"===P&&le(e),oe(e,F),se(e,F),ue(e,F)):f(!0)}})),{className:(0,En.cx)(D.inputStyle,{[D.loadingInputPadding]:!b}),onClick:e=>{e.stopPropagation(),f(!0)},onFocus:()=>{f(!0)}})),b?r().createElement(_n.Spinner,{className:D.loadingIndicator,inline:!0}):null,r().createElement(uo,null,h&&r().createElement(yo,{context:Z,initialFocus:-1,visuallyHiddenDismiss:!0,modal:!1},r().createElement(r().Fragment,null,r().createElement("div",{style:Is(As({},Y),{width:`${v?366:re}px`,transform:F?`translate(${(null==(d=M.current)?void 0:d.getBoundingClientRect().left)||0}px, ${((null==(p=K.domReference.current)?void 0:p.getBoundingClientRect().bottom)||0)+10}px )`:Y.transform}),ref:K.setFloating,className:D.dropdownWrapper,tabIndex:-1},r().createElement("div",Is(As({style:{height:`${ie.getTotalSize()||38}px`}},J()),{tabIndex:-1}),b?r().createElement(as,null):v?r().createElement(os,{handleFetchOptions:()=>ae(P)}):ne.length||I&&"operator"!==P&&O?ie.getVirtualItems().map((t=>{var a;const o=ne[t.index],l=t.index;if(o.options)return r().createElement("div",{key:`${o.label}+${l}`,className:(0,En.cx)(D.optionGroupLabel,D.groupTopBorder),style:{height:`${t.size}px`,transform:`translateY(${t.start}px)`}},r().createElement(_n.Text,{weight:"bold",variant:"bodySmall",color:"secondary"},o.label));const u=ne[t.index+1],c=u&&!u.group&&!u.options&&o.group;return r().createElement(ns,Is(As({},ee({key:`${o.value}-${l}`,ref(e){$.current[l]=e},onClick(t){var r;"value"!==P&&t.stopPropagation(),F?(t.preventDefault(),t.stopPropagation(),U(o),S(""),null==(r=K.domReference.current)||r.focus()):(n._updateFilter(e,ds({filterInputType:P,item:o,filter:e,setFilterMultiValues:T})),fs({populateInputOnEdit:s,item:o,filterInputType:P,setInputValue:S,filter:e}),us(P,C,i,K.domReference.current,!1))}})),{active:_===l,addGroupBottomBorder:c,style:{height:`${t.size}px`,transform:`translateY(${t.start}px)`},"aria-setsize":ne.length,"aria-posinset":t.index+1,isMultiValueEdit:F,checked:k.some((e=>e.value===o.value))}),r().createElement("span",null,o.isCustom?"Use custom value: ":""," ",null!=(a=o.label)?a:o.value),o.description?r().createElement("div",{className:D.descriptionText},o.description):null)})):r().createElement(is,null))),F&&!b&&!v&&ne.length?r().createElement(ss,{onApply:()=>{W(n,e,k)},floatingElement:K.floating.current,maxOptionWidth:re,menuHeight:Math.min(ie.getTotalSize(),300)}):null))))})),Vs=e=>({comboboxWrapper:(0,En.css)({display:"flex",flexWrap:"wrap"}),pillWrapper:(0,En.css)({display:"flex",alignItems:"center",flexWrap:"wrap"}),basePill:(0,En.css)(Is(As({display:"flex",alignItems:"center",background:e.colors.action.disabledBackground,border:`1px solid ${e.colors.border.weak}`,padding:e.spacing(.125,1,.125,1),color:e.colors.text.primary,overflow:"hidden",whiteSpace:"nowrap",minHeight:e.spacing(2.75)},e.typography.bodySmall),{cursor:"pointer"})),keyPill:(0,En.css)({fontWeight:e.typography.fontWeightBold,cursor:"default"}),operatorPill:(0,En.css)({"&:hover":{background:e.colors.action.hover}}),dropdownWrapper:(0,En.css)({backgroundColor:e.colors.background.primary,color:e.colors.text.primary,boxShadow:e.shadows.z2,overflowY:"auto",zIndex:e.zIndex.dropdown}),inputStyle:(0,En.css)({paddingBlock:0,"&:focus":{outline:"none"}}),loadingIndicator:(0,En.css)({color:e.colors.text.secondary,marginLeft:e.spacing(.5)}),loadingInputPadding:(0,En.css)({paddingRight:e.spacing(2.5)}),optionGroupLabel:(0,En.css)({padding:e.spacing(1),position:"absolute",top:0,left:0,width:"100%"}),groupTopBorder:(0,En.css)({"&:not(:first-child)":{borderTop:`1px solid ${e.colors.border.weak}`}}),descriptionText:(0,En.css)(Is(As({},e.typography.bodySmall),{color:e.colors.text.secondary,paddingTop:e.spacing(.5)}))});var Fs=Object.defineProperty,Ls=Object.defineProperties,$s=Object.getOwnPropertyDescriptors,zs=Object.getOwnPropertySymbols,Bs=Object.prototype.hasOwnProperty,Ns=Object.prototype.propertyIsEnumerable,qs=(e,t,n)=>t in e?Fs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Hs=(e,t)=>{for(var n in t||(t={}))Bs.call(t,n)&&qs(e,n,t[n]);if(zs)for(var n of zs(t))Ns.call(t,n)&&qs(e,n,t[n]);return e};function Ws({filter:e,model:n,readOnly:a,focusOnWipInputRef:i}){var o,s,l;const u=(0,_n.useStyles2)(Us),[c,d]=(0,t.useState)(!0),[p,h]=(0,t.useState)(!1),f=(0,t.useRef)(null),[m,g]=(0,t.useState)(!1),b=null!=(o=e.keyLabel)?o:e.key,y=(null==(s=e.valueLabels)?void 0:s.join(", "))||(null==(l=e.values)?void 0:l.join(", "))||e.value,v=(0,t.useCallback)(((e,t)=>{null==e||e.stopPropagation(),a||(h(null!=t?t:!c),d(!c))}),[a,c]);if((0,t.useEffect)((()=>{var e;p&&(null==(e=f.current)||e.focus(),h(!1))}),[p]),(0,t.useEffect)((()=>{e.forceEdit&&c&&(d(!1),n._updateFilter(e,{forceEdit:void 0}))}),[e,n,c]),(0,t.useEffect)((()=>{c&&g((e=>!e&&e))}),[c]),c){const t=r().createElement("span",{className:u.pillText},b," ",e.operator," ",y);return r().createElement("div",{className:(0,En.cx)(u.combinedFilterPill,{[u.readOnlyCombinedFilter]:a}),onClick:e=>{e.stopPropagation(),g(!0),v()},onKeyDown:e=>{"Enter"===e.key&&(g(!0),v())},role:"button","aria-label":`Edit filter with key ${b}`,tabIndex:0,ref:f},y.length<20?t:r().createElement(_n.Tooltip,{content:r().createElement("div",{className:u.tooltipText},y),placement:"top"},t),a?null:r().createElement(_n.IconButton,{onClick:t=>{t.stopPropagation(),n._removeFilter(e),setTimeout((()=>null==i?void 0:i()))},onKeyDownCapture:t=>{"Enter"===t.key&&(t.preventDefault(),t.stopPropagation(),n._removeFilter(e),setTimeout((()=>null==i?void 0:i())))},name:"times",size:"md",className:u.removeButton,tooltip:`Remove filter with key ${b}`}))}return r().createElement(Ms,{filter:e,model:n,handleChangeViewMode:v,focusOnWipInputRef:i,populateInputOnEdit:m})}const Us=e=>{return{combinedFilterPill:(0,En.css)((t=Hs({display:"flex",alignItems:"center",background:e.colors.action.selected,borderRadius:e.shape.radius.default,border:`1px solid ${e.colors.border.weak}`,padding:e.spacing(.125,0,.125,1),color:e.colors.text.primary,overflow:"hidden",whiteSpace:"nowrap",minHeight:e.spacing(2.75)},e.typography.bodySmall),n={fontWeight:e.typography.fontWeightBold,cursor:"pointer","&:hover":{background:e.colors.action.hover}},Ls(t,$s(n)))),readOnlyCombinedFilter:(0,En.css)({paddingRight:e.spacing(1),cursor:"text","&:hover":{background:e.colors.action.selected}}),removeButton:(0,En.css)({marginInline:e.spacing(.5),cursor:"pointer","&:hover":{color:e.colors.text.primary}}),pillText:(0,En.css)({maxWidth:"200px",width:"100%",textOverflow:"ellipsis",overflow:"hidden"}),tooltipText:(0,En.css)({textAlign:"center"})};var t,n},Gs=(0,t.forwardRef)((function({model:e},n){const{_wip:a}=e.useState();return(0,t.useLayoutEffect)((()=>{a||e._addWip()}),[a]),r().createElement(Ms,{model:e,filter:a,isAlwaysWip:!0,ref:n})})),Qs=(0,t.memo)((function({model:e}){const{filters:n,readOnly:a}=e.useState(),i=(0,_n.useStyles2)(Ks),o=(0,t.useRef)();return r().createElement("div",{className:(0,En.cx)(i.comboboxWrapper,{[i.comboboxFocusOutline]:!a}),onClick:()=>{var e;null==(e=o.current)||e.call(o)}},r().createElement(_n.Icon,{name:"filter",className:i.filterIcon,size:"lg"}),n.map(((t,n)=>r().createElement(Ws,{key:`${n}-${t.key}`,filter:t,model:e,readOnly:a,focusOnWipInputRef:o.current}))),a?null:r().createElement(Gs,{model:e,ref:o}))})),Ks=e=>({comboboxWrapper:(0,En.css)({display:"flex",flexWrap:"wrap",alignItems:"center",columnGap:e.spacing(1),rowGap:e.spacing(.5),minHeight:e.spacing(4),backgroundColor:e.components.input.background,border:`1px solid ${e.colors.border.strong}`,borderRadius:e.shape.radius.default,paddingInline:e.spacing(1),paddingBlock:e.spacing(.5),flexGrow:1}),comboboxFocusOutline:(0,En.css)({"&:focus-within":{outline:"2px dotted transparent",outlineOffset:"2px",boxShadow:`0 0 0 2px ${e.colors.background.canvas}, 0 0 0px 4px ${e.colors.primary.main}`,transitionTimingFunction:"cubic-bezier(0.19, 1, 0.22, 1)",transitionDuration:"0.2s",transitionProperty:"outline, outline-offset, box-shadow",zIndex:2}}),filterIcon:(0,En.css)({color:e.colors.text.secondary,alignSelf:"center"})});function Ys(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function Zs(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){Ys(i,r,a,o,s,"next",e)}function s(e){Ys(i,r,a,o,s,"throw",e)}o(void 0)}))}}var Xs=Object.defineProperty,Js=Object.defineProperties,el=Object.getOwnPropertyDescriptors,tl=Object.getOwnPropertySymbols,nl=Object.prototype.hasOwnProperty,rl=Object.prototype.propertyIsEnumerable,al=(e,t,n)=>t in e?Xs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,il=(e,t)=>{for(var n in t||(t={}))nl.call(t,n)&&al(e,n,t[n]);if(tl)for(var n of tl(t))rl.call(t,n)&&al(e,n,t[n]);return e};const ol=[{value:"=",description:"Equals"},{value:"!=",description:"Not equal"},{value:"=|",description:"One of. Use to filter on multiple values.",isMulti:!0},{value:"!=|",description:"Not one of. Use to exclude multiple values.",isMulti:!0},{value:"=~",description:"Matches regex"},{value:"!~",description:"Does not match regex"},{value:"<",description:"Less than"},{value:">",description:"Greater than"}];class sl extends re{setState(e){let t=!1;e.filters&&e.filters!==this.state.filters&&!e.filterExpression&&(e.filterExpression=ll(this.state.expressionBuilder,e.filters),t=e.filterExpression!==this.state.filterExpression),super.setState(e),t&&this.publishEvent(new rt(this),!0)}updateFilters(e,t){let n,r=!1;e&&e!==this.state.filters&&(n=ll(this.state.expressionBuilder,e),r=n!==this.state.filterExpression),super.setState({filters:e,filterExpression:n}),(r&&!0!==(null==t?void 0:t.skipPublish)||(null==t?void 0:t.forcePublish))&&this.publishEvent(new rt(this),!0)}getValue(){return this.state.filterExpression}_updateFilter(e,t){const{filters:n,_wip:r}=this.state;if(e===r)return void("value"in t&&""!==t.value?this.setState({filters:[...n,il(il({},r),t)],_wip:void 0}):this.setState({_wip:il(il({},e),t)}));const a=this.state.filters.map((n=>n===e?il(il({},n),t):n));this.setState({filters:a})}_removeFilter(e){e!==this.state._wip?this.setState({filters:this.state.filters.filter((t=>t!==e))}):this.setState({_wip:void 0})}_removeLastFilter(){const e=this.state.filters.at(-1);e&&this._removeFilter(e)}_handleComboboxBackspace(e){if(this.state.filters.length){let t=this.state.filters.length-1;e!==this.state._wip&&(t=-1),this.setState({filters:this.state.filters.reduce(((n,r,a)=>{return a===t?[...n,(i=il({},r),o={forceEdit:!0},Js(i,el(o)))]:r===e?n:[...n,r];var i,o}),[])})}}_getKeys(e){var t=this;return Zs((function*(){var n,r,a;const i=yield null==(r=(n=t.state).getTagKeysProvider)?void 0:r.call(n,t,e);if(i&&i.replace)return eu(i.values).map(cl);if(t.state.defaultKeys)return t.state.defaultKeys.map(cl);const o=yield t._dataSourceSrv.get(t.state.datasource,t._scopedVars);if(!o||!o.getTagKeys)return[];const s=t.state.filters.filter((t=>t.key!==e)).concat(null!=(a=t.state.baseFilters)?a:[]),l=Hu.getTimeRange(t).state.value,u=t.state.useQueriesAsFilterForOptions?Kl(t):void 0,c=yield o.getTagKeys(il({filters:s,queries:u,timeRange:l},Wn(t)));tu(c)&&t.setState({error:c.error.message});let d=eu(c);i&&(d=d.concat(eu(i.values)));const p=t.state.tagKeyRegexFilter;return p&&(d=d.filter((e=>e.text.match(p)))),d.map(cl)}))()}_getValuesFor(e){var t=this;return Zs((function*(){var n,r,a;const i=yield null==(r=(n=t.state).getTagValuesProvider)?void 0:r.call(n,t,e);if(i&&i.replace)return eu(i.values).map(cl);const o=yield t._dataSourceSrv.get(t.state.datasource,t._scopedVars);if(!o||!o.getTagValues)return[];const s=t.state.filters.filter((t=>t.key!==e.key)).concat(null!=(a=t.state.baseFilters)?a:[]),l=Hu.getTimeRange(t).state.value,u=t.state.useQueriesAsFilterForOptions?Kl(t):void 0,c=yield o.getTagValues(il({key:e.key,filters:s,timeRange:l,queries:u},Wn(t)));tu(c)&&t.setState({error:c.error.message});let d=eu(c);return i&&(d=d.concat(eu(i.values))),d.map(cl)}))()}_addWip(){this.setState({_wip:{key:"",value:"",operator:"=",condition:""}})}_getOperators(){return(this.state.supportsMultiValueOperators?ol:ol.filter((e=>!e.isMulti))).map((({value:e,description:t})=>({label:e,value:e,description:t})))}constructor(e){var t,n;super(il({type:"adhoc",name:null!=(t=e.name)?t:"Filters",filters:[],datasource:null,applyMode:"auto",filterExpression:null!=(n=e.filterExpression)?n:ll(e.expressionBuilder,e.filters)},e)),this._scopedVars={__sceneObject:Kn(this)},this._dataSourceSrv=(0,d.getDataSourceSrv)(),this._urlSync=new xr(this),"auto"===this.state.applyMode&&function(e){if(e.addActivationHandler((()=>(wn.add(e),()=>wn.delete(e)))),vn)return;const t=(0,d.getTemplateSrv)();(null==t?void 0:t.getAdhocFilters)?(vn=t.getAdhocFilters,t.getAdhocFilters=function(e){var n;if(0===wn.size)return vn.call(t,e);const r=(0,d.getDataSourceSrv)().getInstanceSettings(e);if(!r)return[];for(const e of wn.values())if((null==(n=e.state.datasource)?void 0:n.uid)===r.uid)return e.state.filters;return[]}.bind(t)):console.log("Failed to patch getAdhocFilters")}(this)}}function ll(e,t){return(null!=e?e:Wl)(null!=t?t:[])}sl.Component=function({model:e}){const{filters:t,readOnly:n,addFilterButtonText:a}=e.useState(),i=(0,_n.useStyles2)(ul);return"combobox"===e.state.layout?r().createElement(Qs,{model:e}):r().createElement("div",{className:i.wrapper},t.map(((t,n)=>r().createElement(r().Fragment,{key:n},r().createElement(Or,{filter:t,model:e})))),!n&&r().createElement(_r,{model:e,key:"'builder",addFilterButtonText:a}))};const ul=e=>({wrapper:(0,En.css)({display:"flex",flexWrap:"wrap",alignItems:"flex-end",columnGap:e.spacing(2),rowGap:e.spacing(1)})});function cl(e){const{text:t,value:n}=e,r={label:t,value:String(null!=n?n:t)};return"group"in e&&(r.group=e.group),r}function dl(e){return""!==e.key&&""!==e.operator&&""!==e.value}function pl(e){const t=ol.find((t=>t.value===e));return!!t&&Boolean(t.isMulti)}class hl{getMergedStream(e){(function(e,t){if(e.length!==t.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!0;return!1})(e,this._prevLayers)&&(this._resultsMap=new Map,this._prevLayers=e);const t=e.map((e=>e.getResultsStream())),n=[];for(const t of e)n.push(t.activate());return(0,D.merge)(t).pipe((0,D.mergeAll)(),(0,D.filter)((e=>this._resultsMap.get(e.origin.state.key)!==e)),(0,D.map)((e=>(this._resultsMap.set(e.origin.state.key,e),this._resultsMap.values()))),(0,D.finalize)((()=>{n.forEach((e=>e()))})))}constructor(){this._resultsMap=new Map,this._prevLayers=[]}}function fl(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}var ml=Object.defineProperty,gl=Object.defineProperties,bl=Object.getOwnPropertyDescriptors,yl=Object.getOwnPropertySymbols,vl=Object.prototype.hasOwnProperty,wl=Object.prototype.propertyIsEnumerable,Ol=(e,t,n)=>t in e?ml(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Sl=(e,t)=>{for(var n in t||(t={}))vl.call(t,n)&&Ol(e,n,t[n]);if(yl)for(var n of yl(t))wl.call(t,n)&&Ol(e,n,t[n]);return e},_l=(e,t)=>gl(e,bl(t));let xl=100;function Pl(){return"SQR"+xl++}class Cl extends re{getResultsStream(){return this._results}_onActivate(){if(this.isQueryModeAuto()){const e=Hu.getTimeRange(this),t=this.getClosestExtraQueryProviders();for(const e of t)this._subs.add(e.subscribeToState(((t,n)=>{e.shouldRerun(n,t,this.state.queries)&&this.runQueries()})));this.subscribeToTimeRangeChanges(e),this.shouldRunQueriesOnActivate()&&this.runQueries()}return this._dataLayersSub||this._handleDataLayers(),()=>this._onDeactivate()}_handleDataLayers(){const e=Hu.getDataLayers(this);0!==e.length&&(this._dataLayersSub=this._dataLayersMerger.getMergedStream(e).subscribe(this._onLayersReceived.bind(this)))}_onLayersReceived(t){var n,r,a,i,o;const s=Hu.getTimeRange(this),{dataLayerFilter:l}=this.state;let u,c=[],d=[];for(const a of t)for(let t of a.data.series)(null==(n=t.meta)?void 0:n.dataTopic)===e.DataTopic.Annotations&&(c=c.concat(t)),(null==(r=t.meta)?void 0:r.dataTopic)===e.DataTopic.AlertStates&&(d=d.concat(t));if((null==l?void 0:l.panelId)&&(c.length>0&&(c=function(e,t){var n;if(!Array.isArray(e)||0===e.length)return e;const r=Array.from({length:e.length},(()=>new Set));let a=0;for(const i of e){for(let e=0;e<i.length;e++){if(r[a].has(e))continue;let o=!0;const s=i.fields.find((e=>"panelId"===e.name)),l=i.fields.find((e=>"source"===e.name));if(l){s&&"dashboard"===l.values[e].type&&(o=[t.panelId,bn].includes(s.values[e]));const r=l.values[e].filter;if(r){const e=[...null!=(n=r.ids)?n:[],bn].includes(t.panelId);r.exclude?e&&(o=!1):e||(o=!1)}}o&&r[a].add(e)}a++}const i=[];a=0;for(const t of e){const e=r[a].size,n=[];for(const e of t.fields){const i=[];for(let n=0;n<t.length;n++)r[a].has(n)&&i.push(e.values[n]);n.push(gn(mn({},e),{values:i}))}i.push(gn(mn({},t),{fields:n,length:e})),a++}return i}(c,l)),d.length>0))for(const t of d){const n=new e.DataFrameView(t);for(const e of n)if(e.panelId===l.panelId){u=e;break}}if(jl(c)&&jl(this._layerAnnotations)&&(0,ge.isEqual)(u,null==(a=this.state.data)?void 0:a.alertState))return;this._layerAnnotations=c;const p=this.state.data?this.state.data:_l(Sl({},ze),{timeRange:s.state.value});this.setState({data:_l(Sl({},p),{annotations:[...null!=(i=this._resultAnnotations)?i:[],...c],alertState:null!=u?u:null==(o=this.state.data)?void 0:o.alertState})})}onVariableUpdatesCompleted(){this.isQueryModeAuto()&&this.runQueries()}onAnyVariableChanged(e){this._adhocFiltersVar!==e&&this._groupByVar!==e&&this.isQueryModeAuto()&&(e instanceof sl&&this._isRelevantAutoVariable(e)&&this.runQueries(),e instanceof or&&this._isRelevantAutoVariable(e)&&this.runQueries())}_isRelevantAutoVariable(e){var t,n;const r=null!=(t=this.state.datasource)?t:El(this.state.queries);return"auto"===e.state.applyMode&&(null==r?void 0:r.uid)===(null==(n=e.state.datasource)?void 0:n.uid)}shouldRunQueriesOnActivate(){return this._variableValueRecorder.hasDependenciesChanged(this)?(Gt("SceneQueryRunner","Variable dependency changed while inactive, shouldRunQueriesOnActivate returns true"),!0):!this.state.data||!!this._isDataTimeRangeStale(this.state.data)}_isDataTimeRangeStale(e){const t=Hu.getTimeRange(this).state.value,n=e.timeRange;return(t.from.unix()!==n.from.unix()||t.to.unix()!==n.to.unix())&&(Gt("SceneQueryRunner","Data time range is stale"),!0)}_onDeactivate(){var e;this._querySub&&(this._querySub.unsubscribe(),this._querySub=void 0),this._dataLayersSub&&(this._dataLayersSub.unsubscribe(),this._dataLayersSub=void 0),null==(e=this._timeSub)||e.unsubscribe(),this._timeSub=void 0,this._timeSubRange=void 0,this._adhocFiltersVar=void 0,this._groupByVar=void 0,this._variableValueRecorder.recordCurrentDependencyValuesForSceneObject(this)}setContainerWidth(e){!this._containerWidth&&e>0?(this._containerWidth=e,this.state.maxDataPointsFromWidth&&!this.state.maxDataPoints&&setTimeout((()=>{this.isActive&&!this.state._hasFetchedData&&this.runQueries()}),0)):e>0&&(this._containerWidth=e)}isDataReadyToDisplay(){return Boolean(this.state._hasFetchedData)}subscribeToTimeRangeChanges(e){this._timeSubRange!==e&&(this._timeSub&&this._timeSub.unsubscribe(),this._timeSubRange=e,this._timeSub=e.subscribeToState((()=>{this.runWithTimeRange(e)})))}runQueries(){const e=Hu.getTimeRange(this);this.isQueryModeAuto()&&this.subscribeToTimeRangeChanges(e),this.runWithTimeRange(e)}getMaxDataPoints(){var e;return this.state.maxDataPoints?this.state.maxDataPoints:this.state.maxDataPointsFromWidth&&null!=(e=this._containerWidth)?e:500}cancelQuery(){var e;null==(e=this._querySub)||e.unsubscribe(),this._dataLayersSub&&(this._dataLayersSub.unsubscribe(),this._dataLayersSub=void 0),this.setState({data:_l(Sl({},this.state.data),{state:Ae.Done})})}runWithTimeRange(e){var t,n=this;return(t=function*(){var t,r,a;if(!n.state.maxDataPoints&&n.state.maxDataPointsFromWidth&&!n._containerWidth)return;if(n._dataLayersSub||n._handleDataLayers(),null==(t=n._querySub)||t.unsubscribe(),n._variableDependency.hasDependencyInLoadingState())return Gt("SceneQueryRunner","Variable dependency is in loading state, skipping query execution"),void n.setState({data:_l(Sl({},null!=(r=n.state.data)?r:ze),{state:Ae.Loading})});const{queries:i}=n.state;if(null==i?void 0:i.length)try{const t=null!=(a=n.state.datasource)?a:El(i),r=yield Kt(t,n._scopedVars);n.findAndSubscribeToAdHocFilters(r.uid);const o=(0,d.getRunRequest)(),{primary:s,secondaries:l,processors:u}=n.prepareRequests(e,r);Gt("SceneQueryRunner","Starting runRequest",n.state.key);let c=o(r,s);if(l.length>0){const e=l.map((e=>o(r,e))),t=(e=>t=>t.pipe((0,D.mergeMap)((([t,...n])=>{const r=n.flatMap((n=>{var r,a;return null!=(a=null==(r=e.get(n.request.requestId))?void 0:r(t,n))?a:(0,D.of)(n)}));return(0,D.forkJoin)([(0,D.of)(t),...r])})),(0,D.map)((([e,...t])=>{var n,r,a;return r=((e,t)=>{for(var n in t||(t={}))rn.call(t,n)&&on(e,n,t[n]);if(nn)for(var n of nn(t))an.call(t,n)&&on(e,n,t[n]);return e})({},e),a={series:[...e.series,...t.flatMap((e=>e.series))],annotations:[...null!=(n=e.annotations)?n:[],...t.flatMap((e=>{var t;return null!=(t=e.annotations)?t:[]}))]},en(r,tn(a))}))))(u);c=(0,D.forkJoin)([c,...e]).pipe(t)}c=c.pipe(On({type:"data",request:s,origin:n,cancel:()=>n.cancelQuery()})),n._querySub=c.subscribe(n.onDataReceived)}catch(e){console.error("PanelQueryRunner Error",e),n.onDataReceived(_l(Sl(Sl({},ze),n.state.data),{state:Ae.Error,errors:[(0,d.toDataQueryError)(e)]}))}else n._setNoDataState()},function(){var e=this,n=arguments;return new Promise((function(r,a){var i=t.apply(e,n);function o(e){fl(i,r,a,o,s,"next",e)}function s(e){fl(i,r,a,o,s,"throw",e)}o(void 0)}))})()}clone(e){var t;const n=super.clone(e);return this._resultAnnotations&&(n._resultAnnotations=this._resultAnnotations.map((e=>Sl({},e)))),this._layerAnnotations&&(n._layerAnnotations=this._layerAnnotations.map((e=>Sl({},e)))),n._variableValueRecorder=this._variableValueRecorder.cloneAndRecordCurrentValuesForSceneObject(this),n._containerWidth=this._containerWidth,n._results.next({origin:this,data:null!=(t=this.state.data)?t:ze}),n}prepareRequests(t,n){var r;const{minInterval:a,queries:i}=this.state;let o=Sl({app:"scenes",requestId:Pl(),timezone:t.getTimeZone(),range:t.state.value,interval:"1s",intervalMs:1e3,targets:(0,ge.cloneDeep)(i),maxDataPoints:this.getMaxDataPoints(),scopedVars:this._scopedVars,startTime:Date.now(),liveStreaming:this.state.liveStreaming,rangeRaw:{from:t.state.from,to:t.state.to},cacheTimeout:this.state.cacheTimeout,queryCachingTTL:this.state.queryCachingTTL},yn(this));this._adhocFiltersVar&&(o.filters=this._adhocFiltersVar.state.filters.filter(dl)),this._groupByVar&&(o.groupByKeys=this._groupByVar.state.value),o.targets=o.targets.map((e=>{var t;return e.datasource&&(e.datasource.uid===n.uid||(null==(t=n.meta)?void 0:t.mixed)||!d.isExpressionReference||(0,d.isExpressionReference)(e.datasource))||(e.datasource=n.getRef()),e}));const s=a?zu(this,a):n.interval,l=e.rangeUtil.calculateInterval(t.state.value,o.maxDataPoints,s);o.scopedVars=Object.assign({},o.scopedVars,{__interval:{text:l.interval,value:l.interval},__interval_ms:{text:l.intervalMs.toString(),value:l.intervalMs}}),o.interval=l.interval,o.intervalMs=l.intervalMs;const u=t.state.value;let c=[],p=new Map;for(const e of null!=(r=this.getClosestExtraQueryProviders())?r:[])for(const{req:t,processor:n}of e.getExtraQueries(o)){const e=Pl();c.push(_l(Sl({},t),{requestId:e})),p.set(e,null!=n?n:sn)}return o.range=u,{primary:o,secondaries:c,processors:p}}_combineDataLayers(e){return this._layerAnnotations&&this._layerAnnotations.length>0&&(e.annotations=(e.annotations||[]).concat(this._layerAnnotations)),this.state.data&&this.state.data.alertState&&(e.alertState=this.state.data.alertState),e}_setNoDataState(){this.state.data!==ze&&this.setState({data:ze})}getClosestExtraQueryProviders(){const e=new Map;return this.parent?(he(this.parent,(t=>(Xt(t)&&!e.has(t.constructor)&&e.set(t.constructor,t),t.forEachChild((t=>{Xt(t)&&!e.has(t.constructor)&&e.set(t.constructor,t)})),null))),Array.from(e.values())):[]}findAndSubscribeToAdHocFilters(e){const t=function(e){var t;for(const n of wn.values())if(zu(n,null==(t=n.state.datasource)?void 0:t.uid)===e)return n}(e);this._adhocFiltersVar!==t&&(this._adhocFiltersVar=t,this._updateExplicitVariableDependencies());const n=function(e){var t;for(const n of Sn.values())if(zu(n,null==(t=n.state.datasource)?void 0:t.uid)===e)return n}(e);this._groupByVar!==n&&(this._groupByVar=n,this._updateExplicitVariableDependencies())}_updateExplicitVariableDependencies(){const e=[];this._adhocFiltersVar&&e.push(this._adhocFiltersVar.state.name),this._groupByVar&&e.push(this._groupByVar.state.name),this._variableDependency.setVariableNames(e)}isQueryModeAuto(){var e;return"auto"===(null!=(e=this.state.runQueriesMode)?e:"auto")}constructor(t){super(t),this._dataLayersMerger=new hl,this._variableValueRecorder=new Zt,this._results=new D.ReplaySubject(1),this._scopedVars={__sceneObject:Kn(this)},this._variableDependency=new pu(this,{statePaths:["queries","datasource"],onVariableUpdateCompleted:this.onVariableUpdatesCompleted.bind(this),onAnyVariableChanged:this.onAnyVariableChanged.bind(this)}),this.onDataReceived=t=>{const n=(0,e.preProcessPanelData)(t,this.state.data);this._resultAnnotations=t.annotations;const r=this._combineDataLayers(n);let a=this.state._hasFetchedData;a||n.state===Ae.Loading||(a=!0),this.setState({data:r,_hasFetchedData:a}),this._results.next({origin:this,data:r})},this.addActivationHandler((()=>this._onActivate()))}}function El(e){var t,n;return null!=(n=null==(t=e.find((e=>null!==e.datasource)))?void 0:t.datasource)?n:void 0}function jl(e){if(!e)return!0;for(let t=0;t<e.length;t++)if(e[t].length>0)return!1;return!0}const Dl=new Intl.Collator("en",{numeric:!0,sensitivity:"base"}).compare,kl=1/0,Tl=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Rl="eexxaacctt",Al=/\p{P}/gu,Il=(e,t,n)=>e.replace("A-Z",t).replace("a-z",n),Ml={unicode:!1,alpha:null,interSplit:"[^A-Za-z\\d']+",intraSplit:"[a-z][A-Z]",interBound:"[^A-Za-z\\d]",intraBound:"[A-Za-z]\\d|\\d[A-Za-z]|[a-z][A-Z]",interLft:0,interRgt:0,interChars:".",interIns:kl,intraChars:"[a-z\\d']",intraIns:null,intraContr:"'[a-z]{1,2}\\b",intraMode:0,intraSlice:[1,kl],intraSub:null,intraTrn:null,intraDel:null,intraFilt:(e,t,n)=>!0,sort:(e,t,n)=>{let{idx:r,chars:a,terms:i,interLft2:o,interLft1:s,start:l,intraIns:u,interIns:c,cases:d}=e;return r.map(((e,t)=>t)).sort(((e,n)=>a[n]-a[e]||u[e]-u[n]||i[n]+o[n]+.5*s[n]-(i[e]+o[e]+.5*s[e])||c[e]-c[n]||l[e]-l[n]||d[n]-d[e]||Dl(t[r[e]],t[r[n]])))}},Vl=(e,t)=>0==t?"":1==t?e+"??":t==kl?e+"*?":e+`{0,${t}}?`,Fl="(?:\\b|_)";function Ll(e){e=Object.assign({},Ml,e);let{unicode:t,interLft:n,interRgt:r,intraMode:a,intraSlice:i,intraIns:o,intraSub:s,intraTrn:l,intraDel:u,intraContr:c,intraSplit:d,interSplit:p,intraBound:h,interBound:f,intraChars:m}=e;o??=a,s??=a,l??=a,u??=a;let g=e.letters??e.alpha;if(null!=g){let e=g.toLocaleUpperCase(),t=g.toLocaleLowerCase();p=Il(p,e,t),d=Il(d,e,t),f=Il(f,e,t),h=Il(h,e,t),m=Il(m,e,t),c=Il(c,e,t)}let b=t?"u":"";const y='".+?"',v=new RegExp(y,"gi"+b),w=new RegExp(`(?:\\s+|^)-(?:${m}+|${y})`,"gi"+b);let{intraRules:O}=e;null==O&&(O=e=>{let t=Ml.intraSlice,n=0,r=0,a=0,c=0;if(/[^\d]/.test(e)){let d=e.length;d<=4?d>=3&&(a=Math.min(l,1),4==d&&(n=Math.min(o,1))):(t=i,n=o,r=s,a=l,c=u)}return{intraSlice:t,intraIns:n,intraSub:r,intraTrn:a,intraDel:c}});let S=!!d,_=new RegExp(d,"g"+b),x=new RegExp(p,"g"+b),P=new RegExp("^"+p+"|"+p+"$","g"+b),C=new RegExp(c,"gi"+b);const E=(e,t=!1)=>{let n=[];e=(e=e.replace(v,(e=>(n.push(e),Rl)))).replace(P,""),t||(e=e.toLocaleLowerCase()),S&&(e=e.replace(_,(e=>e[0]+" "+e[1])));let r=0;return e.split(x).filter((e=>""!=e)).map((e=>e===Rl?n[r++]:e))},j=/[^\d]+|\d+/g,D=(t,i=0,s=!1)=>{let l=E(t);if(0==l.length)return[];let u,c=Array(l.length).fill("");if(l=l.map(((e,t)=>e.replace(C,(e=>(c[t]=e,""))))),1==a)u=l.map(((e,t)=>{if('"'===e[0])return Tl(e.slice(1,-1));let n="";for(let r of e.matchAll(j)){let e=r[0],{intraSlice:a,intraIns:i,intraSub:o,intraTrn:s,intraDel:l}=O(e);if(i+o+s+l==0)n+=e+c[t];else{let[r,u]=a,d=e.slice(0,r),p=e.slice(u),h=e.slice(r,u);1==i&&1==d.length&&d!=h[0]&&(d+="(?!"+d+")");let f=h.length,g=[e];if(o)for(let e=0;e<f;e++)g.push(d+h.slice(0,e)+m+h.slice(e+1)+p);if(s)for(let e=0;e<f-1;e++)h[e]!=h[e+1]&&g.push(d+h.slice(0,e)+h[e+1]+h[e]+h.slice(e+2)+p);if(l)for(let e=0;e<f;e++)g.push(d+h.slice(0,e+1)+"?"+h.slice(e+1)+p);if(i){let e=Vl(m,1);for(let t=0;t<f;t++)g.push(d+h.slice(0,t)+e+h.slice(t)+p)}n+="(?:"+g.join("|")+")"+c[t]}}return n}));else{let e=Vl(m,o);2==i&&o>0&&(e=")("+e+")("),u=l.map(((t,n)=>'"'===t[0]?Tl(t.slice(1,-1)):t.split("").map(((e,t,n)=>(1==o&&0==t&&n.length>1&&e!=n[t+1]&&(e+="(?!"+e+")"),e))).join(e)+c[n]))}let d=2==n?Fl:"",p=2==r?Fl:"",h=p+Vl(e.interChars,e.interIns)+d;return i>0?s?u=d+"("+u.join(")"+p+"|"+d+"(")+")"+p:(u="("+u.join(")("+h+")(")+")",u="(.??"+d+")"+u+"("+p+".*)"):(u=u.join(h),u=d+u+p),[new RegExp(u,"i"+b),l,c]},k=(e,t,n)=>{let[r]=D(t);if(null==r)return null;let a=[];if(null!=n)for(let t=0;t<n.length;t++){let i=n[t];r.test(e[i])&&a.push(i)}else for(let t=0;t<e.length;t++)r.test(e[t])&&a.push(t);return a};let T=!!h,R=new RegExp(f,b),A=new RegExp(h,b);const I=(t,a,i)=>{let[o,s,l]=D(i,1),u=E(i,!0),[c]=D(i,2),d=s.length,p=Array(d),h=Array(d);for(let e=0;e<d;e++){let t=s[e],n=u[e],r='"'==t[0]?t.slice(1,-1):t+l[e],a='"'==n[0]?n.slice(1,-1):n+l[e];p[e]=r,h[e]=a}let f=t.length,m=Array(f).fill(0),g={idx:Array(f),start:m.slice(),chars:m.slice(),cases:m.slice(),terms:m.slice(),interIns:m.slice(),intraIns:m.slice(),interLft2:m.slice(),interRgt2:m.slice(),interLft1:m.slice(),interRgt1:m.slice(),ranges:Array(f)},y=1==n||1==r,v=0;for(let i=0;i<t.length;i++){let s=a[t[i]],l=s.match(o),u=l.index+l[1].length,f=u,m=!1,w=0,O=0,S=0,_=0,x=0,P=0,C=0,E=0,j=0,D=[];for(let t=0,a=2;t<d;t++,a+=2){let i=l[a].toLocaleLowerCase(),o=p[t],c=h[t],g=o.length,v=i.length,k=i==o;if(l[a]==c&&C++,!k&&l[a+1].length>=g){let e=l[a+1].toLocaleLowerCase().indexOf(o);e>-1&&(D.push(f,v,e,g),f+=M(l,a,e,g),i=o,v=g,k=!0,0==t&&(u=f))}if(y||k){let e=f-1,c=f+v,d=!1,p=!1;if(-1==e||R.test(s[e]))k&&w++,d=!0;else{if(2==n){m=!0;break}if(T&&A.test(s[e]+s[e+1]))k&&O++,d=!0;else if(1==n){let e=l[a+1],n=f+v;if(e.length>=g){let r,c=0,p=!1,h=new RegExp(o,"ig"+b);for(;r=h.exec(e);){c=r.index;let e=n+c,t=e-1;if(-1==t||R.test(s[t])){w++,p=!0;break}if(A.test(s[t]+s[e])){O++,p=!0;break}}p&&(d=!0,D.push(f,v,c,g),f+=M(l,a,c,g),i=o,v=g,k=!0,0==t&&(u=f))}if(!d){m=!0;break}}}if(c==s.length||R.test(s[c]))k&&S++,p=!0;else{if(2==r){m=!0;break}if(T&&A.test(s[c-1]+s[c]))k&&_++,p=!0;else if(1==r){m=!0;break}}k&&(x+=g,d&&p&&P++)}if(v>g&&(j+=v-g),t>0&&(E+=l[a-1].length),!e.intraFilt(o,i,f)){m=!0;break}t<d-1&&(f+=v+l[a+1].length)}if(!m){g.idx[v]=t[i],g.interLft2[v]=w,g.interLft1[v]=O,g.interRgt2[v]=S,g.interRgt1[v]=_,g.chars[v]=x,g.terms[v]=P,g.cases[v]=C,g.interIns[v]=E,g.intraIns[v]=j,g.start[v]=u;let e=s.match(c),n=e.index+e[1].length,r=D.length,a=r>0?0:1/0,o=r-4;for(let t=2;t<e.length;){let r=e[t].length;if(a<=o&&D[a]==n){let r=D[a+1],i=D[a+2],o=D[a+3],s=t,l="";for(let t=0;t<r;s++)l+=e[s],t+=e[s].length;e.splice(t,s-t,l),n+=M(e,t,i,o),a+=4}else n+=r,t++}n=e.index+e[1].length;let l=g.ranges[v]=[],d=n,p=n;for(let t=2;t<e.length;t++){let r=e[t].length;n+=r,t%2==0?p=n:r>0&&(l.push(d,p),d=p=n)}p>d&&l.push(d,p),v++}}if(v<t.length)for(let e in g)g[e]=g[e].slice(0,v);return g},M=(e,t,n,r)=>{let a=e[t]+e[t+1].slice(0,n);return e[t-1]+=a,e[t]=e[t+1].slice(n,n+r),e[t+1]=e[t+1].slice(n+r),a.length};return{search:(...t)=>{let n=((t,n,r,a=1e3,i)=>{r=r?!0===r?5:r:0;let o=null,s=null,l=[];n=n.replace(w,(e=>{let t=e.trim().slice(1);return t='"'===t[0]?Tl(t.slice(1,-1)):t.replace(Al,""),""!=t&&l.push(t),""}));let u,c=E(n);if(l.length>0){if(u=new RegExp(l.join("|"),"i"+b),0==c.length){let e=[];for(let n=0;n<t.length;n++)u.test(t[n])||e.push(n);return[e,null,null]}}else if(0==c.length)return[null,null,null];if(r>0){let e=E(n);if(e.length>1){let n=e.slice().sort(((e,t)=>t.length-e.length));for(let e=0;e<n.length;e++){if(0==i?.length)return[[],null,null];i=k(t,n[e],i)}if(e.length>r)return[i,null,null];o=zl(e).map((e=>e.join(" "))),s=[];let a=new Set;for(let e=0;e<o.length;e++)if(a.size<i.length){let n=i.filter((e=>!a.has(e))),r=k(t,o[e],n);for(let e=0;e<r.length;e++)a.add(r[e]);s.push(r)}else s.push([])}}null==o&&(o=[n],s=[i?.length>0?i:k(t,n)]);let d=null,p=null;if(l.length>0&&(s=s.map((e=>e.filter((e=>!u.test(t[e])))))),s.reduce(((e,t)=>e+t.length),0)<=a){d={},p=[];for(let n=0;n<s.length;n++){let r=s[n];if(null==r||0==r.length)continue;let a=o[n],i=I(r,t,a),l=e.sort(i,t,a);if(n>0)for(let e=0;e<l.length;e++)l[e]+=p.length;for(let e in i)d[e]=(d[e]??[]).concat(i[e]);p=p.concat(l)}}return[[].concat(...s),d,p]})(...t);return n},split:E,filter:k,info:I,sort:e.sort}}const $l=(()=>{let e={A:"",a:"",E:"",e:"",I:"",i:"",O:"",o:"",U:"",u:"",C:"",c:"",L:"",l:"",N:"",n:"",S:"",s:"",Z:"",z:""},t=new Map,n="";for(let r in e)e[r].split("").forEach((e=>{n+=e,t.set(e,r)}));let r=new RegExp(`[${n}]`,"g"),a=e=>t.get(e);return e=>{if("string"==typeof e)return e.replace(r,a);let t=Array(e.length);for(let n=0;n<e.length;n++)t[n]=e[n].replace(r,a);return t}})();function zl(e){let t,n,r=(e=e.slice()).length,a=[e.slice()],i=new Array(r).fill(0),o=1;for(;o<r;)i[o]<o?(t=o%2&&i[o],n=e[o],e[o]=e[t],e[t]=n,++i[o],o=1,a.push(e.slice())):(i[o]=0,++o);return a}const Bl=(e,t)=>t?`<mark>${e}</mark>`:e,Nl=(e,t)=>e+t;function ql(e,t){return e===t||(0,ge.isEqual)(e,t)}function Hl(e){try{return JSON.stringify(e,(()=>{const e=new WeakSet;return(t,n)=>{if("object"==typeof n&&null!==n){if(e.has(n))return;e.add(n)}return n}})())}catch(e){console.error(e)}return""}function Wl(e){return e.map((e=>function(e){var t,n;let r="",a=e.operator;return"=|"===a?(a="=~",r=null==(t=e.values)?void 0:t.map(Gl).join("|")):"!=|"===a?(a="!~",r=null==(n=e.values)?void 0:n.map(Gl).join("|")):r="=~"===a||"!~"===a?Gl(e.value):Ul(e.value),`${e.key}${a}"${r}"`}(e))).join(",")}function Ul(e){return e.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function Gl(e){return Ul(e.replace(Ql,"\\$&"))}Ll.latinize=$l,Ll.permute=e=>zl([...Array(e.length).keys()]).sort(((e,t)=>{for(let n=0;n<e.length;n++)if(e[n]!=t[n])return e[n]-t[n];return 0})).map((t=>t.map((t=>e[t])))),Ll.highlight=function(e,t,n=Bl,r="",a=Nl){r=a(r,n(e.substring(0,t[0]),!1))??r;for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];r=a(r,n(e.substring(o,s),!0))??r,i<t.length-3&&(r=a(r,n(e.substring(t[i+1],t[i+2]),!1))??r)}return a(r,n(e.substring(t[t.length-1]),!1))??r};const Ql=/[*+?()|\\.\[\]{}^$]/g;function Kl(e){var t;const n=Hu.findAllObjects(e.getRoot(),(e=>e instanceof Cl)),r=Hu.interpolate(e,null==(t=e.state.datasource)?void 0:t.uid),a=function(e){const t={};for(const n of e)n.state.key&&(n.state.key in t||(t[n.state.key]=[]),t[n.state.key].push(n));return Object.values(t).flatMap((e=>{const t=e.filter((e=>e.isActive));return 0===t.length&&1===e.length?e:t}))}(n).filter((t=>{var n;return Hu.interpolate(e,null==(n=t.state.datasource)?void 0:n.uid)===r}));if(0===a.length)return[];const i=[];return a.forEach((e=>{i.push(...e.state.queries)})),i}function Yl(e){return null==e?"":/\|/g[Symbol.replace](e,"__gfp__")}function Zl(e){return null==e?"":/,/g[Symbol.replace](e,"__gfc__")}function Xl(e){return null==e?"":(e=/__gfp__/g[Symbol.replace](e,"|"),e=/__gfc__/g[Symbol.replace](e,","))}function Jl(e,t){return t&&e!==t?[e,t].map(Zl).join(","):Zl(e)}function eu(e){return Array.isArray(e)?e:e.data}function tu(e){return!Array.isArray(e)&&Boolean(e.error)}function nu(e){const t=[],n=new Map;for(const r of e){const e=r.group;if(e){let a=n.get(e);a||(a=[],n.set(e,a),t.push({label:e,options:a})),a.push(r)}else t.push(r)}return t}function ru(e,t=1e4){const n=new Ll,r=Array.from({length:Math.min(t,e.length)},((e,t)=>t));return a=>{if(""===a)return r;const[i,o,s]=n.search(e,a);if(i){if(o&&s){const e=Array(Math.min(s.length,t));for(let t=0;t<e.length;t++)e[t]=o.idx[s[t]];return e}return i.slice(0,t)}return[]}}var au=Object.defineProperty,iu=Object.defineProperties,ou=Object.getOwnPropertyDescriptors,su=Object.getOwnPropertySymbols,lu=Object.prototype.hasOwnProperty,uu=Object.prototype.propertyIsEnumerable,cu=(e,t,n)=>t in e?au(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class du extends re{getValue(){return this.state.value}constructor(e){var t;super((t=((e,t)=>{for(var n in t||(t={}))lu.call(t,n)&&cu(e,n,t[n]);if(su)for(var n of su(t))uu.call(t,n)&&cu(e,n,t[n]);return e})({type:"constant",value:"",name:""},e),iu(t,ou({skipUrlSync:!0}))))}}class pu{hasDependencyOn(e){return this.getNames().has(e)}variableUpdateCompleted(t,n){const r=this.getNames();let a=!1;(r.has(t.state.name)||r.has(e.DataLinkBuiltInVars.includeVars))&&n&&(a=!0),Gt("VariableDependencyConfig","variableUpdateCompleted",t.state.name,a,this._isWaitingForVariables),this._options.onAnyVariableChanged&&this._options.onAnyVariableChanged(t),this._options.onVariableUpdateCompleted&&(this._isWaitingForVariables||a)&&this._options.onVariableUpdateCompleted(),a&&(this._options.onReferencedVariableValueChanged&&this._options.onReferencedVariableValueChanged(t),this._options.onReferencedVariableValueChanged||this._options.onVariableUpdateCompleted||this._sceneObject.forceRender())}hasDependencyInLoadingState(){return Hu.hasVariableDependencyInLoadingState(this._sceneObject)?(this._isWaitingForVariables=!0,!0):(this._isWaitingForVariables=!1,!1)}getNames(){const e=this._state,t=this._state=this._sceneObject.state;if(!e)return this.scanStateForDependencies(this._state),this._dependencies;if(t!==e)if(this._statePaths){for(const n of this._statePaths)if("*"===n||t[n]!==e[n]){this.scanStateForDependencies(t);break}}else this.scanStateForDependencies(t);return this._dependencies}setVariableNames(e){this._options.variableNames=e,this.scanStateForDependencies(this._state)}setPaths(e){this._statePaths=e}scanStateForDependencies(e){if(this._dependencies.clear(),this.scanCount+=1,this._options.variableNames)for(const e of this._options.variableNames)this._dependencies.add(e);if(this._statePaths)for(const t of this._statePaths){if("*"===t){this.extractVariablesFrom(e);break}{const n=e[t];n&&this.extractVariablesFrom(n)}}}extractVariablesFrom(e){wt.lastIndex=0;const t=("string"!=typeof e?Hl(e):e).matchAll(wt);if(t)for(const e of t){const[,t,n,,r]=e,a=t||n||r;this._dependencies.add(a)}}handleTimeMacros(){this._sceneObject.addActivationHandler((()=>{const e=Hu.getTimeRange(this._sceneObject).subscribeToState(((e,t)=>{const n=this.getNames(),r=n.has("__from"),a=n.has("__to"),i=n.has("__timezone");if(e.value!==t.value)if(r){const t=new du({name:"__from",value:e.from});this.variableUpdateCompleted(t,!0)}else if(a){const t=new du({name:"__to",value:e.to});this.variableUpdateCompleted(t,!0)}if(e.timeZone!==t.timeZone&&i){const t=new du({name:"__timezone",value:e.timeZone});this.variableUpdateCompleted(t,!0)}}));return()=>e.unsubscribe()}))}constructor(e,t){this._sceneObject=e,this._options=t,this._dependencies=new Set,this._isWaitingForVariables=!1,this.scanCount=0,this._statePaths=t.statePaths,this._options.handleTimeMacros&&this.handleTimeMacros()}}const hu=e=>Boolean(e.metricFindQuery)&&!Boolean(e.variables),fu=t=>{if(!t.variables)return!1;if(t.variables.getType()!==e.VariableSupportType.Standard)return!1;const n=t.variables;return"toDataQuery"in n&&Boolean(n.toDataQuery)},mu=t=>{if(!t.variables)return!1;if(t.variables.getType()!==e.VariableSupportType.Custom)return!1;const n=t.variables;return"query"in n&&"editor"in n&&Boolean(n.query)&&Boolean(n.editor)},gu=t=>!!t.variables&&t.variables.getType()===e.VariableSupportType.Datasource;var bu=Object.defineProperty,yu=Object.defineProperties,vu=Object.getOwnPropertyDescriptors,wu=Object.getOwnPropertySymbols,Ou=Object.prototype.hasOwnProperty,Su=Object.prototype.propertyIsEnumerable,_u=(e,t,n)=>t in e?bu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,xu=(e,t)=>{for(var n in t||(t={}))Ou.call(t,n)&&_u(e,n,t[n]);if(wu)for(var n of wu(t))Su.call(t,n)&&_u(e,n,t[n]);return e},Pu=(e,t)=>yu(e,vu(t));class Cu{getTarget(e){if(fu(this.datasource))return this.datasource.variables.toDataQuery(function(e){var t;const n=null!=(t=e.state.query)?t:"";return"string"==typeof n?{query:n,refId:`variable-${e.state.name}`}:null==n.refId?Pu(xu({},n),{refId:`variable-${e.state.name}`}):e.state.query}(e));throw new Error("Couldn't create a target with supplied arguments.")}runRequest(e,t){return fu(this.datasource)?this.datasource.variables.query?this._runRequest(this.datasource,t,this.datasource.variables.query.bind(this.datasource.variables)):this._runRequest(this.datasource,t):ku()}constructor(e,t=(0,d.getRunRequest)()){this.datasource=e,this._runRequest=t}}class Eu{getTarget(e){if(hu(this.datasource))return e.state.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({variable:t,searchFilter:n},r){return hu(this.datasource)?(0,D.from)(this.datasource.metricFindQuery(t.state.query,Pu(xu({},r),{variable:{name:t.state.name,type:t.state.type},searchFilter:n}))).pipe((0,D.mergeMap)((t=>{if(!t||!t.length)return ku();const n=t;return(0,D.of)({series:n,state:e.LoadingState.Done,timeRange:r.range})}))):ku()}constructor(e){this.datasource=e}}class ju{getTarget(e){if(mu(this.datasource))return e.state.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest(e,t){return mu(this.datasource)?this.datasource.variables.query?this._runRequest(this.datasource,t,this.datasource.variables.query.bind(this.datasource.variables)):this._runRequest(this.datasource,t):ku()}constructor(e,t=(0,d.getRunRequest)()){this.datasource=e,this._runRequest=t}}class Du{getTarget(e){var t;if(gu(this.datasource))return"string"==typeof e.state.query?e.state.query:Pu(xu({},e.state.query),{refId:null!=(t=e.state.query.refId)?t:"variable-query"});throw new Error("Couldn't create a target with supplied arguments.")}runRequest(e,t){return gu(this.datasource)?this._runRequest(this.datasource,t,this.datasource.query):ku()}constructor(e,t=(0,d.getRunRequest)()){this.datasource=e,this._runRequest=t}}function ku(){return(0,D.of)({state:e.LoadingState.Done,series:[],timeRange:(0,e.getDefaultTimeRange)()})}const Tu=(e,t)=>{const n=[];let r=null;t.lastIndex=0;do{r=t.exec(e),r&&n.push(r)}while(t.global&&r&&""!==r[0]&&void 0!==r[0]);return n};function Ru(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}var Au=Object.defineProperty,Iu=Object.getOwnPropertySymbols,Mu=Object.prototype.hasOwnProperty,Vu=Object.prototype.propertyIsEnumerable,Fu=(e,t,n)=>t in e?Au(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Lu extends Ct{getValueOptions(t){return this.state.query?(this.setState({loading:!0,error:null}),(0,D.from)(Kt(this.state.datasource,{__sceneObject:Kn(this)})).pipe((0,D.mergeMap)((n=>{const r=function(e){if(fu(e))return new Cu(e,(0,d.getRunRequest)());if(hu(e))return new Eu(e);if(mu(e))return new ju(e);if(gu(e))return new Du(e);throw new Error(`Couldn't create a query runner for datasource ${e.type}`)}(n),a=r.getTarget(this),i=this.getRequest(a,t.searchFilter);return r.runRequest({variable:this,searchFilter:t.searchFilter},i).pipe(On({type:"variable",request:i,origin:this}),(0,D.filter)((t=>t.state===e.LoadingState.Done||t.state===e.LoadingState.Error)),(0,D.take)(1),(0,D.mergeMap)((t=>t.state===e.LoadingState.Error?(0,D.throwError)((()=>t.error)):(0,D.of)(t))),(t=>t.pipe((0,D.map)((t=>{const n=t.series;if(!n||!n.length)return[];if(function(t){if(!t)return!1;if(!t.length)return!0;const n=t[0];if((0,e.isDataFrame)(n))return!1;for(const e in n){if(!n.hasOwnProperty(e))continue;if(null!==n[e]&&"string"!=typeof n[e]&&"number"!=typeof n[e])continue;const t=e.toLowerCase();if("text"===t||"value"===t)return!0}return!1}(n))return n;if(0===n[0].fields.length)return[];const r=(0,e.getProcessedDataFrames)(n),a=[];let i=-1,o=-1,s=-1,l=-1;for(const t of r)for(let r=0;r<t.fields.length;r++){const a=t.fields[r],u=(0,e.getFieldDisplayName)(a,t,n).toLowerCase();a.type===e.FieldType.string&&-1===s&&(s=r),"text"===u&&a.type===e.FieldType.string&&-1===o&&(o=r),"value"===u&&a.type===e.FieldType.string&&-1===i&&(i=r),"expandable"!==u||a.type!==e.FieldType.boolean&&a.type!==e.FieldType.number||-1!==l||(l=r)}if(-1===s)throw new Error("Couldn't find any field of type string in the results.");for(const e of n)for(let t=0;t<e.length;t++){const n=-1!==l?e.fields[l].values.get(t):void 0,r=e.fields[s].values.get(t),u=-1!==o?e.fields[o].values.get(t):"",c=-1!==i?e.fields[i].values.get(t):"";-1!==i||-1!==o?-1!==i||-1===o?-1===i||-1!==o?a.push({text:u,value:c,expandable:n}):a.push({text:c,value:c,expandable:n}):a.push({text:u,value:u,expandable:n}):a.push({text:r,value:r,expandable:n})}return a})))),(0,D.mergeMap)((t=>{let n="";return this.state.regex&&(n=Hu.interpolate(this,this.state.regex,void 0,"regex")),(0,D.of)(function(t,n,r){var a,i,o,s,l,u,c,d,p,h;let f,m=[];t&&(f=(0,e.stringToJsRegex)(t));for(let e=0;e<r.length;e++){const t=r[e];let n=null!=(i=null!=(a=t.text)?a:t.value)?i:"",g=null!=(s=null!=(o=t.value)?o:t.text)?s:"";if((0,ge.isNumber)(g)&&(g=g.toString()),(0,ge.isNumber)(n)&&(n=n.toString()),f){const e=Tu(g,f);if(!e.length)continue;const t=e.find((e=>e.groups&&e.groups.value)),r=e.find((e=>e.groups&&e.groups.text)),a=e.find((e=>e.length>1)),i=e.length>1&&a;if(t||r)g=null!=(c=null==(l=null==t?void 0:t.groups)?void 0:l.value)?c:null==(u=null==r?void 0:r.groups)?void 0:u.text,n=null!=(h=null==(d=null==r?void 0:r.groups)?void 0:d.text)?h:null==(p=null==t?void 0:t.groups)?void 0:p.value;else{if(i){for(let t=0;t<e.length;t++){const n=e[t];m.push({label:n[1],value:n[1]})}continue}a&&(n=a[1],g=a[1])}}m.push({label:n,value:g})}return m=(0,ge.uniqBy)(m,"value"),((t,n)=>{if(n===e.VariableSort.disabled)return t;const r=e=>{if(!e.text)return-1;const t=e.text.match(/.*?(\d+).*/);return!t||t.length<2?-1:parseInt(t[1],10)},a=e=>e.sort(((e,t)=>e.text?t.text?e.text.localeCompare(t.text,void 0,{numeric:!0}):1:-1));switch(n){case e.VariableSort.alphabeticalAsc:t=(0,ge.sortBy)(t,"label");break;case e.VariableSort.alphabeticalDesc:t=(0,ge.sortBy)(t,"label").reverse();break;case e.VariableSort.numericalAsc:t=(0,ge.sortBy)(t,r);break;case e.VariableSort.numericalDesc:t=(t=(0,ge.sortBy)(t,r)).reverse();break;case e.VariableSort.alphabeticalCaseInsensitiveAsc:t=(0,ge.sortBy)(t,(e=>(0,ge.toLower)(e.label)));break;case e.VariableSort.alphabeticalCaseInsensitiveDesc:t=(t=(0,ge.sortBy)(t,(e=>(0,ge.toLower)(e.label)))).reverse();break;case e.VariableSort.naturalAsc||7:t=a(t);break;case e.VariableSort.naturalDesc||8:t=(t=a(t)).reverse()}return t})(m,n)}(n,this.state.sort,t))})),(0,D.catchError)((e=>e.cancelled?(0,D.of)([]):(0,D.throwError)((()=>e)))))})))):(0,D.of)([])}getRequest(t,n){const r={__sceneObject:Kn(this)};n&&(r.__searchFilter={value:n,text:n});const a=Hu.getTimeRange(this).state.value;return{app:e.CoreApp.Dashboard,requestId:M(),timezone:"",range:a,interval:"",intervalMs:0,targets:[t],scopedVars:r,startTime:Date.now()}}constructor(t){super(((e,t)=>{for(var n in t||(t={}))Mu.call(t,n)&&Fu(e,n,t[n]);if(Iu)for(var n of Iu(t))Vu.call(t,n)&&Fu(e,n,t[n]);return e})({type:"query",name:"",value:"",text:"",options:[],datasource:null,regex:"",query:"",refresh:e.VariableRefresh.onDashboardLoad,sort:e.VariableSort.disabled},t)),this._variableDependency=new pu(this,{statePaths:["regex","query","datasource"]}),this.onSearchChange=e=>{Hl(this.state.query).indexOf("__searchFilter")>-1&&this._updateOptionsBasedOnSearchFilter(e)};var n=this;this._updateOptionsBasedOnSearchFilter=(0,ge.debounce)(function(){var e,t=(e=function*(e){const t=yield(0,D.lastValueFrom)(n.getValueOptions({searchFilter:e}));n.setState({options:t,loading:!1})},function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){Ru(i,r,a,o,s,"next",e)}function s(e){Ru(i,r,a,o,s,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}(),400)}}function $u(e){var t;return null!=(t=he(e,(e=>e.state.$data)))?t:Je}function zu(e,t,n,r,a){return""===t||null==t?"":zt(e,t,n,r,a)}function Bu(e,t,n,r){if(t(e))return e;let a=null;return e.forEachChild((e=>{if(e===n)return;let r=Bu(e,t);r&&(a=r)})),a||(r&&e.parent?Bu(e.parent,t,e,!0):null)}function Nu(e,t){return Bu(e,t,void 0,!0)}function qu(e,t){const n=[];return e.forEachChild((e=>{t(e)&&n.push(e),n.push(...qu(e,t))})),n}Lu.Component=({model:e})=>qn(e);const Hu={getVariables:function(e){var t;return null!=(t=he(e,(e=>e.state.$variables)))?t:tt},getData:$u,getTimeRange:nt,getLayout:function(e){return he(e,(e=>function(e){return"isDraggable"in e}(e)?e:void 0))||null},getDataLayers:function(e,t=!1){let n=e,r=[];for(;n;){const e=n.state.$data;if(e){if(qt(e)?r=r.concat(e):e.state.$data&&qt(e.state.$data)&&(r=r.concat(e.state.$data)),t&&r.length>0)break;n=n.parent}else n=n.parent}return r},interpolate:zu,lookupVariable:be,hasVariableDependencyInLoadingState:function(e){if(!e.variableDependency)return!1;for(const t of e.variableDependency.getNames()){if(e instanceof Lu&&e.state.name===t){console.warn("Query variable is referencing itself");continue}const n=be(t,e);if(n&&n.parent.isVariableLoadingOrWaitingToUpdate(n))return!0}return!1},findByKey:function(e,t){const n=Nu(e,(e=>e.state.key===t));if(!n)throw new Error("Unable to find scene with key "+t);return n},findByKeyAndType:function(e,t,n){const r=Nu(e,(e=>e.state.key===t));if(!r)throw new Error("Unable to find scene with key "+t);if(!(r instanceof n))throw new Error(`Found scene object with key ${t} does not match type ${n.name}`);return r},findObject:Nu,findAllObjects:qu,getAncestor:function(e,t){let n=e;for(;n;){if(n instanceof t)return n;n=n.parent}if(!n)throw new Error("Unable to find parent of type "+t.name);return n},findDescendents:function(e,t){function n(e){return e instanceof t}return qu(e,n).filter(n)},getQueryController:function(e){let t=e;for(;t;){if(t.state.$behaviors)for(const e of t.state.$behaviors)if("isQueryController"in e)return e;t=t.parent}},getUrlSyncManager:function(e){let t=e;for(;t;){if("urlSyncManager"in t.state)return t.state.urlSyncManager;t=t.parent}}};class Wu{getUniqueKey(e,t){const n=this.index.get(e);if(!n)return this.index.set(e,[t]),e;let r=n.findIndex((e=>e===t));return-1===r&&(function(e){for(const t of e)if(Uu(t)){const n=e.indexOf(t);e.splice(n,1)}}(n),n.push(t),r=n.length-1),r>0?`${e}-${r+1}`:e}clear(){this.index.clear()}constructor(){this.index=new Map}}function Uu(e){const t=e.getRoot();return!Hu.findObject(t,(t=>t===e))}function Gu(e){const t=new Wu,n={},r=e=>{if(e.urlSync){const r=e.urlSync.getUrlState();for(const[a,i]of Object.entries(r))if(null!=i){const r=t.getUniqueKey(a,e);n[r]=i}}e.forEachChild(r)};return r(e),n}function Qu(e,t,n,r){r||Ku(e,t,n),e.forEachChild((e=>{Ku(e,t,n)})),e.forEachChild((e=>Qu(e,t,n,!0)))}function Ku(e,t,n){if(e.urlSync){const r={},a=e.urlSync.getUrlState();for(const i of e.urlSync.getKeys()){const o=n.getUniqueKey(i,e),s=t.getAll(o),l=a[i];Yu(s,l)||(s.length>0?Array.isArray(l)?r[i]=s:r[i]=s[0]:r[i]=null)}Object.keys(r).length>0&&e.urlSync.updateFromUrl(r)}}function Yu(e,t){return 0===e.length&&null==t||(Array.isArray(t)||1!==(null==e?void 0:e.length)?0===(null==t?void 0:t.length)&&null===e||(0,ge.isEqual)(e,t):t===e[0])}class Zu extends re{_onVariableChanged(e){const t=this.state.onChange;this._runningEffect&&(this._runningEffect(),this._runningEffect=null);const n=t(e,this);n&&(this._runningEffect=n)}constructor(){super(...arguments),this._runningEffect=null,this._variableDependency=new pu(this,{variableNames:[this.state.variableName],onReferencedVariableValueChanged:this._onVariableChanged.bind(this)})}}var Xu=(e=>(e[e.never=0]="never",e[e.onDashboardLoad=1]="onDashboardLoad",e[e.onTimeRangeChanged=2]="onTimeRangeChanged",e))(Xu||{}),Ju=(e=>(e[e.alphabeticalAsc=1]="alphabeticalAsc",e[e.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",e[e.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",e[e.alphabeticalDesc=2]="alphabeticalDesc",e[e.disabled=0]="disabled",e[e.naturalAsc=7]="naturalAsc",e[e.naturalDesc=8]="naturalDesc",e[e.numericalAsc=3]="numericalAsc",e[e.numericalDesc=4]="numericalDesc",e))(Ju||{}),ec=(e=>(e.ContinuousBlPu="continuous-BlPu",e.ContinuousBlYlRd="continuous-BlYlRd",e.ContinuousBlues="continuous-blues",e.ContinuousGrYlRd="continuous-GrYlRd",e.ContinuousGreens="continuous-greens",e.ContinuousPurples="continuous-purples",e.ContinuousRdYlGr="continuous-RdYlGr",e.ContinuousReds="continuous-reds",e.ContinuousYlBl="continuous-YlBl",e.ContinuousYlRd="continuous-YlRd",e.Fixed="fixed",e.PaletteClassic="palette-classic",e.PaletteClassicByName="palette-classic-by-name",e.Shades="shades",e.Thresholds="thresholds",e))(ec||{}),tc=(e=>(e[e.Crosshair=1]="Crosshair",e[e.Off=0]="Off",e[e.Tooltip=2]="Tooltip",e))(tc||{}),nc=Object.defineProperty,rc=Object.defineProperties,ac=Object.getOwnPropertyDescriptors,ic=Object.getOwnPropertySymbols,oc=Object.prototype.hasOwnProperty,sc=Object.prototype.propertyIsEnumerable,lc=(e,t,n)=>t in e?nc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class uc extends re{getEventsScope(){if(!this.parent)throw new Error("EnableCursorSync cannot be used as a standalone scene object");return this.state.key}constructor(e){var t,n;super((t=((e,t)=>{for(var n in t||(t={}))oc.call(t,n)&&lc(e,n,t[n]);if(ic)for(var n of ic(t))sc.call(t,n)&&lc(e,n,t[n]);return e})({},e),n={sync:e.sync||tc.Off},rc(t,ac(n)))),this.getEventsBus=e=>{if(!this.parent)throw new Error("EnableCursorSync cannot be used as a standalone scene object");return new cc(this.parent,e)}}}class cc{publish(e){e.origin=this,this._eventsOrigin.publishEvent(e,!0)}getStream(e){return new D.Observable((t=>{const n=this._source.subscribeToEvent(e,(e=>{t.next(e)}));return()=>n.unsubscribe()}))}subscribe(e,t){return this.getStream(e).pipe().subscribe(t)}removeAllListeners(){}newScopedBus(e,t){throw new Error("For internal use only")}constructor(e,t){this._source=e,this._eventsOrigin=t}}var dc=function(){},pc="undefined"!=typeof window;const hc=pc?t.useLayoutEffect:t.useEffect;var fc={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};const mc=pc&&void 0!==window.ResizeObserver?function(){var e=(0,t.useState)(null),n=e[0],r=e[1],a=(0,t.useState)(fc),i=a[0],o=a[1],s=(0,t.useMemo)((function(){return new window.ResizeObserver((function(e){if(e[0]){var t=e[0].contentRect,n=t.x,r=t.y,a=t.width,i=t.height,s=t.top,l=t.left,u=t.bottom,c=t.right;o({x:n,y:r,width:a,height:i,top:s,left:l,bottom:u,right:c})}}))}),[]);return hc((function(){if(n)return s.observe(n),function(){s.disconnect()}}),[n]),[r,i]}:function(){return[dc,fc]};function gc({data:e,showAll:t,seriesLimit:n,onShowAllSeries:a}){const i=(0,_n.useStyles2)(bc),o=null==e?void 0:e.series.length;if(void 0===o||o<n)return null;const s=t?"Restore limit":`Show all ${o}`;return r().createElement("div",{className:i.timeSeriesDisclaimer},!t&&r().createElement("span",{className:i.warningMessage},r().createElement(_n.Icon,{title:`Showing only ${n} series`,name:"exclamation-triangle","aria-hidden":"true"})),r().createElement(_n.Tooltip,{content:"Rendering too many series in a single panel may impact performance and make data harder to read."},r().createElement(_n.Button,{variant:"secondary",size:"sm",onClick:a},s)))}const bc=e=>({timeSeriesDisclaimer:(0,En.css)({label:"time-series-disclaimer",display:"flex",alignItems:"center",gap:e.spacing(1)}),warningMessage:(0,En.css)({display:"flex",alignItems:"center",gap:e.spacing(.5),color:e.colors.warning.main,fontSize:e.typography.bodySmall.fontSize})});var yc=Object.defineProperty,vc=Object.defineProperties,wc=Object.getOwnPropertyDescriptors,Oc=Object.getOwnPropertySymbols,Sc=Object.prototype.hasOwnProperty,_c=Object.prototype.propertyIsEnumerable,xc=(e,t,n)=>t in e?yc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Pc=(e,t)=>{for(var n in t||(t={}))Sc.call(t,n)&&xc(e,n,t[n]);if(Oc)for(var n of Oc(t))_c.call(t,n)&&xc(e,n,t[n]);return e};const Cc=(e,t,n,r,a,i,o,s)=>{const l={dashboardUId:e,dashboardTitle:t,panelTitle:n,panelId:r,expressionData:a,dashboardTime:i,rangeDurationMs:o,unit:s};var u;u={type:"message",payload:{source:"oodle-grafana",eventType:"sendQuery",value:JSON.parse(JSON.stringify(l))}},window.parent.postMessage(u,"*")};function Ec(e,t){if(t)return t;let n=e.error?e.error.message:void 0;return e.errors&&(n=e.errors.map((e=>e.message)).join(", ")),n}const jc=(0,En.css)({position:"relative",width:"100%",height:"100%"}),Dc=(0,En.css)({position:"absolute",width:"100%",height:"100%"}),kc=e=>({ok:(0,En.css)({color:e.colors.success.text}),pending:(0,En.css)({color:e.colors.warning.text}),alerting:(0,En.css)({color:e.colors.error.text})});var Tc=Object.defineProperty,Rc=Object.defineProperties,Ac=Object.getOwnPropertyDescriptors,Ic=Object.getOwnPropertySymbols,Mc=Object.prototype.hasOwnProperty,Vc=Object.prototype.propertyIsEnumerable,Fc=(e,t,n)=>t in e?Tc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Lc=(e,t)=>{for(var n in t||(t={}))Mc.call(t,n)&&Fc(e,n,t[n]);if(Ic)for(var n of Ic(t))Vc.call(t,n)&&Fc(e,n,t[n]);return e},$c=(e,t)=>Rc(e,Ac(t));const zc="hideSeriesFrom",Bc=(0,e.isSystemOverrideWithRef)(zc);function Nc(t,n=e.ByNamesMatcherMode.exclude,r){return r=null!=r?r:{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:zc,matcher:{id:e.FieldMatcherID.byNames,options:{mode:n,names:t,prefix:n===e.ByNamesMatcherMode.exclude?"All except:":void 0,readOnly:!0}},properties:[$c(Lc({},r),{value:{viz:!0,legend:!1,tooltip:!1}})]}}const qc=e=>{var t;const n=null==(t=e.matcher.options)?void 0:t.names;return Array.isArray(n)?[...n]:[]},Hc=(t,n)=>{const r=new Set;for(const a of t)for(const i of a.fields){if(i.type!==e.FieldType.number)continue;const o=(0,e.getFieldDisplayName)(i,a,t);o!==n&&r.add(o)}return Array.from(r)},Wc=(t,n)=>{var r;let a=[];for(const i of t){const t=i.properties.find((e=>"custom.hideFrom"===e.id));if(void 0!==t&&!0===(null==(r=t.value)?void 0:r.legend)){const t=e.fieldMatchers.get(i.matcher.id).get(i.matcher.options);for(const r of n)for(const i of r.fields){if(i.type!==e.FieldType.number)continue;const o=(0,e.getFieldDisplayName)(i,r,n);t(i,r,n)&&a.push(o)}}}return a};var Uc=Object.defineProperty,Gc=Object.defineProperties,Qc=Object.getOwnPropertyDescriptors,Kc=Object.getOwnPropertySymbols,Yc=Object.prototype.hasOwnProperty,Zc=Object.prototype.propertyIsEnumerable,Xc=(e,t,n)=>t in e?Uc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Jc=(e,t)=>{for(var n in t||(t={}))Yc.call(t,n)&&Xc(e,n,t[n]);if(Kc)for(var n of Kc(t))Zc.call(t,n)&&Xc(e,n,t[n]);return e},ed=(e,t)=>Gc(e,Qc(t));const td=(t,n)=>({matcher:{id:e.FieldMatcherID.byName,options:t},properties:[nd(n)]}),nd=t=>({id:"color",value:{mode:e.FieldColorModeId.Fixed,fixedColor:t}});function rd(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function ad(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){rd(i,r,a,o,s,"next",e)}function s(e){rd(i,r,a,o,s,"throw",e)}o(void 0)}))}}var id=Object.defineProperty,od=Object.defineProperties,sd=Object.getOwnPropertyDescriptors,ld=Object.getOwnPropertySymbols,ud=Object.prototype.hasOwnProperty,cd=Object.prototype.propertyIsEnumerable,dd=(e,t,n)=>t in e?id(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,pd=(e,t)=>{for(var n in t||(t={}))ud.call(t,n)&&dd(e,n,t[n]);if(ld)for(var n of ld(t))cd.call(t,n)&&dd(e,n,t[n]);return e},hd=(e,t)=>od(e,sd(t));class fd extends re{_onActivate(){this._plugin||this._loadPlugin(this.state.pluginId)}forceRender(){var e;this.setState({_renderCounter:(null!=(e=this.state._renderCounter)?e:0)+1})}_loadPlugin(t,n,r,a){var i=this;return ad((function*(){const o=function(e){var t;const{getPanelPluginFromCache:n}=(0,d.getPluginImportUtils)();return null!=(t=n(e))?t:j.get(e)}(t);if(o)i._pluginLoaded(o,n,r,a);else{const{importPanelPlugin:o}=(0,d.getPluginImportUtils)();try{const e=yield o(t);i._pluginLoaded(e,n,r,a)}catch(n){i._pluginLoaded(function(t){const n=new e.PanelPlugin((()=>null));return n.meta={id:t,name:t,sort:100,type:e.PluginType.panel,module:"",baseUrl:"",info:{author:{name:""},description:"",links:[],logos:{large:"",small:"public/img/grafana_icon.svg"},screenshots:[],updated:"",version:""}},n}(t)),n instanceof Error&&i.setState({_pluginLoadError:n.message})}}}))()}getLegacyPanelId(){const e=parseInt(this.state.key.replace("panel-",""),10);return isNaN(e)?0:e}_pluginLoaded(t,n,r,a){var i=this;return ad((function*(){const{options:o,fieldConfig:s,title:l,pluginVersion:u,_UNSAFE_customMigrationHandler:c}=i.state,d={title:l,options:o,fieldConfig:s,id:i.getLegacyPanelId(),type:t.meta.id,pluginVersion:u};n&&(d.options=n),r&&(d.fieldConfig=r);const p=i._getPluginVersion(t);null==c||c(d,t),t.onPanelMigration&&p!==u&&!a&&(d.options=yield t.onPanelMigration(d));const h=(0,e.getPanelOptionsWithDefaults)({plugin:t,currentOptions:d.options,currentFieldConfig:d.fieldConfig,isAfterPluginChange:null!=a&&a});if(i._plugin=t,i.setState({options:h.options,fieldConfig:h.fieldConfig,pluginVersion:p,pluginId:t.meta.id}),t.meta.skipDataQuery){const e=Hu.getTimeRange(i);i._subs.add(e.subscribeToState((()=>i.forceRender())))}}))()}_getPluginVersion(e){return e&&e.meta.info.version?e.meta.info.version:d.config.buildInfo.version}getPlugin(){return this._plugin}getPanelContext(){return null!=this._panelContext||(this._panelContext=this.buildPanelContext()),this._panelContext}changePluginType(e,t,n){var r=this;return ad((function*(){var a,i;const{options:o,fieldConfig:s,pluginId:l}=r.state;r._dataWithFieldConfig=void 0;const u=r.state.pluginId!==e;yield r._loadPlugin(e,null!=t?t:{},n,u);const c={title:r.state.title,options:r.state.options,fieldConfig:r.state.fieldConfig,id:1,type:e},d=null==(i=null==(a=r._plugin)?void 0:a.onPanelTypeChanged)?void 0:i.call(a,c,l,o,s);d&&!(0,ge.isEmpty)(d)&&r.onOptionsChange(d,!0,!0)}))()}clearFieldConfigCache(){this._dataWithFieldConfig=void 0}applyFieldConfig(t){var n,r,a,i;const o=this._plugin;if(!o||o.meta.skipDataQuery||!t)return ze;if(this._prevData===t&&this._dataWithFieldConfig)return this._dataWithFieldConfig;const s=o.dataSupport||{alertStates:!1,annotations:!1},l=o.fieldConfigRegistry,u=null!=(r=null==(n=this._dataWithFieldConfig)?void 0:n.series)?r:[],c=(0,e.applyFieldOverrides)({data:t.series,fieldConfig:this.state.fieldConfig,fieldConfigRegistry:l,replaceVariables:this.interpolate,theme:d.config.theme2,timeZone:null==(a=t.request)?void 0:a.timezone});return(0,e.compareArrayValues)(c,u,e.compareDataFrameStructures)||this._structureRev++,this._dataWithFieldConfig=hd(pd({},t),{structureRev:this._structureRev,series:c}),this._dataWithFieldConfig.annotations&&(this._dataWithFieldConfig.annotations=(0,e.applyFieldOverrides)({data:this._dataWithFieldConfig.annotations,fieldConfig:{defaults:{},overrides:[]},fieldConfigRegistry:l,replaceVariables:this.interpolate,theme:d.config.theme2,timeZone:null==(i=t.request)?void 0:i.timezone})),s.alertStates||(this._dataWithFieldConfig.alertState=void 0),s.annotations||(this._dataWithFieldConfig.annotations=void 0),this._prevData=t,this._dataWithFieldConfig}buildPanelContext(){const t=Hu.findObject(this,(e=>e instanceof uc));const n={eventsScope:t?t.getEventsScope():"__global_",eventBus:t?t.getEventsBus(this):(0,d.getAppEvents)(),app:e.CoreApp.Unknown,sync:()=>t?t.state.sync:e.DashboardCursorSync.Off,onSeriesColorChange:this._onSeriesColorChange,onToggleSeriesVisibility:this._onSeriesVisibilityChange,onToggleLegendSort:this._onToggleLegendSort,onInstanceStateChange:this._onInstanceStateChange};return this.state.extendPanelContext&&this.state.extendPanelContext(this,n),n}constructor(t){var n;super(pd({options:{},fieldConfig:{defaults:{},overrides:[]},title:"Title",pluginId:"timeseries",_renderCounter:0},t)),this._variableDependency=new pu(this,{statePaths:["title","options","fieldConfig"]}),this._structureRev=0,this.onTimeRangeChange=t=>{Hu.getTimeRange(this).onTimeRangeChange({raw:{from:(0,e.toUtc)(t.from),to:(0,e.toUtc)(t.to)},from:(0,e.toUtc)(t.from),to:(0,e.toUtc)(t.to)})},this.getTimeRange=e=>{const t=Hu.findObject(this,(e=>e instanceof gd)),n=Hu.getTimeRange(this);if(t instanceof gd&&t.isEnabled)return He(n.state.from,n.state.to,n.getTimeZone(),n.state.fiscalYearStartMonth,n.state.UNSAFE_nowDelay,n.state.weekStart);const r=this.getPlugin();return r&&!r.meta.skipDataQuery&&e&&e.timeRange?e.timeRange:n.state.value},this.onTitleChange=e=>{this.setState({title:e})},this.onDescriptionChange=e=>{this.setState({description:e})},this.onDisplayModeChange=e=>{this.setState({displayMode:e})},this.onToggleCollapse=e=>{this.setState({collapsed:e})},this.onOptionsChange=(t,n=!1,r=!1)=>{var a;const{fieldConfig:i,options:o}=this.state,s=n?t:(0,ge.mergeWith)((0,ge.cloneDeep)(o),t,((e,t,n,r)=>{if((0,ge.isArray)(t))return t;e===t||void 0!==t||(r[n]=t)})),l=(0,e.getPanelOptionsWithDefaults)({plugin:this._plugin,currentOptions:s,currentFieldConfig:i,isAfterPluginChange:r});this.setState({options:l.options,_renderCounter:(null!=(a=this.state._renderCounter)?a:0)+1})},this.onFieldConfigChange=(t,n)=>{const{fieldConfig:r,options:a}=this.state,i=n?t:(0,ge.merge)((0,ge.cloneDeep)(r),t),o=(0,e.getPanelOptionsWithDefaults)({plugin:this._plugin,currentOptions:a,currentFieldConfig:i,isAfterPluginChange:!1});this._dataWithFieldConfig=void 0,this.setState({fieldConfig:o.fieldConfig})},this.interpolate=(e,t,n)=>Hu.interpolate(this,e,t,n),this.getDescription=()=>{this.publishEvent(new G({origin:this,interaction:"panel-description-shown"}),!0);const{description:t}=this.state;if(t){const n=this.interpolate(t);return(0,e.renderMarkdown)(n)}return""},this.onCancelQuery=()=>{var e;this.publishEvent(new G({origin:this,interaction:"panel-cancel-query-clicked"}),!0);const t=Hu.getData(this);null==(e=t.cancelQuery)||e.call(t)},this.onStatusMessageClick=()=>{this.publishEvent(new G({origin:this,interaction:"panel-status-message-clicked"}),!0)},this._onSeriesColorChange=(t,n)=>{this.onFieldConfigChange(((t,n,r)=>{const{overrides:a}=r,i=r.overrides.findIndex((n=>n.matcher.id===e.FieldMatcherID.byName&&n.matcher.options===t));if(i<0)return ed(Jc({},r),{overrides:[...r.overrides,td(t,n)]});const o=Array.from(a),s=o[i],l=s.properties.findIndex((e=>"color"===e.id));if(l<0)return o[i]=ed(Jc({},s),{properties:[...s.properties,nd(n)]}),ed(Jc({},r),{overrides:o});const u=Array.from(s.properties);return u[l]=nd(n),o[i]=ed(Jc({},s),{properties:u}),ed(Jc({},r),{overrides:o})})(t,n,this.state.fieldConfig))},this._onSeriesVisibilityChange=(t,n)=>{this._dataWithFieldConfig&&this.onFieldConfigChange(function(t,n,r,a){const{overrides:i}=r,o=t,s=i.findIndex(Bc);if(s<0){if(n===_n.SeriesVisibilityChangeMode.ToggleSelection){const e=Nc([o,...Wc(i,a)]);return $c(Lc({},r),{overrides:[...r.overrides,e]})}const e=Nc(Hc(a,o));return $c(Lc({},r),{overrides:[...r.overrides,e]})}const l=Array.from(i),[u]=l.splice(s,1);if(n===_n.SeriesVisibilityChangeMode.ToggleSelection){let e=qc(u);const t=Wc(l,a);if(t.length>0&&(e=e.filter((e=>t.indexOf(e)<0))),e[0]===o&&1===e.length)return $c(Lc({},r),{overrides:l});const n=Nc([o,...t]);return $c(Lc({},r),{overrides:[...l,n]})}const c=((t,n,r=e.ByNamesMatcherMode.exclude)=>{const a=t.properties.find((e=>"custom.hideFrom"===e.id)),i=qc(t),o=i.findIndex((e=>e===n));return o<0?i.push(n):i.splice(o,1),Nc(i,r,a)})(u,o);return((e,t)=>qc(e).length===Hc(t).length)(c,a)?$c(Lc({},r),{overrides:l}):$c(Lc({},r),{overrides:[...l,c]})}(t,n,this.state.fieldConfig,this._dataWithFieldConfig.series),!0)},this._onInstanceStateChange=e=>{this._panelContext&&(this._panelContext=hd(pd({},this._panelContext),{instanceState:e})),this.setState({_pluginInstanceState:e})},this._onToggleLegendSort=e=>{const t=this.state.options.legend;if(!t)return;let n=t.sortDesc,r=t.sortBy;e!==r&&(n=void 0),!1===n?(r=void 0,n=void 0):(n=!n,r=e),this.onOptionsChange(hd(pd({},this.state.options),{legend:hd(pd({},t),{sortBy:r,sortDesc:n})}),!0)},this.addActivationHandler((()=>{this._onActivate()})),null==(n=t.menu)||n.addActivationHandler((()=>{this.publishEvent(new G({origin:this,interaction:"panel-menu-shown"}),!0)}))}}fd.Component=function({model:n}){var a,i,o;const{title:s,options:l,fieldConfig:u,_pluginLoadError:c,displayMode:p,hoverHeader:h,showMenuAlways:f,hoverHeaderOffset:m,menu:g,headerActions:b,titleItems:y,seriesLimit:v,seriesLimitShowAll:w,description:O,collapsible:S,collapsed:_,_renderCounter:x=0}=n.useState(),[P,{width:C,height:E}]=mc(),j=(0,t.useMemo)((()=>(0,d.getAppEvents)()),[]),D=(0,t.useCallback)((()=>{n.state.key&&j.publish(new e.SetPanelAttentionEvent({panelId:n.state.key}))}),[n.state.key,j]),k=(0,t.useMemo)((()=>(0,ge.debounce)(D,100,{leading:!0,trailing:!1})),[D]),T=n.getPlugin(),{dragClass:R,dragClassCancel:A}=function(e){var t,n;const r=Hu.getLayout(e),a=null==r?void 0:r.isDraggable();return r&&a&&!function(e,t){let n=e.parent;for(;n&&n!==t;){if("isDraggable"in n.state&&!1===n.state.isDraggable)return!0;n=n.parent}return!1}(e,r)?{dragClass:null==(t=r.getDragClass)?void 0:t.call(r),dragClassCancel:null==(n=null==r?void 0:r.getDragClassCancel)?void 0:n.call(r)}:{dragClass:"",dragClassCancel:""}}(n),I=Hu.getData(n),M=I.useState(),V=function(e,n,r){return(0,t.useMemo)((()=>{return(null==e?void 0:e.series)&&n&&!r?(t=Pc({},e),a={series:e.series.slice(0,n)},vc(t,wc(a))):e;var t,a}),[e,n,r])}(M.data,v,w),F=n.applyFieldConfig(V),L=Hu.getTimeRange(n).getTimeZone(),$=n.getTimeRange(F),z=n.interpolate(s,void 0,"text"),B=(0,_n.useStyles2)(kc);if(!T)return r().createElement("div",null,"Loading plugin panel...");if(!T.panel)return r().createElement("div",null,"Panel plugin has no panel component");const N=T.panel;I&&I.setContainerWidth&&I.setContainerWidth(Math.round(C));let q,H,W=[];y&&(Array.isArray(y)?W=W.concat(y.map((e=>r().createElement(e.Component,{model:e,key:`${e.state.key}`})))):Bt(y)?W.push(r().createElement(y.Component,{model:y})):W.push(y)),v&&W.push(r().createElement(gc,{key:"series-limit",data:M.data,seriesLimit:v,showAll:w,onShowAllSeries:()=>n.setState({seriesLimitShowAll:!w})})),n.state.$timeRange&&W.push(r().createElement(n.state.$timeRange.Component,{model:n.state.$timeRange,key:n.state.key})),F.alertState&&W.push(r().createElement(_n.Tooltip,{content:null!=(a=F.alertState.state)?a:"unknown",key:`alert-states-icon-${n.state.key}`},r().createElement(_n.PanelChrome.TitleItem,{className:(0,En.cx)({[B.ok]:F.alertState.state===e.AlertState.OK,[B.pending]:F.alertState.state===e.AlertState.Pending,[B.alerting]:F.alertState.state===e.AlertState.Alerting})},r().createElement(_n.Icon,{name:"alerting"===F.alertState.state?"heart-break":"heart",className:"panel-alert-icon",size:"md"})))),g&&(q=r().createElement(g.Component,{model:g})),b&&(H=Array.isArray(b)?r().createElement(r().Fragment,null,b.map((e=>r().createElement(e.Component,{model:e,key:`${e.state.key}`})))):Bt(b)?r().createElement(b.Component,{model:b}):b);const U=F,G=!I.isDataReadyToDisplay||I.isDataReadyToDisplay(),Q=n.getPanelContext(),K=n.getLegacyPanelId();let Y=null==(o=null==(i=U.request)?void 0:i.targets[0])?void 0:o.datasource;return r().createElement("div",{className:jc+" oodle-panel"},r().createElement("div",{ref:P,className:Dc,"data-viz-panel-key":n.state.key},C>0&&E>0&&r().createElement(_n.PanelChrome,{title:z,description:(null==O?void 0:O.trim())?n.getDescription:void 0,loadingState:U.state,statusMessage:Ec(U,c),statusMessageOnClick:n.onStatusMessageClick,width:C,height:E,selectionId:n.state.key,displayMode:p,showMenuAlways:f,hoverHeader:h,hoverHeaderOffset:m,titleItems:W,dragClass:R,actions:H,dragClassCancel:A,padding:T.noPadding?"none":"md",menu:q,onCancelQuery:n.onCancelQuery,onFocus:D,onMouseEnter:D,onMouseMove:k,collapsible:S,collapsed:_,onToggleCollapse:n.onToggleCollapse},((t,a)=>{var i;return r().createElement(r().Fragment,null,"timeseries"===T.meta.id&&r().createElement(_n.Button,{style:{top:(null==(i=n.state.title)?void 0:i.length)>0?"-32px":"0px",right:"28px",position:"absolute",border:0,padding:0},variant:"secondary",fill:"outline",type:"button","data-testid":"send-query-button",tooltip:"Oodle insight",tooltipPlacement:"top",hidden:"prometheus"!==(null==Y?void 0:Y.type),onClick:()=>{var e,t;const r=Pc({},null==(e=null==U?void 0:U.request)?void 0:e.scopedVars);r.__interval={value:"$__interval"},r.__interval_ms={value:"$__interval_ms"};let a=null==(t=U.request)?void 0:t.range,i=a.to.valueOf()-a.from.valueOf();(0,d.getDataSourceSrv)().get(Y,r).then((e=>{var t,o,s,l,u,c;if(!e.interpolateVariablesInQueries)throw new Error("datasource does not support variable interpolation");{let d=e.interpolateVariablesInQueries(null==(t=U.request)?void 0:t.targets,r);Cc(null==(o=U.request)?void 0:o.dashboardUID,"Insights",n.state.title,null==(s=U.request)?void 0:s.panelId,d,a,i,null==(c=null==(u=null==(l=n.state)?void 0:l.fieldConfig)?void 0:u.defaults)?void 0:c.unit)}})).catch((e=>{var t,r,o,s,l,u;Cc(null==(t=U.request)?void 0:t.dashboardUID,"Insights",n.state.title,null==(r=U.request)?void 0:r.panelId,null==(o=U.request)?void 0:o.targets,a,i,null==(u=null==(l=null==(s=n.state)?void 0:s.fieldConfig)?void 0:l.defaults)?void 0:u.unit)}))}},r().createElement("img",{src:"https://imagedelivery.net/oP5rEbdkySYwiZY4N9HGRw/d0e74e50-902c-4b3c-90af-cabc367bcb00/public",alt:"Insight icon","data-testid":"insight-icon",style:{height:"25px"}})),r().createElement(_n.ErrorBoundaryAlert,{dependencies:[T,U]},r().createElement(e.PluginContextProvider,{meta:T.meta},r().createElement(_n.PanelContextProvider,{value:Q},G&&r().createElement(N,{id:K,data:U,title:s,timeRange:$,timeZone:L,options:l,fieldConfig:u,transparent:!1,width:t,height:a,renderCounter:x,replaceVariables:n.interpolate,onOptionsChange:n.onOptionsChange,onFieldConfigChange:n.onFieldConfigChange,onChangeTimeRange:n.onTimeRangeChange,eventBus:Q.eventBus})))))}))))};const md=class extends re{enable(){window.clearInterval(this.timerId),this.timerId=void 0,this.timerId=window.setInterval((()=>{const e=Hu.findAllObjects(this.getRoot(),(e=>e instanceof fd));for(const t of e)t.forceRender()}),md.REFRESH_RATE),this.setState({enabled:!0})}disable(){window.clearInterval(this.timerId),this.timerId=void 0,this.setState({enabled:!1})}get isEnabled(){return this.state.enabled}constructor({enabled:e=!1}){super({enabled:e}),this.timerId=void 0,this._activationHandler=()=>(this.state.enabled&&this.enable(),()=>{window.clearInterval(this.timerId),this.timerId=void 0}),this.addActivationHandler(this._activationHandler)}};let gd=md;function bd(e){if("string"==typeof e)return e;if(e){if(e instanceof Error)return e.message;if((0,d.isFetchError)(e)){if(e.data&&e.data.message)return e.data.message;if(e.statusText)return e.statusText}else if(e.hasOwnProperty("message"))return e.message}return JSON.stringify(e)}gd.REFRESH_RATE=100;var yd=Object.defineProperty,vd=Object.getOwnPropertySymbols,wd=Object.prototype.hasOwnProperty,Od=Object.prototype.propertyIsEnumerable,Sd=(e,t,n)=>t in e?yd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class _d extends re{onActivate(){return this.state.isEnabled&&this.onEnable(),this.shouldRunLayerOnActivate()&&this.runLayer(),this.subscribeToState(((e,t)=>{!e.isEnabled&&this.querySub&&(this.querySub.unsubscribe(),this.querySub=void 0,this.onDisable(),this._results.next({origin:this,data:ze}),this.setStateHelper({data:ze})),e.isEnabled&&!t.isEnabled&&(this.onEnable(),this.runLayer())})),()=>{this.onDeactivate()}}onDeactivate(){this.querySub&&(this.querySub.unsubscribe(),this.querySub=void 0),this.onDisable(),this._variableValueRecorder.recordCurrentDependencyValuesForSceneObject(this)}onVariableUpdateCompleted(){this.runLayer()}cancelQuery(){this.querySub&&(this.querySub.unsubscribe(),this.querySub=void 0,this.publishResults(ze))}publishResults(e){this.state.isEnabled&&(this._results.next({origin:this,data:e}),this.setStateHelper({data:e}))}getResultsStream(){return this._results}shouldRunLayerOnActivate(){return!!this.state.isEnabled&&(this._variableValueRecorder.hasDependenciesChanged(this)?(Gt("SceneDataLayerBase","Variable dependency changed while inactive, shouldRunLayerOnActivate returns true"),!0):!this.state.data)}setStateHelper(e){xt(this,e)}constructor(e,t=[]){super(((e,t)=>{for(var n in t||(t={}))wd.call(t,n)&&Sd(e,n,t[n]);if(vd)for(var n of vd(t))Od.call(t,n)&&Sd(e,n,t[n]);return e})({isEnabled:!0},e)),this._results=new D.ReplaySubject(1),this.isDataLayer=!0,this._variableValueRecorder=new Zt,this._variableDependency=new pu(this,{onVariableUpdateCompleted:this.onVariableUpdateCompleted.bind(this)}),this._variableDependency.setPaths(t),this.addActivationHandler((()=>this.onActivate()))}}class xd extends re{constructor(){super({})}}function Pd({layer:e}){var t,n;const a=`data-layer-${e.state.key}`,{data:i,isEnabled:o}=e.useState(),s=Boolean(i&&i.state===Ae.Loading);return r().createElement("div",{className:Cd},r().createElement(cr,{htmlFor:a,isLoading:s,onCancel:()=>{var t;return null==(t=e.cancelQuery)?void 0:t.call(e)},label:e.state.name,description:e.state.description,error:null==(n=null==(t=e.state.data)?void 0:t.errors)?void 0:n[0].message}),r().createElement(_n.InlineSwitch,{id:a,value:o,onChange:()=>e.setState({isEnabled:!o})}))}xd.Component=function({model:e}){const t=Hu.getDataLayers(e,!0);return 0===t.length?null:r().createElement(r().Fragment,null,t.map((e=>r().createElement(e.Component,{model:e,key:e.state.key}))))};const Cd=(0,En.css)({display:"flex"});function Ed(e){return"function"==typeof e}function jd(e){return function(t){if(function(e){return Ed(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}var Dd=function(e,t){return Dd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Dd(e,t)};function kd(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Dd(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function Td(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function Rd(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ad(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o}function Id(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}function Md(e){return this instanceof Md?(this.v=e,this):new Md(e)}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var Vd,Fd=((Vd=function(e){var t;t=this,Error.call(t),t.stack=(new Error).stack,this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}).prototype=Object.create(Error.prototype),Vd.prototype.constructor=Vd,Vd);function Ld(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var $d=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,r,a;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var o=Rd(i),s=o.next();!s.done;s=o.next())s.value.remove(this)}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else i.remove(this);var l=this.initialTeardown;if(Ed(l))try{l()}catch(e){a=e instanceof Fd?e.errors:[e]}var u=this._finalizers;if(u){this._finalizers=null;try{for(var c=Rd(u),d=c.next();!d.done;d=c.next()){var p=d.value;try{Bd(p)}catch(e){a=null!=a?a:[],e instanceof Fd?a=Id(Id([],Ad(a)),Ad(e.errors)):a.push(e)}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}if(a)throw new Fd(a)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)Bd(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Ld(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&Ld(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function zd(e){return e instanceof $d||e&&"closed"in e&&Ed(e.remove)&&Ed(e.add)&&Ed(e.unsubscribe)}function Bd(e){Ed(e)?e():e.unsubscribe()}$d.EMPTY;var Nd=null,qd=null,Hd=void 0,Wd=!1,Ud=!1,Gd={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var a=Gd.delegate;return(null==a?void 0:a.setTimeout)?a.setTimeout.apply(a,Id([e,t],Ad(n))):setTimeout.apply(void 0,Id([e,t],Ad(n)))},clearTimeout:function(e){var t=Gd.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function Qd(e){Gd.setTimeout((function(){if(!Nd)throw e;Nd(e)}))}function Kd(){}var Yd=Zd("C",void 0,void 0);function Zd(e,t,n){return{kind:e,value:t,error:n}}var Xd=null,Jd=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,zd(t)&&t.add(n)):n.destination=op,n}return kd(t,e),t.create=function(e,t,n){return new rp(e,t,n)},t.prototype.next=function(e){this.isStopped?ip(function(e){return Zd("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?ip(Zd("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?ip(Yd,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}($d),ep=Function.prototype.bind;function tp(e,t){return ep.call(e,t)}var np=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){ap(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){ap(e)}else ap(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){ap(e)}},e}(),rp=function(e){function t(t,n,r){var a,i,o=e.call(this)||this;return Ed(t)||!t?a={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:o&&Ud?((i=Object.create(t)).unsubscribe=function(){return o.unsubscribe()},a={next:t.next&&tp(t.next,i),error:t.error&&tp(t.error,i),complete:t.complete&&tp(t.complete,i)}):a=t,o.destination=new np(a),o}return kd(t,e),t}(Jd);function ap(e){var t;Wd?(t=e,Wd&&Xd&&(Xd.errorThrown=!0,Xd.error=t)):Qd(e)}function ip(e,t){var n=qd;n&&Gd.setTimeout((function(){return n(e,t)}))}var op={closed:!0,next:Kd,error:function(e){throw e},complete:Kd};function sp(e,t,n,r,a){return new lp(e,t,n,r,a)}var lp=function(e){function t(t,n,r,a,i,o){var s=e.call(this,t)||this;return s.onFinalize=i,s.shouldUnsubscribe=o,s._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,s._error=a?function(e){try{a(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return kd(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(Jd);function up(e,t){return jd((function(n,r){var a=0;n.subscribe(sp(r,(function(n){r.next(e.call(t,n,a++))})))}))}var cp="function"==typeof Symbol&&Symbol.observable||"@@observable";function dp(e){return e}var pp=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,a=this,i=(r=e)&&r instanceof Jd||function(e){return e&&Ed(e.next)&&Ed(e.error)&&Ed(e.complete)}(r)&&zd(r)?e:new rp(e,t,n);return function(e){if(Wd){var t=!Xd;if(t&&(Xd={errorThrown:!1,error:null}),e(),t){var n=Xd,r=n.errorThrown,a=n.error;if(Xd=null,r)throw a}}else e()}((function(){var e=a,t=e.operator,n=e.source;i.add(t?t.call(i,n):n?a._subscribe(i):a._trySubscribe(i))})),i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=hp(t))((function(t,r){var a=new rp({next:function(t){try{e(t)}catch(e){r(e),a.unsubscribe()}},error:r,complete:t});n.subscribe(a)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[cp]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===(n=e).length?dp:1===n.length?n[0]:function(e){return n.reduce((function(e,t){return t(e)}),e)})(this);var n},e.prototype.toPromise=function(e){var t=this;return new(e=hp(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function hp(e){var t;return null!==(t=null!=e?e:Hd)&&void 0!==t?t:Promise}var fp="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function mp(e){if(e instanceof pp)return e;if(null!=e){if(function(e){return Ed(e[cp])}(e))return o=e,new pp((function(e){var t=o[cp]();if(Ed(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if((i=e)&&"number"==typeof i.length&&"function"!=typeof i)return a=e,new pp((function(e){for(var t=0;t<a.length&&!e.closed;t++)e.next(a[t]);e.complete()}));if(Ed(null==(r=e)?void 0:r.then))return n=e,new pp((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,Qd)}));if(function(e){return Symbol.asyncIterator&&Ed(null==e?void 0:e[Symbol.asyncIterator])}(e))return gp(e);if(function(e){return Ed(null==e?void 0:e[fp])}(e))return t=e,new pp((function(e){var n,r;try{for(var a=Rd(t),i=a.next();!i.done;i=a.next()){var o=i.value;if(e.next(o),e.closed)return}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}e.complete()}));if(function(e){return Ed(null==e?void 0:e.getReader)}(e))return gp(function(e){return function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,a=n.apply(e,t||[]),i=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",(function(e){return function(t){return Promise.resolve(t).then(e,u)}})),r[Symbol.asyncIterator]=function(){return this},r;function o(e,t){a[e]&&(r[e]=function(t){return new Promise((function(n,r){i.push([e,t,n,r])>1||s(e,t)}))},t&&(r[e]=t(r[e])))}function s(e,t){try{(n=a[e](t)).value instanceof Md?Promise.resolve(n.value.v).then(l,u):c(i[0][2],n)}catch(e){c(i[0][3],e)}var n}function l(e){s("next",e)}function u(e){s("throw",e)}function c(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}(this,arguments,(function(){var t,n,r;return Td(this,(function(a){switch(a.label){case 0:t=e.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,Md(t.read())];case 3:return n=a.sent(),r=n.value,n.done?[4,Md(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,Md(r)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}(e))}var t,n,r,a,i,o;throw function(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}(e)}function gp(e){return new pp((function(t){(function(e,t){var n,r,a,i,o,s,l,u;return o=this,s=void 0,u=function(){var o,s;return Td(this,(function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=Rd(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,a){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,a,(t=e[n](t)).done,t.value)}))}}}(e),l.label=1;case 1:return[4,n.next()];case 2:if((r=l.sent()).done)return[3,4];if(o=r.value,t.next(o),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=l.sent(),a={error:s},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(i=n.return)?[4,i.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(a)throw a.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))},new((l=void 0)||(l=Promise))((function(e,t){function n(e){try{a(u.next(e))}catch(e){t(e)}}function r(e){try{a(u.throw(e))}catch(e){t(e)}}function a(t){var a;t.done?e(t.value):(a=t.value,a instanceof l?a:new l((function(e){e(a)}))).then(n,r)}a((u=u.apply(o,s||[])).next())}))})(e,t).catch((function(e){return t.error(e)}))}))}function bp(e,t,n){return void 0===n&&(n=1/0),Ed(t)?bp((function(n,r){return up((function(e,a){return t(n,e,r,a)}))(mp(e(n,r)))}),n):("number"==typeof t&&(n=t),jd((function(t,r){return function(e,t,n,r){var a=[],i=0,o=0,s=!1,l=function(){!s||a.length||i||t.complete()},u=function(e){return i<r?c(e):a.push(e)},c=function(e){i++;var s=!1;mp(n(e,o++)).subscribe(sp(t,(function(e){t.next(e)}),(function(){s=!0}),void 0,(function(){if(s)try{i--;for(var e=function(){var e=a.shift();c(e)};a.length&&i<r;)e();l()}catch(e){t.error(e)}})))};return e.subscribe(sp(t,u,(function(){s=!0,l()}))),function(){}}(t,r,e,n)})))}var yp=Object.defineProperty,vp=Object.defineProperties,wp=Object.getOwnPropertyDescriptors,Op=Object.getOwnPropertySymbols,Sp=Object.prototype.hasOwnProperty,_p=Object.prototype.propertyIsEnumerable,xp=(e,t,n)=>t in e?yp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const Pp={prepareAnnotation:e=>{if((0,ge.isString)(null==e?void 0:e.query)){const n=e,{query:r}=n;return t=((e,t)=>{for(var n in t||(t={}))Sp.call(t,n)&&xp(e,n,t[n]);if(Op)for(var n of Op(t))_p.call(t,n)&&xp(e,n,t[n]);return e})({},((e,t)=>{var n={};for(var r in e)Sp.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&Op)for(var r of Op(e))t.indexOf(r)<0&&_p.call(e,r)&&(n[r]=e[r]);return n})(n,["query"])),vp(t,wp({target:{refId:"annotation_query",query:r},mappings:{}}))}var t;return e},prepareQuery:e=>e.target,processEvents:(t,n)=>function(t,n){return(0,D.of)(t).pipe((t=>t.pipe(bp((t=>{if(!(null==t?void 0:t.length))return(0,D.of)(void 0);if(1===t.length)return(0,D.of)(t[0]);return(0,D.of)(t).pipe(e.standardTransformers.mergeTransformer.operator({},{interpolate:e=>e}),up((e=>e[0])))})))),up((t=>{if(!(null==t?void 0:t.length))return[];let r=!1,a=!1;const i={};for(const n of t.fields)i[(0,e.getFieldDisplayName)(n,t).toLowerCase()]=n;n||(n={});const o=[];for(const s of Ep){const l=n[s.key]||{};if(l.source===e.AnnotationEventFieldSource.Skip)continue;const u={key:s.key,split:s.split};if(l.source===e.AnnotationEventFieldSource.Text)u.text=l.value;else{const e=(l.value||s.key).toLowerCase();u.field=i[e],!u.field&&s.field&&(u.field=s.field(t))}(u.field||u.text)&&(o.push(u),"time"===u.key?r=!0:"text"===u.key&&(a=!0))}if(!r||!a)return console.error("Cannot process annotation fields. No time or text present."),[];const s=[];for(let e=0;e<t.length;e++){const t={type:"default",color:"red"};for(const n of o){let r;if(n.text)r=n.text;else if(n.field&&(r=n.field.values.get(e),void 0!==r&&n.regex)){const e=n.regex.exec(r);e&&(r=e[1]?e[1]:e[0])}null!=r&&(n.split&&"string"==typeof r&&(r=r.split(",")),t[n.key]=r)}s.push(t)}return s})))}(n,t.mappings)},Cp=[{key:"time",field:t=>t.fields.find((t=>t.type===e.FieldType.time)),placeholder:"time, or the first time field"},{key:"timeEnd",help:"When this field is defined, the annotation will be treated as a range"},{key:"title"},{key:"text",field:t=>t.fields.find((t=>t.type===e.FieldType.string)),placeholder:"text, or the first text field"},{key:"tags",split:",",help:"The results will be split on comma (,)"},{key:"id"}],Ep=[...d.config.publicDashboardAccessToken?[{key:"color"},{key:"isRegion"},{key:"source"}]:[],...Cp,{key:"userId"},{key:"login"},{key:"email"},{key:"prevState"},{key:"newState"},{key:"data"},{key:"panelId"},{key:"alertId"},{key:"dashboardId"},{key:"dashboardUID"}],jp=["prometheus","loki","elasticsearch","grafana-opensearch-datasource"];var Dp=Object.defineProperty,kp=Object.defineProperties,Tp=Object.getOwnPropertyDescriptors,Rp=Object.getOwnPropertySymbols,Ap=Object.prototype.hasOwnProperty,Ip=Object.prototype.propertyIsEnumerable,Mp=(e,t,n)=>t in e?Dp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Vp=(e,t)=>{for(var n in t||(t={}))Ap.call(t,n)&&Mp(e,n,t[n]);if(Rp)for(var n of Rp(t))Ip.call(t,n)&&Mp(e,n,t[n]);return e},Fp=(e,t)=>kp(e,Tp(t));let Lp=100;var $p=Object.defineProperty,zp=Object.getOwnPropertySymbols,Bp=Object.prototype.hasOwnProperty,Np=Object.prototype.propertyIsEnumerable,qp=(e,t,n)=>t in e?$p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function Hp(e){return"panel-alert"===e.eventType}function Wp(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function Up(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){Wp(i,r,a,o,s,"next",e)}function s(e){Wp(i,r,a,o,s,"throw",e)}o(void 0)}))}}var Gp=Object.defineProperty,Qp=Object.defineProperties,Kp=Object.getOwnPropertyDescriptors,Yp=Object.getOwnPropertySymbols,Zp=Object.prototype.hasOwnProperty,Xp=Object.prototype.propertyIsEnumerable,Jp=(e,t,n)=>t in e?Gp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,eh=(e,t)=>{for(var n in t||(t={}))Zp.call(t,n)&&Jp(e,n,t[n]);if(Yp)for(var n of Yp(t))Xp.call(t,n)&&Jp(e,n,t[n]);return e},th=(e,t)=>Qp(e,Kp(t));class nh extends _d{onEnable(){this.publishEvent(new d.RefreshEvent,!0);const e=Hu.getTimeRange(this);this._timeRangeSub=e.subscribeToState((()=>{this.runWithTimeRange(e)}))}onDisable(){var e;this.publishEvent(new d.RefreshEvent,!0),null==(e=this._timeRangeSub)||e.unsubscribe()}runLayer(){Gt("AnnotationsDataLayer","run layer");const e=Hu.getTimeRange(this);this.runWithTimeRange(e)}runWithTimeRange(t){var n=this;return Up((function*(){const{query:r}=n.state;if(n.querySub&&n.querySub.unsubscribe(),n._variableDependency.hasDependencyInLoadingState())Gt("AnnotationsDataLayer","Variable dependency is in loading state, skipping query execution");else try{let a=function(t,n,r,a){var i;if(t.annotationQuery&&function(e){const{type:t}=e;return!e.annotations||jp.includes(t)}(t))return console.warn("Using deprecated annotationQuery method, please upgrade your datasource"),(0,D.from)(t.annotationQuery({range:n.state.value,rangeRaw:n.state.value.raw,annotation:r,dashboard:{getVariables:(0,d.getTemplateSrv)().getVariables}})).pipe(up((e=>({state:Ae.Done,events:e}))));const o=Vp(Vp({},Pp),t.annotations),s=Vp(Vp({},null==(i=o.getDefaultQuery)?void 0:i.call(o)),r),l=o.prepareAnnotation(s);if(!l)return(0,D.of)({state:Ae.Done,events:[]});const u=o.prepareQuery(l);if(!u)return(0,D.of)({state:Ae.Done,events:[]});const c=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,p=e.rangeUtil.calculateInterval(n.state.value,c,t.interval),h={__interval:{text:p.interval,value:p.interval},__interval_ms:{text:p.intervalMs.toString(),value:p.intervalMs},__annotation:{text:l.name,value:l},__sceneObject:Kn(a)},f=Vp(Fp(Vp({startTime:Date.now(),requestId:"AQ"+Lp++,range:n.state.value,maxDataPoints:c,scopedVars:h},p),{app:e.CoreApp.Dashboard,timezone:n.getTimeZone(),targets:[Fp(Vp({},u),{refId:"Anno"})]}),yn(a));return(0,d.getRunRequest)()(t,f).pipe(bp((t=>{const n=(null==t?void 0:t.series.length)?t.series:t.annotations;return(null==n?void 0:n.length)?(n.forEach((t=>{var n;(null==(n=t.meta)?void 0:n.dataTopic)||(t.meta=Fp(Vp({},t.meta||{}),{dataTopic:e.DataTopic.Annotations}))})),o.processEvents(l,n).pipe(up((e=>({state:t.state,events:e||[]}))))):(0,D.of)({state:t.state,events:[]})})))}(yield n.resolveDataSource(r),t,r,n).pipe(On({type:"annotations",origin:n,cancel:()=>n.cancelQuery()}),(0,D.map)((e=>n.processEvents(r,e))));n.querySub=a.subscribe((e=>{n.publishResults(e)}))}catch(e){n.publishResults(th(eh({},ze),{state:Ae.Error,errors:[{message:bd(e)}]})),console.error("AnnotationsDataLayer error",e)}}))()}resolveDataSource(e){var t=this;return Up((function*(){return yield Kt(e.datasource||void 0,t._scopedVars)}))()}processEvents(t,n){let r=(a=t,i=n.events||[],a.snapshotData&&delete(a=(0,ge.cloneDeep)(a)).snapshotData,i.map((e=>{var t;const n=((e,t)=>{for(var n in t||(t={}))Bp.call(t,n)&&qp(e,n,t[n]);if(zp)for(var n of zp(t))Np.call(t,n)&&qp(e,n,t[n]);return e})({},e);switch(n.source=a,n.color=d.config.theme2.visualization.getColorByName(a.iconColor),n.type=a.name,n.isRegion=Boolean(n.timeEnd&&n.time!==n.timeEnd),null==(t=n.newState)?void 0:t.toLowerCase()){case"pending":n.color="yellow";break;case"alerting":n.color="red";break;case"ok":case"normal":n.color="green";break;case"no_data":case"nodata":n.color="gray"}return n})));var a,i;r=function(e){let t=[];const n=(0,ge.partition)(e,"id"),r=(0,ge.groupBy)(n[0],"id");return t=(0,ge.map)(r,(e=>e.length>1&&!(0,ge.every)(e,Hp)?(0,ge.find)(e,(e=>"panel-alert"!==e.eventType)):(0,ge.head)(e))),t=(0,ge.concat)(t,n[1]),t}(r);const o=th(eh({},ze),{state:n.state}),s=(0,e.arrayToDataFrame)(r);return s.meta=th(eh({},s.meta),{dataTopic:e.DataTopic.Annotations}),o.series=[s],o}constructor(e){super(eh({isEnabled:!0},e),["query"]),this._scopedVars={__sceneObject:Kn(this)}}}nh.Component=function({model:e}){const{isHidden:t}=e.useState();return t?null:r().createElement(Pd,{layer:e})};class rh extends re{getAncestorTimeRange(){if(!this.parent||!this.parent.parent)throw new Error(typeof this+" must be used within $timeRange scope");return Hu.getTimeRange(this.parent.parent)}getTimeZone(){return this.getAncestorTimeRange().getTimeZone()}onTimeRangeChange(e){this.getAncestorTimeRange().onTimeRangeChange(e)}onTimeZoneChange(e){this.getAncestorTimeRange().onTimeZoneChange(e)}onRefresh(){this.getAncestorTimeRange().onRefresh()}constructor(e){super(e),this._activationHandler=()=>{const e=this.getAncestorTimeRange();this.ancestorTimeRangeChanged(e.state),this._subs.add(e.subscribeToState((e=>this.ancestorTimeRangeChanged(e))))},this.addActivationHandler(this._activationHandler)}}var ah=Object.defineProperty,ih=Object.defineProperties,oh=Object.getOwnPropertyDescriptors,sh=Object.getOwnPropertySymbols,lh=Object.prototype.hasOwnProperty,uh=Object.prototype.propertyIsEnumerable,ch=(e,t,n)=>t in e?ah(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,dh=(e,t)=>{for(var n in t||(t={}))lh.call(t,n)&&ch(e,n,t[n]);if(sh)for(var n of sh(t))uh.call(t,n)&&ch(e,n,t[n]);return e},ph=(e,t)=>ih(e,oh(t));class hh extends rh{ancestorTimeRangeChanged(e){this.setState(ph(dh({},e),{timeZone:this.state.timeZone,value:He(e.from,e.to,this.state.timeZone,e.fiscalYearStartMonth,e.UNSAFE_nowDelay,e.weekStart)}))}getTimeZone(){return this.state.timeZone}onTimeZoneChange(e){const t=this.getAncestorTimeRange();this.setState({timeZone:e,value:He(t.state.from,t.state.to,e,t.state.fiscalYearStartMonth,t.state.UNSAFE_nowDelay,t.state.weekStart)})}constructor(t){super(ph(dh({},t),{timeZone:t.timeZone,from:"now-6h",to:"now",value:(0,e.getDefaultTimeRange)()}))}}class fh extends re{setContainerWidth(e){var t,n;null==(n=(t=this.state.source.resolve()).setContainerWidth)||n.call(t,e)}isDataReadyToDisplay(){var e,t,n;return null==(n=null==(t=(e=this.state.source.resolve()).isDataReadyToDisplay)?void 0:t.call(e))||n}cancelQuery(){var e,t;null==(t=(e=this.state.source.resolve()).cancelQuery)||t.call(e)}getResultsStream(){return this.state.source.resolve().getResultsStream()}constructor(e){super({source:e.source,data:e.source.resolve().state.data}),this.addActivationHandler((()=>{this._subs.add(this.state.source.resolve().subscribeToState(((e,t)=>{e.data!==t.data&&this.setState({data:e.data})})))}))}}var mh=Object.defineProperty,gh=Object.defineProperties,bh=Object.getOwnPropertyDescriptors,yh=Object.getOwnPropertySymbols,vh=Object.prototype.hasOwnProperty,wh=Object.prototype.propertyIsEnumerable,Oh=(e,t,n)=>t in e?mh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Sh extends re{subscribeToAllLayers(e){e.length>0?this.querySub=this._dataLayersMerger.getMergedStream(e).subscribe(this._onLayerUpdateReceived.bind(this)):(this._results.next({origin:this,data:ze}),this.setStateHelper({data:ze}))}_onLayerUpdateReceived(e){var t;let n=[];for(const r of e)(null==(t=r.data)?void 0:t.series)&&(n=n.concat(r.data.series));const r=(a=((e,t)=>{for(var n in t||(t={}))vh.call(t,n)&&Oh(e,n,t[n]);if(yh)for(var n of yh(t))wh.call(t,n)&&Oh(e,n,t[n]);return e})({},ze),gh(a,bh({series:n})));var a;this._results.next({origin:this,data:r}),this.setStateHelper({data:r})}getResultsStream(){return this._results}cancelQuery(){var e;null==(e=this.querySub)||e.unsubscribe()}setStateHelper(e){xt(this,e)}constructor(){super(...arguments),this.isDataLayer=!0,this._results=new D.ReplaySubject(1),this._dataLayersMerger=new hl}}class _h extends Sh{_onActivate(){return this._subs.add(this.subscribeToState(((e,t)=>{var n;e.layers!==t.layers&&(null==(n=this.querySub)||n.unsubscribe(),this.subscribeToAllLayers(e.layers))}))),this.subscribeToAllLayers(this.state.layers),()=>{var e;null==(e=this.querySub)||e.unsubscribe()}}constructor(e){var t,n;super({name:null!=(t=e.name)?t:"Data layers",layers:null!=(n=e.layers)?n:[]}),this.addActivationHandler((()=>this._onActivate()))}}_h.Component=({model:e})=>{const{layers:t}=e.useState();return r().createElement(r().Fragment,null,t.map((e=>r().createElement(e.Component,{model:e,key:e.state.key}))))};var xh=Object.defineProperty,Ph=Object.defineProperties,Ch=Object.getOwnPropertyDescriptors,Eh=Object.getOwnPropertySymbols,jh=Object.prototype.hasOwnProperty,Dh=Object.prototype.propertyIsEnumerable,kh=(e,t,n)=>t in e?xh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Th=(e,t)=>{for(var n in t||(t={}))jh.call(t,n)&&kh(e,n,t[n]);if(Eh)for(var n of Eh(t))Dh.call(t,n)&&kh(e,n,t[n]);return e},Rh=(e,t)=>Ph(e,Ch(t));class Ah extends re{activationHandler(){const e=this.getSourceData();return this._subs.add(e.subscribeToState((e=>this.transform(e.data)))),e.state.data&&this.transform(e.state.data),()=>{this._transformSub&&this._transformSub.unsubscribe()}}getSourceData(){if(this.state.$data){if(this.state.$data instanceof _h)throw new Error("SceneDataLayerSet can not be used as data provider for SceneDataTransformer.");return this.state.$data}if(!this.parent||!this.parent.parent)throw new Error("SceneDataTransformer must either have $data set on it or have a parent.parent with $data");return Hu.getData(this.parent.parent)}setContainerWidth(e){this.state.$data&&this.state.$data.setContainerWidth&&this.state.$data.setContainerWidth(e)}isDataReadyToDisplay(){const e=this.getSourceData();return!e.isDataReadyToDisplay||e.isDataReadyToDisplay()}reprocessTransformations(){this.transform(this.getSourceData().state.data,!0)}cancelQuery(){var e,t;null==(t=(e=this.getSourceData()).cancelQuery)||t.call(e)}getResultsStream(){return this._results}clone(e){const t=super.clone(e);return this._prevDataFromSource&&(t._prevDataFromSource=this._prevDataFromSource),t}haveAlreadyTransformedData(e){if(!this._prevDataFromSource)return!1;if(e===this._prevDataFromSource)return!0;const{series:t,annotations:n}=this._prevDataFromSource;return e.series===t&&e.annotations===n&&(this.state.data&&e.state!==this.state.data.state&&this.setState({data:Rh(Th({},this.state.data),{state:e.state})}),!0)}transform(t,n=!1){var r;if(0===this.state.transformations.length||!t)return this._prevDataFromSource=t,this.setState({data:t}),void(t&&this._results.next({origin:this,data:t}));if(!n&&this.haveAlreadyTransformedData(t))return;const a=this.state.transformations.filter((t=>!("options"in t)&&!("topic"in t)||null==t.topic||t.topic===e.DataTopic.Series)).map((e=>"operator"in e?e.operator:e)),i=this.state.transformations.filter((t=>("options"in t||"topic"in t)&&t.topic===e.DataTopic.Annotations)).map((e=>"operator"in e?e.operator:e));this._transformSub&&this._transformSub.unsubscribe();const o={interpolate:e=>{var n;return Hu.interpolate(this,e,null==(n=t.request)?void 0:n.scopedVars)}};let s=[(0,e.transformDataFrame)(a,t.series,o)];t.annotations&&t.annotations.length>0&&i.length>0&&s.push((0,e.transformDataFrame)(i,null!=(r=t.annotations)?r:[])),this._transformSub=(0,D.forkJoin)(s).pipe((0,D.map)((e=>{const n=e[0],r=e[1];return Rh(Th({},t),{series:n,annotations:null!=r?r:t.annotations})})),(0,D.catchError)((n=>{var r;console.error("Error transforming data: ",n);const a=(null==(r=this.getSourceData().state.data)?void 0:r.errors)||[],i=(0,d.toDataQueryError)(n);i.message=`Error transforming data: ${i.message}`;const o=Rh(Th({},t),{state:e.LoadingState.Error,errors:[...a,i]});return(0,D.of)(o)}))).subscribe((e=>{this.setState({data:e}),this._results.next({origin:this,data:e}),this._prevDataFromSource=t}))}constructor(e){super(e),this._results=new D.ReplaySubject(1),this._variableDependency=new pu(this,{statePaths:["transformations"],onReferencedVariableValueChanged:()=>this.reprocessTransformations()}),this.addActivationHandler((()=>this.activationHandler()))}}class Ih extends re{}function Mh({variable:t,layout:n,showAlways:a,hideLabel:i}){return ae(t,{shouldActivateOrKeepAlive:!0}).hide!==e.VariableHide.hideVariable||a?"vertical"===n?r().createElement("div",{className:Lh,"data-testid":Cn.pages.Dashboard.SubMenu.submenuItem},r().createElement(Vh,{variable:t,layout:n,hideLabel:i}),r().createElement(t.Component,{model:t})):r().createElement("div",{className:Fh,"data-testid":Cn.pages.Dashboard.SubMenu.submenuItem},r().createElement(Vh,{variable:t,hideLabel:i}),r().createElement(t.Component,{model:t})):null}function Vh({variable:t,layout:n,hideLabel:a}){var i;const{state:o}=t;if(t.state.hide===e.VariableHide.hideLabel||a)return null;const s=`var-${o.key}`,l=o.label||o.name;return r().createElement(cr,{htmlFor:s,isLoading:o.loading,onCancel:()=>{var e;return null==(e=t.onCancel)?void 0:e.call(t)},label:l,error:o.error,layout:n,description:null!=(i=o.description)?i:void 0})}Ih.Component=function({model:e}){const t=Hu.getVariables(e).useState();return r().createElement(r().Fragment,null,t.variables.map((t=>r().createElement(Mh,{key:t.state.key,variable:t,layout:e.state.layout}))))};const Fh=(0,En.css)({display:"flex"}),Lh=(0,En.css)({display:"flex",flexDirection:"column"});(class extends re{}).Component=function({model:e}){const t=Hu.lookupVariable(e.state.variableName,e);return t?r().createElement(Mh,{key:t.state.key,variable:t,layout:e.state.layout,showAlways:!0}):null};class $h extends re{getByName(e){return this.state.variables.find((t=>t.state.name===e))}_refreshTimeRangeBasedVariables(){for(const t of this.state.variables)"refresh"in t.state&&t.state.refresh===e.VariableRefresh.onTimeRangeChanged&&this._variablesToUpdate.add(t);this._updateNextBatch()}_checkForVariablesThatChangedWhileInactive(){if(this._variableValueRecorder.hasValues())for(const e of this.state.variables)this._variableValueRecorder.hasValueChanged(e)&&(zh(e,"Changed while in-active"),this._addDependentVariablesToUpdateQueue(e))}_variableNeedsUpdate(e){return!(e.isLazy||!e.validateAndUpdate||this._variableValueRecorder.hasRecordedValue(e)&&(zh(e,"Skipping updateAndValidate current value valid"),1))}_updateNextBatch(){for(const e of this._variablesToUpdate){if(!e.validateAndUpdate)throw new Error("Variable added to variablesToUpdate but does not have validateAndUpdate");if(this._updating.has(e))continue;if(Hu.hasVariableDependencyInLoadingState(e))continue;const t={variable:e};this._updating.set(e,t),zh(e,"updateAndValidate started"),t.subscription=e.validateAndUpdate().subscribe({next:()=>this._validateAndUpdateCompleted(e),complete:()=>this._validateAndUpdateCompleted(e),error:t=>this._handleVariableError(e,t)})}}_validateAndUpdateCompleted(e){var t;if(!this._updating.has(e))return;const n=this._updating.get(e);null==(t=null==n?void 0:n.subscription)||t.unsubscribe(),this._updating.delete(e),this._variablesToUpdate.delete(e),zh(e,"updateAndValidate completed"),this._notifyDependentSceneObjects(e),this._updateNextBatch()}cancel(e){var t;const n=this._updating.get(e);null==(t=null==n?void 0:n.subscription)||t.unsubscribe(),this._updating.delete(e),this._variablesToUpdate.delete(e)}_handleVariableError(e,t){var n;const r=this._updating.get(e);null==(n=null==r?void 0:r.subscription)||n.unsubscribe(),this._updating.delete(e),this._variablesToUpdate.delete(e),e.setState({loading:!1,error:t.message}),console.error("SceneVariableSet updateAndValidate error",t),zh(e,"updateAndValidate error",t),this._notifyDependentSceneObjects(e),this._updateNextBatch()}_handleVariableValueChanged(e){this._variablesThatHaveChanged.add(e),this._addDependentVariablesToUpdateQueue(e),this._updating.has(e)||(this._updateNextBatch(),this._notifyDependentSceneObjects(e))}_handleParentVariableUpdatesCompleted(e,t){t&&this._addDependentVariablesToUpdateQueue(e),this._variablesToUpdate.size>0&&0===this._updating.size&&this._updateNextBatch()}_addDependentVariablesToUpdateQueue(e){for(const t of this.state.variables)t.variableDependency&&t.variableDependency.hasDependencyOn(e.state.name)&&(zh(t,"Added to update queue, dependant variable value changed"),this._updating.has(t)&&t.onCancel&&t.onCancel(),this._variablesToUpdate.add(t))}_notifyDependentSceneObjects(e){this.parent&&(this._traverseSceneAndNotify(this.parent,e,this._variablesThatHaveChanged.has(e)),this._variablesThatHaveChanged.delete(e))}_traverseSceneAndNotify(e,t,n){if(this!==e&&e.isActive){if(e.state.$variables&&e.state.$variables!==this&&e.state.$variables.getByName(t.state.name))return;e.variableDependency&&e.variableDependency.variableUpdateCompleted(t,n),e.forEachChild((e=>this._traverseSceneAndNotify(e,t,n)))}}isVariableLoadingOrWaitingToUpdate(e){return!(!e.isAncestorLoading||!e.isAncestorLoading())||!(!this._variablesToUpdate.has(e)&&!this._updating.has(e))||Hu.hasVariableDependencyInLoadingState(e)}constructor(e){super(e),this._variablesThatHaveChanged=new Set,this._variablesToUpdate=new Set,this._updating=new Map,this._variableValueRecorder=new Zt,this._variableDependency=new Bh(this._handleParentVariableUpdatesCompleted.bind(this)),this._onActivate=()=>{const e=Hu.getTimeRange(this);this._subs.add(this.subscribeToEvent(rt,(e=>this._handleVariableValueChanged(e.payload)))),this._subs.add(e.subscribeToState((()=>{this._refreshTimeRangeBasedVariables()}))),this._subs.add(this.subscribeToState(this._onStateChanged)),this._checkForVariablesThatChangedWhileInactive();for(const e of this.state.variables)this._variableNeedsUpdate(e)&&this._variablesToUpdate.add(e);return this._updateNextBatch(),this._onDeactivate},this._onDeactivate=()=>{var e;for(const t of this._updating.values())null==(e=t.subscription)||e.unsubscribe();for(const e of this.state.variables)this._variablesToUpdate.has(e)||this._updating.has(e)||this._variableValueRecorder.recordCurrentValue(e);this._variablesToUpdate.clear(),this._updating.clear()},this._onStateChanged=(e,t)=>{const n=this._variablesToUpdate.size;for(const n of t.variables)if(!e.variables.includes(n)){const e=this._updating.get(n);(null==e?void 0:e.subscription)&&e.subscription.unsubscribe(),this._updating.delete(n),this._variablesToUpdate.delete(n)}for(const n of e.variables)t.variables.includes(n)||this._variableNeedsUpdate(n)&&this._variablesToUpdate.add(n);0===n&&this._variablesToUpdate.size>0&&this._updateNextBatch()},this.addActivationHandler(this._onActivate)}}function zh(e,t,n){n?Gt("SceneVariableSet",`Variable[${e.state.name}]: ${t}`,n):Gt("SceneVariableSet",`Variable[${e.state.name}]: ${t}`)}class Bh{getNames(){return this._emptySet}hasDependencyOn(e){return!1}variableUpdateCompleted(e,t){this._variableUpdatesCompleted(e,t)}constructor(e){this._variableUpdatesCompleted=e,this._emptySet=new Set}}var Nh=Object.defineProperty,qh=Object.getOwnPropertySymbols,Hh=Object.prototype.hasOwnProperty,Wh=Object.prototype.propertyIsEnumerable,Uh=(e,t,n)=>t in e?Nh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Gh extends Ct{getValueOptions(e){var t;const n=(null!=(t=Hu.interpolate(this,this.state.query).match(/(?:\\,|[^,])+/g))?t:[]).map((e=>{var t;e=e.replace(/\\,/g,",");const n=null!=(t=/^(.+)\s:\s(.+)$/g.exec(e))?t:[];if(3===n.length){const[,e,t]=n;return{label:e.trim(),value:t.trim()}}return{label:e.trim(),value:e.trim()}}));return(0,D.of)(n)}constructor(e){super(((e,t)=>{for(var n in t||(t={}))Hh.call(t,n)&&Uh(e,n,t[n]);if(qh)for(var n of qh(t))Wh.call(t,n)&&Uh(e,n,t[n]);return e})({type:"custom",query:"",value:"",text:"",options:[],name:""},e)),this._variableDependency=new pu(this,{statePaths:["query"]})}}Gh.Component=({model:e})=>qn(e);var Qh=Object.defineProperty,Kh=Object.getOwnPropertySymbols,Yh=Object.prototype.hasOwnProperty,Zh=Object.prototype.propertyIsEnumerable,Xh=(e,t,n)=>t in e?Qh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Jh extends Ct{getValueOptions(t){if(!this.state.pluginId)return(0,D.of)([]);const n=(0,d.getDataSourceSrv)().getList({metrics:!0,variables:!1,pluginId:this.state.pluginId});let r;if(this.state.regex){const t=Hu.interpolate(this,this.state.regex,void 0,"regex");r=(0,e.stringToJsRegex)(t)}const a=[];for(let e=0;e<n.length;e++){const t=n[e];ef(t,r)&&a.push({label:t.name,value:t.uid}),this.state.defaultOptionEnabled&&tf(t,r)&&a.push({label:"default",value:"default"})}return 0===a.length?this.setState({error:"No data sources found"}):this.state.error&&this.setState({error:null}),(0,D.of)(a)}constructor(e){super(((e,t)=>{for(var n in t||(t={}))Yh.call(t,n)&&Xh(e,n,t[n]);if(Kh)for(var n of Kh(t))Zh.call(t,n)&&Xh(e,n,t[n]);return e})({type:"datasource",value:"",text:"",options:[],name:"",regex:"",pluginId:""},e)),this._variableDependency=new pu(this,{statePaths:["regex"]})}}function ef(e,t){return!t||t.exec(e.name)}function tf(e,t){return!!e.isDefault&&(!t||t.exec("default"))}function nf(e,t){const n=["A","B","C","D","E","F","G","H"],r=[];if(t>5)return[];for(const a of n){const n=`${e}${a}`;r.push({name:n,children:nf(n,t+1)})}return r}function rf(e,t,n){if(n>=t.length)return e;if("*"===t[n])return e;const r=t[n];let a=[],i=[r];r.startsWith("{")&&(i=r.replace(/\{|\}/g,"").split(","));for(const r of e)for(const e of i)if(-1!==e.indexOf("*")){const i=e.replace("*","");new RegExp(`^${i}.*`,"gi").test(r.name)&&(a=a.concat(rf([r],t,n+1)))}else r.name===e&&(a=a.concat(rf(r.children,t,n+1)));return a}function af(e){return 0===e.indexOf("value")?[{name:e,children:[]}]:rf(nf("",0),e.split("."),0)}Jh.Component=({model:e})=>qn(e);var of=Object.defineProperty,sf=Object.getOwnPropertySymbols,lf=Object.prototype.hasOwnProperty,uf=Object.prototype.propertyIsEnumerable,cf=(e,t,n)=>t in e?of(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class df extends Ct{getValueOptions(e){const{delayMs:t}=this.state;this.getValueOptionsCount+=1;const n=Hu.getQueryController(this);return new D.Observable((e=>{const r={type:"variable",origin:this,cancel:()=>e.complete()};if(n&&n.queryStarted(r),this.setState({loading:!0}),this.state.throwError)throw new Error(this.state.throwError);const a=Hu.interpolate(this,this.state.query),i=this.getOptions(a),o=this.completeUpdate.subscribe({next:()=>{const t={issuedQuery:a,loading:!1};this.state.updateOptions&&(t.options=i),this.setState(t),e.next(i),e.complete()}});let s;return t?s=window.setTimeout((()=>this.signalUpdateCompleted()),t):0===t&&this.signalUpdateCompleted(),this.isGettingValues=!0,()=>{o.unsubscribe(),window.clearTimeout(s),this.isGettingValues=!1,this.state.loading&&this.setState({loading:!1}),n&&n.queryCompleted(r)}}))}cancel(){const e=he(this,(e=>e instanceof $h?e:void 0));null==e||e.cancel(this)}getOptions(e){return this.state.optionsToReturn?this.state.optionsToReturn:af(e).map((e=>({label:e.name,value:e.name})))}signalUpdateCompleted(){this.completeUpdate.next(1)}constructor(t,n=!1){super(((e,t)=>{for(var n in t||(t={}))lf.call(t,n)&&cf(e,n,t[n]);if(sf)for(var n of sf(t))uf.call(t,n)&&cf(e,n,t[n]);return e})({type:"custom",name:"Test",value:"Value",text:"Text",query:"Query",options:[],refresh:e.VariableRefresh.onDashboardLoad,updateOptions:!0},t)),this.completeUpdate=new D.Subject,this.isGettingValues=!0,this.getValueOptionsCount=0,this.isLazy=!1,this._variableDependency=new pu(this,{statePaths:["query"]}),this.isLazy=n}}function pf({model:e}){const{value:n,key:a,loading:i}=e.useState(),o=(0,t.useCallback)((t=>{e.setValue(t.currentTarget.value)}),[e]),s=(0,t.useCallback)((t=>{"Enter"===t.key&&e.setValue(t.currentTarget.value)}),[e]);return r().createElement(_n.AutoSizeInput,{id:a,placeholder:"Enter value",minWidth:15,maxWidth:30,value:n,loading:i,onBlur:o,onKeyDown:s})}df.Component=({model:e})=>qn(e);var hf=Object.defineProperty,ff=Object.getOwnPropertySymbols,mf=Object.prototype.hasOwnProperty,gf=Object.prototype.propertyIsEnumerable,bf=(e,t,n)=>t in e?hf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class yf extends re{getValue(){return this.state.value}setValue(e){e!==this.state.value&&(this.setState({value:e}),this.publishEvent(new rt(this),!0))}getKey(){return`var-${this.state.name}`}getUrlState(){return{[this.getKey()]:this.state.value}}updateFromUrl(e){const t=e[this.getKey()];"string"==typeof t&&this.setValue(t)}constructor(e){super(((e,t)=>{for(var n in t||(t={}))mf.call(t,n)&&bf(e,n,t[n]);if(ff)for(var n of ff(t))gf.call(t,n)&&bf(e,n,t[n]);return e})({type:"textbox",value:"",name:""},e)),this._urlSync=new Be(this,{keys:()=>[this.getKey()]})}}yf.Component=({model:e})=>r().createElement(pf,{model:e}),Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var vf=Object.defineProperty,wf=Object.getOwnPropertySymbols,Of=Object.prototype.hasOwnProperty,Sf=Object.prototype.propertyIsEnumerable,_f=(e,t,n)=>t in e?vf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class xf extends re{getKey(){return`var-${this.state.name}`}getUrlState(){return{[this.getKey()]:this.state.value}}updateFromUrl(e){const t={},n=e[this.getKey()];"string"==typeof n&&(n.startsWith("$__auto_interval_")?t.value=vt:t.value=n),this.setState(t)}getOptionsForSelect(){const{value:e,intervals:t,autoEnabled:n}=this.state;let r=t.map((e=>({value:e,label:e})));return n&&(r=[{value:vt,label:"Auto"},...r]),e&&!r.some((t=>t.value===e))&&r.push({value:e,label:e}),r}getValue(){const{value:e,autoStepCount:t,autoMinInterval:n}=this.state;return e===vt?this.getAutoRefreshInteval(t,n):e}getAutoRefreshInteval(t,n){const r=Hu.getTimeRange(this).state.value;return e.rangeUtil.calculateInterval(r,t,n).interval}validateAndUpdate(){const{value:e,intervals:t}=this.state;let n=!1;if(e===vt)n=!0;else if(!e&&t.length>0){const e=t[0];this.setState({value:e}),n=!0}return n&&this.publishEvent(new rt(this),!0),(0,D.of)({})}constructor(e){super(((e,t)=>{for(var n in t||(t={}))Of.call(t,n)&&_f(e,n,t[n]);if(wf)for(var n of wf(t))Sf.call(t,n)&&_f(e,n,t[n]);return e})({type:"interval",value:"",intervals:["1m","10m","30m","1h","6h","12h","1d","7d","14d","30d"],name:"",autoStepCount:30,autoMinInterval:"10s",autoEnabled:!1,refresh:Xu.onTimeRangeChanged},e)),this._onChange=e=>{this.setState({value:e.value}),this.publishEvent(new rt(this),!0)},this._urlSync=new Be(this,{keys:()=>[this.getKey()]})}}xf.Component=({model:e})=>{const{key:t,value:n}=e.useState();return r().createElement(_n.Select,{id:t,placeholder:"Select value",width:"auto",value:n,tabSelectsValue:!1,options:e.getOptionsForSelect(),onChange:e._onChange})};var Pf,Cf,Ef=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},jf=(e,t,n)=>(Ef(e,t,"read from private field"),n?n.call(e):t.get(e)),Df=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},kf=(e,t,n,r)=>(Ef(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);class Tf extends e.BusEventWithPayload{}Tf.type="new-scene-object-added";class Rf{initSync(e){var t;if(this._subs&&(Gt("UrlSyncManager","Unregister previous scene state subscription",null==(t=this._sceneRoot)?void 0:t.state.key),this._subs.unsubscribe()),Gt("UrlSyncManager","init",e.state.key),this._sceneRoot=e,this._subs=new D.Subscription,this._subs.add(e.subscribeToEvent(U,(e=>{this.handleSceneObjectStateChanged(e.payload.changedObject)}))),this._subs.add(e.subscribeToEvent(Tf,(e=>{this.handleNewObject(e.payload)}))),this._urlKeyMapper.clear(),this._lastLocation=this._locationService.getLocation(),this.handleNewObject(this._sceneRoot),this._options.updateUrlOnInit){const t=Gu(e);(function(e,t){for(let n in e)if(!Yu(t.getAll(n),e[n]))return!0;return!1})(t,this._paramsCache.getParams())&&this._locationService.partial(t,!0)}}cleanUp(e){this._sceneRoot===e&&(Gt("UrlSyncManager","Clean up"),this._subs&&(this._subs.unsubscribe(),this._subs=void 0,Gt("UrlSyncManager","Root deactived, unsub to state","same key",this._sceneRoot.state.key===e.state.key)),this._sceneRoot=void 0,this._lastLocation=void 0)}handleNewLocation(e){this._sceneRoot&&this._lastLocation!==e&&(Gt("UrlSyncManager","handleNewLocation"),this._lastLocation=e,Qu(this._sceneRoot,this._paramsCache.getParams(),this._urlKeyMapper))}handleNewObject(e){this._sceneRoot&&Qu(e,this._paramsCache.getParams(),this._urlKeyMapper)}handleSceneObjectStateChanged(e){var t,n;if(!e.urlSync)return;const r=e.urlSync.getUrlState(),a=this._locationService.getSearch(),i={};for(const[t,n]of Object.entries(r)){const r=this._urlKeyMapper.getUniqueKey(t,e);Yu(a.getAll(r),n)||(i[r]=n)}if(Object.keys(i).length>0){const a=!0!==(null==(n=(t=e.urlSync).shouldCreateHistoryStep)?void 0:n.call(t,r));Gt("UrlSyncManager","onStateChange updating URL"),this._locationService.partial(i,a),this._lastLocation=this._locationService.getLocation()}}getUrlState(e){return Gu(e)}constructor(e={},t=d.locationService){this._urlKeyMapper=new Wu,this._options=e,this._locationService=t,this._paramsCache=new Af(t)}}class Af{getParams(){const e=this.locationService.getLocation();return jf(this,Cf)===e||(kf(this,Cf,e),kf(this,Pf,new URLSearchParams(e.search))),jf(this,Pf)}constructor(e){this.locationService=e,Df(this,Pf,void 0),Df(this,Cf,void 0)}}function If(e,n={}){const r=(0,i.useLocation)(),a=Pt(),[o,s]=(0,t.useState)(!1),l=function(e,n){return(0,t.useMemo)((()=>new Rf({updateUrlOnInit:e.updateUrlOnInit,createBrowserHistorySteps:e.createBrowserHistorySteps},n)),[e.updateUrlOnInit,e.createBrowserHistorySteps,n])}(n,a);return(0,t.useEffect)((()=>(l.initSync(e),s(!0),()=>l.cleanUp(e))),[e,l]),(0,t.useEffect)((()=>{const e=a.getLocation(),t=e!==r?e:r;e!==r&&Gt("useUrlSync","latestLocation different from location"),l.handleNewLocation(t)}),[e,l,r,a]),o}function Mf({children:e,scene:t,updateUrlOnInit:n,createBrowserHistorySteps:r}){return If(t,{updateUrlOnInit:n,createBrowserHistorySteps:r})?e:null}Pf=new WeakMap,Cf=new WeakMap;class Vf extends re{constructor(e){super(e),this.addActivationHandler((()=>{const e=function(e){const t=window.__grafanaSceneContext;return Gt("setWindowGrafanaScene","set window.__grafanaSceneContext",e),window.__grafanaSceneContext=e,()=>{window.__grafanaSceneContext===e&&(Gt("setWindowGrafanaScene","restore window.__grafanaSceneContext",t),window.__grafanaSceneContext=t)}}(this);return()=>{e()}}))}}Vf.Component=function({model:e}){const{body:t,controls:n}=e.useState(),a=(0,_n.useStyles2)(Ff);return r().createElement("div",{className:a.container},n&&r().createElement("div",{className:a.controls},n.map((e=>r().createElement(e.Component,{key:e.state.key,model:e})))),r().createElement("div",{className:a.body},r().createElement(t.Component,{model:t})))};const Ff=e=>({container:(0,En.css)({flexGrow:1,display:"flex",gap:e.spacing(2),minHeight:"100%",flexDirection:"column"}),body:(0,En.css)({flexGrow:1,display:"flex",gap:e.spacing(1)}),controls:(0,En.css)({display:"flex",gap:e.spacing(2),alignItems:"flex-end",flexWrap:"wrap"})});class Lf extends re{addItem(e){this.setState({items:this.state.items?[...this.state.items,e]:[e]})}setItems(e){this.setState({items:e})}}Lf.Component=function({model:e}){const{items:n=[]}=e.useState(),a=r().useRef(null);(0,t.useEffect)((()=>{a.current&&a.current.focus()}),[]);const i=e=>e.map((e=>{switch(e.type){case"divider":return r().createElement(_n.Menu.Divider,{key:e.text});case"group":return r().createElement(_n.Menu.Group,{key:e.text,label:e.text},e.subMenu?i(e.subMenu):void 0);default:return r().createElement(_n.Menu.Item,{key:e.text,label:e.text,icon:e.iconClassName,childItems:e.subMenu?i(e.subMenu):void 0,url:e.href,onClick:e.onClick,shortcut:e.shortcut,testId:Cn.components.Panels.Panel.menuItems(e.text)})}}));return r().createElement(_n.Menu,{ref:a},i(n))};var $f=function(){return $f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},$f.apply(this,arguments)};function zf(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function Bf(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){zf(i,r,a,o,s,"next",e)}function s(e){zf(i,r,a,o,s,"throw",e)}o(void 0)}))}}function Nf(){return Nf=Bf((function*(e,t,n,r){var a,i,o,s;const l=null==(a=e.request)?void 0:a.targets;if(!l)return"";const{from:u,to:c}=n,p=null==(i=e.request)?void 0:i.filters,h={__sceneObject:Kn(t)},f=(yield Promise.allSettled(l.map(function(){var e=Bf((function*(e){var t;const n=yield(0,d.getDataSourceSrv)().get(e.datasource);return(null==(t=n.interpolateVariablesInQueries)?void 0:t.call(n,[e],null!=h?h:{},p)[0])||e}));return function(t){return e.apply(this,arguments)}}()))).filter((e=>"fulfilled"===e.status)).map((e=>e.value)).map((e=>{var t;return null!=(t=null==r?void 0:r(e))?t:e})),m=null!=f?f:[],g=null==(s=null==(o=m.find((e=>{var t;return!!(null==(t=e.datasource)?void 0:t.uid)})))?void 0:o.datasource)?void 0:s.uid;return(null==m?void 0:m.length)&&g&&u&&c?`/explore?left=${encodeURIComponent(JSON.stringify({datasource:g,queries:m,range:{from:u,to:c}}))}`:""})),Nf.apply(this,arguments)}function qf(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function Hf(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){qf(i,r,a,o,s,"next",e)}function s(e){qf(i,r,a,o,s,"throw",e)}o(void 0)}))}}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;class Wf extends re{constructor(e={}){super({options:e})}}Wf.Component=function({model:e}){const{options:n}=e.useState(),{data:a}=Hu.getData(e).useState(),{from:i,to:o}=Hu.getTimeRange(e).useState(),{value:s}=function(e,n){void 0===n&&(n=[]);var r=function(e,n,r){void 0===n&&(n=[]),void 0===r&&(r={loading:!1});var a,i,o=(0,t.useRef)(0),s=(a=(0,t.useRef)(!1),i=(0,t.useCallback)((function(){return a.current}),[]),(0,t.useEffect)((function(){return a.current=!0,function(){a.current=!1}}),[]),i),l=(0,t.useState)(r),u=l[0],c=l[1],d=(0,t.useCallback)((function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=++o.current;return u.loading||c((function(e){return $f($f({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return s()&&r===o.current&&c({value:e,loading:!1}),e}),(function(e){return s()&&r===o.current&&c({error:e,loading:!1}),e}))}),n);return[u,d]}(e,n,{loading:!0}),a=r[0],i=r[1];return(0,t.useEffect)((function(){i()}),[i]),a}(Hf((function*(){return a?function(e,t,n,r){return Nf.apply(this,arguments)}(a,e,{from:i,to:o},n.transform):""})),[a,e,i,o]),l=(0,d.useReturnToPrevious)();return s?r().createElement(_n.LinkButton,{key:"explore",icon:"compass",size:"sm",variant:"secondary",href:s,onClick:()=>{var e;n.returnToPrevious&&l(n.returnToPrevious.title,n.returnToPrevious.href),null==(e=n.onClick)||e.call(n)}},"Explore"):null};class Uf extends re{}function Gf(e){return e instanceof Wm}Uf.Component=function({model:e}){const{body:t}=e.useState(),n=e.parent;if(n&&!(n instanceof Mm)&&!Gf(n))throw new Error("SceneGridItem must be a child of SceneGridLayout or SceneGridRow");return t?r().createElement(t.Component,{model:t}):null};var Qf=h(206),Kf=h.n(Qf);var Yf=Object.defineProperty,Zf=Object.getOwnPropertySymbols,Xf=Object.prototype.hasOwnProperty,Jf=Object.prototype.propertyIsEnumerable,em=(e,t,n)=>t in e?Yf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function tm(){const e=(0,t.useRef)(void 0);return null!=e.current||(e.current=(0,ge.uniqueId)()),e.current}const nm=r().forwardRef(((e,n)=>{var a=e,{children:i,onLoad:o,onChange:s,className:l}=a,u=((e,t)=>{var n={};for(var r in e)Xf.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&Zf)for(var r of Zf(e))t.indexOf(r)<0&&Jf.call(e,r)&&(n[r]=e[r]);return n})(a,["children","onLoad","onChange","className"]);const c=tm(),{hideEmpty:d}=(0,_n.useStyles2)(rm),[p,h]=(0,t.useState)(!1),[f,m]=(0,t.useState)(!1),g=(0,t.useRef)(null);var b;(0,t.useImperativeHandle)(n,(()=>g.current)),b=()=>{nm.addCallback(c,(e=>{!p&&e.isIntersecting&&(h(!0),null==o||o()),m(e.isIntersecting),null==s||s(e.isIntersecting)}));const e=g.current;return e&&nm.observer.observe(e),()=>{e&&nm.observer.unobserve(e),delete nm.callbacks[c],0===Object.keys(nm.callbacks).length&&nm.observer.disconnect()}},(0,t.useEffect)(b,[]);const y=`${p?d:""} ${l}`;return r().createElement("div",((e,t)=>{for(var n in t||(t={}))Xf.call(t,n)&&em(e,n,t[n]);if(Zf)for(var n of Zf(t))Jf.call(t,n)&&em(e,n,t[n]);return e})({id:c,ref:g,className:y},u),p&&("function"==typeof i?i({isInView:f}):i))}));function rm(){return{hideEmpty:(0,En.css)({"&:empty":{display:"none"}})}}nm.displayName="LazyLoader",nm.callbacks={},nm.addCallback=(e,t)=>nm.callbacks[e]=t,nm.observer=new IntersectionObserver((e=>{for(const t of e)"function"==typeof nm.callbacks[t.target.id]&&nm.callbacks[t.target.id](t)}),{rootMargin:"100px"});var am=Object.defineProperty,im=Object.defineProperties,om=Object.getOwnPropertyDescriptors,sm=Object.getOwnPropertySymbols,lm=Object.prototype.hasOwnProperty,um=Object.prototype.propertyIsEnumerable,cm=(e,t,n)=>t in e?am(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,dm=(e,t)=>{for(var n in t||(t={}))lm.call(t,n)&&cm(e,n,t[n]);if(sm)for(var n of sm(t))um.call(t,n)&&cm(e,n,t[n]);return e},pm=(e,t)=>im(e,om(t)),hm=(e,t)=>{var n={};for(var r in e)lm.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&sm)for(var r of sm(e))t.indexOf(r)<0&&um.call(e,r)&&(n[r]=e[r]);return n};const fm=r().forwardRef(((e,t)=>{var n;const a=e,{grid:i,layoutItem:o,index:s,totalCount:l,isLazy:u,style:c,onLoad:d,onChange:p,children:h}=a,f=hm(a,["grid","layoutItem","index","totalCount","isLazy","style","onLoad","onChange","children"]),m=i.getSceneLayoutChild(o.i),g=null==(n=m.getClassName)?void 0:n.call(m),b=r().createElement(m.Component,{model:m,key:m.state.key});return u?r().createElement(nm,pm(dm({},f),{key:m.state.key,"data-griditem-key":m.state.key,className:(0,En.cx)(g,e.className),style:c,ref:t}),b,h):r().createElement("div",pm(dm({},f),{ref:t,key:m.state.key,"data-griditem-key":m.state.key,className:(0,En.cx)(g,e.className),style:c}),b,h)}));function mm(e,t,n){e.current?t?e.current.classList.add("react-grid-layout--enable-move-animations"):e.current.classList.remove("react-grid-layout--enable-move-animations"):n||setTimeout((()=>mm(e,t,!0)),50)}fm.displayName="GridItemWrapper";const gm=r().forwardRef(((e,t)=>{var n=hm(e,["handleAxis"]);const a=(0,_n.useStyles2)(bm);return r().createElement("div",pm(dm({ref:t},n),{className:`${a} scene-resize-handle`}),r().createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r().createElement("path",{d:"M21 15L15 21M21 8L8 21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})))}));function bm(e){return(0,En.css)({position:"absolute",bottom:0,right:0,zIndex:999,padding:e.spacing(1.5,0,0,1.5),color:e.colors.border.strong,cursor:"se-resize","&:hover":{color:e.colors.text.link},svg:{display:"block"},".react-resizable-hide &":{display:"none"}})}gm.displayName="ResizeHandle";var ym=Object.defineProperty,vm=Object.defineProperties,wm=Object.getOwnPropertyDescriptors,Om=Object.getOwnPropertySymbols,Sm=Object.prototype.hasOwnProperty,_m=Object.prototype.propertyIsEnumerable,xm=(e,t,n)=>t in e?ym(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Pm=Object.defineProperty,Cm=Object.defineProperties,Em=Object.getOwnPropertyDescriptors,jm=Object.getOwnPropertySymbols,Dm=Object.prototype.hasOwnProperty,km=Object.prototype.propertyIsEnumerable,Tm=(e,t,n)=>t in e?Pm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Rm=(e,t)=>{for(var n in t||(t={}))Dm.call(t,n)&&Tm(e,n,t[n]);if(jm)for(var n of jm(t))km.call(t,n)&&Tm(e,n,t[n]);return e},Am=(e,t)=>Cm(e,Em(t));const Im=class extends re{isDraggable(){var e;return null!=(e=this.state.isDraggable)&&e}getDragClass(){return`grid-drag-handle-${this.state.key}`}getDragClassCancel(){return"grid-drag-cancel"}toggleRow(e){var t,n;if(!e.state.isCollapsed)return e.setState({isCollapsed:!0}),void this.setState({});const r=e.state.children;if(0===r.length)return e.setState({isCollapsed:!1}),void this.setState({});const a=e.state.y,i=(null!=(t=r[0].state.y)?t:a)-(a+1);let o=a;for(const e of r){const t=Rm({},e.state);t.y=null!=(n=t.y)?n:a,t.y-=i,t.y!==e.state.y&&e.setState(t),o=Math.max(o,Number(t.y)+Number(t.height))}const s=o-a-1;for(const t of this.state.children)if(t.state.y>a&&this.pushChildDown(t,s),Gf(t)&&t!==e)for(const e of t.state.children)e.state.y>a&&this.pushChildDown(e,s);e.setState({isCollapsed:!1}),this.setState({})}ignoreLayoutChange(e){this._skipOnLayoutChange=e}getSceneLayoutChild(e){for(const t of this.state.children){if(t.state.key===e)return t;if(t instanceof Wm)for(const n of t.state.children)if(n.state.key===e)return n}throw new Error("Scene layout child not found for GridItem")}pushChildDown(e,t){e.setState({y:e.state.y+t})}findGridItemSceneParent(e,t){for(let n=t;n>=0;n--){const t=e[n],r=this.getSceneLayoutChild(t.i);if(r instanceof Wm)return r.state.isCollapsed?this:r}return this}isRowDropValid(e,t,n){if(e[e.length-1].i===t.i)return!0;const r=this.getSceneLayoutChild(e[n+1].i);return r instanceof Wm||r.parent instanceof Im}moveChildTo(e,t){const n=e.parent;let r=this.state.children;const a=e.clone({key:e.state.key});if(n instanceof Wm){const i=n.clone();if(i.setState({children:i.state.children.filter((t=>t.state.key!==e.state.key))}),r=r.map((e=>e===n?i:e)),t instanceof Wm){const e=t.clone();e.setState({children:[...e.state.children,a]}),r=r.map((n=>n===t?e:n))}else r=[...r,a]}else if(!(t instanceof Im)){r=r.filter((t=>t.state.key!==e.state.key));const n=t.clone();n.setState({children:[...n.state.children,a]}),r=r.map((e=>e===t?n:e))}return r}toGridCell(e){var t,n;const r=e.state;let a=null!=(t=r.x)?t:0,i=null!=(n=r.y)?n:0;const o=Number.isInteger(Number(r.width))?Number(r.width):4,s=Number.isInteger(Number(r.height))?Number(r.height):4;let l=e.state.isDraggable,u=e.state.isResizable;return e instanceof Wm&&(l=!!e.state.isCollapsed,u=!1),{i:e.state.key,x:a,y:i,h:s,w:o,isResizable:u,isDraggable:l}}buildGridLayout(e,t){let n=[];for(const e of this.state.children)if(n.push(this.toGridCell(e)),e instanceof Wm&&!e.state.isCollapsed)for(const t of e.state.children)n.push(this.toGridCell(t));return n=Fm(n),this.state.UNSAFE_fitPanels&&(n=function(e,t){const n=t-32,r=Math.max(...e.map((e=>e.h+e.y)))/Math.floor(n/38);return e.map((e=>{return t=((e,t)=>{for(var n in t||(t={}))Sm.call(t,n)&&xm(e,n,t[n]);if(Om)for(var n of Om(t))_m.call(t,n)&&xm(e,n,t[n]);return e})({},e),n={y:Math.round(e.y/r)||0,h:Math.round(e.h/r)||1},vm(t,wm(n));var t,n}))}(n,t)),e<768?(this._skipOnLayoutChange=!0,n.map((e=>Am(Rm({},e),{w:24})))):(this._skipOnLayoutChange=!1,n)}constructor(e){super(Am(Rm({},e),{children:Vm(e.children)})),this._skipOnLayoutChange=!1,this._oldLayout=[],this._loadOldLayout=!1,this.onLayoutChange=e=>{if(this._skipOnLayoutChange)this._skipOnLayoutChange=!1;else{this._loadOldLayout&&(e=[...this._oldLayout],this._loadOldLayout=!1);for(const r of e){const e=this.getSceneLayoutChild(r.i),a={x:r.x,y:r.y,width:r.w,height:r.h};n=a,((t=e.state).x!==n.x||t.y!==n.y||t.width!==n.width||t.height!==n.height)&&e.setState(Rm({},a))}var t,n;this.setState({children:Vm(this.state.children)})}},this.onResizeStop=(e,t,n)=>{this.getSceneLayoutChild(n.i).setState({width:n.w,height:n.h})},this.onDragStart=e=>{this._oldLayout=[...e]},this.onDragStop=(e,t,n)=>{const r=this.getSceneLayoutChild(n.i);e=Fm(e);for(let t=0;t<e.length;t++){const n=e[t],r=this.getSceneLayoutChild(n.i),a=r.state;(null==a?void 0:a.x)===n.x&&(null==a?void 0:a.y)===n.y||r.setState({x:n.x,y:n.y})}const a=e.findIndex((e=>e.i===n.i));let i=this.findGridItemSceneParent(e,a-1),o=this.state.children;r instanceof Wm&&i instanceof Wm&&(this.isRowDropValid(e,n,a)||(this._loadOldLayout=!0),i=this),i!==r.parent&&(o=this.moveChildTo(r,i)),this.setState({children:Vm(o)}),this._skipOnLayoutChange=!0}}};let Mm=Im;function Vm(e){return e.forEach((e=>{e instanceof Wm&&e.setState({children:Vm(e.state.children)})})),[...e].sort(((e,t)=>e.state.y-t.state.y||e.state.x-t.state.x))}function Fm(e){return[...e].sort(((e,t)=>e.y-t.y||e.x-t.x))}Mm.Component=function({model:e}){const{children:n,isLazy:a,isDraggable:i,isResizable:o}=e.useState(),[s,{width:l,height:u}]=mc(),c=(0,t.useRef)(null);return(0,t.useEffect)((()=>{mm(c,!!i)}),[i]),function(e){if(e.some((e=>void 0===e.state.height||void 0===e.state.width||void 0===e.state.x||void 0===e.state.y)))throw new Error("All children must have a size specified")}(n),r().createElement("div",{ref:s,style:{flex:"1 1 auto",position:"relative",zIndex:1,width:"100%"}},((t,n)=>{if(!t||!n)return null;const s=e.buildGridLayout(t,n);return r().createElement("div",{ref:c,style:{width:`${t}px`,height:"100%"},className:"react-grid-layout"},r().createElement(Kf(),{width:t,isDraggable:i&&t>768,isResizable:null!=o&&o,containerPadding:[0,0],useCSSTransforms:!0,margin:[8,8],cols:24,rowHeight:30,draggableHandle:`.grid-drag-handle-${e.state.key}`,draggableCancel:".grid-drag-cancel",layout:s,onDragStart:e.onDragStart,onDragStop:e.onDragStop,onResizeStop:e.onResizeStop,onLayoutChange:e.onLayoutChange,isBounded:!1,resizeHandle:r().createElement(gm,null)},s.map(((t,n)=>r().createElement(fm,{key:t.i,grid:e,layoutItem:t,index:n,isLazy:a,totalCount:s.length})))))})(l,u))};var Lm=Object.defineProperty,$m=Object.defineProperties,zm=Object.getOwnPropertyDescriptors,Bm=Object.getOwnPropertySymbols,Nm=Object.prototype.hasOwnProperty,qm=Object.prototype.propertyIsEnumerable,Hm=(e,t,n)=>t in e?Lm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Wm extends re{getGridLayout(){const e=this.parent;if(!(e&&e instanceof Mm))throw new Error("SceneGridRow must be a child of SceneGridLayout");return e}getUrlState(){return{rowc:this.state.isCollapsed?"1":"0"}}updateFromUrl(e){null!=e.rowc&&e.rowc!==this.getUrlState().rowc&&this.onCollapseToggle()}constructor(e){var t;super((t=((e,t)=>{for(var n in t||(t={}))Nm.call(t,n)&&Hm(e,n,t[n]);if(Bm)for(var n of Bm(t))qm.call(t,n)&&Hm(e,n,t[n]);return e})({children:e.children||[],isCollapsible:e.isCollapsible||!0,title:e.title||""},e),$m(t,zm({x:0,height:1,width:24})))),this._variableDependency=new pu(this,{statePaths:["title"],handleTimeMacros:!0}),this.onCollapseToggle=()=>{this.state.isCollapsible&&this.getGridLayout().toggleRow(this)}}}Wm.Component=function({model:e}){const t=(0,_n.useStyles2)(Um),{isCollapsible:n,isCollapsed:a,title:i,actions:o,children:s}=e.useState(),l=e.getGridLayout(),u=l.getDragClass(),c=l.isDraggable(),d=s?s.length:0,p=1===d?"panel":"panels";return r().createElement("div",{className:(0,En.cx)(t.row,a&&t.rowCollapsed)+" oodle-panel-row oodle-panel-row-"+(a?"closed":"open")},r().createElement("div",{className:t.rowTitleAndActionsGroup},r().createElement("button",{onClick:e.onCollapseToggle,className:t.rowTitleButton,"aria-label":a?"Expand row":"Collapse row","data-testid":Cn.components.DashboardRow.title(Hu.interpolate(e,i,void 0,"text"))},n&&r().createElement(_n.Icon,{name:a?"angle-right":"angle-down"}),r().createElement("span",{className:t.rowTitle,role:"heading"},Hu.interpolate(e,i,void 0,"text"))),r().createElement("span",{className:(0,En.cx)(t.panelCount,a&&t.panelCountCollapsed)},"(",d," ",p,")"),o&&r().createElement("div",{className:t.rowActions},r().createElement(o.Component,{model:o}))),c&&a&&r().createElement("div",{className:(0,En.cx)(t.dragHandle,u)},r().createElement(_n.Icon,{name:"draggabledots"})))};const Um=e=>({row:(0,En.css)({width:"100%",height:"30px",display:"flex",justifyContent:"space-between",gap:e.spacing(1)}),rowTitleButton:(0,En.css)({display:"flex",alignItems:"center",cursor:"pointer",background:"transparent",border:"none",minWidth:0,gap:e.spacing(1)}),rowCollapsed:(0,En.css)({borderBottom:`1px solid ${e.colors.border.weak}`}),rowTitle:(0,En.css)({fontSize:e.typography.h5.fontSize,fontWeight:e.typography.fontWeightMedium,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",flexGrow:1,minWidth:0}),collapsedInfo:(0,En.css)({fontSize:e.typography.bodySmall.fontSize,color:e.colors.text.secondary,display:"flex",alignItems:"center",flexGrow:1}),rowTitleAndActionsGroup:(0,En.css)({display:"flex",minWidth:0,"&:hover, &:focus-within":{"& > div":{opacity:1}}}),rowActions:(0,En.css)({display:"flex",whiteSpace:"nowrap",opacity:0,transition:"200ms opacity ease-in 200ms","&:hover, &:focus-within":{opacity:1}}),dragHandle:(0,En.css)({display:"flex",padding:e.spacing(0,1),alignItems:"center",justifyContent:"flex-end",cursor:"move",color:e.colors.text.secondary,"&:hover":{color:e.colors.text.primary}}),panelCount:(0,En.css)({whiteSpace:"nowrap",paddingLeft:e.spacing(2),color:e.colors.text.secondary,fontStyle:"italic",fontSize:e.typography.size.sm,fontWeight:"normal",display:"none",lineHeight:"30px"}),panelCountCollapsed:(0,En.css)({display:"inline-block"})});class Gm extends re{constructor(){super(...arguments),this.onToggle=()=>{this.setState({isCollapsed:!this.state.isCollapsed})},this.onRemove=()=>{const e=this.parent;"body"in e.state&&e.setState({body:void 0})}}}Gm.Component=function({model:e}){const{title:t,isCollapsed:n,canCollapse:a,canRemove:i,body:o,controls:s}=e.useState(),l=(0,_n.useStyles2)(Um),u=(0,_n.useStyles2)(Qm),c=(null!=s?s:[]).map((e=>r().createElement(e.Component,{key:e.state.key,model:e})));return i&&c.push(r().createElement(_n.ToolbarButton,{icon:"times",variant:"default",onClick:e.onRemove,key:"remove-button","aria-label":"Remove scene"})),r().createElement("div",{className:u.wrapper},r().createElement("div",{className:(0,En.cx)(u.row,n&&u.rowCollapsed)},r().createElement("button",{onClick:e.onToggle,className:l.rowTitleButton,"aria-label":n?"Expand scene":"Collapse scene"},a&&r().createElement(_n.Icon,{name:n?"angle-right":"angle-down"}),r().createElement("span",{className:l.rowTitle,role:"heading"},Hu.interpolate(e,t,void 0,"text"))),r().createElement("div",{className:u.actions},c)),!n&&r().createElement(o.Component,{model:o}))};const Qm=e=>({wrapper:(0,En.css)({display:"flex",flexDirection:"column",flexGrow:1,gap:e.spacing(1)}),row:(0,En.css)({width:"100%",display:"flex",justifyContent:"space-between",gap:e.spacing(1)}),rowCollapsed:(0,En.css)({borderBottom:`1px solid ${e.colors.border.weak}`,paddingBottom:e.spacing(1)}),actions:(0,En.css)({display:"flex",alignItems:"center",gap:e.spacing(1),justifyContent:"flex-end",flexGrow:1})});class Km extends re{constructor(){super(...arguments),this._variableDependency=new pu(this,{statePaths:["text"]})}}Km.Component=({model:e})=>{const{text:t,fontSize:n=20,align:a="left",key:i,spacing:o}=e.useState(),s=(0,_n.useTheme2)(),l=(0,En.css)({fontSize:n,display:"flex",flexGrow:1,alignItems:"center",padding:o?s.spacing(o,0):void 0,justifyContent:a});return r().createElement("div",{className:l,"data-testid":i},Hu.interpolate(e,t))},class extends re{}.Component=({model:e})=>{const t=e.useState();return r().createElement(_n.ToolbarButton,{onClick:t.onClick,icon:t.icon})};class Ym extends re{}Ym.Component=({model:e})=>{const t=e.useState();return r().createElement("div",{style:{display:"flex"}},t.label&&r().createElement(cr,{label:t.label}),r().createElement(_n.Input,{defaultValue:t.value,width:8,onBlur:t=>{e.state.onChange(parseInt(t.currentTarget.value,10))}}))};class Zm extends re{constructor(){super(...arguments),this.onZoom=()=>{const t=Hu.getTimeRange(this),n=function(t){const n=t.to.valueOf()-t.from.valueOf(),r=t.to.valueOf()-n/2,a=0===n?3e4:2*n,i=r+a/2,o=r-a/2;return{from:(0,e.toUtc)(o),to:(0,e.toUtc)(i),raw:{from:(0,e.toUtc)(o),to:(0,e.toUtc)(i)}}}(t.state.value);t.onTimeRangeChange(n)},this.onChangeFiscalYearStartMonth=e=>{Hu.getTimeRange(this).setState({fiscalYearStartMonth:e})},this.toAbsolute=()=>{const t=Hu.getTimeRange(this),n=t.state.value,r=(0,e.toUtc)(n.from),a=(0,e.toUtc)(n.to);t.onTimeRangeChange({from:r,to:a,raw:{from:r,to:a}})},this.onMoveBackward=()=>{const e=Hu.getTimeRange(this),{state:{value:t}}=e;e.onTimeRangeChange(Jm(Xm.Backward,t,Date.now()))},this.onMoveForward=()=>{const e=Hu.getTimeRange(this),{state:{value:t}}=e;e.onTimeRangeChange(Jm(Xm.Forward,t,Date.now()))}}}Zm.Component=function({model:n}){const{hidePicker:a,isOnCanvas:i}=n.useState(),o=Hu.getTimeRange(n),s=o.getTimeZone(),l=o.useState(),[u,c]=function(e,n,r){if(!pc)return[n,dc,dc];if(!e)throw new Error("useLocalStorage key may not be falsy");var a=r?r.raw?function(e){return e}:r.deserializer:JSON.parse,i=(0,t.useRef)((function(e){try{var t=r?r.raw?String:r.serializer:JSON.stringify,i=localStorage.getItem(e);return null!==i?a(i):(n&&localStorage.setItem(e,t(n)),n)}catch(e){return n}})),o=(0,t.useState)((function(){return i.current(e)})),s=o[0],l=o[1];(0,t.useLayoutEffect)((function(){return l(i.current(e))}),[e]);var u=(0,t.useCallback)((function(t){try{var n,i="function"==typeof t?t(s):t;if(void 0===i)return;n=r?r.raw?"string"==typeof i?i:JSON.stringify(i):r.serializer?r.serializer(i):JSON.stringify(i):JSON.stringify(i),localStorage.setItem(e,n),l(a(n))}catch(e){}}),[e,l]),c=(0,t.useCallback)((function(){try{localStorage.removeItem(e),l(void 0)}catch(e){}}),[e,l]);return[s,u,c]}(eg,[],{raw:!1,serializer:ng,deserializer:tg});return a?null:r().createElement(_n.TimeRangePicker,{isOnCanvas:null==i||i,value:l.value,onChange:t=>{var n;n=t,((0,e.isDateTime)(n.raw.from)||(0,e.isDateTime)(n.raw.to))&&c([t,...null!=u?u:[]]),o.onTimeRangeChange(t)},timeZone:s,fiscalYearStartMonth:l.fiscalYearStartMonth,onMoveBackward:n.onMoveBackward,onMoveForward:n.onMoveForward,onZoom:n.onZoom,onChangeTimeZone:o.onTimeZoneChange,onChangeFiscalYearStartMonth:n.onChangeFiscalYearStartMonth,weekStart:l.weekStart,history:u})};var Xm=(e=>(e[e.Backward=0]="Backward",e[e.Forward=1]="Forward",e))(Xm||{});function Jm(t,n,r){const a=n.to.valueOf(),i=n.from.valueOf(),o=(a-i)/2;let s,l;0===t?(s=i-o,l=a-o):(s=i+o,l=a+o,l>r&&a<r&&(l=r,s=i));const u=(0,e.toUtc)(s),c=(0,e.toUtc)(l);return{from:u,to:c,raw:{from:u,to:c}}}const eg="grafana.dashboard.timepicker.history";function tg(t){return JSON.parse(t).map((t=>e.rangeUtil.convertRawToRange(t,"utc",void 0,"YYYY-MM-DD HH:mm:ss")))}function ng(e){return JSON.stringify((t=e.map((e=>({from:"string"==typeof e.raw.from?e.raw.from:e.raw.from.toISOString(),to:"string"==typeof e.raw.to?e.raw.to:e.raw.to.toISOString()}))),(0,ge.uniqBy)(t,(e=>e.from+e.to)).slice(0,4)));var t}var rg=Object.defineProperty,ag=Object.defineProperties,ig=Object.getOwnPropertyDescriptors,og=Object.getOwnPropertySymbols,sg=Object.prototype.hasOwnProperty,lg=Object.prototype.propertyIsEnumerable,ug=(e,t,n)=>t in e?rg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const cg=["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"];class dg extends re{getUrlState(){let e=this.state.refresh;return"string"==typeof e&&0!==e.length||(e=void 0),{refresh:e}}updateFromUrl(t){const{intervals:n}=this.state;let r=t.refresh;"string"==typeof r&&function(t){try{return e.rangeUtil.describeInterval(t).count>0}catch(e){return!1}}(r)&&((null==n?void 0:n.includes(r))?this.setState({refresh:r}):this.setState({refresh:n?n[0]:void 0}))}isTabVisible(){return void 0===document.visibilityState||"visible"===document.visibilityState}constructor(t){var n,r,a,i,o;super((i=((e,t)=>{for(var n in t||(t={}))sg.call(t,n)&&ug(e,n,t[n]);if(og)for(var n of og(t))lg.call(t,n)&&ug(e,n,t[n]);return e})({refresh:""},t),o={autoValue:void 0,autoEnabled:null==(n=t.autoEnabled)||n,autoMinInterval:null!=(r=t.autoMinInterval)?r:d.config.minRefreshInterval,intervals:(null!=(a=t.intervals)?a:cg).filter((n=>{var r;const a=null!=(r=t.minRefreshInterval)?r:d.config.minRefreshInterval;try{return!a||e.rangeUtil.intervalToMs(n)>=e.rangeUtil.intervalToMs(a)}catch(e){return!1}}))},ag(i,ig(o)))),this._urlSync=new Be(this,{keys:["refresh"]}),this._autoRefreshBlocked=!1,this.onRefresh=()=>{const e=Hu.getQueryController(this);if(null==e?void 0:e.state.isRunning)return void e.cancelAll();const t=Hu.getTimeRange(this);this._intervalTimer&&clearInterval(this._intervalTimer),t.onRefresh(),this.setupIntervalTimer()},this.onIntervalChanged=e=>{this.setState({refresh:e}),this.setupIntervalTimer()},this.setupAutoTimeRangeListener=()=>Hu.getTimeRange(this).subscribeToState(((e,t)=>{e.from===t.from&&e.to===t.to||this.setupIntervalTimer()})),this.calculateAutoRefreshInterval=()=>{var t;const n=Hu.getTimeRange(this),r=null!=(t=null==window?void 0:window.innerWidth)?t:2e3;return e.rangeUtil.calculateInterval(n.state.value,r,this.state.autoMinInterval)},this.setupIntervalTimer=()=>{var t;const n=Hu.getTimeRange(this),{refresh:r,intervals:a}=this.state;if((this._intervalTimer||""===r)&&clearInterval(this._intervalTimer),""===r)return;if(r!==_n.RefreshPicker.autoOption.value&&a&&!a.includes(r))return;let i;if(null==(t=this._autoTimeRangeListener)||t.unsubscribe(),r===_n.RefreshPicker.autoOption.value){const e=this.calculateAutoRefreshInterval();i=e.intervalMs,this._autoTimeRangeListener=this.setupAutoTimeRangeListener(),e.interval!==this.state.autoValue&&this.setState({autoValue:e.interval})}else i=e.rangeUtil.intervalToMs(r);this._intervalTimer=setInterval((()=>{this.isTabVisible()?n.onRefresh():this._autoRefreshBlocked=!0}),i)},this.addActivationHandler((()=>{this.setupIntervalTimer();const e=()=>{this._autoRefreshBlocked&&"visible"===document.visibilityState&&(this._autoRefreshBlocked=!1,this.onRefresh())};return document.addEventListener("visibilitychange",e),()=>{var t;this._intervalTimer&&clearInterval(this._intervalTimer),document.removeEventListener("visibilitychange",e),null==(t=this._autoTimeRangeListener)||t.unsubscribe()}}))}}dg.Component=function({model:e}){var t;const{refresh:n,intervals:a,autoEnabled:i,autoValue:o,isOnCanvas:s,primary:l,withText:u}=e.useState(),c=function(e){const t=Hu.getQueryController(e);return!!t&&t.useState().isRunning}(e);let d,p,h=n===(null==(t=_n.RefreshPicker.autoOption)?void 0:t.value)?o:u?"Refresh":void 0;return c&&(d="Cancel all queries",u&&(h="Cancel")),u&&(p="96px"),r().createElement(_n.RefreshPicker,{showAutoInterval:i,value:n,intervals:a,tooltip:d,width:p,text:h,onRefresh:e.onRefresh,primary:l,onIntervalChanged:e.onIntervalChanged,isLoading:c,isOnCanvas:null==s||s})};const pg=e=>`${e}-compare`;var hg=Object.defineProperty,fg=Object.defineProperties,mg=Object.getOwnPropertyDescriptors,gg=Object.getOwnPropertySymbols,bg=Object.prototype.hasOwnProperty,yg=Object.prototype.propertyIsEnumerable,vg=(e,t,n)=>t in e?hg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,wg=(e,t)=>{for(var n in t||(t={}))bg.call(t,n)&&vg(e,n,t[n]);if(gg)for(var n of gg(t))yg.call(t,n)&&vg(e,n,t[n]);return e},Og=(e,t)=>fg(e,mg(t));const Sg="__previousPeriod",_g="__noPeriod",xg={label:"Previous period",value:Sg},Pg={label:"No comparison",value:_g},Cg=[{label:"Day before",value:"24h"},{label:"Week before",value:"1w"},{label:"Month before",value:"1M"}];class Eg extends re{getExtraQueries(e){const t=[],n=this.getCompareTimeRange(e.range);if(!n)return t;const r=e.targets.filter((e=>!1!==e.timeRangeCompare));return r.length&&t.push({req:Og(wg({},e),{targets:r,range:n}),processor:jg}),t}shouldRerun(e,t,n){return e.compareWith!==t.compareWith&&void 0!==n.find((e=>!1!==e.timeRangeCompare))}getCompareTimeRange(t){let n,r;if(this.state.compareWith){if(this.state.compareWith===Sg){const a=t.to.diff(t.from);n=(0,e.dateTime)(t.from).subtract(a),r=(0,e.dateTime)(t.to).subtract(a)}else n=(0,e.dateTime)(t.from).subtract(e.rangeUtil.intervalToMs(this.state.compareWith)),r=(0,e.dateTime)(t.to).subtract(e.rangeUtil.intervalToMs(this.state.compareWith));return{from:n,to:r,raw:{from:n,to:r}}}}getUrlState(){return{compareWith:this.state.compareWith}}updateFromUrl(e){if(!e.compareWith)return;const t=qe(e.compareWith);t&&(this.getCompareOptions(Hu.getTimeRange(this).state.value).find((({value:e})=>e===t))?this.setState({compareWith:t}):this.setState({compareWith:"__previousPeriod"}))}constructor(t){super(wg({compareOptions:Cg},t)),this._urlSync=new Be(this,{keys:["compareWith"]}),this._onActivate=()=>{const e=Hu.getTimeRange(this);this.setState({compareOptions:this.getCompareOptions(e.state.value)}),this._subs.add(e.subscribeToState((e=>{const t=this.getCompareOptions(e.value),n={compareOptions:t};Boolean(this.state.compareWith)&&!t.find((({value:e})=>e===this.state.compareWith))&&(n.compareWith=Sg),this.setState(n)})))},this.getCompareOptions=t=>{const n=Math.ceil(t.to.diff(t.from)),r=Cg.findIndex((({value:t})=>e.rangeUtil.intervalToMs(t)>=n));return[Pg,xg,...Cg.slice(r).map((({label:e,value:t})=>({label:e,value:t})))]},this.onCompareWithChanged=e=>{e===_g?this.onClearCompare():this.setState({compareWith:e})},this.onClearCompare=()=>{this.setState({compareWith:void 0})},this.addActivationHandler(this._onActivate)}}Eg.Component=function({model:e}){var t;const n=(0,_n.useStyles2)(Dg),{compareWith:a,compareOptions:i}=e.useState(),[o,s]=r().useState(a),l=null!=(t=i.find((({value:e})=>e===o)))?t:xg,u=i.find((({value:e})=>e===a)),c=Boolean(u),d=()=>{c?(s(a),e.onClearCompare()):c||e.onCompareWithChanged(l.value)};return r().createElement(_n.ButtonGroup,null,r().createElement(_n.ToolbarButton,{variant:"canvas",tooltip:"Enable time frame comparison",onClick:e=>{e.stopPropagation(),e.preventDefault(),d()}},r().createElement(_n.Checkbox,{label:" ",value:c,onClick:d}),"Comparison"),c?r().createElement(_n.ButtonSelect,{variant:"canvas",value:u,options:i,onChange:t=>{e.onCompareWithChanged(t.value)}}):r().createElement(_n.ToolbarButton,{className:n.previewButton,disabled:!0,variant:"canvas",isOpen:!1},l.label))};const jg=(t,n)=>{const r=n.timeRange.from.diff(t.timeRange.from);return n.series.forEach((t=>{t.refId=pg(t.refId||""),t.meta=Og(wg({},t.meta),{timeCompare:{diffMs:r,isTimeShiftQuery:!0}}),t.fields.forEach((t=>(t.type===e.FieldType.time&&(t.values=t.values.map((e=>r<0?e-r:e+r))),t.config=Og(wg({},t.config),{color:{mode:"fixed",fixedColor:d.config.theme.palette.gray60}}),t)))})),(0,D.of)(n)};function Dg(e){return{previewButton:(0,En.css)({"&:disabled":{border:`1px solid ${e.colors.secondary.border}`,color:e.colors.text.disabled,opacity:1}})}}class kg extends re{performRepeat(e){const t=[];for(let n=0;n<e.series.length;n++){const r=this.state.getLayoutChild(e,e.series[n],n);t.push(r)}this.state.body.setState({children:t})}constructor(t){super(t),this.addActivationHandler((()=>{const t=Hu.getData(this);this._subs.add(t.subscribeToState((t=>{var n;(null==(n=t.data)?void 0:n.state)===e.LoadingState.Done&&this.performRepeat(t.data)}))),t.state.data&&this.performRepeat(t.state.data)}))}}kg.Component=({model:e})=>{const{body:t}=e.useState();return r().createElement(t.Component,{model:t})};class Tg extends re{performRepeat(){if(this._variableDependency.hasDependencyInLoadingState())return;const e=Hu.lookupVariable(this.state.variableName,this);if(!(e instanceof Ct))return void console.error("SceneByVariableRepeater: variable is not a MultiValueVariable");const t=function(e){const{value:t,text:n,options:r}=e.state;return e.hasAllValue()?r:Array.isArray(t)&&Array.isArray(n)?t.map(((e,t)=>({value:e,label:n[t]}))):[{value:t,label:n}]}(e),n=[];for(const e of t){const t=this.state.getLayoutChild(e);n.push(t)}this.state.body.setState({children:n})}constructor(e){super(e),this._variableDependency=new pu(this,{variableNames:[this.state.variableName],onVariableUpdateCompleted:()=>this.performRepeat()}),this.addActivationHandler((()=>this.performRepeat()))}}Tg.Component=({model:e})=>{const{body:t}=e.useState();return r().createElement(t.Component,{model:t})};class Rg extends re{constructor(){super({}),this._renderBeforeActivation=!0}}Rg.Component=e=>r().createElement("div",{style:{flexGrow:1}});class Ag extends re{toggleDirection(){this.setState({direction:"row"===this.state.direction?"column":"row"})}isDraggable(){return!1}}Ag.Component=function({model:e,parentState:n}){const{children:a,isHidden:i}=e.useState(),o=function(e,n){return(0,t.useMemo)((()=>{var t,r,a,i,o,s,l,u,c,p;const{direction:h="row",wrap:f}=e,m=d.config.theme2,g={};return n?Mg(g,e,n):(g.display="flex",g.flexGrow=1,g.minWidth=e.minWidth,g.minHeight=e.minHeight),g.flexDirection=h,g.gap="8px",g.flexWrap=f||"nowrap",g.alignContent="baseline",g.minWidth=g.minWidth||0,g.minHeight=g.minHeight||0,g[m.breakpoints.down("md")]={flexDirection:null!=(r=null==(t=e.md)?void 0:t.direction)?r:"column",maxWidth:null!=(i=null==(a=e.md)?void 0:a.maxWidth)?i:"unset",maxHeight:null!=(s=null==(o=e.md)?void 0:o.maxHeight)?s:"unset",height:null!=(u=null==(l=e.md)?void 0:l.height)?u:"unset",width:null!=(p=null==(c=e.md)?void 0:c.width)?p:"unset"},(0,En.css)(g)}),[n,e])}(e.state,n);return i?null:r().createElement("div",{className:o},a.map((t=>{const n=t.Component;return r().createElement(n,{key:t.state.key,model:t,parentState:e.state})})))};class Ig extends re{}function Mg(e,t,n){var r,a,i;const o=null!=(r=n.direction)?r:"row",{xSizing:s="fill",ySizing:l="fill"}=t;return e.display="flex",e.position="relative",e.flexDirection=o,"column"===o?(t.height?e.height=t.height:e.flexGrow="fill"===l?1:0,t.width?e.width=t.width:e.alignSelf="fill"===s?"stretch":"flex-start"):(t.height?e.height=t.height:e.alignSelf="fill"===l?"stretch":"flex-start",t.width?e.width=t.width:e.flexGrow="fill"===s?1:0),e.minWidth=t.minWidth,e.maxWidth=t.maxWidth,e.maxHeight=t.maxHeight,e.minHeight=null!=(a=t.minHeight)?a:n.minHeight,e.height=null!=(i=t.height)?i:n.height,e}Ig.Component=function({model:e,parentState:n}){if(!n)throw new Error("SceneFlexItem must be a child of SceneFlexLayout");const{body:a,isHidden:i}=e.useState(),o=function(e,n){return(0,t.useMemo)((()=>{var t,r,a,i,o,s,l,u,c,p;const h=d.config.theme2,f=Mg({},e,n);return f[h.breakpoints.down("md")]={maxWidth:null!=(r=null==(t=e.md)?void 0:t.maxWidth)?r:"unset",maxHeight:null!=(i=null==(a=e.md)?void 0:a.maxHeight)?i:"unset",height:null!=(l=null==(o=e.md)?void 0:o.height)?l:null==(s=n.md)?void 0:s.height,width:null!=(p=null==(u=e.md)?void 0:u.width)?p:null==(c=n.md)?void 0:c.width},(0,En.css)(f)}),[e,n])}(e.state,n);return!a||i?null:r().createElement("div",{className:o},r().createElement(a.Component,{model:a}))};var Vg=Object.defineProperty,Fg=Object.getOwnPropertySymbols,Lg=Object.prototype.hasOwnProperty,$g=Object.prototype.propertyIsEnumerable,zg=(e,t,n)=>t in e?Vg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Bg extends re{isDraggable(){return!1}constructor(e){var t,n;super(((e,t)=>{for(var n in t||(t={}))Lg.call(t,n)&&zg(e,n,t[n]);if(Fg)for(var n of Fg(t))$g.call(t,n)&&zg(e,n,t[n]);return e})({rowGap:1,columnGap:1,templateColumns:"repeat(auto-fit, minmax(400px, 1fr))",autoRows:null!=(t=e.autoRows)?t:"320px",children:null!=(n=e.children)?n:[]},e))}}Bg.Component=function({model:e}){const{children:n,isHidden:a,isLazy:i}=e.useState(),o=(s=e.state,(0,t.useMemo)((()=>{var e,t,n,r,a,i,o,l,u,c,p;const h={},f=d.config.theme2;return h.display="grid",h.gridTemplateColumns=s.templateColumns,h.gridTemplateRows=s.templateRows||"unset",h.gridAutoRows=s.autoRows||"unset",h.rowGap=f.spacing(null!=(e=s.rowGap)?e:1),h.columnGap=f.spacing(null!=(t=s.columnGap)?t:1),h.justifyItems=s.justifyItems||"unset",h.alignItems=s.alignItems||"unset",h.justifyContent=s.justifyContent||"unset",h.flexGrow=1,s.md&&(h[f.breakpoints.down("md")]={gridTemplateRows:null==(n=s.md)?void 0:n.templateRows,gridTemplateColumns:null==(r=s.md)?void 0:r.templateColumns,rowGap:s.md.rowGap?f.spacing(null!=(i=null==(a=s.md)?void 0:a.rowGap)?i:1):void 0,columnGap:s.md.columnGap?f.spacing(null!=(l=null==(o=s.md)?void 0:o.rowGap)?l:1):void 0,justifyItems:null==(u=s.md)?void 0:u.justifyItems,alignItems:null==(c=s.md)?void 0:c.alignItems,justifyContent:null==(p=s.md)?void 0:p.justifyContent}),(0,En.css)(h)}),[s]));var s;return a?null:r().createElement("div",{className:o},n.map((t=>{const n=t.Component;return i?r().createElement(nm,{key:t.state.key,className:o},r().createElement(n,{key:t.state.key,model:t,parentState:e.state})):r().createElement(n,{key:t.state.key,model:t,parentState:e.state})})))};class Ng extends re{}Ng.Component=function({model:e,parentState:n}){if(!n)throw new Error("SceneCSSGridItem must be a child of SceneCSSGridLayout");const{body:a,isHidden:i}=e.useState(),o=(s=e.state,(0,t.useMemo)((()=>{const e={};return e.gridColumn=s.gridColumn||"unset",e.gridRow=s.gridRow||"unset",e.position="relative",(0,En.css)(e)}),[s]));var s;return!a||i?null:r().createElement("div",{className:o},r().createElement(a.Component,{model:a}))};var qg=Object.defineProperty,Hg=Object.getOwnPropertySymbols,Wg=Object.prototype.hasOwnProperty,Ug=Object.prototype.propertyIsEnumerable,Gg=(e,t,n)=>t in e?qg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Qg=(e,t)=>{for(var n in t||(t={}))Wg.call(t,n)&&Gg(e,n,t[n]);if(Hg)for(var n of Hg(t))Ug.call(t,n)&&Gg(e,n,t[n]);return e};const Kg=new Set(["ArrowUp","ArrowDown"]),Yg=new Set(["ArrowLeft","ArrowRight"]),Zg={row:{dim:"width",axis:"clientX",min:"minWidth",max:"maxWidth"},column:{dim:"height",axis:"clientY",min:"minHeight",max:"maxHeight"}};function Xg({direction:e="row",handleSize:n=32,initialSize:a="auto",primaryPaneStyles:i,secondaryPaneStyles:o,onDragFinished:s,children:l}){const u=r().Children.toArray(l),c=(0,t.useRef)(null),d=(0,t.useRef)(null),p=(0,t.useRef)(null),h=(0,t.useRef)(null),f=(0,t.useRef)(null),m=(0,t.useRef)("1fr"),g=(0,t.useRef)(void 0),b=(0,t.useRef)(void 0),y=Zg[e].dim,v=Zg[e].axis,w=Zg[e].min,O=Zg[e].max;!function(e,n,r=0,a){const i=(0,ge.throttle)(n,r);(0,t.useLayoutEffect)((()=>{if(!e)return;const t=new ResizeObserver(i);return t.observe(e,{box:"device-pixel-content-box"}),()=>t.disconnect()}),a)}(h.current,(e=>{for(const t of e){if(!t.target.isSameNode(h.current))return;const e=d.current.getBoundingClientRect()[y],n=eb(d.current);c.current.ariaValueNow=`${(0,ge.clamp)((e-n[w])/(n[O]-n[w])*100,0,100)}`}}),500,[O,w,e,y]);const S=(0,t.useRef)(null),_=(0,t.useCallback)((e=>{m.current=d.current.getBoundingClientRect()[y],f.current=h.current.getBoundingClientRect()[y],S.current=e[v],c.current.setPointerCapture(e.pointerId),g.current=eb(d.current),b.current=void 0}),[y,v]),x=(0,t.useCallback)((e=>{if(null!==S.current&&"1fr"!==m.current){const t=e[v]-S.current,r=g.current,a=(0,ge.clamp)(m.current+t,r[w],r[O]),i=a/(f.current-n);d.current.style.flexGrow=`${i}`,p.current.style.flexGrow=""+(1-i);const o=(0,ge.clamp)((a-r[w])/(r[O]-r[w])*100,0,100);c.current.ariaValueNow=`${o}`}}),[n,v,w,O]),P=(0,t.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),c.current.releasePointerCapture(e.pointerId),S.current=null,null==s||s(parseFloat(d.current.style.flexGrow))}),[s]),C=(0,t.useRef)(new Set),E=(0,t.useRef)(null),j=(0,t.useCallback)((t=>{var r;if(0===C.current.size)return void(E.current=null);if("1fr"===m.current)return;const a=.3*(t-(null!=(r=E.current)?r:t));let i=0;"row"===e?(C.current.has("ArrowLeft")&&(i-=a),C.current.has("ArrowRight")&&(i+=a)):(C.current.has("ArrowUp")&&(i-=a),C.current.has("ArrowDown")&&(i+=a));const o=g.current,s=d.current.getBoundingClientRect()[y],l=(0,ge.clamp)(s+i,o[w],o[O]),u=l/(f.current-n);d.current.style.flexGrow=`${u}`,p.current.style.flexGrow=""+(1-u);const h=(l-o[w])/(o[O]-o[w])*100;c.current.ariaValueNow=`${(0,ge.clamp)(h,0,100)}`,E.current=t,window.requestAnimationFrame(j)}),[e,n,w,O,y]),D=(0,t.useCallback)((t=>{if("Enter"!==t.key){if("Home"===t.key){g.current=eb(d.current),f.current=h.current.getBoundingClientRect()[y];const e=g.current[w]/(f.current-n);return d.current.style.flexGrow=`${e}`,p.current.style.flexGrow=""+(1-e),void(c.current.ariaValueNow="0")}if("End"===t.key){g.current=eb(d.current),f.current=h.current.getBoundingClientRect()[y];const e=g.current[O]/(f.current-n);return d.current.style.flexGrow=`${e}`,p.current.style.flexGrow=""+(1-e),void(c.current.ariaValueNow="100")}if(("column"===e&&Kg.has(t.key)||"row"===e&&Yg.has(t.key))&&!C.current.has(t.key)&&(b.current=void 0,t.preventDefault(),t.stopPropagation(),m.current=d.current.getBoundingClientRect()[y],f.current=h.current.getBoundingClientRect()[y],g.current=eb(d.current),!C.current.has(t.key))){const e=0===C.current.size;C.current.add(t.key),e&&window.requestAnimationFrame(j)}}else void 0===b.current?(b.current=d.current.style.flexGrow,d.current.style.flexGrow="0",p.current.style.flexGrow="1"):(d.current.style.flexGrow=b.current,p.current.style.flexGrow=""+(1-parseFloat(b.current)),b.current=void 0)}),[e,j,n,O,y,w]),k=(0,t.useCallback)((t=>{"row"===e&&!Yg.has(t.key)||"column"===e&&!Kg.has(t.key)||(C.current.delete(t.key),null==s||s(parseFloat(d.current.style.flexGrow)))}),[e,s]),T=(0,t.useCallback)((()=>{d.current.style.flexGrow="0.5",p.current.style.flexGrow="0.5";const e=eb(d.current);g.current=e,m.current=d.current.getBoundingClientRect()[y],c.current.ariaValueNow=""+(m.current-e[w])/(e[O]-e[w])*100}),[O,y,w]),R=(0,t.useCallback)((()=>{C.current.size>0&&(C.current.clear(),S.current=null,null==s||s(parseFloat(d.current.style.flexGrow)))}),[s]),A=(0,_n.useStyles2)(Jg),I=tm(),M=2===u.length?"visible":"hidden";return r().createElement("div",{ref:h,className:A.container,style:{flexDirection:e}},r().createElement("div",{ref:d,className:A.panel,style:Qg({flexGrow:"auto"===a?.5:(0,ge.clamp)(a,0,1),[w]:"min-content"},i),id:`start-panel-${I}`},u[0]),u[1]&&r().createElement(r().Fragment,null,r().createElement("div",{ref:c,style:{[y]:`${n}px`},className:(0,En.cx)(A.handle,{[A.handleHorizontal]:"column"===e}),onPointerUp:P,onPointerDown:_,onPointerMove:x,onKeyDown:D,onKeyUp:k,onDoubleClick:T,onBlur:R,role:"separator","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":50,"aria-controls":`start-panel-${I}`,"aria-label":"Pane resize widget",tabIndex:0}),r().createElement("div",{ref:p,className:A.panel,style:Qg({flexGrow:"auto"===a?.5:(0,ge.clamp)(1-a,0,1),[w]:"min-content",visibility:`${M}`},o),id:`end-panel-${I}`},u[1])))}function Jg(e){return{handle:(0,En.css)({cursor:"col-resize",position:"relative",flexShrink:0,userSelect:"none","&::before":{content:'""',position:"absolute",backgroundColor:e.colors.primary.main,left:"50%",transform:"translate(-50%)",top:0,height:"100%",width:"1px",opacity:0,transition:"opacity ease-in-out 0.2s"},"&::after":{content:'""',width:"4px",borderRadius:"4px",backgroundColor:e.colors.border.weak,transition:"background-color ease-in-out 0.2s",height:"50%",top:"calc(50% - (50%) / 2)",transform:"translateX(-50%)",position:"absolute",left:"50%"},"&:hover, &:focus-visible":{outline:"none","&::before":{opacity:1},"&::after":{backgroundColor:e.colors.primary.main}}}),handleHorizontal:(0,En.css)({cursor:"row-resize","&::before":{left:"inherit",transform:"translateY(-50%)",top:"50%",height:"1px",width:"100%"},"&::after":{width:"50%",height:"4px",top:"50%",transform:"translateY(-50%)",left:"calc(50% - (50%) / 2)"}}),container:(0,En.css)({display:"flex",width:"100%",flexGrow:1,overflow:"hidden"}),panel:(0,En.css)({display:"flex",position:"relative",flexBasis:0})}}function eb(e){if(null===e)return;const t=document.body.style.overflow,n=e.style.width,r=e.style.height,a=e.style.flexGrow;document.body.style.overflow="hidden",e.style.flexGrow="0";const{width:i,height:o}=e.getBoundingClientRect();e.style.flexGrow="100";const{width:s,height:l}=e.getBoundingClientRect();return document.body.style.overflow=t,e.style.width=n,e.style.height=r,e.style.flexGrow=a,{minWidth:i,maxWidth:s,minHeight:o,maxHeight:l}}class tb extends re{toggleDirection(){this.setState({direction:"row"===this.state.direction?"column":"row"})}isDraggable(){return!1}}tb.Component=function({model:e}){const{primary:t,secondary:n,direction:a,isHidden:i,initialSize:o,primaryPaneStyles:s,secondaryPaneStyles:l}=e.useState();if(i)return null;const u=t.Component,c=null==n?void 0:n.Component;let d=n?o:1;return r().createElement(Xg,{direction:a,initialSize:null!=d?d:.5,primaryPaneStyles:s,secondaryPaneStyles:l},r().createElement(u,{key:t.state.key,model:t,parentState:e.state}),c&&n&&r().createElement(c,{key:n.state.key,model:n,parentState:e.state}))};class nb extends re{enrichDataRequest(){return{app:this.state.name||"app"}}}nb.Component=({model:e})=>{const{pages:t}=e.useState();return r().createElement(rb.Provider,{value:e},r().createElement(i.Switch,null,t.map((e=>r().createElement(i.Route,{key:e.state.url,exact:!1,path:e.state.url,render:t=>w(e,t)})))))};const rb=(0,t.createContext)(null),ab=new Map;var ib=Object.defineProperty,ob=Object.getOwnPropertySymbols,sb=Object.prototype.hasOwnProperty,lb=Object.prototype.propertyIsEnumerable,ub=(e,t,n)=>t in e?ib(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class cb extends re{}function db({node:e}){const t=e.useState(),n=(0,_n.useStyles2)(pb);return r().createElement("div",{className:n.container},Object.keys(t).map((a=>r().createElement("div",{className:n.row,key:a},r().createElement("div",{className:n.keyName},a),r().createElement("div",{className:n.value},function(e,t,n){if(null===t)return"null";switch(typeof t){case"number":return r().createElement(_n.Input,{type:"number",defaultValue:t,onBlur:t=>n.setState({[e]:t.currentTarget.valueAsNumber})});case"string":return r().createElement(_n.Input,{type:"text",defaultValue:t,onBlur:t=>n.setState({[e]:t.currentTarget.value})});case"object":return Bt(t)?t.constructor.name:(0,ge.isPlainObject)(t)||(0,ge.isArray)(t)?r().createElement(_n.JSONFormatter,{json:t,open:0}):String(t);default:return typeof t}}(a,t[a],e))))))}function pb(e){return{container:(0,En.css)({flexGrow:1,display:"flex",gap:e.spacing(.5),flexDirection:"column"}),row:(0,En.css)({display:"flex",gap:e.spacing(2)}),keyName:(0,En.css)({display:"flex",flexGrow:"0",width:120,alignItems:"center",height:e.spacing(e.components.height.md)}),value:(0,En.css)({flexGrow:1,minHeight:e.spacing(e.components.height.md),display:"flex",alignItems:"center"})}}function hb({node:e,selectedObject:t,onSelect:n}){const a=(0,_n.useStyles2)(fb),i=[],o=e===t;return e.forEachChild((e=>{i.push(r().createElement(hb,{node:e,key:e.state.key,selectedObject:t,onSelect:n}))})),r().createElement("div",{className:a.container},r().createElement("div",{className:(0,En.cx)(a.name,o&&a.selected),onClick:()=>n(e)},e.constructor.name),r().createElement("div",{className:a.children},i))}function fb(e){return{container:(0,En.css)({flexGrow:1,display:"flex",gap:e.spacing(.5),flexDirection:"column"}),name:(0,En.css)({flexGrow:1,display:"flex",gap:e.spacing(1),fontSize:e.typography.bodySmall.fontSize,cursor:"pointer",padding:e.spacing(0,1),borderRadius:e.shape.borderRadius(2),position:"relative","&:hover":{background:e.colors.background.secondary}}),selected:(0,En.css)({"&::before":{display:"block",content:"' '",position:"absolute",left:0,width:4,bottom:2,top:2,borderRadius:e.shape.radius.default,backgroundImage:e.colors.gradients.brandVertical}}),children:(0,En.css)({flexGrow:1,display:"flex",flexDirection:"column",paddingLeft:e.spacing(1)})}}function mb({scene:e}){const n=(0,_n.useStyles2)(gb),[a,i]=(0,t.useState)(!1),[o,s]=(0,t.useState)();return r().createElement(r().Fragment,null,r().createElement(_n.ToolbarButton,{variant:"canvas",icon:"bug",onClick:()=>i(!0)}),a&&r().createElement(_n.Drawer,{title:"Scene debugger",onClose:()=>i(!1),size:"lg"},r().createElement("div",{className:n.panes},r().createElement("div",{className:n.pane1},r().createElement("div",{className:n.paneHeading},"Scene graph"),r().createElement(_n.CustomScrollbar,{autoHeightMin:"100%"},r().createElement("div",{className:n.treeWrapper},r().createElement(hb,{node:e,selectedObject:o,onSelect:s})))),r().createElement("div",{className:n.pane2},r().createElement("div",{className:n.paneHeading},"Object details"),o&&r().createElement(db,{node:o})))))}function gb(e){return{panes:(0,En.css)({flexGrow:1,display:"flex",height:"100%",flexDirection:"row",marginTop:e.spacing(-2)}),pane1:(0,En.css)({flexGrow:0,display:"flex",height:"100%",flexDirection:"column",borderRight:`1px solid ${e.colors.border.weak}`}),pane2:(0,En.css)({flexGrow:1,display:"flex",minHeight:"100%",flexDirection:"column",paddingLeft:e.spacing(2)}),treeWrapper:(0,En.css)({paddingRight:e.spacing(2),height:"100%",marginLeft:e.spacing(-1)}),paneHeading:(0,En.css)({padding:e.spacing(1,0),fontWeight:e.typography.fontWeightMedium})}}function bb({page:e,routeProps:n}){const a=function(e){return e.parent instanceof wb?e.parent:e}(e),o=a.useState(),s=function(){const e=(0,i.useLocation)();return(0,d.locationSearchToObject)(e.search||"")}(),l=e.getScene(n.match),u=(0,t.useContext)(rb),c=o.initializedScene===l,{layout:p}=e.state,h=Pt();(0,t.useLayoutEffect)((()=>{c||a.initializeScene(l)}),[l,a,c]),(0,t.useEffect)((()=>()=>a.setState({initializedScene:void 0})),[a]);const f=If(a,null==u?void 0:u.state.urlSyncOptions);if(!c&&!f)return null;const m={text:o.title,img:o.titleImg,icon:o.titleIcon,url:v(o.url,h.getSearchObject(),o.preserveUrlKeys),hideFromBreadcrumbs:o.hideFromBreadcrumbs,parentItem:yb(o.getParentPage?o.getParentPage():a.parent,s,h.getSearchObject())};o.tabs&&(m.children=o.tabs.map((t=>({text:t.state.title,icon:t.state.titleIcon,tabSuffix:t.state.tabSuffix,active:e===t,url:v(t.state.url,h.getSearchObject(),t.state.preserveUrlKeys),parentItem:m}))));let g=[];return o.controls&&(g=o.controls.map((e=>r().createElement(e.Component,{model:e,key:e.state.key})))),s["scene-debugger"]&&g.push(r().createElement(mb,{scene:a,key:"scene-debugger"})),r().createElement(d.PluginPage,{layout:p,pageNav:m,actions:g,renderTitle:o.renderTitle,subTitle:o.subTitle},r().createElement(l.Component,{model:l}))}function yb(e,t,n){if(e instanceof wb)return{text:e.state.title,url:v(e.state.url,n,e.state.preserveUrlKeys),hideFromBreadcrumbs:e.state.hideFromBreadcrumbs,parentItem:yb(e.state.getParentPage?e.state.getParentPage():e.parent,t,n)}}function vb({drilldown:e,parent:t,routeProps:n}){return w(t.getDrilldownPage(e,n.match),n)}cb.Component=({model:e})=>{const{component:t,props:n,reactNode:a}=e.useState();return t?r().createElement(t,((e,t)=>{for(var n in t||(t={}))sb.call(t,n)&&ub(e,n,t[n]);if(ob)for(var n of ob(t))lb.call(t,n)&&ub(e,n,t[n]);return e})({},n)):a||null};class wb extends re{initializeScene(e){this.setState({initializedScene:e})}getScene(e){let t=this._sceneCache.get(e.url);if(t)return t;if(!this.state.getScene)throw new Error("Missing getScene on SceneAppPage "+this.state.title);return t=this.state.getScene(e),this._sceneCache.set(e.url,t),t}getDrilldownPage(e,t){let n=this._drilldownCache.get(t.url);return n||(n=e.getPage(t,this),this._drilldownCache.set(t.url,n),n)}enrichDataRequest(e){if(this.state.getParentPage)return this.state.getParentPage().enrichDataRequest(e);if(!this.parent)return null;const t=this.getRoot();return Nt(t)?t.enrichDataRequest(e):null}constructor(e){super(e),this._sceneCache=new Map,this._drilldownCache=new Map}}wb.Component=function({model:e,routeProps:t}){var n,a;const{tabs:o,drilldowns:s}=e.useState(),l=[];if(o&&o.length>0)for(let t=0;t<o.length;t++){const s=o[t];if(0===t&&l.push(r().createElement(i.Route,{exact:!0,key:e.state.url,path:null!=(n=e.state.routePath)?n:e.state.url,render:e=>w(s,e)})),l.push(r().createElement(i.Route,{exact:!0,key:s.state.url,path:null!=(a=s.state.routePath)?a:s.state.url,render:e=>w(s,e)})),s.state.drilldowns)for(const e of s.state.drilldowns)l.push(r().createElement(i.Route,{exact:!1,key:e.routePath,path:e.routePath,render:t=>r().createElement(vb,{drilldown:e,parent:s,routeProps:t})}))}if(s)for(const t of s)l.push(r().createElement(i.Route,{key:t.routePath,exact:!1,path:t.routePath,render:n=>r().createElement(vb,{drilldown:t,parent:e,routeProps:n})}));return!o&&(u=e,(c=t.match).isExact&&(c.url===u.state.url||u.parent instanceof wb&&u.parent.state.tabs[0]===u&&u.parent.state.url===c.url))?r().createElement(bb,{page:e,routeProps:t}):(l.push(function(e,t){return r().createElement(i.Route,{key:"fallback route",render:n=>{var a,i,o;const s=null!=(o=null==(i=(a=e.state).getFallbackPage)?void 0:i.call(a))?o:new wb({url:"",title:"Not found",subTitle:"The url did not match any page",getScene:()=>new Vf({body:new Ag({direction:"column",children:[new Ig({body:new cb({component:()=>r().createElement("div",{"data-testid":"default-fallback-content"},"If you found your way here using a link then there might be a bug in this application.")})})]})})});return r().createElement(bb,{page:s,routeProps:t})}})}(e,t)),r().createElement(i.Switch,null,l));var u,c};var Ob=(e=>(e.Always="always",e.Auto="auto",e.Never="never",e))(Ob||{}),Sb=(e=>(e.Hue="hue",e.None="none",e.Opacity="opacity",e.Scheme="scheme",e))(Sb||{}),_b=(e=>(e.None="none",e.Normal="normal",e.Percent="percent",e))(_b||{}),xb=(e=>(e.Auto="auto",e.Horizontal="horizontal",e.Vertical="vertical",e))(xb||{}),Pb=(e=>(e.Background="background",e.BackgroundSolid="background_solid",e.None="none",e.Value="value",e))(Pb||{}),Cb=(e=>(e.Area="area",e.Line="line",e.None="none",e))(Cb||{}),Eb=(e=>(e.Auto="auto",e.Center="center",e))(Eb||{}),jb=(e=>(e.Auto="auto",e.Name="name",e.None="none",e.Value="value",e.ValueAndName="value_and_name",e))(jb||{}),Db=(e=>(e.Inverted="inverted",e.SameAsValue="same_as_value",e.Standard="standard",e))(Db||{}),kb=(e=>(e.Multi="multi",e.None="none",e.Single="single",e))(kb||{}),Tb=(e=>(e.Basic="basic",e.Gradient="gradient",e.Lcd="lcd",e))(Tb||{}),Rb=(e=>(e.Color="color",e.Hidden="hidden",e.Text="text",e))(Rb||{}),Ab=(e=>(e.Auto="auto",e.Hidden="hidden",e.Left="left",e.Top="top",e))(Ab||{}),Ib=(e=>(e.Auto="auto",e.Manual="manual",e))(Ib||{}),Mb=(e=>(e.Auto="auto",e.Lg="lg",e.Md="md",e.Sm="sm",e))(Mb||{});xb.Auto,Ob.Auto,_b.None,Sb.None,Tb.Gradient,Ab.Auto,Ib.Auto,Rb.Color;const Vb={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:Ib.Auto},Fb=(Ob.Auto,kb.Single,Sb.None,{displayLabels:[]}),Lb={colorMode:Pb.Value,graphMode:Cb.Area,justifyMode:Eb.Auto,percentChangeColorMode:Db.Standard,showPercentChange:!1,textMode:jb.Auto,wideLayout:!0},$b=(Ob.Auto,Ob.Auto,{cellHeight:Mb.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]});var zb=(e=>(e.Code="code",e.HTML="html",e.Markdown="markdown",e))(zb||{});const Bb={content:"# Title\n\nFor markdown syntax help: [commonmark.org/help](https://commonmark.org/help/)",mode:"markdown"};Ob.Auto;class Nb{overrideColor(e){return this._overrides[this._overrides.length-1].properties.push({id:"color",value:e}),this}overrideDecimals(e){return this._overrides[this._overrides.length-1].properties.push({id:"decimals",value:e}),this}overrideDisplayName(e){return this._overrides[this._overrides.length-1].properties.push({id:"displayName",value:e}),this}overrideFilterable(e){return this._overrides[this._overrides.length-1].properties.push({id:"filterable",value:e}),this}overrideLinks(e){return this._overrides[this._overrides.length-1].properties.push({id:"links",value:e}),this}overrideMappings(e){return this._overrides[this._overrides.length-1].properties.push({id:"mappings",value:e}),this}overrideMax(e){return this._overrides[this._overrides.length-1].properties.push({id:"max",value:e}),this}overrideMin(e){return this._overrides[this._overrides.length-1].properties.push({id:"min",value:e}),this}overrideNoValue(e){return this._overrides[this._overrides.length-1].properties.push({id:"noValue",value:e}),this}overrideThresholds(e){return this._overrides[this._overrides.length-1].properties.push({id:"thresholds",value:e}),this}overrideUnit(e){return this._overrides[this._overrides.length-1].properties.push({id:"unit",value:e}),this}constructor(){this._overrides=[]}}class qb extends Nb{match(e){return this._overrides.push({matcher:e,properties:[]}),this}matchFieldsWithName(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byName,options:t},properties:[]}),this}matchFieldsWithNameByRegex(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byRegexp,options:t},properties:[]}),this}matchFieldsByType(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byType,options:t},properties:[]}),this}matchFieldsByQuery(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byFrameRefID,options:t},properties:[]}),this}matchFieldsByValue(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byValue,options:t},properties:[]}),this}matchComparisonQuery(e){return this.matchFieldsByQuery(pg(e))}overrideCustomFieldConfig(e,t){const n=`custom.${String(e)}`;return this._overrides[this._overrides.length-1].properties.push({id:n,value:t}),this}build(){return this._overrides}}var Hb=Object.defineProperty,Wb=Object.defineProperties,Ub=Object.getOwnPropertyDescriptors,Gb=Object.getOwnPropertySymbols,Qb=Object.prototype.hasOwnProperty,Kb=Object.prototype.propertyIsEnumerable,Yb=(e,t,n)=>t in e?Hb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Zb=(e,t)=>{for(var n in t||(t={}))Qb.call(t,n)&&Yb(e,n,t[n]);if(Gb)for(var n of Gb(t))Kb.call(t,n)&&Yb(e,n,t[n]);return e},Xb=(e,t)=>Wb(e,Ub(t));class Jb{setDefaults(){const e={defaults:{custom:this.defaultFieldConfig?(0,ge.cloneDeep)(this.defaultFieldConfig()):{}},overrides:[]};this._fieldConfig=e}setColor(e){return this.setFieldConfigDefaults("color",e)}setDecimals(e){return this.setFieldConfigDefaults("decimals",e)}setDisplayName(e){return this.setFieldConfigDefaults("displayName",e)}setFilterable(e){return this.setFieldConfigDefaults("filterable",e)}setLinks(e){return this.setFieldConfigDefaults("links",e)}setMappings(e){return this.setFieldConfigDefaults("mappings",e)}setMax(e){return this.setFieldConfigDefaults("max",e)}setMin(e){return this.setFieldConfigDefaults("min",e)}setNoValue(e){return this.setFieldConfigDefaults("noValue",e)}setThresholds(e){return this.setFieldConfigDefaults("thresholds",e)}setUnit(e){return this.setFieldConfigDefaults("unit",e)}setCustomFieldConfig(e,t){return this._fieldConfig.defaults=Xb(Zb({},this._fieldConfig.defaults),{custom:(0,ge.merge)(this._fieldConfig.defaults.custom,{[e]:t})}),this}setOverrides(e){return e(this._overridesBuilder),this}setFieldConfigDefaults(e,t){return this._fieldConfig.defaults=Xb(Zb({},this._fieldConfig.defaults),{[e]:t}),this}build(){return{defaults:this._fieldConfig.defaults,overrides:this._overridesBuilder.build()}}constructor(e){this.defaultFieldConfig=e,this._fieldConfig={defaults:{},overrides:[]},this._overridesBuilder=new qb,this.setDefaults()}}class ey{setDefaults(){this._options=this.defaultOptions?(0,ge.cloneDeep)(this.defaultOptions()):{}}setOption(e,t){return this._options=(0,ge.merge)(this._options,{[e]:t}),this}build(){return this._options}constructor(e){this.defaultOptions=e,this._options={},this.setDefaults()}}var ty=Object.defineProperty,ny=Object.defineProperties,ry=Object.getOwnPropertyDescriptors,ay=Object.getOwnPropertySymbols,iy=Object.prototype.hasOwnProperty,oy=Object.prototype.propertyIsEnumerable,sy=(e,t,n)=>t in e?ty(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class ly{setTitle(e){return this._state.title=e,this}setDescription(e){return this._state.description=e,this}setDisplayMode(e){return this._state.displayMode=e,this}setHoverHeader(e){return this._state.hoverHeader=e,this}setShowMenuAlways(e){return this._state.showMenuAlways=e,this}setMenu(e){return this._state.menu=e,this}setHeaderActions(e){return this._state.headerActions=e,this}setCollapsible(e){return this._state.collapsible=e,this}setCollapsed(e){return this._state.collapsed=e,this}setColor(e){return this._fieldConfigBuilder.setColor(e),this}setDecimals(e){return this._fieldConfigBuilder.setDecimals(e),this}setDisplayName(e){return this._fieldConfigBuilder.setDisplayName(e),this}setFilterable(e){return this._fieldConfigBuilder.setFilterable(e),this}setLinks(e){return this._fieldConfigBuilder.setLinks(e),this}setMappings(e){return this._fieldConfigBuilder.setMappings(e),this}setMax(e){return this._fieldConfigBuilder.setMax(e),this}setMin(e){return this._fieldConfigBuilder.setMin(e),this}setNoValue(e){return this._fieldConfigBuilder.setNoValue(e),this}setThresholds(e){return this._fieldConfigBuilder.setThresholds(e),this}setUnit(e){return this._fieldConfigBuilder.setUnit(e),this}setCustomFieldConfig(e,t){return this._fieldConfigBuilder.setCustomFieldConfig(e,t),this}setOverrides(e){return this._fieldConfigBuilder.setOverrides(e),this}setOption(e,t){return this._panelOptionsBuilder.setOption(e,t),this}setData(e){return this._state.$data=e,this}setTimeRange(e){return this._state.$timeRange=e,this}setVariables(e){return this._state.$variables=e,this}setBehaviors(e){return this._state.$behaviors=e,this}setSeriesLimit(e){return this._state.seriesLimit=e,this}applyMixin(e){return e(this),this}build(){const e=new fd((t=((e,t)=>{for(var n in t||(t={}))iy.call(t,n)&&sy(e,n,t[n]);if(ay)for(var n of ay(t))oy.call(t,n)&&sy(e,n,t[n]);return e})({},this._state),n={options:this._panelOptionsBuilder.build(),fieldConfig:this._fieldConfigBuilder.build()},ny(t,ry(n))));var t,n;return e}constructor(e,t,n,r){this._state={},this._state.title="",this._state.description="",this._state.displayMode="default",this._state.hoverHeader=!1,this._state.pluginId=e,this._state.pluginVersion=t,this._fieldConfigBuilder=new Jb(r),this._panelOptionsBuilder=new ey(n)}}const uy=()=>new ly("logs","10.0.0"),cy=()=>new ly("piechart","10.0.0",(()=>Fb)),dy=()=>new ly("stat","10.0.0",(()=>Lb)),py=()=>new ly("table","10.0.0",(()=>$b)),hy=()=>new ly("text","10.0.0",(()=>Bb)),fy=()=>new ly("timeseries","10.0.0");class my{setColor(e){return this._fieldConfigBuilder.setColor(e),this}setDecimals(e){return this._fieldConfigBuilder.setDecimals(e),this}setDisplayName(e){return this._fieldConfigBuilder.setDisplayName(e),this}setFilterable(e){return this._fieldConfigBuilder.setFilterable(e),this}setLinks(e){return this._fieldConfigBuilder.setLinks(e),this}setMappings(e){return this._fieldConfigBuilder.setMappings(e),this}setMax(e){return this._fieldConfigBuilder.setMax(e),this}setMin(e){return this._fieldConfigBuilder.setMin(e),this}setNoValue(e){return this._fieldConfigBuilder.setNoValue(e),this}setThresholds(e){return this._fieldConfigBuilder.setThresholds(e),this}setUnit(e){return this._fieldConfigBuilder.setUnit(e),this}setCustomFieldConfig(e,t){return this._fieldConfigBuilder.setCustomFieldConfig(e,t),this}setOverrides(e){return this._fieldConfigBuilder.setOverrides(e),this}setOption(e,t){return this._panelOptionsBuilder.setOption(e,t),this}build(){return{pluginId:this._pluginId,pluginVersion:this._pluginVersion,options:this._panelOptionsBuilder.build(),fieldConfig:this._fieldConfigBuilder.build()}}constructor(e,t,n,r){this._pluginId=e,this._pluginVersion=t,this._fieldConfigBuilder=new Jb(r),this._panelOptionsBuilder=new ey(n)}}const gy=()=>new my("table","10.0.0",(()=>$b)),by=()=>new my("timeseries","10.0.0"),yy=()=>new ey((()=>Vb)),vy=()=>new ey((()=>$b)),wy=()=>new ey,Oy=()=>new Jb,Sy=()=>new Jb,_y=function({pluginId:e,plugin:t}){if(j.has(e))throw new Error(`A runtime panel plugin with id ${e} has already been registered`);var n;t.meta=(n=((e,t)=>{for(var n in t||(t={}))P.call(t,n)&&E(e,n,t[n]);if(x)for(var n of x(t))C.call(t,n)&&E(e,n,t[n]);return e})({},t.meta),S(n,_({id:e,name:e,module:"runtime plugin",baseUrl:"runtime plugin",info:{author:{name:"Runtime plugin "+e},description:"",links:[],logos:{large:"",small:""},screenshots:[],updated:"",version:""}}))),j.set(e,t)},xy=function({dataSource:e}){if(me.has(e.uid))throw new Error(`A runtime data source with uid ${e.uid} has already been registered`);me.set(e.uid,e)};function Py(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Cy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Py(e,t,n[t])}))}return e}function Ey(e,t){return new Cl(Cy({queries:[Cy({refId:"A",datasource:l,scenarioId:"random_walk"},e)]},t))}function jy(){return{$timeRange:new Xe,controls:[new Ih({}),new Rg,new Zm({}),new dg({})]}}function Dy(e){return new Ig({ySizing:"content",body:new Km({text:e,fontSize:12})})}function ky(e){return new Cl({datasource:{uid:"gdev-prometheus"},queries:[Cy({refId:"A",instant:!0,format:"table",maxDataPoints:500},e)]})}function Ty(e){return new Cl({datasource:{uid:"gdev-prometheus"},queries:[Cy({refId:"A",range:!0,format:"time_series",maxDataPoints:500},e)]})}function Ry(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ay(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ry(e,t,n[t])}))}return e}function Iy(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function My(t){return _y({pluginId:"custom-viz-panel",plugin:new e.PanelPlugin(Vy).setPanelOptions((e=>{e.addTextInput({path:"mode",name:"Mode",defaultValue:"modeA"})})).useFieldConfig({useCustomConfig:e=>{e.addNumberInput({path:"numericOption",name:"Option editor",description:"Option editor description",defaultValue:10})}})}),new wb(Iy(Ay({},t),{subTitle:"Demo of a runtime registered panel plugin",getScene:()=>new Vf({body:new Ag(Iy(Ay({},jy()),{direction:"column",children:[new Ig({body:new fd({title:"Custom visualization panel plugin",pluginId:"custom-viz-panel",$data:Ey(),fieldConfig:{defaults:{},overrides:[]}})})]}))})}))}function Vy(e){var t,n,a;const{options:i,data:o}=e;return r().createElement("div",null,r().createElement("h4",null,"CustomVizPanel ",i.mode),r().createElement("div",null,"FieldConfig: ",JSON.stringify(null===(a=o.series[0])||void 0===a||null===(n=a.fields[0])||void 0===n||null===(t=n.config)||void 0===t?void 0:t.custom)))}function Fy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ly extends re{constructor(...e){super(...e),Fy(this,"onChange",(e=>{this.setState({value:e})}))}}Fy(Ly,"Component",(({model:e})=>{const{options:t,value:n}=e.useState();return r().createElement(_n.RadioButtonGroup,{options:t,value:n,onChange:e.onChange})}));class $y extends re{setHidden(){const e=zy(this);e.state.isHidden||e.setState({isHidden:!0})}setVisible(){const e=zy(this);e.state.isHidden&&e.setState({isHidden:!1})}constructor(e){super(e)}}function zy(e){if(e instanceof Ig||e instanceof Ag)return e;if(!e.parent)throw new Error("Could not find parent flex item");return zy(e.parent)}class By extends $y{constructor(t){var n,r;super(t),r=t=>{const n=e.rangeUtil.convertRawToRange({from:this.state.greaterThan,to:"now"});t.value.from.valueOf()<n.from.valueOf()?this.setHidden():this.setVisible()},(n="_onTimeRangeChange")in this?Object.defineProperty(this,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[n]=r,this.addActivationHandler((()=>{this._subs.add(Hu.getTimeRange(this).subscribeToState(this._onTimeRangeChange)),this._onTimeRangeChange(Hu.getTimeRange(this).state)}))}}class Ny extends $y{constructor(){var e,t;super({}),t=e=>{e.data&&(e.data&&0===e.data.series.length?this.setHidden():this.setVisible())},(e="_onData")in this?Object.defineProperty(this,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):this[e]=t,this.addActivationHandler((()=>{this._subs.add(Hu.getData(this).subscribeToState(this._onData))}))}}class qy extends $y{_onActivate(){for(const e of this.state.references){const t=Hu.findObject(this,(t=>t.state.key===e));if(!t)throw new Error(`SceneObject with key ${e} not found in scene graph`);this._resolvedRefs.push(t),this._subs.add(t.subscribeToState((()=>this._onReferenceChanged())))}this._onReferenceChanged()}_onReferenceChanged(){this.state.condition(...this._resolvedRefs)?this.setVisible():this.setHidden()}constructor(e){var t,n;super(e),n=[],(t="_resolvedRefs")in this?Object.defineProperty(this,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[t]=n,this.addActivationHandler((()=>this._onActivate()))}}function Hy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Hy(e,t,n[t])}))}return e}function Uy(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Gy(e){return new wb(Uy(Wy({},e),{subTitle:"Behaviors can augment any scene object with new runtime behaviors and state logic",getScene:()=>{const e=Ey({seriesCount:2,alias:"__server_names",scenarioId:"random_walk"});return new Vf({$timeRange:new Xe,controls:[new Ym({value:"2",onChange:t=>{e.setState({queries:[Uy(Wy({},e.state.queries[0]),{seriesCount:t})]}),e.runQueries()}}),new Ly({key:"toggle",options:[{value:"visible",label:"Show text panel"},{value:"hidden",label:"Hide text panel"}],value:"hidden"}),new Rg,new Zm({})],body:new Ag({direction:"column",children:[new Ig({$behaviors:[new qy({references:["toggle"],condition:e=>"visible"===e.state.value})],body:hy().setOption("content","This panel can be hidden with a toggle!").build()}),new Ig({$behaviors:[new By({greaterThan:"now-2d"})],isHidden:!0,body:fy().setTitle("Hidden for time ranges > 2d").setBehaviors([Qy]).setData(new Cl({key:"Hidden for time range query runner",$behaviors:[Qy],queries:[{refId:"A",datasource:l,scenarioId:"random_walk"}]})).build()}),new Ig({$behaviors:[new Ny],$data:e,body:fy().setTitle("Hidden when no time series").build()})]})})}}))}function Qy(e){var t;return console.log(`[SceneObjectEvent]: ${null===(t=e.constructor)||void 0===t?void 0:t.name} ${e.state.key} activated!`),e.subscribeToState((t=>{var n;console.log(`[SceneObjectEvent]: ${null===(n=e.constructor)||void 0===n?void 0:n.name} ${e.state.key} state changed!`,t)})),()=>{var t;console.log(`[SceneObjectEvent]: ${null===(t=e.constructor)||void 0===t?void 0:t.name} ${e.state.key} deactivated!`)}}function Ky(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Yy(e){const t=[Zy("/tab1","Temperature")],n=new wb((a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ky(e,t,n[t])}))}return e}({},e),i=null!=(i={subTitle:"Dynamic tabs, and drilldowns. Adds a tab with drilldown after 2 seconds.",$timeRange:new Xe,controls:[new Zm({}),new dg({})],tabs:t,getFallbackPage:()=>new wb({title:"Loading...",url:"",getScene:()=>new Vf({body:new cb({component:()=>r().createElement("p",null,"Please wait...")})})})})?i:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(i)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(i)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(i,e))})),a));var a,i;return n.addActivationHandler((()=>{if(1===n.state.tabs.length){const e=setTimeout((()=>{n.setState({tabs:[...t,Zy("/tab2","Humidity")],renderTitle:Xy,getFallbackPage:void 0})}),2e3);return()=>clearTimeout(e)}})),n}function Zy(e,t){return new wb({title:t,url:`${c("dynamic-page")}${e}`,getScene:()=>new Vf({body:new Ag({direction:"column",children:[new Ig({body:fy().setTitle(t).build()})]}),$data:Ey()}),drilldowns:[]})}function Xy(e){return r().createElement("div",{style:{display:"flex",gap:"16px",alignItems:"center"}},r().createElement("h1",null,e),r().createElement("img",{src:"public/img/online.svg",style:{width:"24px",height:"24px"}}))}function Jy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ev(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Jy(e,t,n[t])}))}return e}function tv(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function nv(e){return new wb(tv(ev({},e),{subTitle:"A simple demo of different flex layout options",getScene:()=>new Vf(tv(ev({},jy()),{key:"Flex layout embedded scene",body:new Ag({direction:"column",children:[new Ag({direction:"row",children:[new Ig({minWidth:"70%",body:new fd({title:"Failing panel because of wrong panel id",pluginId:"this-plugin-does-not-exist",$data:Ey({})})}),new Ag({$data:Ey({},{maxDataPoints:50}),direction:"column",children:[new Ig({body:fy().setTitle("Fill height").build()}),new Ig({ySizing:"content",body:new Km({text:"Size to content",fontSize:20,align:"center"})}),new Ig({height:300,body:dy().setTitle("Fixed height").build()})]})]}),new Ag({direction:"row",children:[new Ig({width:150,height:150,body:hy().setTitle("150x150").setOption("content","").build()}),new Ig({maxHeight:200,body:fy().setTitle("maxHeigh 200").setData(Ey()).build()}),new Ig({width:"10%",body:hy().setTitle("").setOption("content","").build()})]})]})}))}))}function rv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function av(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){rv(e,t,n[t])}))}return e}function iv(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function ov(e){return new wb(iv(av({},e),{subTitle:"Demo of the SceneGridLayout",getScene:()=>new Vf(iv(av({},jy()),{$data:Ey(),body:new Mm({isLazy:!0,isDraggable:!0,isResizable:!0,children:[new Uf({x:0,y:0,width:12,height:10,isResizable:!0,isDraggable:!0,body:fy().setTitle("Draggable and resizable").setOption("legend",{showLegend:!1}).build()}),new Uf({x:12,y:0,width:12,height:10,isResizable:!1,isDraggable:!1,body:fy().setTitle("No drag and no resize").setOption("legend",{showLegend:!1}).build()}),new Uf({x:0,y:11,width:24,height:10,isDraggable:!1,isResizable:!0,body:new Ag({direction:"column",height:300,children:[new Ig({body:fy().setTitle("Child of flex layout").build()}),new Ig({body:fy().setTitle("Child of flex layout").build()})]})})]})}))}))}function sv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){sv(e,t,n[t])}))}return e}function uv(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function cv(e){return new wb(uv(lv({},e),{subTitle:"SceneGridLayout demo with collapsible rows",getScene:()=>new Vf(uv(lv({},jy()),{$data:Ey(),body:new Mm({isDraggable:!0,children:[new Wm({title:"Row A",key:"Row A",isCollapsed:!0,isDraggable:!0,isResizable:!1,y:0,x:0,children:[new Uf({x:0,y:1,width:12,height:5,isResizable:!0,isDraggable:!0,body:fy().setTitle("Row A Child1").build()}),new Uf({x:0,y:5,width:6,height:5,isResizable:!0,isDraggable:!0,body:fy().setTitle("Row A Child2").build()})]}),new Wm({title:"Row B",key:"Row B",isCollapsed:!0,y:1,children:[new Uf({x:0,y:2,width:12,height:5,isResizable:!1,isDraggable:!0,body:fy().setTitle("Row B Child1").build()}),new Uf({x:0,y:7,width:6,height:5,isResizable:!1,isDraggable:!0,body:fy().setTitle("Row B Child2").build()})]}),new Uf({x:2,y:12,width:12,height:10,isResizable:!0,isDraggable:!0,body:fy().setTitle("Outsider").build()})]})}))}))}function dv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){dv(e,t,n[t])}))}return e}function hv(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function fv(e){return new wb(hv(pv({},e),{subTitle:"Showcasing lazy rendering and query execution of panels that are outside viewport",getScene:()=>{const e=Array.from(Array(20).keys());return new Vf(hv(pv({},jy()),{body:new Mm({isLazy:!0,children:e.map((e=>new Uf({x:0,y:6*e,width:24,height:6,isResizable:!0,isDraggable:!0,body:fy().setTitle(`Panel ${e}`).setData(Ey({scenarioId:"slow_query",stringInput:"5s"})).build()})))})}))}}))}function mv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){mv(e,t,n[t])}))}return e}function bv(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function yv(e){return new wb(bv(gv({},e),{subTitle:"Here you can test changing series color and toggle series visiblity. ",getScene:()=>new Vf(bv(gv({},jy()),{body:new Ag({direction:"column",children:[new Ig({height:400,body:fy().setData(new Cl({datasource:l,queries:[{labels:"cluster=eu",refId:"A",scenarioId:"random_walk",seriesCount:1},{hide:!1,labels:"cluster=us",refId:"B",scenarioId:"random_walk",seriesCount:1},{hide:!1,labels:"cluster=asia",refId:"C",scenarioId:"random_walk",seriesCount:1}]})).setTitle("Check legend visibility actions, and color change").setDisplayName("${__field.labels.cluster}").build()}),new Ig({height:400,body:hy().setOption("content","from: ${__from:date:iso} to: ${__to:date:iso}").build()})]})}))}))}function vv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){vv(e,t,n[t])}))}return e}function Ov(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Sv(e){const t=Ey(),n=[{text:"Item 1",onClick:()=>{alert("Item 1 clicked")}},{text:"Item 2",onClick:()=>{alert("Item 2 clicked")}}],r=new Lf({});r.addActivationHandler((()=>{setTimeout((()=>{r.setItems(n)}),1e3)}));const a=new Lf({items:n}),i=new Lf({});i.addActivationHandler((()=>{i.setItems(n)}));const o=new Lf({});let s=1;o.addActivationHandler((()=>{setTimeout((()=>{const e=`Item ${s} clicked`;o.addItem({text:`Item ${s}`,onClick:()=>{alert(e)}}),s++}),500)}));const l=new Lf({}),u=fy().setTitle("Menu reading from panel state").setMenu(l).build();return l.addActivationHandler((()=>{var e;const n=u.getPlugin();l.setItems([{text:"Alert plugin type",onClick:()=>{var e;alert(null===(e=n)||void 0===e?void 0:e.meta.id)}},{text:`Change ${null===(e=n)||void 0===e?void 0:e.meta.id} panel title`,onClick:()=>{u.setState({title:`Updated title ${Math.floor(100*Math.random())+1}`})}},{text:"Change number of  series",onClick:()=>{t.setState({queries:[Ov(wv({},t.state.queries[0]),{seriesCount:Math.floor(10*Math.random())+1})]}),t.runQueries()}}])})),new wb(Ov(wv({},e),{subTitle:"Different ways to use panel menu",getScene:()=>new Vf(Ov(wv({},jy()),{body:new Ag({$data:t,direction:"row",wrap:"wrap",children:[new Ig({minHeight:200,minWidth:"40%",body:fy().setTitle("Basic static menu").setMenu(a).build()}),new Ig({minHeight:200,minWidth:"40%",body:fy().setTitle("Basic lazy menu").setMenu(i).build()}),new Ig({minHeight:200,minWidth:"40%",body:fy().setTitle("Async menu, will show after 1s").setMenu(r).build()}),new Ig({minHeight:200,minWidth:"40%",body:fy().setTitle("New item added to menu after it is shown").setMenu(o).build()}),new Ig({minHeight:200,minWidth:"40%",body:u})]})}))}))}function _v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){_v(e,t,n[t])}))}return e}function Pv(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Cv(t){const n=Ey({seriesCount:2,alias:"__server_names",scenarioId:"random_walk"});return new wb(Pv(xv({},t),{subTitle:"Here we use the SceneByFrameRepeater to dynamically build a layout for each frame",getScene:()=>new Vf(Pv(xv({},jy()),{body:new kg({body:new Ag({direction:"column",children:[]}),getLayoutChild:(t,n,r)=>new Ig({minHeight:200,body:new Ag({direction:"row",key:`panel-${r}`,$data:new $e({data:Pv(xv({},t),{series:[n]})}),children:[new Ig({body:fy().setTitle((0,e.getFrameDisplayName)(n,r)).setOption("legend",{showLegend:!1}).build()}),new Ig({width:300,body:dy().setDisplayName("Last").setOption("graphMode",Ce.None).build()})]})})}),$data:n,controls:[new Ym({value:"2",label:"Series count",onChange:e=>{n.setState({queries:[Pv(xv({},n.state.queries[0]),{seriesCount:e})]}),n.runQueries()}}),...jy().controls]}))}))}function Ev(e){return{editorList:(0,En.css)({overflow:"auto",listStyle:"none",gap:e.spacing(2)}),queryEditor:(0,En.css)({display:"flex",flexDirection:"column"}),refIdLabel:(0,En.css)({display:"flex",flexGrow:1,fontSize:e.typography.h5.fontSize})}}function jv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dv(e){var n,{model:a}=e,i=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,["model"]);const o=null!==(n=a.constructor.Component)&&void 0!==n?n:Tv,[s,l]=(0,t.useState)(0);return(0,t.useEffect)((()=>{const e=a.activate();return l((e=>e+1)),e}),[a]),a.isActive||a.renderBeforeActivation?r().createElement(o,(u=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){jv(e,t,n[t])}))}return e}({},i),c=null!=(c={model:a})?c:{},Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(c)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(c)).forEach((function(e){Object.defineProperty(u,e,Object.getOwnPropertyDescriptor(c,e))})),u)):null;var u,c}const kv=r().memo(Dv);function Tv(e){return null}function Rv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Av extends e.BusEventWithPayload{}Rv(Av,"type","scene-object-state-change");class Iv extends e.BusEventWithPayload{}function Mv(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}Rv(Iv,"type","scene-object-user-action");var Vv=new WeakMap;class Fv{resolve(){return function(e,t){return t.get?t.get.call(e):t.value}(this,Mv(this,Vv,"get"))}constructor(e){(function(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)})(this,Vv,{writable:!0,value:void 0}),function(e,t,n){(function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}})(e,Mv(e,t,"set"),n)}(this,Vv,e)}}function Lv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class $v{get state(){return this._state}get isActive(){return this._isActive}get renderBeforeActivation(){return this._renderBeforeActivation}get parent(){return this._parent}get variableDependency(){return this._variableDependency}get urlSync(){return this._urlSync}get Component(){return kv}_setParent(e){zv(e,(e=>{e._parent&&e._parent!==this&&console.warn("SceneObject already has a parent set that is different from the new parent. You cannot share the same SceneObject instance in multiple scenes or in multiple different places of the same scene graph. Use SceneObject.clone() to duplicate a SceneObject or store a state key reference and use sceneGraph.findObject to locate it.",e,this),e._parent=this}))}clearParent(){this._parent=void 0}subscribeToState(e){return this._events.subscribe(Av,(t=>{t.payload.changedObject===this&&e(t.payload.newState,t.payload.prevState)}))}subscribeToEvent(e,t){return this._events.subscribe(e,t)}setState(e){const t=this._state,n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Lv(e,t,n[t])}))}return e}({},this._state,e);this._state=Object.freeze(n),this._setParent(e),this._handleActivationOfChangedStateProps(t,n),this.publishEvent(new Av({prevState:t,newState:n,partialUpdate:e,changedObject:this}),!0)}_handleActivationOfChangedStateProps(e,t){this.isActive&&(e.$behaviors!==t.$behaviors&&this._handleChangedBehaviors(e.$behaviors,t.$behaviors),e.$data!==t.$data&&this._handleChangedStateActivation(e.$data,t.$data),e.$variables!==t.$variables&&this._handleChangedStateActivation(e.$variables,t.$variables),e.$timeRange!==t.$timeRange&&this._handleChangedStateActivation(e.$timeRange,t.$timeRange))}_handleChangedStateActivation(e,t){if(e){const t=this._deactivationHandlers.get(e);t&&(t(),this._deactivationHandlers.delete(e))}t&&this._deactivationHandlers.set(t,t.activate())}_handleChangedBehaviors(e,t){if(e)for(const n of e)if(!t||!t.includes(n)){const e=this._deactivationHandlers.get(n);e&&(e(),this._deactivationHandlers.delete(n))}if(t)for(const n of t)e&&e.includes(n)||this._activateBehavior(n)}publishEvent(e,t){this._events.publish(e),t&&this.parent&&this.parent.publishEvent(e,t)}getRoot(){return this._parent?this._parent.getRoot():this}_internalActivate(){this._isActive=!0;const{$data:e,$variables:t,$timeRange:n,$behaviors:r}=this.state;if(this._activationHandlers.forEach((e=>{const t=e();t&&this._deactivationHandlers.set(t,t)})),n&&!n.isActive&&this._deactivationHandlers.set(n,n.activate()),t&&!t.isActive&&this._deactivationHandlers.set(t,t.activate()),e&&!e.isActive&&this._deactivationHandlers.set(e,e.activate()),r)for(const e of r)this._activateBehavior(e)}_activateBehavior(e){if(e instanceof $v)this._deactivationHandlers.set(e,e.activate());else if("function"==typeof e){const t=e(this);t&&this._deactivationHandlers.set(e,t)}}activate(){this.isActive||this._internalActivate(),this._refCount++;let e=!1;return()=>{if(this._refCount--,e)throw new Error("SceneObject cancelation handler returned by activate() called a second time");e=!0,0===this._refCount&&this._internalDeactivate()}}_internalDeactivate(){this._isActive=!1;for(let e of this._deactivationHandlers.values())e();this._deactivationHandlers.clear(),this._events.removeAllListeners(),this._subs.unsubscribe(),this._subs=new D.Subscription}useState(){return function(e){const[n,r]=(0,t.useState)(e.state),a=e.state;var i;const o=null!==(i=void 0)&&void 0!==i&&i;return(0,t.useEffect)((()=>{let t;o&&(t=e.activate());const n=e.subscribeToState((e=>{r(e)}));return e.state!==a&&r(e.state),()=>{n.unsubscribe(),t&&t()}}),[e,o]),e.state}(this)}forceRender(){this.setState({})}clone(e){return function(e,t){const n=function(e,t){const n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Bv(e,t,n[t])}))}return e}({},e);Object.assign(n,t);for(const e in n){if(t&&void 0!==t[e])continue;const r=n[e];if(r instanceof $v&&(n[e]=r.clone()),r instanceof Fv)console.warn("Cloning object with SceneObjectRef");else if(Array.isArray(r)){const t=[];for(const e of r)e instanceof $v?t.push(e.clone()):t.push(e);n[e]=t}}return n}(e.state,t);return new e.constructor(n)}(this,e)}addActivationHandler(e){this._activationHandlers.push(e)}forEachChild(e){zv(this.state,e)}getRef(){return this._ref||(this._ref=new Fv(this)),this._ref}constructor(t){Lv(this,"_isActive",!1),Lv(this,"_state",void 0),Lv(this,"_activationHandlers",[]),Lv(this,"_deactivationHandlers",new Map),Lv(this,"_ref",void 0),Lv(this,"_events",void 0),Lv(this,"_parent",void 0),Lv(this,"_subs",new D.Subscription),Lv(this,"_refCount",0),Lv(this,"_renderBeforeActivation",!1),Lv(this,"_variableDependency",void 0),Lv(this,"_urlSync",void 0),t.key||(t.key=M()),this._events=new e.EventBusSrv,this._state=Object.freeze(t),this._setParent(this._state)}}function zv(e,t){for(const n of Object.values(e))if(n instanceof $v&&t(n),Array.isArray(n))for(const e of n)e instanceof $v&&t(e)}function Bv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nv(e,t){let n,r=e;for(;r&&!n;)n=t(r),r=r.parent;return n}function qv(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function Hv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Wv extends re{constructor(e){super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Hv(e,t,n[t])}))}return e}({},e)),Hv(this,"_onActivate",(()=>{const e=Uv(this);e&&this._subs.add(e.subscribeToState(((e,t)=>{var n,r,a;const i=null!==(a=e.datasource)&&void 0!==a?a:Gv(e.queries);var o;const s=null!==(o=t.datasource)&&void 0!==o?o:Gv(t.queries);((null===(n=i)||void 0===n?void 0:n.uid)!==(null===(r=s)||void 0===r?void 0:r.uid)||i&&!this.state.datasource)&&function(e,t){return Qv.apply(this,arguments)}(e.datasource,{}).then((e=>this.setState({datasource:e}))).catch((e=>this.setState({datasourceLoadErrorMessage:e})))})))})),Hv(this,"onChange",((e,t)=>{const n=e.state.queries;e.setState({queries:n.map((e=>e.refId===t.refId?t:e))}),e.runQueries()})),this.addActivationHandler(this._onActivate)}}function Uv(e){return Nv(e,(e=>{if(e.state.$data instanceof Cl)return e.state.$data}))}function Gv(e){var t,n;return null!==(n=null===(t=e.find((e=>null!==e.datasource)))||void 0===t?void 0:t.datasource)&&void 0!==n?n:void 0}function Qv(){var e;return e=function*(e,t){return e&&e.query?e:yield(0,d.getDataSourceSrv)().get(e,t)},Qv=function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){qv(i,r,a,o,s,"next",e)}function s(e){qv(i,r,a,o,s,"throw",e)}o(void 0)}))},Qv.apply(this,arguments)}function Kv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Yv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Kv(e,t,n[t])}))}return e}function Zv(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Xv(e){return new wb(Zv(Yv({},e),{subTitle:"Example of how to to build a component that uses the QueryEditor",getScene:()=>new Vf(Zv(Yv({},jy()),{body:new Ag({direction:"column",children:[new Ig({ySizing:"content",body:new Wv}),new Ig({body:fy().setTitle("Timeseries").build(),minHeight:400,minWidth:"40%"})]}),$data:Ey()}))}))}function Jv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ew(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Jv(e,t,n[t])}))}return e}function tw(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function nw(e){return new wb(tw(ew({},e),{subTitle:"Show casing the default and custom responsive options of SceneFlexLayout",getScene:()=>new Vf(tw(ew({},jy()),{$data:Ey({},{maxDataPoints:40}),body:new Ag({direction:"column",children:[Dy("Row with height 150, Default responsive behavior of switching to column layout and removing height constraint on layout. Height constraints are automatically also applied to children so they work when the media query switches the flex direction to column"),new Ag({direction:"row",height:150,children:[rw({}),rw({}),rw({})]}),Dy("Row with height 20, Overriding default responsive rule to maintain row layout even on smaller screens but with only 100px height"),new Ag({direction:"row",height:200,md:{height:100,direction:"row"},children:[rw({}),rw({})]}),Dy("Row with minHeight 300, and item with width constraint. The responsive style will remove the maxWidth by default"),new Ag({direction:"row",minHeight:300,children:[aw({},"No constraints"),new Ag({direction:"column",maxWidth:300,children:[aw({},"maxWidth 300"),aw({},"maxWidth 300")]})]})]})}))}))}function rw(e){return new Ig(tw(ew({},e),{body:dy().setTitle("Stat").build()}))}function aw(e,t){return new Ig(tw(ew({},e),{body:fy().setTitle(null!=t?t:"Panel").build()}))}function iw(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function ow(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){iw(i,r,a,o,s,"next",e)}function s(e){iw(i,r,a,o,s,"throw",e)}o(void 0)}))}}function sw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lw(t){return new wb((n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){sw(e,t,n[t])}))}return e}({},t),r={subTitle:"Test of variable cascading updates and refresh on time range change",$timeRange:new Xe,controls:[new Zm({}),new dg({})],tabs:[new wb({title:"Async and chained",url:`${t.url}/query`,getScene:()=>new Vf({controls:[new Ih({})],$variables:new $h({variables:[new df({name:"server",query:"A.*",value:"server",text:"",description:"Server name",delayMs:1e3,isMulti:!0,options:[],refresh:e.VariableRefresh.onTimeRangeChanged}),new df({name:"pod",query:"A.$server.*",value:"pod",delayMs:1e3,isMulti:!0,text:"",options:[]}),new df({name:"handler",query:"A.$server.$pod.*",value:"pod",delayMs:1e3,isMulti:!0,text:"",options:[],refresh:e.VariableRefresh.onTimeRangeChanged}),new Gh({name:"keyValue",description:"CustomVariable with key value pairs",value:"",isMulti:!0,text:"",query:"A : 1, B : 2, C : 3"}),new xf({name:"interval",intervals:["1d","1m"],autoEnabled:!0,autoStepCount:30,autoMinInterval:"10s",description:"Auto step count 30, auto min interval 10s",refresh:e.VariableRefresh.onTimeRangeChanged}),new Lu({name:"queryVar",label:"QueryVariable with TestData datasource",query:{query:"*",refId:"A"},datasource:{uid:"gdev-testdata"},definition:"*"})]}),body:new Ag({direction:"column",$behaviors:[cw("keyValue"),cw("server")],children:[uw(),new Ig({body:new Gm({title:"Collapsable inner scene",canCollapse:!0,body:uw()})})]})})}),new wb({title:"Data source and textbox",url:`${t.url}/ds`,getScene:()=>new Vf({controls:[new Ih({})],$variables:new $h({variables:[new Jh({name:"ds",pluginId:"grafana-testdata-datasource"}),new yf({name:"search"})]}),body:new Ag({direction:"column",children:[new Ig({body:fy().setTitle("datasource: $ds, search = $search").setData(new Cl({datasource:{uid:"$ds"},queries:[{refId:"A",scenarioId:"random_walk",alias:"ds = $ds, search = $search"}]})).build()})]})})}),new wb({title:"Search filter",url:`${t.url}/search`,getScene:()=>new Vf({controls:[new Ih({})],$variables:new $h({variables:[new Lu({name:"server",query:{query:"A.$__searchFilter",refId:"A"},datasource:{uid:"gdev-testdata"},definition:"A.$__searchFilter"})]}),body:new Ag({direction:"column",children:[new Ig({body:hy().setTitle("Variable with search filter").setOption("content","This is a very old messy feature that allows data sources to filter down the options in a query variable dropdown based on what the user has typed in. Only implemented by very few data sources (Graphite, SQL, Datadog)").build()})]})})}),new wb({title:"Many variable options",url:`${t.url}/many-values`,getScene:()=>new Vf({controls:[new Ih({})],$variables:new $h({variables:[new df({name:"manyOptions",query:"",optionsToReturn:dw(1e5),delayMs:0})]}),body:new Ag({direction:"column",children:[new Ig({body:hy().setTitle("Description").setOption("content","This tab is mainly to test a variable with 100 000 options, to test search / typing performance. manyOptions=$manyOptions").build()})]})})}),new wb({title:"Many adhoc variable values",url:`${t.url}/many-adhoc-values`,getScene:()=>new Vf({controls:[new Ih({})],$variables:new $h({variables:[new sl({name:"manyAdhocOptions",getTagKeysProvider:ow((function*(){return{replace:!0,values:[{value:"a",text:"A"},{value:"b",text:"B"},{value:"c",text:"C"}]}})),getTagValuesProvider:ow((function*(){return{replace:!0,values:dw(1e5).map((({value:e,label:t})=>({value:e,text:t})))}}))})]}),body:new Ag({direction:"column",children:[new Ig({body:hy().setTitle("Description").setOption("content","This tab is mainly to test an adhoc variable with 100 000 options, to test search / typing performance. manyAdhocOptions=$manyAdhocOptions").build()})]})})})]},r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(r)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))})),n));var n,r}function uw(){return new Ag({children:[new Ig({body:fy().setTitle("handler: $handler").setData(Ey({alias:"handler: $handler"})).build()}),new Ig({body:hy().setTitle("Interpolation").setOption("content","\n* server: $server\n* pod: $pod\n* handler: $handler\n* interval: $interval\n* keyValue: $keyValue\n* keyValue: ${keyValue:text} (text value)\n* queryVar: $queryVar\n* [Link that updates pod = AAG and AAH](${__url.path}${__url.params:exclude:var-pod}&var-pod=AAG&var-pod=AAH)\n\n          ").build()})]})}function cw(e){return new Zu({variableName:e,onChange:e=>{console.log(`${e.state.name} changed`);const t=setTimeout((()=>{console.log(`${e.state.name} post effect`)}),5e3);return()=>{console.log(`${e.state.name} cancel effect`),clearTimeout(t)}}})}function dw(e){return new Array(e).fill(null).map(((e,t)=>({value:pw(50),label:pw(50)})))}function pw(e){let t="";let n=0;for(;n<e;)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random())),n+=1;return t}function hw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){hw(e,t,n[t])}))}return e}function mw(){const e=new Ah({transformations:[{id:"reduce",options:{reducers:["mean"]}},{id:"organize",options:{excludeByName:{},indexByName:{},renameByName:{Field:"Room",Mean:"Average temperature"}}}]});return py().setData(e).setTitle("Room temperature overview").setOption("sortBy",[{displayName:"Average temperature"}]).setColor({mode:ec.ContinuousGrYlRd}).setCustomFieldConfig("align","auto").setCustomFieldConfig("cellOptions",{type:ke.Auto}).setCustomFieldConfig("inspect",!1).setOverrides((e=>e.matchFieldsWithName("Average temperature").overrideUnit("celsius").overrideCustomFieldConfig("cellOptions",{type:ke.Gauge,mode:De.Gradient}).overrideCustomFieldConfig("align","center").matchFieldsWithName("Room").overrideLinks([{title:"Go to room overview",url:"${__url.path}/room/${__value.text}/temperature"}]).overrideCustomFieldConfig("width",250))).build()}function gw(e){const t=new Ah({transformations:[{id:"reduce",options:{reducers:e}}]});return dy().setData(t).setUnit("celsius").build()}function bw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){bw(e,t,n[t])}))}return e}function vw(e){return{refId:"Temp",datasource:l,scenarioId:"random_walk",seriesCount:1,alias:e,min:10,max:30}}function ww(e){return{refId:"Humidity",datasource:l,scenarioId:"random_walk",seriesCount:1,alias:e,min:30,max:60}}function Ow(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ow(e,t,n[t])}))}return e}function _w(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}Hv(Wv,"Component",(function({model:t}){var n;const{datasource:a,datasourceLoadErrorMessage:i}=t.useState(),{data:o}=Hu.getData(t).useState(),s=Uv(t),l=null===(n=s)||void 0===n?void 0:n.state.queries,u=(0,_n.useStyles2)(Ev);if(i)return r().createElement("div",null,"Failed to load datasource: ",i);if(!a||!a.components)return r().createElement("div",null,"Loading data source...");if(!a.components.QueryEditor)return r().createElement("div",null,"Datasource has no query editor.");if(!l||0===l.length)return r().createElement("div",null,"No queries found.");const c=a.components.QueryEditor;return r().createElement("ul",{className:u.editorList},l.map((n=>{var i;return r().createElement("li",{key:n.refId,className:u.queryEditor},r().createElement("span",{className:u.refIdLabel},n.refId),r().createElement(c,{key:a.name,query:n,datasource:a,onChange:e=>t.onChange(s,e),onRunQuery:()=>{},onAddQuery:()=>{},data:o,range:null===(i=o)||void 0===i?void 0:i.timeRange,queries:l,app:e.CoreApp.PanelEditor}))})))}));const xw={refId:"Rooms temperature",datasource:l,scenarioId:"random_walk",seriesCount:8,alias:"__house_locations",min:10,max:27},Pw=()=>new Vf(_w(Sw({},jy()),{$data:new Cl({datasource:l,queries:[xw],maxDataPoints:100}),body:new Ag({direction:"column",children:[new Ig({height:300,body:mw()}),new Ig({ySizing:"fill",body:new kg({body:new Ag({direction:"column",children:[]}),getLayoutChild:(t,n,a)=>{return new Ig({key:`panel-${a}`,minHeight:200,$data:new $e({data:(i=fw({},t),o={series:[n]},o=null!=o?o:{},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(o)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(o)).forEach((function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(o,e))})),i)}),body:new Ag({direction:"row",children:[new Ig({body:fy().setTitle((0,e.getFrameDisplayName)(n)).setOption("legend",{showLegend:!1}).setHeaderActions(r().createElement("a",{className:"external-link",href:`${c("with-drilldowns")}/room/${encodeURIComponent((0,e.getFrameDisplayName)(n))}/temperature`},r().createElement(_n.Icon,{name:"arrow-right"}),"Go to room")).build()}),new Ig({width:200,body:dy().setTitle("Last").setOption("graphMode",Ce.None).setOption("textMode",Ee.Value).setDisplayName("Last").build()})]})});var i,o}})})]})}));function Cw(t){return new wb(_w(Sw({},t),{subTitle:"This scene showcases a basic drilldown functionality. Interact with room to see room details scene.",getScene:Pw,drilldowns:[{routePath:`${t.url}/room/:roomName`,getPage(n,a){const i=n.params.roomName;return new wb({url:`${t.url}/room/${i}/temperature`,title:`${i}`,subTitle:"This scene is a particular room drilldown. It implements two tabs to organise the data.",getParentPage:()=>a,tabs:[new wb({title:"Temperature",titleIcon:"dashboard",tabSuffix:()=>r().createElement(_n.Counter,{value:1}),url:`${t.url}/room/${i}/temperature`,getScene:()=>function(t){return new Vf(yw({$data:new Cl({datasource:l,queries:[vw(t)],maxDataPoints:100}),body:new Ag({direction:"column",children:[new Ig({height:500,body:fy().setTitle("Temperature over time").setUnit("celsius").build()}),new Ig({body:new Ag({direction:"row",children:[new Ig({body:gw([e.ReducerID.min])}),new Ig({body:gw([e.ReducerID.max])}),new Ig({body:gw([e.ReducerID.mean])})]})})]})},jy()))}(i)}),new wb({title:"Humidity",titleIcon:"chart-line",url:`${t.url}/room/${i}/humidity`,getScene:()=>function(e){return new Vf(yw({$data:new Cl({datasource:l,queries:[ww(e)],maxDataPoints:100}),body:new Ag({direction:"column",children:[new Ig({height:500,body:fy().setTitle("Humidity over time").setUnit("humidity").build()})]})},jy()))}(i)})]})}}]}))}function Ew(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jw(e){const t=new Xe({timeZone:"browser"}),n=new Xe({from:"now-5m",to:"now"}),r=new hh({timeZone:"America/New_York"}),a=fy(),i=a.setTitle("Using global time range and time zone (${__timezone})").setDescription("This panel should show data within time zone and time range selected in the time picker.").build(),o=a.setTitle("Using local range and global time zone (${__timezone})").setDescription("This panel should show data from the last 5 minutes, using time zone from the time picker").build(),s=a.setTitle("Using global range, local time zone (${__timezone})").setDescription("This panel should show data using America/New_York time zone and time range from the time picker").build();return t.subscribeToState((()=>{i.setState({title:`Using global time range and global time zone: ${t.getTimeZone()}`}),o.setState({title:`Using local time range and global time zone: ${n.getTimeZone()}`})})),r.subscribeToState(((e,t)=>{s.setState({title:`Using global time range and local time zone: ${r.getTimeZone()}`})})),new wb((l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ew(e,t,n[t])}))}return e}({},e),u=null!=(u={subTitle:"Time zones support test",getScene:()=>new Vf({$timeRange:t,controls:[new Rg,new Zm({}),new dg({})],key:"Time zones embedded scene",body:new Ag({direction:"column",children:[new Ag({direction:"row",maxHeight:"500",children:[new Ig({$data:Ey({}),minHeight:"200",body:i}),new Ig({$data:Ey({}),$timeRange:n,minHeight:"200",body:new Ag({direction:"column",children:[new Ig({body:o})]})}),new Ig({$data:Ey({}),$timeRange:r,minHeight:"200",body:s})]})]})})})?u:{},Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(u)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(u)).forEach((function(e){Object.defineProperty(l,e,Object.getOwnPropertyDescriptor(u,e))})),l));var l,u}function Dw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Dw(e,t,n[t])}))}return e}function Tw(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const Rw={refId:"Rooms temperature",datasource:l,scenarioId:"random_walk",seriesCount:8,alias:"__house_locations",min:10,max:27},Aw=()=>{const e=new Ig({minWidth:500,body:new Km({text:"Select room to see details",fontSize:20,align:"center"})}),t=new Cl({datasource:l,queries:[Rw],maxDataPoints:100}),n=py().setData(new Ah({transformations:[{id:"reduce",options:{reducers:["mean"]}},{id:"organize",options:{excludeByName:{},indexByName:{},renameByName:{Field:"Room",Mean:"Average temperature"}}}]})).setTitle("Room temperature overview").setOption("sortBy",[{displayName:"Average temperature"}]).setCustomFieldConfig("align","auto").setCustomFieldConfig("cellOptions",{type:ke.Auto}).setCustomFieldConfig("inspect",!1).setColor({mode:ec.ContinuousGrYlRd}).setOverrides((t=>t.matchFieldsWithName("Average temperature").overrideUnit("celsius").overrideCustomFieldConfig("align","center").overrideCustomFieldConfig("cellOptions",{type:ke.Gauge,mode:De.Gradient}).matchFieldsWithName("Room").overrideLinks([{title:"Go to room overview",url:"",onClick:t=>{const n=t.origin.field.values.get(t.origin.rowIndex);a.setState({secondary:new Ig({minWidth:500,body:fy().setTitle(`${n} temperature`).setData(new Cl({datasource:l,queries:[vw(n)]})).setHeaderActions(r().createElement("label",null,r().createElement(_n.IconButton,{name:"trash-alt",type:"button",onClick:()=>a.setState({secondary:void 0}),"aria-label":"remove right part"}),r().createElement(_n.IconButton,{name:"times",type:"button",onClick:()=>a.setState({secondary:e}),"aria-label":"clear right part"}))).build()})})}}]).overrideCustomFieldConfig("width",250))).build(),a=new tb({direction:"row",primary:new Ig({body:n,minWidth:300}),secondary:e});return new Vf(Tw(kw({},jy()),{key:"Flex layout embedded scene",$data:t,body:a}))};function Iw(e){return new wb(Tw(kw({},e),{subTitle:"A demo of split layout options",url:c("split-layout"),tabs:[new wb({title:"Split layout test",url:c("split-layout"),getScene:()=>new Vf(Tw(kw({},jy()),{key:"Flex layout embedded scene",body:new tb({initialSize:.7,direction:"row",primary:new Ig({minWidth:300,body:fy().setTitle("Dynamic height and width").setData(Ey({},{maxDataPointsFromWidth:!0})).build()}),secondary:new Ig({minWidth:300,body:new tb({ySizing:"content",direction:"column",primary:new Ig({minHeight:200,body:fy().setTitle("Dynamic height and width").setData(Ey({},{maxDataPointsFromWidth:!0})).build()}),secondary:new Ig({minHeight:200,body:new Km({text:"Blah blah",fontSize:30,align:"center"})})})})})}))}),new wb({title:"Dynamic split layout test",url:c("split-layout/dynamic"),getScene:Aw})]}))}function Mw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Mw(e,t,n[t])}))}return e}function Fw(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Lw(e){return new wb(Fw(Vw({},e),{subTitle:"Demo of query cancellation",getScene:()=>new Vf(Fw(Vw({},jy()),{key:"Flex layout embedded scene",$data:Ey({scenarioId:"slow_query",stringInput:"10s"},{maxDataPointsFromWidth:!1}),body:new Ag({direction:"column",children:[new Ag({direction:"row",children:[new Ig({minWidth:"20%",body:fy().setTitle("Global query").build()}),new Ig({minWidth:"20%",body:fy().setTitle("Local query").setData(Ey({scenarioId:"slow_query",stringInput:"10s"},{maxDataPointsFromWidth:!1})).build()}),new Ig({minWidth:"20%",body:dy().setTitle("Local query via transformation").setData(new Ah({$data:Ey({scenarioId:"slow_query",stringInput:"15s"},{maxDataPointsFromWidth:!0}),transformations:[{id:"reduce",options:{reducers:["mean"]}}]})).build()}),new Ig({minWidth:"20%",body:dy().setTitle("Global query via transformation").setData(new Ah({transformations:[{id:"reduce",options:{reducers:["mean"]}}]})).build()}),new Ig({minWidth:"20%",body:dy().setTitle("Transformed transformation").setData(new Ah({transformations:[{id:"calculateField",options:{mode:"binary",reduce:{reducer:"sum"},binary:{left:"A-series",reducer:"sum",operator:"*",right:"2"}}}]})).build()})]})]})}))}))}function $w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){$w(e,t,n[t])}))}return e}function Bw(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Nw(e){return xy({dataSource:new qw("my-custom-ds","my-custom-ds-uid")}),new wb(Bw(zw({},e),{subTitle:"Demo of a runtime registered panel plugin",getScene:()=>new Vf(Bw(zw({},jy()),{$variables:new $h({variables:[new Lu({name:"test",query:{refId:"A",query:"A"},datasource:{uid:"my-custom-ds-uid",type:"my-custom-ds"}})]}),body:new Ag(Bw(zw({},jy()),{direction:"column",children:[new Ig({body:new fd({title:"Data coming from custom runtime registered data source",pluginId:"table",$data:new Cl({datasource:{uid:"my-custom-ds-uid",type:"my-custom-ds"},queries:[{refId:"A",query:"A"}]})})})]}))}))}))}class qw extends fe{query(t){return Promise.resolve({state:Ae.Done,data:[{fields:[{name:"Values",type:e.FieldType.number,values:[1,2,3],config:{}}],length:3}]})}metricFindQuery(e,t){return Promise.resolve([{text:"value1-from-runtime-ds",value:"value1-from-runtime-ds"},{text:"value2-from-runtime-ds",value:"value2-from-runtime-ds"}])}testDatasource(){return Promise.resolve({status:"success",message:"OK"})}}function Hw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ww extends re{constructor(){super({count:0}),Hw(this,"onIncrement",(()=>{this.setState({count:this.state.count+1})}))}}function Uw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Hw(Ww,"Component",(function({model:e}){const{count:t}=e.useState();return r().createElement("div",null,r().createElement("div",null,"Counter: ",t),r().createElement("button",{onClick:e.onIncrement},"Increase"))}));class Gw extends re{constructor(){super({count:0}),Uw(this,"onIncrement",(()=>{this.setState({count:this.state.count+1})}))}}function Qw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Kw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Qw(e,t,n[t])}))}return e}function Yw(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}Uw(Gw,"Component",(function({model:e}){const{count:t}=e.useState();return r().createElement("div",null,r().createElement("div",null,"Counter: ",t),r().createElement("button",{onClick:e.onIncrement},"Increase"))}));const Zw=()=>e=>e.pipe(up((e=>e.map((e=>Yw(Kw({},e),{fields:e.fields.map((e=>"handler"===e.name?Yw(Kw({},e),{values:e.values.map((e=>"http://www.my-api.com"+e))}):e))}))))));function Xw(e){var t,n;const{options:a,data:i}=e;return r().createElement("div",null,r().createElement("h4",null,"CustomVizPanel options: ",r().createElement("pre",null,JSON.stringify(a))),r().createElement("div",null,"CustomVizPanel field config: ",r().createElement("pre",null,JSON.stringify(null===(n=i.series[0])||void 0===n||null===(t=n.fields[0])||void 0===t?void 0:t.config))))}function Jw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class eO extends re{constructor(e){super({text:e}),Jw(this,"_variableDependency",new pu(this,{statePaths:["text"]})),Jw(this,"onTextChange",(e=>{this.setState({text:e})}))}}Jw(eO,"Component",(function({model:e}){const{text:t}=e.useState(),n=Hu.interpolate(e,t);return r().createElement("div",null,r().createElement("div",{style:{marginBottom:8}},r().createElement(_n.TextArea,{defaultValue:t,onBlur:t=>e.onTextChange(t.currentTarget.value)})),r().createElement("pre",null,n))}));class tO extends re{activationHandler(){const e=Hu.getData(this);this._subs.add(e.subscribeToState((e=>console.log(e))))}constructor(){super({}),this.addActivationHandler((()=>this.activationHandler()))}}var nO,rO,aO;function iO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}aO=function({model:e}){var t,n;const a=Hu.getData(e).useState();return r().createElement("div",null,r().createElement("pre",null,"Time range: ",JSON.stringify(null===(t=a.data)||void 0===t?void 0:t.timeRange)),r().createElement("pre",null,"Data: ",JSON.stringify(null===(n=a.data)||void 0===n?void 0:n.series)))},(rO="Component")in(nO=tO)?Object.defineProperty(nO,rO,{value:aO,enumerable:!0,configurable:!0,writable:!0}):nO[rO]=aO;const oO=e=>(console.log(`${e.state.key} activated`),e.subscribeToState((()=>{console.log(`${e.state.key} state changed`)})),()=>{console.log(`${e.state.key} deactivated`)});class sO extends re{constructor(e){super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){iO(e,t,n[t])}))}return e}({batchStateUpdates:5},e)),iO(this,"_batchedStateUpdates",[]),iO(this,"_onActivate",(()=>{const e=this.parent;if(!e)throw new Error("LoggerBehavior must be attached to a parent object");return console.log(`StatefulLoggerBehavior: ${e.state.key} activated`),e.subscribeToState((()=>{this._batchedStateUpdates.push(e.state),this._batchedStateUpdates.length===this.state.batchStateUpdates&&(console.log(`StatefulLoggerBehavior: ${e.state.key} state changed batch`,this._batchedStateUpdates),this._batchedStateUpdates=[])})),()=>{console.log(`StatefulLoggerBehavior: ${e.state.key} deactivated`)}})),this.addActivationHandler(this._onActivate)}}function lO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const uO=[{title:"Hello world",url:"hello-world",getScene:function(){return new Vf({body:new Ag({children:[new Ig({width:"50%",height:300,body:hy().setTitle("Panel title").setOption("content","Hello world!").build()})]})})}},{title:"Custom object",url:"custom-object",getScene:function(){return new Vf({body:new Ag({children:[new Ig({width:"50%",height:300,body:new Gw})]})})}},{title:"Data and time range",url:"data-and-time-range",getScene:function(){const e=new Cl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"rate(prometheus_http_requests_total{}[5m])"}]}),t=new Cl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"avg by (job, instance, mode) (rate(node_cpu_seconds_total[5m]))"}]});return new Vf({$data:e,$timeRange:new Xe({from:"now-5m",to:"now"}),body:new Ag({direction:"row",children:[new Ig({width:"50%",height:300,body:fy().setTitle("Panel using global time range").build()}),new Ig({width:"50%",height:300,body:fy().setTitle("Panel using local time range").setTimeRange(new Xe({from:"now-6h",to:"now"})).setData(t).build()})]})})}},{title:"Flexbox layout",url:"scene-layout-flexbox",getScene:function(){const e=new Cl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"rate(prometheus_http_requests_total{}[5m])"}]});return new Vf({$data:e,body:new Ag({direction:"column",children:[new Ig({body:fy().setTitle("Time series").build()}),new Ig({body:py().setTitle("Table").build()})]})})}},{title:"CSS grid layout",url:"scene-layout-css-grid",getScene:function(){const e=new Cl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"rate(prometheus_http_requests_total{}[5m])"}]});return new Vf({$data:e,body:new Bg({templateColumns:"repeat(auto-fit, minmax(400px, 1fr))",autoRows:"150px",rowGap:2,columnGap:2,children:[new Ng({body:fy().setTitle("Time series").build()}),new Ng({body:py().setTitle("Time series").build()}),new Ng({body:fy().setTitle("Time series").build()}),new Ng({body:py().setTitle("Time series").build()}),new Ng({body:fy().setTitle("Table").build()}),new Ng({body:py().setTitle("Table").build()})]})})}},{title:"Grid layout",url:"scene-layout-grid",getScene:function(){const e=new Cl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"rate(prometheus_http_requests_total{}[5m])"}]});return new Vf({body:new Mm({$data:e,children:[new Uf({x:0,y:0,width:12,height:10,isResizable:!1,isDraggable:!1,body:fy().setTitle("Time series").build()}),new Uf({x:12,y:0,width:12,height:10,isResizable:!1,isDraggable:!1,body:py().setTitle("Table").build()})]})})}},{title:"Split layout",url:"scene-layout-split",getScene:function(){const e=new Cl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"rate(prometheus_http_requests_total{}[5m])"}]});return new Vf({$data:e,body:new tb({direction:"column",primary:fy().setTitle("Primary panel").build(),secondary:py().setTitle("Secondary panel").build()})})}},{title:"Standard visualizations",url:"visualizations-standard",getScene:function(){const e=fy().setTitle("My first panel"),t=new Cl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"rate(prometheus_http_requests_total{}[5m])"}],$timeRange:new Xe({from:"now-5m",to:"now"})});e.setData(t),e.setOption("legend",{asTable:!0}).setOption("tooltip",{mode:je.Single}),e.setDecimals(2).setUnit("ms"),e.setCustomFieldConfig("lineInterpolation",Oe.Smooth),e.setOverrides((e=>e.matchFieldsWithNameByRegex("/metrics/").overrideDecimals(4).overrideCustomFieldConfig("lineWidth",5)));const n=e.build();return new Vf({body:new Ag({children:[new Ig({body:n})]})})}},{title:"Custom visualization",url:"visualizations-custom",getScene:()=>{const t=new e.PanelPlugin(Xw).useFieldConfig({useCustomConfig:e=>{e.addNumberInput({path:"numericOption",name:"Numeric option",description:"A numeric option",defaultValue:1})}});_y({pluginId:"my-scene-app-my-custom-viz",plugin:t});const n=new Cl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"rate(prometheus_http_requests_total{}[5m])"}],$timeRange:new Xe({from:"now-5m",to:"now"})});return new Vf({$data:n,body:new Ag({children:[new Ig({body:new fd({pluginId:"my-scene-app-my-custom-viz",options:{mode:"my-custom-mode"},fieldConfig:{defaults:{unit:"ms",custom:{numericOption:100}},overrides:[]}})})]})})}},{title:"Variables",url:"variables",getScene:function(){const e=new Lu({name:"handler",datasource:{type:"prometheus",uid:"gdev-prometheus"},query:{query:"label_values(prometheus_http_requests_total,handler)",refId:"A"}}),t=new Cl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",range:!0,format:"time_series",expr:'rate(prometheus_http_requests_total{handler="$handler"}[5m])'}]});return new Vf({$variables:new $h({variables:[e]}),$data:t,body:new Ag({children:[new Ig({body:fy().build()})]}),controls:[new Ih({})]})}},{title:"Transformations",url:"transformations",getScene:function(){const e=new Cl({$timeRange:new Xe,datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"sort_desc(avg by(handler) (rate(prometheus_http_request_duration_seconds_sum {}[5m]) * 1e3))",format:"table",instant:!0}]}),t=new Ah({$data:e,transformations:[Zw,{id:"organize",options:{excludeByName:{Time:!0},indexByName:{},renameByName:{}}},{id:"renameByRegex",options:{regex:"handler",renamePattern:"Handler"}},{id:"renameByRegex",options:{regex:"Value",renamePattern:"Average duration"}}]});return new Vf({$data:t,body:new Ag({direction:"column",children:[new Ig({body:py().setTitle("Average duration of HTTP request").build()})]})})}},{title:"Advanced - custom objects",url:"advanced-custom-scene-objects",getScene:function(){return new Vf({body:new Ag({children:[new Ig({width:"50%",height:300,body:new Ww})]})})}},{title:"Advanced - activation handlers",url:"advanced-activation-handlers",getScene:function(){const e=new Cl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",range:!0,format:"time_series",expr:"rate(prometheus_http_requests_total[5m])"}]}),t=hy().setTitle("Debug view").setOption("mode",zb.HTML).setOption("content","").build();return e.addActivationHandler((()=>{let n="";const r=e.subscribeToState((e=>{n=`${new Date(Date.now()).toLocaleTimeString()} Executed query: <pre>${e.queries.map((e=>e.expr))}</pre>\n`+n,t.setState({options:{content:n}})}));return()=>{r.unsubscribe()}})),new Vf({$timeRange:new Xe,controls:[new Zm({isOnCanvas:!0}),new dg({isOnCanvas:!0})],body:new Ag({direction:"row",children:[new Ig({body:fy().setTitle("Panel title").setData(e).build()}),new Ig({width:"30%",body:t})]})})}},{title:"Advanced - data",url:"advanced-data",getScene:function(){const e=new Cl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"rate(prometheus_http_requests_total{}[5m])"}]});return new Vf({$data:e,controls:[new Rg,new Zm({}),new dg({})],body:new Ag({direction:"column",children:[new Ig({body:new tO})]})})}},{title:"Advanced - variables",url:"advanced-variables",getScene:function(){const e=new Gh({name:"greetings",query:"Hello , Hola , Bonjour , Ahoj"});return new Vf({$variables:new $h({variables:[e]}),controls:[new Ih({})],body:new Ag({direction:"column",children:[new Ig({minHeight:300,body:new eO("Hello world")})]})})}},{title:"Advanced - time range comparison",url:"advanced-time-range-comparison",getScene:function(){const e=new Cl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:'rate(prometheus_http_requests_total{handler=~"/metrics"}[5m])'}]});return new Vf({$data:e,$timeRange:new Xe({from:"now-5m",to:"now"}),controls:[new Zm({}),new Eg({})],body:new Ag({direction:"row",children:[new Ig({width:"100%",height:"100%",body:fy().setTitle("Panel using global time range").build()})]})})}},{title:"Advanced - Behaviors",url:"advanced-behaviors",getScene:function(){const e=new Cl({$behaviors:[oO,new sO({batchStateUpdates:5})],datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",range:!0,format:"time_series",expr:"rate(prometheus_http_requests_total[5m])"}]});return new Vf({$timeRange:new Xe,controls:[new Zm({isOnCanvas:!0}),new dg({isOnCanvas:!0})],body:new Ag({direction:"row",children:[new Ig({body:fy().setTitle("Panel title").setData(e).build()})]})})}}];function cO(e){return new wb((t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){lO(e,t,n[t])}))}return e}({},e),n={subTitle:"Examples from documentation page",url:c("docs-examples"),tabs:uO.map((e=>function(e,t,n){return new wb({title:n,url:c(`docs-examples/${t}`),getScene:e})}(e.getScene,e.url,e.title)))},n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t));var t,n}function dO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pO(e){return new wb((t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){dO(e,t,n[t])}))}return e}({},e),n=null!=(n={subTitle:"Time range comparison test",getScene:()=>new Vf({$data:Ey({},{maxDataPointsFromWidth:!1}),$timeRange:new Xe({}),controls:[new Rg,new Zm({}),new Eg({key:"top"}),new dg({})],key:"Flex layout embedded scene",body:new Ag({direction:"column",children:[new Ag({direction:"row",wrap:"wrap",children:[new Ig({minWidth:"40%",minHeight:500,body:fy().setTitle("Uses global time range, data and comparer").setData(Ey({},{maxDataPointsFromWidth:!0})).build()}),new Ig({minWidth:"40%",minHeight:500,body:fy().setOverrides((e=>e.matchComparisonQuery("MyQuery").overrideColor({mode:"fixed",fixedColor:"red"}))).setTitle("Uses global time range and comparer, local data").setData(Ey({refId:"MyQuery"},{maxDataPointsFromWidth:!0})).build()}),new Ig({minWidth:"40%",minHeight:500,body:fy().setTitle("Uses global time range, local comparer and data").setData(Ey({},{maxDataPointsFromWidth:!0})).setHeaderActions([new Eg({key:"mid"})]).build()}),new Ig({minWidth:"40%",minHeight:500,body:fy().setTitle("Uses local time range, data and comparer").setTimeRange(new Xe({})).setData(Ey({},{maxDataPointsFromWidth:!0})).setHeaderActions([new Zm({}),new Eg({key:"bottom"}),new dg({})]).build()})]})]})})})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t));var t,n}function hO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){hO(e,t,n[t])}))}return e}function mO(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function gO(e){return new wb(mO(fO({},e),{subTitle:"A simple demo of scoped cursor sync",url:c("cursor-sync"),tabs:[new wb({title:"Global sync scope",url:c("cursor-sync"),getScene:()=>new Vf(mO(fO({},jy()),{key:"Flex layout embedded scene",$behaviors:[new uc({key:"sync1",sync:tc.Tooltip})],body:new Ag({direction:"column",children:[new Ag({direction:"row",children:[new Ig({body:new fd({title:"Panel 1",pluginId:"timeseries",$data:Ey({scenarioId:"csv_metric_values",stringInput:"1,20,90,30,5,0"})})}),new Ig({body:fy().setData(Ey({scenarioId:"csv_metric_values",stringInput:"1,20,90,30,5,0"},{maxDataPoints:50})).setTitle("Panel 2").build()})]}),new Ag({direction:"row",children:[new Ig({body:new fd({title:"Panel 3",pluginId:"timeseries",$data:Ey({})})})]})]})}))}),new wb({title:"Cursor sync test",url:c("cursor-sync/scoped"),getScene:()=>new Vf(mO(fO({},jy()),{key:"Flex layout embedded scene",body:new Ag({direction:"column",children:[new Ag({direction:"row",$behaviors:[new uc({key:"sync1",sync:tc.Tooltip})],children:[new Ig({body:new fd({title:"Panel 1 - syncs tooltip with Panel 2",pluginId:"piechart",$data:Ey({alias:"__house_locations",seriesCount:5,scenarioId:"random_walk"})})}),new Ig({body:cy().setData(Ey({alias:"__house_locations",seriesCount:5,scenarioId:"random_walk"},{maxDataPoints:50})).setTitle("Panel 2").build()})]}),new Ag({direction:"row",$behaviors:[new uc({key:"sync1",sync:tc.Tooltip})],children:[new Ig({body:new fd({title:"Panel 1 - syncs tooltip with Panel 2",pluginId:"timeseries",$data:Ey({scenarioId:"csv_metric_values",stringInput:"1,20,90,30,5,0"})})}),new Ig({body:fy().setData(Ey({scenarioId:"csv_metric_values",stringInput:"1,20,90,30,5,0"},{maxDataPoints:50})).setTitle("Panel 2").build()})]}),new Ag({direction:"row",$behaviors:[new uc({key:"sync2",sync:tc.Crosshair})],children:[new Ig({body:new fd({title:"Panel 3 - syncs crosshair with Panel 4",pluginId:"timeseries",$data:Ey({})})}),new Ig({body:fy().setData(Ey({},{maxDataPoints:50})).setTitle("Panel 4").build()})]}),new Ag({direction:"row",$behaviors:[new uc({key:"sync3",sync:tc.Off})],children:[new Ig({body:new fd({title:"No sync",pluginId:"timeseries",$data:Ey({})})}),new Ig({body:fy().setData(Ey({},{maxDataPoints:50})).setTitle("No sync").build()})]})]})}))})]}))}function bO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){bO(e,t,n[t])}))}return e}function vO(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function wO(e){const t=new nh({name:"Global annotations",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"yellow",name:"New annotation",target:{lines:10,refId:"Anno",scenarioId:"annotations"}}}),n=new nh({name:"Nested annotations",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"red",name:"New annotation",target:{lines:5,refId:"Anno",scenarioId:"annotations"}}}),r=new nh({name:"Independent annotations",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"purple",name:"New annotation",target:{lines:3,refId:"Anno",scenarioId:"annotations"}}});return new wb(vO(yO({},e),{subTitle:"A simple demo of different flex layout options",getScene:()=>new Vf(vO(yO({},jy()),{controls:[new xd,new Rg,new Zm({}),new dg({})],key:"Multiple annotations layers",$data:new _h({layers:[t]}),body:new Ag({direction:"column",children:[new Ag({direction:"row",children:[new Ig({$data:Ey({scenarioId:"slow_query",stringInput:"5s"}),body:new fd({title:"Global annotations only",pluginId:"timeseries"})}),new Ig({$data:n,body:new fd({$data:Ey({}),title:"Nested annotations",description:"Uses a single data layer directly, not inside a SceneDataLayers",pluginId:"timeseries",headerActions:[new xd]})}),new Ig({body:new fd({$data:new Cl({$data:new _h({layers:[r]}),queries:[{refId:"A",datasource:l,scenarioId:"random_walk"}]}),title:"Combined annotations, from global and SceneQueryRunner",pluginId:"timeseries",headerActions:[new xd]})})]}),new Ag({direction:"row",children:[new Ig({$data:new Ah({$data:Ey({scenarioId:"csv_metric_values",stringInput:"1,20,90,30,5,0"}),transformations:[{id:"calculateField",options:{mode:"binary",reduce:{reducer:"sum"},binary:{left:"A-series",reducer:"sum",operator:"*",right:"2"}}}]}),body:new fd({title:"Transformed data & Global annotations",pluginId:"timeseries"})}),new Ig({$data:new _h({layers:[new nh({name:"Local annotations",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"green",name:"New annotation",target:{lines:4,refId:"Anno",scenarioId:"annotations"}}})]}),body:new fd({$data:new Ah({$data:Ey({scenarioId:"csv_metric_values",stringInput:"1,20,90,30,5,0"}),transformations:[{id:"calculateField",options:{mode:"binary",reduce:{reducer:"sum"},binary:{left:"A-series",reducer:"sum",operator:"*",right:"5"}}}]}),title:"Transformed local data, global+local annotations",pluginId:"timeseries",headerActions:[new xd]})})]})]})}))}))}function OO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){OO(e,t,n[t])}))}return e}function _O(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function xO(t){return new wb(_O(SO({},t),{subTitle:"Adhoc filters variable can be used in auto mode. By default datasources will apply the filters automatically to all queries of the same data source.\n     In manual mode you can use it as a normal variable in queries or use it programmtically.\n    ",tabs:[new wb({title:"Apply mode auto",url:`${t.url}/auto`,getScene:()=>new Vf(_O(SO({},jy()),{$variables:new $h({variables:[new sl({name:"Filters",baseFilters:[{key:"__name__",operator:"=",value:"ALERTS",condition:""}],datasource:{uid:"gdev-prometheus"},supportsMultiValueOperators:!0})]}),body:new Ag({direction:"row",children:[new Ig({body:py().setTitle("ALERTS").setData(new Cl({datasource:{uid:"gdev-prometheus"},queries:[{refId:"A",expr:"ALERTS",format:"table",instant:!0}]})).build()})]})}))}),new wb({title:"Apply mode manual",url:`${t.url}/manual`,getScene:()=>{const e=new sl({applyMode:"manual",datasource:{uid:"gdev-prometheus"},filters:[{key:"job",operator:"=",value:"grafana",condition:""}],supportsMultiValueOperators:!0});return new Vf(_O(SO({},jy()),{$variables:new $h({variables:[e]}),body:new Ag({direction:"column",children:[new Ig({ySizing:"content",body:new Km({text:"Using AdHocFilterSet in manual mode allows you to use it as a normal variable. The query below is interpolated to ALERTS{$Filters}",fontSize:14})}),new Ig({ySizing:"content",body:new PO({filtersVar:e.getRef()})}),new Ig({body:py().setTitle("ALERTS").setData(new Cl({datasource:{uid:"gdev-prometheus"},queries:[{refId:"A",expr:"ALERTS{$Filters}",format:"table",instant:!0}]})).build()})]}),$timeRange:new Xe}))}}),new wb({title:"Vertical Variants",url:`${t.url}/vertical`,getScene:()=>new Vf(_O(SO({},jy()),{$variables:new $h({variables:[new sl({name:"no-button-text",layout:"vertical",label:"Without add filter button text",hide:e.VariableHide.hideLabel,datasource:{uid:"gdev-prometheus"},filters:[{key:"job",operator:"=",value:"has no text",condition:""}],supportsMultiValueOperators:!0}),new sl({name:"button-text",layout:"vertical",label:"With add filter button text",hide:e.VariableHide.hideLabel,addFilterButtonText:"Add a filter",datasource:{uid:"gdev-prometheus"},filters:[{key:"job",operator:"=",value:"has text on add button",condition:""}],supportsMultiValueOperators:!0}),new sl({name:"button-text",layout:"vertical",label:"With add filter button text",hide:e.VariableHide.hideLabel,addFilterButtonText:"Filter",datasource:{uid:"gdev-prometheus"},filters:[{key:"job",operator:"=",value:"also has text on add button",condition:""}],supportsMultiValueOperators:!0})]}),body:new Ag({direction:"column",children:[new Ig({ySizing:"content",body:new Km({text:"Using AdHocFilterSet in manual mode allows you to use it as a normal variable. The query below is interpolated to ALERTS{$Filters}",fontSize:14})}),new Ig({body:py().setTitle("ALERTS").setData(new Cl({datasource:{uid:"gdev-prometheus"},queries:[{refId:"A",expr:"ALERTS{$Filters}",format:"table",instant:!0}]})).build()})]}),$timeRange:new Xe}))}),new wb({title:"New Filters UI",url:`${t.url}/new-filters`,getScene:()=>new Vf(_O(SO({},jy()),{$variables:new $h({variables:[new sl({name:"ComboboxFilters",label:"Without add filter button text",hide:e.VariableHide.hideLabel,datasource:{uid:"gdev-prometheus"},filters:[{key:"job",operator:"=",value:"has no text",condition:""}],layout:"combobox",supportsMultiValueOperators:!0})]}),body:new Ag({direction:"column",children:[new Ig({ySizing:"content",body:new Km({text:"The query below is interpolated to ALERTS{$ComboboxFilters}",fontSize:14})}),new Ig({body:py().setTitle("ALERTS").setData(new Cl({datasource:{uid:"gdev-prometheus"},queries:[{refId:"A",expr:"ALERTS",format:"table",instant:!0}]})).build()})]}),$timeRange:new Xe}))})]}))}class PO extends re{}function CO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function EO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){CO(e,t,n[t])}))}return e}function jO(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function DO(e){return new wb(jO(EO({},e),{subTitle:"TODO description",getScene:()=>new Vf(jO(EO(jO(EO({},jy()),{$variables:new $h({variables:[new or({name:"groupBy",label:"Group By MultiSelect (static list)",datasource:{uid:"gdev-prometheus"},defaultOptions:[{text:"instance",value:"instance"},{text:"job",value:"job"},{text:"alert_name",value:"alert_name"}]}),new or({name:"groupByOneSelection",label:"Group By OneSelection (static list)",datasource:{uid:"gdev-prometheus"},isMulti:!1,defaultOptions:[{text:"schema",value:"schema"},{text:"instance",value:"instance"},{text:"job",value:"job"}]})]}),controls:[new Ih({})]}),jy().controls),{body:new Ag({direction:"column",children:[new Ig({ySizing:"content",body:new Km({text:"Interpolated value MultiSelect(static): {$groupBy}",fontSize:14})}),new Ig({ySizing:"content",body:new Km({text:"Interpolated value OneSelection (static): {$groupByOneSelection}",fontSize:14})}),new Ig({body:py().setTitle("ALERTS").setData(new Cl({datasource:{uid:"gdev-prometheus"},queries:[{refId:"A",expr:"count(ALERTS)",format:"table",instant:!0}]})).build()})]})}))}))}function kO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function TO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){kO(e,t,n[t])}))}return e}function RO(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function AO(e){return new wb(RO(TO({},e),{subTitle:"TODO description",getScene:()=>new Vf(RO(TO(RO(TO({},jy()),{$variables:new $h({variables:[new or({name:"groupBy",label:"Group By (from datasource)",datasource:{uid:"gdev-prometheus"}})]}),controls:[new Ih({})]}),jy().controls),{body:new Ag({direction:"column",children:[new Ig({ySizing:"content",body:new Km({text:"Interpolated value (datasource): {$groupBy})",fontSize:14})}),new Ig({body:py().setTitle("ALERTS").setData(new Cl({datasource:{uid:"gdev-prometheus"},queries:[{refId:"A",expr:"count(ALERTS)",format:"table",instant:!0}]})).build()})]})}))}))}function IO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function MO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){IO(e,t,n[t])}))}return e}function VO(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function FO(e){return new wb(VO(MO({},e),{subTitle:"Transformations support ",getScene:()=>new Vf(VO(MO({},jy()),{$data:Ey({scenarioId:"csv_metric_values",stringInput:"1,20,90,30,5,0"}),body:new Ag({direction:"row",children:[new Ig({body:new Ag({direction:"column",children:[new Ig({body:new Ag({direction:"row",children:[new Ig({body:fy().setTitle("Source data (global query)").build()}),new Ig({body:dy().setTitle("Transformed data").setData(new Ah({transformations:[{id:"reduce",options:{reducers:["last","mean"]}}]})).build()}),new Ig({body:fy().setTitle("Custom transformer (log10 scale)").setData(new Ah({transformations:[LO()]})).build()}),new Ig({body:fy().setTitle("Custom transformer (log10 scale) that throws").setData(new Ah({transformations:[LO(!0)]})).build()})]})}),new Ig({body:dy().setTitle("Query with predefined transformations").setData(new Ah({$data:Ey(),transformations:[{id:"reduce",options:{reducers:["mean"]}}]})).build()}),new Ig({body:dy().setTitle("Datasoure and transformations error").setData(new Ah({$data:Ey({datasource:{uid:"nonexistent"}}),transformations:[LO(!0)]})).build()})]})})]})}))}))}OO(PO,"Component",(({model:t})=>{const n=t.state.filtersVar.resolve();return r().createElement(_n.Stack,null,r().createElement(_n.Button,{onClick:()=>{n.setState({filters:[],hide:e.VariableHide.hideVariable})}},"Clear"),r().createElement(_n.Button,{onClick:()=>{n.setState({filters:[{key:"job",operator:"=",value:"has no text",condition:""}],hide:e.VariableHide.dontHide})}},"Add filter"))}));const LO=(t=!1)=>()=>n=>n.pipe((0,D.map)((n=>n.map((r=>(t&&(n[1999].fields=[]),VO(MO({},r),{fields:r.fields.map((t=>t.type===e.FieldType.number?VO(MO({},t),{values:t.values.map((e=>Math.log(e)/Math.log(10)))}):t))})))))));function $O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){$O(e,t,n[t])}))}return e}function BO(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function NO(e){return new wb(BO(zO({},e),{subTitle:"A panel with actions that change visualization settings",getScene:()=>new Vf(BO(zO({},jy()),{key:"Dynamic options demo",$data:Ey({seriesCount:3,spread:15},{maxDataPoints:50}),body:new Ag({direction:"column",children:[new Ig({body:fy().setTitle("Graph").setHeaderActions([new HO({value:"lines"})]).build()}),new Ig({body:fy().setTitle("Graph").setHeaderActions([new qO({value:"timeseries"})]).build()})]})}))}))}class qO extends re{constructor(...e){super(...e),$O(this,"onChange",(e=>{this.setState({value:e});const t=this.parent;if("timeseries"===e)t.changePluginType("timeseries");else if("stat"===e)t.changePluginType("stat");else if("gauge_extra"===e){const e=yy().setOption("orientation",Pe.Vertical).build(),n=Oy().setUnit("accMS2").build();t.changePluginType("gauge",e,n)}}))}}$O(qO,"Component",(({model:e})=>{const{value:t}=e.useState();return r().createElement(r().Fragment,null,r().createElement(_n.RadioButtonGroup,{value:t,options:[{label:"Timeseries panel",value:"timeseries"},{label:"Stat",value:"stat"},{label:"Gauge with extra config",value:"gauge_extra"}],onChange:e.onChange,size:"sm"}))}));class HO extends re{constructor(...e){super(...e),$O(this,"intervalId",void 0),$O(this,"onChange",(e=>{window.clearInterval(this.intervalId),this.setState({value:e});const t=this.parent;switch(e){case"random_description":t.onDescriptionChange(WO());break;case"random_title":t.onTitleChange(WO()),this.intervalId=window.setInterval((()=>{t.onTitleChange(WO())}),2e3);break;case"lines":t.onFieldConfigChange(Sy().build(),!0),t.onOptionsChange(wy().build(),!0);break;case"bars_stacked":t.onFieldConfigChange(Sy().setCustomFieldConfig("fillOpacity",35).setCustomFieldConfig("drawStyle",we.Bars).setCustomFieldConfig("stacking",{mode:_e.Normal,group:"A"}).build()),t.onOptionsChange(wy().setOption("legend",{displayMode:xe.Table}).build());break;case"lines_stacked":t.onFieldConfigChange(Sy().setCustomFieldConfig("fillOpacity",10).setCustomFieldConfig("drawStyle",we.Line).setCustomFieldConfig("stacking",{mode:_e.Normal,group:"A"}).build()),t.onOptionsChange(wy().setOption("tooltip",{mode:je.Multi}).build(),!0)}}))}}function WO(){const e=["I","You","We","They"],t=["run","eat","sleep","dance","sing"],n=["apples","bananas","books","cats","dogs"];return`${e[Math.floor(Math.random()*e.length)]} ${t[Math.floor(Math.random()*t.length)]} ${n[Math.floor(Math.random()*n.length)]}.`}function UO(e){return r().createElement(_n.Tooltip,{content:"Cancel query"},r().createElement(_n.Icon,{className:"spin-clockwise",name:"sync",size:"xs",role:"button",onMouseDown:t=>{e.onCancel(t)}}))}function GO(e){const t=(0,_n.useStyles2)(QO),n=(0,_n.useTheme2)(),a="vertical"===e.layout,i=Boolean(e.isLoading)?r().createElement("div",{style:{marginLeft:n.spacing(1),marginTop:"-1px"},"aria-label":Cn.components.LoadingIndicator.icon},r().createElement(UO,{onCancel:t=>{var n,r;t.preventDefault(),t.stopPropagation(),null===(n=(r=e).onCancel)||void 0===n||n.call(r)}})):null;let o=null;e.error&&(o=r().createElement(_n.Tooltip,{content:e.error,placement:"bottom"},r().createElement(_n.Icon,{className:t.errorIcon,name:"exclamation-triangle"})));let s=null;e.description&&(s=r().createElement(_n.Tooltip,{content:e.description,placement:a?"top":"bottom"},r().createElement(_n.Icon,{className:t.normalIcon,name:"info-circle"})));const l="string"==typeof e.label?Cn.pages.Dashboard.SubMenu.submenuItemLabels(e.label):"";let u;return u=a?r().createElement("label",{className:t.verticalLabel,"data-testid":l,htmlFor:e.htmlFor},e.label,s,o,e.icon&&r().createElement(_n.Icon,{name:e.icon,className:t.normalIcon}),i,e.onRemove&&r().createElement(_n.IconButton,{variant:"secondary",size:"xs",name:"times",onClick:e.onRemove,tooltip:"Remove"})):r().createElement("label",{className:t.horizontalLabel,"data-testid":l,htmlFor:e.htmlFor},o,e.icon&&r().createElement(_n.Icon,{name:e.icon,className:t.normalIcon}),e.label,s,i),u}$O(HO,"Component",(({model:e})=>{const{value:t}=e.useState();return r().createElement(r().Fragment,null,r().createElement(_n.RadioButtonGroup,{value:t,options:[{label:"Default config",value:"lines"},{label:"Bars stacked & table legend",value:"bars_stacked"},{label:"Lines stacked & tooltip multi",value:"lines_stacked"},{label:"Random title (every 2 sec)",value:"random_title"},{label:"Random description",value:"random_description"}],onChange:e.onChange,size:"sm"}))}));const QO=e=>({horizontalLabel:(0,En.css)({background:e.isDark?e.colors.background.primary:e.colors.background.secondary,display:"flex",alignItems:"center",padding:e.spacing(0,1),fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.bodySmall.fontSize,height:e.spacing(e.components.height.md),lineHeight:e.spacing(e.components.height.md),borderRadius:e.shape.borderRadius(1),border:`1px solid ${e.components.input.borderColor}`,position:"relative",right:-1,whiteSpace:"nowrap",gap:e.spacing(.5)}),verticalLabel:(0,En.css)({display:"flex",alignItems:"center",fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.bodySmall.fontSize,lineHeight:e.typography.bodySmall.lineHeight,whiteSpace:"nowrap",marginBottom:e.spacing(.5),gap:e.spacing(1)}),errorIcon:(0,En.css)({color:e.colors.error.text}),normalIcon:(0,En.css)({color:e.colors.text.secondary})});function KO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function YO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){KO(e,t,n[t])}))}return e}function ZO(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function XO(e){const t=new eS({value:""}),n=new Cl({queries:[{refId:"A",datasource:l,scenarioId:"random_walk_table"}]}),r=new Ah({$data:n,transformations:[tS("")]});r.addActivationHandler((()=>{const e=t.subscribeToState((e=>{r.setState({transformations:[tS(e.value)]}),r.reprocessTransformations()}));return()=>e.unsubscribe()}));const a=py().setData(r).build(),i=new JO({vizPanelRef:new Y(a)});return new wb(ZO(YO({},e),{subTitle:"Demo showing a simple data filtering case",getScene:()=>new Vf(ZO(YO({},jy()),{key:"Flex layout embedded scene",body:new Ag({direction:"column",children:[new Ig({minWidth:"70%",body:a})]}),controls:[t,i]}))}))}class JO extends re{constructor(e){super(YO({isEnabled:!1},e)),KO(this,"onChange",(()=>{const e=!this.state.isEnabled;this.setState({isEnabled:e});const t=vy().setOption("footer",{enablePagination:e}).build();this.state.vizPanelRef.resolve().onOptionsChange(t)}))}}KO(JO,"Component",(function({model:e}){const{isEnabled:t}=e.useState();return r().createElement("div",{style:{display:"flex"}},r().createElement(GO,{label:"Enable pagination",htmlFor:"items-per-page-select"}),r().createElement(_n.InlineSwitch,{id:"items-per-page-select",value:t,onChange:e.onChange}))}));class eS extends re{constructor(...e){super(...e),KO(this,"onChange",(e=>{this.setState({value:e.currentTarget.value})}))}}function tS(t){const n={id:e.ValueMatcherID.regex,options:{value:t}};return{id:e.DataTransformerID.filterByValue,options:{type:"include",match:"all",filters:[{fieldName:"Info",config:n}]}}}function nS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){nS(e,t,n[t])}))}return e}function aS(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function iS(t){return new wb(aS(rS({},t),{subTitle:"Shows variables that depend on other variables defined on a higher level",$variables:new $h({variables:[new df({name:"server",query:"A.*",value:"server",text:"",delayMs:2e3,options:[]}),new df({name:"notUsed",query:"A.$A.*",value:"server",text:"",delayMs:5e3,options:[]})]}),controls:[new Ih({})],tabs:[new wb({title:"Overview",url:`${t.url}/overview`,getScene:()=>{return new Vf(aS(rS({},jy()),{$variables:new $h({variables:[new df({name:"pod",query:"A.$server.*",value:"pod",delayMs:2e3,isMulti:!0,text:"",options:[]})]}),body:new Ag({direction:"row",children:[new Ig({body:new Ag({direction:"column",children:[new Ig({body:new Ag({children:[new Ig({body:fy().setTitle("handler: $handler").setData(Ey({alias:"handler: $pod"})).build()})]})}),new Ig({body:(t="Inner scene1",new Gm({title:t,canRemove:!0,canCollapse:!0,$variables:new $h({variables:[new df({name:"handler",query:"A.$server.$pod.*",value:"pod",delayMs:2e3,isMulti:!0,text:"",options:[],refresh:e.VariableRefresh.onTimeRangeChanged})]}),body:new Ag({direction:"row",children:[new Ig({body:fy().setTitle("handler: $handler").setData(Ey({alias:"handler: $handler"})).build()})]}),$timeRange:new Xe,$data:Ey(),controls:[new Ih({}),new Zm({})]}))})]})})]}),$timeRange:new Xe}));var t}})]}))}function oS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){oS(e,t,n[t])}))}return e}function lS(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}KO(eS,"Component",(({model:e})=>{const{value:t}=e.useState();return r().createElement("div",{style:{display:"flex"}},r().createElement(GO,{label:"Search by Info",htmlFor:"search-box"}),r().createElement(_n.Input,{id:"search-box",width:25,placeholder:"i.e. ^up",value:t,onChange:e.onChange}))}));const uS=["repeat(auto-fit, minmax(400px, 1fr))","repeat(3, 1fr)","2fr 1fr 1fr","auto"],cS=["unset","auto","350px repeat(4, 150px)","repeat(4, 1fr)","100%"],dS=["150px","250px","auto"];function pS(e){return new wb(lS(sS({},e),{subTitle:"A CSS Grid Layout demo, isLazy is enabled to showcase lazy rendering of panels. Every 3rd panel is hidden to test the layout working properly.",getScene:()=>{const e=new Bg({children:hS(10),templateColumns:uS[0],templateRows:cS[0],autoRows:dS[0],rowGap:2,isLazy:!0}),t=new Ym({label:"Panel count",value:"10",onChange:t=>{e.setState({children:hS(t)})}}),n=new fS({label:"Column template",value:uS[0],options:uS,onChange:t=>e.setState({templateColumns:t})}),r=new fS({label:"Row template",value:cS[0],options:cS,onChange:t=>e.setState({templateRows:t})}),a=new fS({label:"Auto rows",value:dS[0],options:dS,onChange:t=>e.setState({autoRows:t})});return new Vf(lS(sS({},jy()),{controls:[t,n,r,a],body:e}))}}))}function hS(e){return Array.from(Array(e),((e,t)=>new Ng({body:dy().setTitle(`Panel ${t+1}`).setData(Ey({},{maxDataPoints:400})).build(),isHidden:t%3==0})))}class fS extends re{constructor(...e){super(...e),oS(this,"onChange",(e=>{this.setState({value:e.value}),this.state.onChange(e.value)}))}}function mS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){mS(e,t,n[t])}))}return e}function bS(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function yS(e){return new wb(bS(gS({},e),{subTitle:"Example of panels with actions and controls",getScene:()=>new Vf(bS(gS({},jy()),{key:"Flex layout embedded scene",body:new Bg({templateColumns:"repeat(auto-fit, minmax(400px, 1fr))",autoRows:"320px",children:[new Ng({body:fy().setTitle("Panel with sm button").setData(Ey()).setHeaderActions(r().createElement(_n.Button,{size:"sm",variant:"secondary"},"Does nothing")).build()}),new Ng({body:fy().setTitle("Panel with md button").setData(Ey()).setHeaderActions(r().createElement(_n.Button,{size:"md",variant:"secondary"},"Does nothing")).build()}),new Ng({body:fy().setTitle("Panel with select").setData(Ey()).setHeaderActions(r().createElement(_n.Select,{options:[{label:"Option 1",value:"1"}],onChange:()=>{},value:"1"})).build()}),new Ng({body:fy().setTitle("Panel with explore button").setData(Ey()).setHeaderActions(new Wf).build()})]})}))}))}oS(fS,"Component",(({model:e})=>{const{value:t,options:n,label:a}=e.useState(),i=n.map((e=>({label:e,value:e})));var o;const s=null!==(o=i.find((e=>e.value===t)))&&void 0!==o?o:n[0];return r().createElement("div",{style:{display:"flex"}},r().createElement(GO,{label:a}),r().createElement(_n.Select,{value:s,options:i,onChange:e.onChange}))}));var vS=(e=>(e[e.dontHide=0]="dontHide",e[e.hideLabel=1]="hideLabel",e[e.hideVariable=2]="hideVariable",e))(vS||{});function wS(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function OS(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){wS(i,r,a,o,s,"next",e)}function s(e){wS(i,r,a,o,s,"throw",e)}o(void 0)}))}}function SS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){SS(e,t,n[t])}))}return e}function xS(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function PS(t){return new wb(xS(_S({},t),{subTitle:"Test of variables and adhoc filters with vertical layout",getScene:()=>new Vf(xS(_S({},jy()),{controls:[new Ih({layout:"vertical"}),new Rg,new Zm({}),new dg({})],$variables:new $h({variables:[new df({name:"server",query:"A.*",value:"server",text:"",delayMs:1e3,options:[],refresh:e.VariableRefresh.onTimeRangeChanged,description:"Server name"}),new df({name:"pod",query:"A.$server.*",value:"pod",delayMs:1e3,isMulti:!0,text:"",options:[]}),new df({name:"handler",query:"A.$server.$pod.*",value:"pod",delayMs:1e3,isMulti:!0,text:"",options:[],refresh:e.VariableRefresh.onTimeRangeChanged}),new sl({name:"filters",hide:vS.hideLabel,layout:"vertical",applyMode:"manual",filters:[{key:"job",operator:"=",value:"grafana",condition:""}],getTagKeysProvider:function(){var e=OS((function*(e,t){return yield new Promise((e=>setTimeout(e,200))),{replace:!0,values:[{text:"job"},{text:"instance"}]}}));return function(t,n){return e.apply(this,arguments)}}(),getTagValuesProvider:function(){var e=OS((function*(e,t){return yield new Promise((e=>setTimeout(e,400))),{replace:!0,values:["A","B","C","D","E","F","grafana"].map((e=>({text:e})))}}));return function(t,n){return e.apply(this,arguments)}}()})]}),body:new Ag({direction:"column",children:[new Ag({children:[new Ig({body:fy().setTitle("handler: $handler").setData(Ey({alias:"handler: $handler"})).build()}),new Ig({body:hy().setTitle("Interpolation").setOption("content","\n* server: $server\n* pod: $pod\n* handler: $handler\n\n          ").build()})]})]})}))}))}function CS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ES(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){CS(e,t,n[t])}))}return e}function jS(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function DS(e){return new wb(jS(ES({},e),{subTitle:"Interactive table",getScene:()=>new Vf(jS(ES({},jy()),{$data:Ey(),body:new Ag({children:[new Ig({body:new kS({$data:ky({expr:"sort_desc(avg without(job, instance) (rate(grafana_http_request_duration_seconds_sum[$__rate_interval]) * 1e3))"})})})]})}))}))}class kS extends re{}function TS({tableViz:e,row:n}){var a;const{expandedRows:i}=e.useState(),o=null===(a=i)||void 0===a?void 0:a.find((e=>e.state.key===n.handler));return(0,t.useEffect)((()=>{if(!o){const a=(r=n.handler,new Ag({key:r,height:300,children:[new Ig({body:fy().setTitle("Requests / s").setCustomFieldConfig("fillOpacity",6).setData(Ty({expr:`sum without(job, instance) (rate(grafana_http_request_duration_seconds_count{handler="${r}"}[$__rate_interval]))`,legendFormat:"{{method}} (status = {{status_code}})"})).build()})]}));var t;e.setState({expandedRows:[...null!==(t=e.state.expandedRows)&&void 0!==t?t:[],a]})}var r}),[n,e,o]),o?r().createElement(o.Component,{model:o}):null}function RS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AS(e){return new wb((t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){RS(e,t,n[t])}))}return e}({},e),n=null!=(n={subTitle:"Test of repeating layout by variable",$timeRange:new Xe,getScene:()=>new Vf({controls:[new Ih({})],$variables:new $h({variables:[new df({name:"server",query:"A.*",value:"server",text:"",description:"Server name",delayMs:1e3,includeAll:!0,defaultToAll:!0,isMulti:!0,options:[]})]}),body:new Tg({variableName:"server",body:new Ag({direction:"column",children:[]}),getLayoutChild:e=>function(e){return new Ag({minHeight:200,children:[new Ig({body:fy().setTitle(`server: ${e.value}`).setData(Ey({alias:`server: ${e.value}`})).build()}),new Ig({body:dy().setTitle("Max").setData(Ey({})).build()})]})}(e)})})})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t));var t,n}function IS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function MS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){IS(e,t,n[t])}))}return e}function VS(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function FS(e){const t=new nh({name:"Global annotations",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"yellow",name:"New annotation",target:{lines:10,refId:"Anno",scenarioId:"slow_query",stringInput:"10s"}}});return new wb(VS(MS({},e),{subTitle:"Shows how to see query state of a sub scene and cancel all sub scene queries",getScene:()=>new Vf(VS(MS({},jy()),{$data:new _h({layers:[t]}),$behaviors:[new Ut],$variables:new $h({variables:[new df({name:"server",query:"A.*",value:"server",delayMs:1e3,options:[],refresh:Xu.onTimeRangeChanged}),new df({name:"pod",query:"A.$server.*",value:"pod",delayMs:3e3,options:[],refresh:Xu.onDashboardLoad})]}),controls:[new Ih({}),new xd,new Rg,new Zm({}),new dg({withText:!0,primary:!0})],body:new Ag({direction:"column",children:[new Ig({height:"320px",body:new Bg({autoRows:"320px",children:[fy().setTitle("2s query").setData(Ey({scenarioId:"slow_query",stringInput:"2s"})).build(),fy().setTitle("3s query").setData(Ey({scenarioId:"slow_query",stringInput:"3s"})).build(),fy().setTitle("5s query").setData(Ey({scenarioId:"slow_query",stringInput:"5s"})).build()]})}),new Ig({body:LS("Inner scene1")})]})}))}))}function LS(e){const t=new nh({name:"Nested annotations",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"red",name:"New annotation",target:{lines:10,refId:"Anno",scenarioId:"slow_query",stringInput:"10s"}}});return new Gm({title:e,canCollapse:!0,body:new Bg({children:[fy().setTitle("2s query").setData(Ey({scenarioId:"slow_query",stringInput:"2s"})).build(),fy().setTitle("3s query").setData(Ey({scenarioId:"slow_query",stringInput:"3s"})).build(),fy().setTitle("5s query").setData(Ey({scenarioId:"slow_query",stringInput:"5s"})).build()]}),$timeRange:new Xe,$data:new _h({layers:[t]}),$behaviors:[new Ut],controls:[new xd,new Rg,new Zm({}),new dg({withText:!0})]})}function $S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){$S(e,t,n[t])}))}return e}function BS(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function NS(e){return new wb(BS(zS({},e),{subTitle:"A demo of data layers added and removed dynamically",getScene:()=>new Vf(BS(zS({},jy()),{controls:[new xd,new qS({}),new Rg,new Zm({}),new dg({})],key:"Multiple annotations layers",$data:new _h({layers:[]}),body:new Ag({direction:"column",children:[new Ag({direction:"row",children:[new Ig({$data:Ey({}),body:new fd({title:"Global annotations only",pluginId:"timeseries"})})]})]})}))}))}CS(kS,"Component",(({model:n})=>{const{data:a}=Hu.getData(n).useState(),i=(0,t.useMemo)((()=>[{id:"handler",header:"Handler"},{id:"method",header:"Method"},{id:"status_code",header:"Status code"},{id:"Value",header:"Value"}]),[]),o=(0,t.useMemo)((()=>{if(!a||0===a.series.length)return[];const t=a.series[0];return new e.DataFrameView(t).toArray()}),[a]);return r().createElement(_n.InteractiveTable,{columns:i,getRowId:e=>e.handler,data:o,renderExpandedRow:e=>r().createElement(TS,{tableViz:n,row:e})})}));class qS extends re{constructor(...e){super(...e),$S(this,"onAdd",(()=>{const e=Hu.getAncestor(this,Vf).state.$data,t=e.state.layers.length+1,n=new nh({name:"Annotation query "+t,query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:d.config.theme2.visualization.palette[t],name:"New annotation",target:{lines:15*Math.random(),refId:"Anno",scenarioId:"annotations"}}});e.setState({layers:[...e.state.layers,n]})})),$S(this,"onRemove",(()=>{const e=Hu.getAncestor(this,Vf).state.$data;e.setState({layers:e.state.layers.slice(0,-1)})}))}}function HS(e,t,...n){let r=!1;"undefined"!=typeof window&&(r="true"===localStorage.getItem("grafana.debug.scenes")),r&&console.log(`${e}: `,t,...n)}$S(qS,"Component",(({model:e})=>r().createElement(r().Fragment,null,r().createElement(_n.Button,{onClick:e.onAdd,variant:"secondary"},"Add annotation layer"),r().createElement(_n.Button,{onClick:e.onRemove,variant:"secondary"},"Remove annotation layer"))));var WS=Object.defineProperty,US=Object.defineProperties,GS=Object.getOwnPropertyDescriptors,QS=Object.getOwnPropertySymbols,KS=Object.prototype.hasOwnProperty,YS=Object.prototype.propertyIsEnumerable,ZS=(e,t,n)=>t in e?WS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class XS extends re{addToScene(e){this.publishEvent(new Tf(e),!0),this.setState({children:[...this.state.children,e]}),HS("SceneContext",`Adding to scene: ${e.constructor.name} key: ${e.state.key}`);const t=e.activate();return()=>{HS("SceneContext",`Removing from scene: ${e.constructor.name} key: ${e.state.key}`),this.setState({children:this.state.children.filter((t=>t!==e))}),t()}}findByKey(e){return this.state.children.find((t=>t.state.key===e))}findVariable(e){const t=this.state.$variables;if(t)return t.getByName(e)}addVariable(e){let t=this.state.$variables;return this.publishEvent(new Tf(e),!0),t?t.setState({variables:[...t.state.variables,e]}):(t=new $h({variables:[e]}),this.setState({$variables:t})),HS("SceneContext",`Adding variable: ${e.constructor.name} key: ${e.state.key}`),()=>{t.setState({variables:t.state.variables.filter((t=>t!==e))}),HS("SceneContext",`Removing variable: ${e.constructor.name} key: ${e.state.key}`)}}addChildContext(e){var t;this.publishEvent(new Tf(e),!0),this.setState({childContexts:[...null!=(t=this.state.childContexts)?t:[],e]}),HS("SceneContext",`Adding child context: ${e.constructor.name} key: ${e.state.key}`)}removeChildContext(e){var t;this.setState({childContexts:null==(t=this.state.childContexts)?void 0:t.filter((t=>e!==t))}),HS("SceneContext",`Remvoing child context: ${e.constructor.name} key: ${e.state.key}`)}constructor(e){var t,n,r,a;super((r=((e,t)=>{for(var n in t||(t={}))KS.call(t,n)&&ZS(e,n,t[n]);if(QS)for(var n of QS(t))YS.call(t,n)&&ZS(e,n,t[n]);return e})({},e),a={children:null!=(t=null==e?void 0:e.children)?t:[],childContexts:null!=(n=null==e?void 0:e.childContexts)?n:[]},US(r,GS(a))))}}const JS=(0,t.createContext)(null);function e_({children:e,timeRange:n,withQueryController:a}){const i=(0,t.useContext)(JS),[o,s]=(0,t.useState)(),l=n;if((0,t.useEffect)((()=>{const e={children:[]};a&&(e.$behaviors=[new Ut]),l&&(e.$timeRange=new Xe(l));const t=new XS(e);i&&i.addChildContext(t);const n=t.activate();return s(t),()=>{n(),i&&i.removeChildContext(t)}}),[i,a]),!o)return null;const u=r().createElement(JS.Provider,{value:o},e);return i?u:r().createElement(Mf,{scene:o,updateUrlOnInit:!0,createBrowserHistorySteps:!0},u)}function t_(){const e=(0,t.useContext)(JS);if(!e)throw new Error("Cannot find a SceneContext");return e}function n_(){const e=t_(),t=Hu.getTimeRange(e),{value:n}=t.useState();return[n,t]}function r_(e){const n=t_();return function({timeRange:e,variables:n=[]}){const r=t_(),[a,i]=(0,t.useState)();(0,t.useEffect)((()=>{const t=new D.Subscription;if(n&&n.length>0)for(const e of n){const n=Hu.lookupVariable(e,r);n&&t.add(n.subscribeToEvent(rt,(()=>{i({variableName:n.state.name,variableValue:n.getValue()})})))}return e&&Hu.getTimeRange(r).subscribeToState(((e,t)=>{e.value!==t.value&&i({timeRange:e.value})})),()=>t.unsubscribe()}),[r,e,...n])}(e),(0,t.useCallback)((e=>Hu.interpolate(n,e)),[n])}const a_="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,i_=new Set,o_="object"==typeof process&&process?process:{},s_=(e,t,n,r)=>{"function"==typeof o_.emitWarning?o_.emitWarning(e,t,n,r):console.error(`[${n}] ${t}: ${e}`)};let l_=globalThis.AbortController,u_=globalThis.AbortSignal;if(void 0===l_){u_=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(e,t){this._onabort.push(t)}},l_=class{constructor(){t()}signal=new u_;abort(e){if(!this.signal.aborted){this.signal.reason=e,this.signal.aborted=!0;for(const t of this.signal._onabort)t(e);this.signal.onabort?.(e)}}};let e="1"!==o_.env?.LRU_CACHE_IGNORE_AC_WARNING;const t=()=>{e&&(e=!1,s_("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",t))}}Symbol("type");const c_=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),d_=e=>c_(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?p_:null:null;class p_ extends Array{constructor(e){super(e),this.fill(0)}}class h_{heap;length;static#e=!1;static create(e){const t=d_(e);if(!t)return[];h_.#e=!0;const n=new h_(e,t);return h_.#e=!1,n}constructor(e,t){if(!h_.#e)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class f_{#t;#n;#r;#a;#i;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#o;#s;#l;#u;#c;#d;#p;#h;#f;#m;#g;#b;#y;#v;#w;#O;#S;static unsafeExposeInternals(e){return{starts:e.#y,ttls:e.#v,sizes:e.#b,keyMap:e.#l,keyList:e.#u,valList:e.#c,next:e.#d,prev:e.#p,get head(){return e.#h},get tail(){return e.#f},free:e.#m,isBackgroundFetch:t=>e.#_(t),backgroundFetch:(t,n,r,a)=>e.#x(t,n,r,a),moveToTail:t=>e.#P(t),indexes:t=>e.#C(t),rindexes:t=>e.#E(t),isStale:t=>e.#j(t)}}get max(){return this.#t}get maxSize(){return this.#n}get calculatedSize(){return this.#s}get size(){return this.#o}get fetchMethod(){return this.#i}get dispose(){return this.#r}get disposeAfter(){return this.#a}constructor(e){const{max:t=0,ttl:n,ttlResolution:r=1,ttlAutopurge:a,updateAgeOnGet:i,updateAgeOnHas:o,allowStale:s,dispose:l,disposeAfter:u,noDisposeOnSet:c,noUpdateTTL:d,maxSize:p=0,maxEntrySize:h=0,sizeCalculation:f,fetchMethod:m,noDeleteOnFetchRejection:g,noDeleteOnStaleGet:b,allowStaleOnFetchRejection:y,allowStaleOnFetchAbort:v,ignoreFetchAbort:w}=e;if(0!==t&&!c_(t))throw new TypeError("max option must be a nonnegative integer");const O=t?d_(t):Array;if(!O)throw new Error("invalid max value: "+t);if(this.#t=t,this.#n=p,this.maxEntrySize=h||this.#n,this.sizeCalculation=f,this.sizeCalculation){if(!this.#n&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(void 0!==m&&"function"!=typeof m)throw new TypeError("fetchMethod must be a function if specified");if(this.#i=m,this.#O=!!m,this.#l=new Map,this.#u=new Array(t).fill(void 0),this.#c=new Array(t).fill(void 0),this.#d=new O(t),this.#p=new O(t),this.#h=0,this.#f=0,this.#m=h_.create(t),this.#o=0,this.#s=0,"function"==typeof l&&(this.#r=l),"function"==typeof u?(this.#a=u,this.#g=[]):(this.#a=void 0,this.#g=void 0),this.#w=!!this.#r,this.#S=!!this.#a,this.noDisposeOnSet=!!c,this.noUpdateTTL=!!d,this.noDeleteOnFetchRejection=!!g,this.allowStaleOnFetchRejection=!!y,this.allowStaleOnFetchAbort=!!v,this.ignoreFetchAbort=!!w,0!==this.maxEntrySize){if(0!==this.#n&&!c_(this.#n))throw new TypeError("maxSize must be a positive integer if specified");if(!c_(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#D()}if(this.allowStale=!!s,this.noDeleteOnStaleGet=!!b,this.updateAgeOnGet=!!i,this.updateAgeOnHas=!!o,this.ttlResolution=c_(r)||0===r?r:1,this.ttlAutopurge=!!a,this.ttl=n||0,this.ttl){if(!c_(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#k()}if(0===this.#t&&0===this.ttl&&0===this.#n)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#t&&!this.#n){const e="LRU_CACHE_UNBOUNDED";(e=>!i_.has(e))(e)&&(i_.add(e),s_("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",e,f_))}}getRemainingTTL(e){return this.#l.has(e)?1/0:0}#k(){const e=new p_(this.#t),t=new p_(this.#t);this.#v=e,this.#y=t,this.#T=(n,r,a=a_.now())=>{if(t[n]=0!==r?a:0,e[n]=r,0!==r&&this.ttlAutopurge){const e=setTimeout((()=>{this.#j(n)&&this.delete(this.#u[n])}),r+1);e.unref&&e.unref()}},this.#R=n=>{t[n]=0!==e[n]?a_.now():0},this.#A=(a,i)=>{if(e[i]){const o=e[i],s=t[i];if(!o||!s)return;a.ttl=o,a.start=s,a.now=n||r();const l=a.now-s;a.remainingTTL=o-l}};let n=0;const r=()=>{const e=a_.now();if(this.ttlResolution>0){n=e;const t=setTimeout((()=>n=0),this.ttlResolution);t.unref&&t.unref()}return e};this.getRemainingTTL=a=>{const i=this.#l.get(a);if(void 0===i)return 0;const o=e[i],s=t[i];return o&&s?o-((n||r())-s):1/0},this.#j=a=>{const i=t[a],o=e[a];return!!o&&!!i&&(n||r())-i>o}}#R=()=>{};#A=()=>{};#T=()=>{};#j=()=>!1;#D(){const e=new p_(this.#t);this.#s=0,this.#b=e,this.#I=t=>{this.#s-=e[t],e[t]=0},this.#M=(e,t,n,r)=>{if(this.#_(t))return 0;if(!c_(n)){if(!r)throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");if("function"!=typeof r)throw new TypeError("sizeCalculation must be a function");if(n=r(t,e),!c_(n))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return n},this.#V=(t,n,r)=>{if(e[t]=n,this.#n){const n=this.#n-e[t];for(;this.#s>n;)this.#F(!0)}this.#s+=e[t],r&&(r.entrySize=n,r.totalCalculatedSize=this.#s)}}#I=e=>{};#V=(e,t,n)=>{};#M=(e,t,n,r)=>{if(n||r)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#C({allowStale:e=this.allowStale}={}){if(this.#o)for(let t=this.#f;this.#L(t)&&(!e&&this.#j(t)||(yield t),t!==this.#h);)t=this.#p[t]}*#E({allowStale:e=this.allowStale}={}){if(this.#o)for(let t=this.#h;this.#L(t)&&(!e&&this.#j(t)||(yield t),t!==this.#f);)t=this.#d[t]}#L(e){return void 0!==e&&this.#l.get(this.#u[e])===e}*entries(){for(const e of this.#C())void 0===this.#c[e]||void 0===this.#u[e]||this.#_(this.#c[e])||(yield[this.#u[e],this.#c[e]])}*rentries(){for(const e of this.#E())void 0===this.#c[e]||void 0===this.#u[e]||this.#_(this.#c[e])||(yield[this.#u[e],this.#c[e]])}*keys(){for(const e of this.#C()){const t=this.#u[e];void 0===t||this.#_(this.#c[e])||(yield t)}}*rkeys(){for(const e of this.#E()){const t=this.#u[e];void 0===t||this.#_(this.#c[e])||(yield t)}}*values(){for(const e of this.#C())void 0===this.#c[e]||this.#_(this.#c[e])||(yield this.#c[e])}*rvalues(){for(const e of this.#E())void 0===this.#c[e]||this.#_(this.#c[e])||(yield this.#c[e])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(e,t={}){for(const n of this.#C()){const r=this.#c[n],a=this.#_(r)?r.__staleWhileFetching:r;if(void 0!==a&&e(a,this.#u[n],this))return this.get(this.#u[n],t)}}forEach(e,t=this){for(const n of this.#C()){const r=this.#c[n],a=this.#_(r)?r.__staleWhileFetching:r;void 0!==a&&e.call(t,a,this.#u[n],this)}}rforEach(e,t=this){for(const n of this.#E()){const r=this.#c[n],a=this.#_(r)?r.__staleWhileFetching:r;void 0!==a&&e.call(t,a,this.#u[n],this)}}purgeStale(){let e=!1;for(const t of this.#E({allowStale:!0}))this.#j(t)&&(this.delete(this.#u[t]),e=!0);return e}info(e){const t=this.#l.get(e);if(void 0===t)return;const n=this.#c[t],r=this.#_(n)?n.__staleWhileFetching:n;if(void 0===r)return;const a={value:r};if(this.#v&&this.#y){const e=this.#v[t],n=this.#y[t];if(e&&n){const t=e-(a_.now()-n);a.ttl=t,a.start=Date.now()}}return this.#b&&(a.size=this.#b[t]),a}dump(){const e=[];for(const t of this.#C({allowStale:!0})){const n=this.#u[t],r=this.#c[t],a=this.#_(r)?r.__staleWhileFetching:r;if(void 0===a||void 0===n)continue;const i={value:a};if(this.#v&&this.#y){i.ttl=this.#v[t];const e=a_.now()-this.#y[t];i.start=Math.floor(Date.now()-e)}this.#b&&(i.size=this.#b[t]),e.unshift([n,i])}return e}load(e){this.clear();for(const[t,n]of e){if(n.start){const e=Date.now()-n.start;n.start=a_.now()-e}this.set(t,n.value,n)}}set(e,t,n={}){if(void 0===t)return this.delete(e),this;const{ttl:r=this.ttl,start:a,noDisposeOnSet:i=this.noDisposeOnSet,sizeCalculation:o=this.sizeCalculation,status:s}=n;let{noUpdateTTL:l=this.noUpdateTTL}=n;const u=this.#M(e,t,n.size||0,o);if(this.maxEntrySize&&u>this.maxEntrySize)return s&&(s.set="miss",s.maxEntrySizeExceeded=!0),this.delete(e),this;let c=0===this.#o?void 0:this.#l.get(e);if(void 0===c)c=0===this.#o?this.#f:0!==this.#m.length?this.#m.pop():this.#o===this.#t?this.#F(!1):this.#o,this.#u[c]=e,this.#c[c]=t,this.#l.set(e,c),this.#d[this.#f]=c,this.#p[c]=this.#f,this.#f=c,this.#o++,this.#V(c,u,s),s&&(s.set="add"),l=!1;else{this.#P(c);const n=this.#c[c];if(t!==n){if(this.#O&&this.#_(n)){n.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:t}=n;void 0===t||i||(this.#w&&this.#r?.(t,e,"set"),this.#S&&this.#g?.push([t,e,"set"]))}else i||(this.#w&&this.#r?.(n,e,"set"),this.#S&&this.#g?.push([n,e,"set"]));if(this.#I(c),this.#V(c,u,s),this.#c[c]=t,s){s.set="replace";const e=n&&this.#_(n)?n.__staleWhileFetching:n;void 0!==e&&(s.oldValue=e)}}else s&&(s.set="update")}if(0===r||this.#v||this.#k(),this.#v&&(l||this.#T(c,r,a),s&&this.#A(s,c)),!i&&this.#S&&this.#g){const e=this.#g;let t;for(;t=e?.shift();)this.#a?.(...t)}return this}pop(){try{for(;this.#o;){const e=this.#c[this.#h];if(this.#F(!0),this.#_(e)){if(e.__staleWhileFetching)return e.__staleWhileFetching}else if(void 0!==e)return e}}finally{if(this.#S&&this.#g){const e=this.#g;let t;for(;t=e?.shift();)this.#a?.(...t)}}}#F(e){const t=this.#h,n=this.#u[t],r=this.#c[t];return this.#O&&this.#_(r)?r.__abortController.abort(new Error("evicted")):(this.#w||this.#S)&&(this.#w&&this.#r?.(r,n,"evict"),this.#S&&this.#g?.push([r,n,"evict"])),this.#I(t),e&&(this.#u[t]=void 0,this.#c[t]=void 0,this.#m.push(t)),1===this.#o?(this.#h=this.#f=0,this.#m.length=0):this.#h=this.#d[t],this.#l.delete(n),this.#o--,t}has(e,t={}){const{updateAgeOnHas:n=this.updateAgeOnHas,status:r}=t,a=this.#l.get(e);if(void 0!==a){const e=this.#c[a];if(this.#_(e)&&void 0===e.__staleWhileFetching)return!1;if(!this.#j(a))return n&&this.#R(a),r&&(r.has="hit",this.#A(r,a)),!0;r&&(r.has="stale",this.#A(r,a))}else r&&(r.has="miss");return!1}peek(e,t={}){const{allowStale:n=this.allowStale}=t,r=this.#l.get(e);if(void 0===r||!n&&this.#j(r))return;const a=this.#c[r];return this.#_(a)?a.__staleWhileFetching:a}#x(e,t,n,r){const a=void 0===t?void 0:this.#c[t];if(this.#_(a))return a;const i=new l_,{signal:o}=n;o?.addEventListener("abort",(()=>i.abort(o.reason)),{signal:i.signal});const s={signal:i.signal,options:n,context:r},l=(r,a=!1)=>{const{aborted:o}=i.signal,l=n.ignoreFetchAbort&&void 0!==r;if(n.status&&(o&&!a?(n.status.fetchAborted=!0,n.status.fetchError=i.signal.reason,l&&(n.status.fetchAbortIgnored=!0)):n.status.fetchResolved=!0),o&&!l&&!a)return u(i.signal.reason);const d=c;return this.#c[t]===c&&(void 0===r?d.__staleWhileFetching?this.#c[t]=d.__staleWhileFetching:this.delete(e):(n.status&&(n.status.fetchUpdated=!0),this.set(e,r,s.options))),r},u=r=>{const{aborted:a}=i.signal,o=a&&n.allowStaleOnFetchAbort,s=o||n.allowStaleOnFetchRejection,l=s||n.noDeleteOnFetchRejection,u=c;if(this.#c[t]===c&&(l&&void 0!==u.__staleWhileFetching?o||(this.#c[t]=u.__staleWhileFetching):this.delete(e)),s)return n.status&&void 0!==u.__staleWhileFetching&&(n.status.returnedStale=!0),u.__staleWhileFetching;if(u.__returned===u)throw r};n.status&&(n.status.fetchDispatched=!0);const c=new Promise(((t,r)=>{const o=this.#i?.(e,a,s);o&&o instanceof Promise&&o.then((e=>t(void 0===e?void 0:e)),r),i.signal.addEventListener("abort",(()=>{n.ignoreFetchAbort&&!n.allowStaleOnFetchAbort||(t(void 0),n.allowStaleOnFetchAbort&&(t=e=>l(e,!0)))}))})).then(l,(e=>(n.status&&(n.status.fetchRejected=!0,n.status.fetchError=e),u(e)))),d=Object.assign(c,{__abortController:i,__staleWhileFetching:a,__returned:void 0});return void 0===t?(this.set(e,d,{...s.options,status:void 0}),t=this.#l.get(e)):this.#c[t]=d,d}#_(e){if(!this.#O)return!1;const t=e;return!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof l_}async fetch(e,t={}){const{allowStale:n=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:a=this.noDeleteOnStaleGet,ttl:i=this.ttl,noDisposeOnSet:o=this.noDisposeOnSet,size:s=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,noDeleteOnFetchRejection:c=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:d=this.allowStaleOnFetchRejection,ignoreFetchAbort:p=this.ignoreFetchAbort,allowStaleOnFetchAbort:h=this.allowStaleOnFetchAbort,context:f,forceRefresh:m=!1,status:g,signal:b}=t;if(!this.#O)return g&&(g.fetch="get"),this.get(e,{allowStale:n,updateAgeOnGet:r,noDeleteOnStaleGet:a,status:g});const y={allowStale:n,updateAgeOnGet:r,noDeleteOnStaleGet:a,ttl:i,noDisposeOnSet:o,size:s,sizeCalculation:l,noUpdateTTL:u,noDeleteOnFetchRejection:c,allowStaleOnFetchRejection:d,allowStaleOnFetchAbort:h,ignoreFetchAbort:p,status:g,signal:b};let v=this.#l.get(e);if(void 0===v){g&&(g.fetch="miss");const t=this.#x(e,v,y,f);return t.__returned=t}{const t=this.#c[v];if(this.#_(t)){const e=n&&void 0!==t.__staleWhileFetching;return g&&(g.fetch="inflight",e&&(g.returnedStale=!0)),e?t.__staleWhileFetching:t.__returned=t}const a=this.#j(v);if(!m&&!a)return g&&(g.fetch="hit"),this.#P(v),r&&this.#R(v),g&&this.#A(g,v),t;const i=this.#x(e,v,y,f),o=void 0!==i.__staleWhileFetching&&n;return g&&(g.fetch=a?"stale":"refresh",o&&a&&(g.returnedStale=!0)),o?i.__staleWhileFetching:i.__returned=i}}get(e,t={}){const{allowStale:n=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:a=this.noDeleteOnStaleGet,status:i}=t,o=this.#l.get(e);if(void 0!==o){const t=this.#c[o],s=this.#_(t);return i&&this.#A(i,o),this.#j(o)?(i&&(i.get="stale"),s?(i&&n&&void 0!==t.__staleWhileFetching&&(i.returnedStale=!0),n?t.__staleWhileFetching:void 0):(a||this.delete(e),i&&n&&(i.returnedStale=!0),n?t:void 0)):(i&&(i.get="hit"),s?t.__staleWhileFetching:(this.#P(o),r&&this.#R(o),t))}i&&(i.get="miss")}#$(e,t){this.#p[t]=e,this.#d[e]=t}#P(e){e!==this.#f&&(e===this.#h?this.#h=this.#d[e]:this.#$(this.#p[e],this.#d[e]),this.#$(this.#f,e),this.#f=e)}delete(e){let t=!1;if(0!==this.#o){const n=this.#l.get(e);if(void 0!==n)if(t=!0,1===this.#o)this.clear();else{this.#I(n);const t=this.#c[n];if(this.#_(t)?t.__abortController.abort(new Error("deleted")):(this.#w||this.#S)&&(this.#w&&this.#r?.(t,e,"delete"),this.#S&&this.#g?.push([t,e,"delete"])),this.#l.delete(e),this.#u[n]=void 0,this.#c[n]=void 0,n===this.#f)this.#f=this.#p[n];else if(n===this.#h)this.#h=this.#d[n];else{const e=this.#p[n];this.#d[e]=this.#d[n];const t=this.#d[n];this.#p[t]=this.#p[n]}this.#o--,this.#m.push(n)}}if(this.#S&&this.#g?.length){const e=this.#g;let t;for(;t=e?.shift();)this.#a?.(...t)}return t}clear(){for(const e of this.#E({allowStale:!0})){const t=this.#c[e];if(this.#_(t))t.__abortController.abort(new Error("deleted"));else{const n=this.#u[e];this.#w&&this.#r?.(t,n,"delete"),this.#S&&this.#g?.push([t,n,"delete"])}}if(this.#l.clear(),this.#c.fill(void 0),this.#u.fill(void 0),this.#v&&this.#y&&(this.#v.fill(0),this.#y.fill(0)),this.#b&&this.#b.fill(0),this.#h=0,this.#f=0,this.#m.length=0,this.#s=0,this.#o=0,this.#S&&this.#g){const e=this.#g;let t;for(;t=e?.shift();)this.#a?.(...t)}}}var m_,g_,b_,y_=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},v_=(e,t,n)=>(y_(e,t,"read from private field"),n?n.call(e):t.get(e)),w_=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},O_=(e,t,n,r)=>(y_(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);class S_{add(e,t){v_(this,m_).set(e,t)}get(e){return v_(this,m_).get(e)}getHashKey(e,t){return Array.isArray(e)?`${t.name}-${e.map((e=>this.getHashKeyElement(e))).join()}`:`${t.name}-${this.getHashKeyElement(e)}`}getByRefHashKey(e){let t=v_(this,g_).get(e);return null==t&&(t=((e,t)=>({set _(n){O_(e,t,n,undefined)},get _(){return v_(e,t,undefined)}}))(this,b_)._++,v_(this,g_).set(e,t)),t}getHashKeyElement(e){return"string"==typeof e||"boolean"==typeof e||"number"==typeof e?e:function(e){return JSON.stringify(e,((e,t)=>(0,ge.isPlainObject)(t)?Object.keys(t).sort().reduce(((e,n)=>(e[n]=t[n],e)),{}):t))}(e)}constructor(){w_(this,m_,void 0),w_(this,g_,new WeakMap),w_(this,b_,0),O_(this,m_,new f_({max:500,ttl:3e5}))}}let __;function x_(){return __||(__=new S_)}function P_(e){const n=function(e){const n=t_(),r=(0,t.useId)(),a=x_();let i=e.cacheKey?a.getHashKey(e.cacheKey,e.objectConstructor):void 0,o=n.findByKey(r);return!o&&i&&(o=a.get(i),o&&o.parent!==n&&(Hu.findObject(n,(e=>e===o))?(console.error("A scene object cache key matched an object that is already in the scene"),o=void 0,i=void 0):o.clearParent())),o||(o=e.factory(r),i&&a.add(i,o)),(0,t.useEffect)((()=>n.addToScene(o)),[o,n]),o}({factory:t=>new Cl({key:t,queries:e.queries,maxDataPoints:e.maxDataPoints,datasource:e.datasource,liveStreaming:e.liveStreaming,maxDataPointsFromWidth:e.maxDataPointsFromWidth}),objectConstructor:Cl,cacheKey:e.cacheKey});return(0,t.useEffect)((()=>{(0,ge.isEqual)(n.state.queries,e.queries)||(n.setState({queries:e.queries}),n.runQueries())}),[n,e]),n}function C_(e){const[t,n]=n_();return r().createElement(_n.TimeRangePicker,{isOnCanvas:!0,value:t,onChange:n.onTimeRangeChange,timeZone:n.getTimeZone(),onMoveBackward:()=>{},onMoveForward:()=>{},onZoom:()=>{},onChangeTimeZone:()=>{},onChangeFiscalYearStartMonth:()=>{}})}function E_({name:e,hideLabel:t,layout:n}){const a=t_(),i=Hu.lookupVariable(e,a);return i?r().createElement(Mh,{key:i.state.key,variable:i,hideLabel:t,layout:n}):r().createElement("div",null,"Variable ",e," not found")}function j_(e){var n=(0,t.useRef)();return(0,t.useEffect)((function(){n.current=e})),n.current}function D_(n){const{title:a,description:i,viz:o,dataProvider:s,displayMode:l,hoverHeader:u,hoverHeaderOffset:c,headerActions:d,menu:p,titleItems:h,extendPanelContext:f,seriesLimit:m,seriesLimitShowAll:g,collapsible:b,collapsed:y}=n,v=t_(),w=(0,t.useId)(),O=j_(n);let S=v.findByKey(w);return S||(S=new fd({key:w,pluginId:o.pluginId,title:a,titleItems:h,description:i,options:o.options,fieldConfig:o.fieldConfig,pluginVersion:o.pluginVersion,$data:k_(s),displayMode:l,hoverHeader:u,hoverHeaderOffset:c,headerActions:d,menu:p,extendPanelContext:f,collapsible:b,collapsed:y,seriesLimit:m,seriesLimitShowAll:g})),(0,t.useEffect)((()=>v.addToScene(S)),[S,v]),(0,t.useEffect)((()=>{const t={};if(O){if(a!==O.title&&(t.title=a),i!==O.description&&(t.description=i),l!==O.displayMode&&(t.displayMode=l),u!==O.hoverHeader&&(t.hoverHeader=u),c!==O.hoverHeaderOffset&&(t.hoverHeaderOffset=c),p!==O.menu&&(t.menu=p),h!==O.titleItems&&(t.titleItems=h),d!==O.headerActions&&(t.headerActions=d),s!==O.dataProvider&&(t.$data=k_(s)),m!==O.seriesLimit&&(t.seriesLimit=m),g!==O.seriesLimitShowAll&&(t.seriesLimitShowAll=g),b!==O.collapsible&&(t.collapsible=b),y!==O.collapsed&&(t.collapsed=y),o!==O.viz&&o.pluginId===O.viz.pluginId){const n=S.getPlugin();if(n){const r=(0,e.getPanelOptionsWithDefaults)({plugin:n,currentOptions:o.options,currentFieldConfig:o.fieldConfig,isAfterPluginChange:!1});t.options=r.options,t.fieldConfig=r.fieldConfig,S.clearFieldConfigCache()}}Object.keys(t).length>0&&(S.setState(t),HS("VizPanel","Updating VizPanel state",t))}}),[S,a,i,l,u,c,d,p,h,o,s,m,g,b,y,O]),r().createElement(S.Component,{model:S})}function k_(e){return!e||e instanceof $e?e:new fh({source:e.getRef()})}m_=new WeakMap,g_=new WeakMap,b_=new WeakMap;var T_=Object.defineProperty,R_=Object.getOwnPropertySymbols,A_=Object.prototype.hasOwnProperty,I_=Object.prototype.propertyIsEnumerable,M_=(e,t,n)=>t in e?T_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function V_(e){const n=t_(),a=(0,t.useId)(),i=j_(e);let o=n.findByKey(a);return o||(o=new dg(((e,t)=>{for(var n in t||(t={}))A_.call(t,n)&&M_(e,n,t[n]);if(R_)for(var n of R_(t))I_.call(t,n)&&M_(e,n,t[n]);return e})({key:a},e))),(0,t.useEffect)((()=>n.addToScene(o)),[o,n]),(0,t.useEffect)((()=>{const t={};i&&(e.refresh!==i.refresh&&(t.refresh=e.refresh),e.withText!==i.withText&&(t.withText=e.withText),o.setState(t))}),[o,e,i]),r().createElement(o.Component,{model:o})}function F_({name:e}){const t=t_(),n=function(e,t){for(let n=0;n<e.length;n++){const r=e[n].state.layers.find((e=>e.state.name===t));if(r)return r}}(Hu.getDataLayers(t),e);return n?r().createElement(n.Component,{model:n}):r().createElement("div",null,"Annotation ",e," not found")}function L_({query:e,name:n,label:r,hide:a,initialValue:i,isMulti:o,includeAll:s,children:l}){const u=t_(),[c,d]=(0,t.useState)();let p=u.findVariable(n);return p||(p=new Gh({name:n,label:r,query:e,value:i,isMulti:o,includeAll:s,hide:a})),(0,t.useEffect)((()=>{const e=u.addVariable(p);return d(!0),e}),[p,u,n]),(0,t.useEffect)((()=>{null==p||p.setState({label:r,query:e,hide:a,isMulti:o,includeAll:s})}),[a,s,o,r,e,p]),c?l:null}function $_({pluginId:e,regex:n,name:r,label:a,hide:i,initialValue:o,isMulti:s,includeAll:l,children:u}){const c=t_(),[d,p]=(0,t.useState)();let h=c.findVariable(r);return h||(h=new Jh({pluginId:e,regex:n,name:r,label:a,value:o,isMulti:s,hide:i,includeAll:l})),(0,t.useEffect)((()=>{const e=c.addVariable(h);return p(!0),e}),[h,c,r]),(0,t.useEffect)((()=>{d&&(h.state.pluginId===e&&h.state.regex===n&&h.state.label===a&&h.state.hide===i&&h.state.includeAll===l||(h.setState({pluginId:e,regex:n,label:a,hide:i,includeAll:l}),h.refreshOptions()))}),[i,l,a,e,n,h,d]),d?u:null}function z_({query:e,name:n,datasource:r,label:a,hide:i,regex:o,refresh:s,sort:l,initialValue:u,isMulti:c,includeAll:d,children:p}){const h=t_(),[f,m]=(0,t.useState)();let g=h.findVariable(n);return g||(g=new Lu({name:n,label:a,query:e,datasource:r,refresh:s,sort:l,regex:o,value:u,isMulti:c,hide:i,includeAll:d})),(0,t.useEffect)((()=>{const e=h.addVariable(g);return m(!0),e}),[g,h,n]),(0,t.useEffect)((()=>{f&&((0,ge.isEqual)(g.state.query,e)&&(0,ge.isEqual)(g.state.datasource,r)&&g.state.regex===o&&g.state.label===a&&g.state.hide===i&&g.state.includeAll===d&&g.state.refresh===s&&g.state.sort===l||(g.setState({label:a,query:e,datasource:r,refresh:s,sort:l,regex:o,hide:i,includeAll:d}),g.refreshOptions()))}),[r,i,d,a,e,s,o,l,g,f]),f?p:null}const B_=(0,t.createContext)({breadcrumbs:[],addBreadcrumb:()=>{},removeBreadcrumb:()=>{}});function N_({children:e}){const[n,a]=(0,t.useState)([]);return r().createElement(B_.Provider,{value:{breadcrumbs:n,addBreadcrumb:(0,t.useCallback)((e=>a((t=>[...t,e]))),[]),removeBreadcrumb:(0,t.useCallback)((e=>a((t=>t.filter((t=>t.url!==e.url))))),[])}},e)}function q_({text:n,path:r,extraKeys:a}){const{addBreadcrumb:o,removeBreadcrumb:s}=(0,t.useContext)(B_),l=function(){const n=function(){const{search:e}=(0,i.useLocation)();return[(0,t.useMemo)((()=>(0,d.locationSearchToObject)(e||"")),[e]),(0,t.useCallback)(((e,t)=>d.locationService.partial(e,t)),[])]}()[0],r=function(){const e=t_();return Hu.getVariables(e).useState().variables}(),[a,o]=n_();return(0,t.useCallback)(((t,a)=>{const i={};for(const e of r)if(e.urlSync&&!e.state.skipUrlSync){const t=e.urlSync.getUrlState();Object.assign(i,t)}if(o.urlSync){const e=o.urlSync.getUrlState();Object.assign(i,e)}if(a)for(const e of a)n[e]&&(i[e]=n[e]);return e.urlUtil.renderUrl(t,i)}),[r,n,o])}();return(0,t.useEffect)((()=>{const e={text:n,url:l(r,a)};return o(e),()=>{s(e)}}),[n,r,a,o,l,s]),null}function H_({name:e,query:n,children:r}){const a=t_(),[i,o]=(0,t.useState)();let s=function(e,t){const n=e.state.$data;if(n)return n.state.layers.find((e=>e.state.name===t))}(a,e);return s||(s=new nh({name:e,query:n})),(0,t.useEffect)((()=>{const e=function(e,t){let n=e.state.$data;return n?n.setState({layers:[...n.state.layers,t]}):(n=new _h({layers:[t]}),e.setState({$data:n})),HS("SceneContext",`Adding annotation data layer: ${t.state.name} key: ${t.state.key}`),()=>{n.setState({layers:n.state.layers.filter((e=>e!==t))}),HS("SceneContext",`Removing annotation data layer: ${t.state.name} key: ${t.state.key}`)}}(a,s);return o(!0),e}),[a,e,s]),(0,t.useEffect)((()=>{}),[i]),i?r:null}var W_=Object.defineProperty,U_=Object.defineProperties,G_=Object.getOwnPropertyDescriptors,Q_=Object.getOwnPropertySymbols,K_=Object.prototype.hasOwnProperty,Y_=Object.prototype.propertyIsEnumerable,Z_=(e,t,n)=>t in e?W_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class X_ extends Vf{constructor(e){var t,n;super((t=((e,t)=>{for(var n in t||(t={}))K_.call(t,n)&&Z_(e,n,t[n]);if(Q_)for(var n of Q_(t))Y_.call(t,n)&&Z_(e,n,t[n]);return e})({},e),n={context:new XS},U_(t,G_(n))))}}function J_(e){return r().createElement("div",{style:{display:"grid",flexGrow:1,gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gridAutoRows:"320px",columnGap:"8px",rowGap:"8px"}},e.children)}function ex({name:e}){const t=r().useRef(0);return t.current+=1,r().createElement("div",null,e," render count: ",t.current)}X_.Component=({model:e})=>r().createElement(JS.Provider,{value:e.state.context},r().createElement(Vf.Component,{model:e}));const tx=u(`${s.ReactDemo}`),nx=by().setCustomFieldConfig("fillOpacity",6).build(),rx=by().setCustomFieldConfig("drawStyle",we.Bars).setCustomFieldConfig("fillOpacity",6).build(),ax=by().setCustomFieldConfig("fillOpacity",10).setCustomFieldConfig("lineWidth",3).setCustomFieldConfig("gradientMode",Se.Scheme).setColor({mode:ec.ContinuousGrYlRd}).build();function ix({maxDataPoints:e=20,title:t,queryAlias:n}){const a=[{uid:"gdev-testdata",refId:"A",scenarioId:"random_walk",alias:null!=n?n:"env = $env"}],i=P_({queries:a,maxDataPoints:e,cacheKey:[a,e]});return r().createElement(D_,{title:t,viz:nx,dataProvider:i})}function ox(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ox(e,t,n[t])}))}return e}function lx(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function ux(e){return new wb(lx(sx({},e),{subTitle:"Testing using the hooks and plain react components from normal scene",getScene:()=>new X_(lx(sx({},jy()),{key:"Flex layout embedded scene",body:new Ag({direction:"column",children:[new Ig({body:new fd({title:"Graph",pluginId:"timeseries",$data:Ey({})})}),new Ig({body:new cx({})})]})}))}))}class cx extends re{}function dx(e,t){const n=t.state.$variables;if(!n)return t.parent?dx(e,t.parent):null;return n.getByName(e)||(t.parent?dx(e,t.parent):null)}function px(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ox(cx,"Component",(({model:e})=>{const[t,n]=n_();return r().createElement(_n.Stack,{direction:"column"},r().createElement("div",null,"Time hook: ",t.from.toString()),r().createElement(J_,null,r().createElement(ix,{title:"Visualization using React VizPanel with data from useQueryRunner"})))}));const hx={state:Ae.Done,series:[],timeRange:(0,e.getDefaultTimeRange)()};function fx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class mx{getKeys(){return"function"==typeof this._keys?this._keys():this._keys}getUrlState(){return this._sceneObject.getUrlState()}updateFromUrl(e){this._sceneObject.updateFromUrl(e)}performBrowserHistoryAction(e){this._nextChangeShouldAddHistoryStep=!0,e(),this._nextChangeShouldAddHistoryStep=!1}shouldCreateHistoryStep(e){return this._nextChangeShouldAddHistoryStep}constructor(e,t){fx(this,"_sceneObject",void 0),fx(this,"_keys",void 0),fx(this,"_nextChangeShouldAddHistoryStep",void 0),this._sceneObject=e,this._nextChangeShouldAddHistoryStep=!1,this._keys=t.keys}}const gx=/^\d+[yYmMsSwWhHdD]$/;function bx(t){if("string"!=typeof t)return null;if(-1!==t.indexOf("now"))return t;if(gx.test(t))return t;if(8===t.length){const n=(0,e.toUtc)(t,"YYYYMMDD");if(n.isValid())return n.toISOString()}else if(15===t.length){const n=(0,e.toUtc)(t,"YYYYMMDDTHHmmss");if(n.isValid())return n.toISOString()}else if(19===t.length){const n=(0,e.toUtc)(t,"YYYY-MM-DD HH:mm:ss");if(n.isValid())return n.toISOString()}else if(24===t.length)return(0,e.toUtc)(t).toISOString();const n=parseInt(t,10);return isNaN(n)?null:(0,e.toUtc)(n).toISOString()}function yx(t,n,r,a,i,o){const s=i&&"now"===n,l=Date.now();o&&function(t){t!==vx&&(vx=t,(0,e.setWeekStart)(t))}(o);const u=(t,n)=>e.dateMath.toDateTime?e.dateMath.toDateTime(t,n):e.dateMath.parse(t,n.roundUp,n.timezone,n.fiscalYearStartMonth);return{to:u(s?"now-"+i:n,{roundUp:!0,timezone:r,fiscalYearStartMonth:a,now:l}),from:u(t,{roundUp:!1,timezone:r,fiscalYearStartMonth:a,now:l}),raw:{from:t,to:n}}}let vx;function wx(t,n,r){return(0,e.isDateTime)(t)?t.isValid():e.dateMath.isMathString(t)?e.dateMath.isValid(t):(0,e.dateTimeParse)(t,{roundUp:n,timeZone:r}).isValid()}function Ox(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Sx=new class extends $v{getResultsStream(){const e={origin:this,data:this.state.data};return(0,D.of)(e)}constructor(e){super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){px(e,t,n[t])}))}return e}({data:hx},e))}},_x=new class extends $v{_onActivate(){if(!this.state.timeZone){const e=this.getTimeZoneSource();e!==this&&this._subs.add(e.subscribeToState(((e,t)=>{void 0!==e.timeZone&&e.timeZone!==t.timeZone&&this.refreshRange(0)})))}return e.rangeUtil.isRelativeTimeRange(this.state.value.raw)&&this.refreshIfStale(),()=>{this.state.weekStart&&(0,e.setWeekStart)(d.config.bootData.user.weekStart)}}refreshIfStale(){var e,t,n,r;let a;void 0!==(null===(t=this.state)||void 0===t||null===(e=t.refreshOnActivate)||void 0===e?void 0:e.percent)&&(a=this.calculatePercentOfInterval(this.state.refreshOnActivate.percent)),void 0!==(null===(r=this.state)||void 0===r||null===(n=r.refreshOnActivate)||void 0===n?void 0:n.afterMs)&&(a=Math.min(this.state.refreshOnActivate.afterMs,null!=a?a:1/0)),void 0!==a&&this.refreshRange(a)}getTimeZoneSource(){if(!this.parent||!this.parent.parent)return this;return Nv(this.parent.parent,(e=>{if(e.state.$timeRange&&e.state.$timeRange.state.timeZone)return e.state.$timeRange}))||this}refreshRange(t){var n;const r=yx(this.state.from,this.state.to,null!==(n=this.state.timeZone)&&void 0!==n?n:(0,e.getTimeZone)(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay,this.state.weekStart);r.to.diff(this.state.value.to,"milliseconds")>=t&&this.setState({value:r})}calculatePercentOfInterval(e){const t=this.state.value.to.diff(this.state.value.from,"milliseconds");return Math.ceil(t/e)}getTimeZone(){if(this.state.timeZone)return this.state.timeZone;const t=this.getTimeZoneSource();return t!==this?t.state.timeZone:(0,e.getTimeZone)()}getUrlState(){const e=d.locationService.getSearchObject(),t={from:this.state.from,to:this.state.to,timezone:this.getTimeZone()};return e.time&&e["time.window"]&&(t.time=null,t["time.window"]=null),t}updateFromUrl(t){const n={};let r=bx(t.from),a=bx(t.to);if(t.time&&t["time.window"]){const n=function(t,n){const r=isNaN(Date.parse(t))?parseInt(t,10):Date.parse(t);let a;return a=n.match(/^\d+$/)&&parseInt(n,10)?parseInt(n,10):e.rangeUtil.intervalToMs(n),{from:(0,e.toUtc)(r-a/2).toISOString(),to:(0,e.toUtc)(r+a/2).toISOString()}}(Array.isArray(t.time)?t.time[0]:t.time,Array.isArray(t["time.window"])?t["time.window"][0]:t["time.window"]);n.from&&wx(n.from)&&(r=n.from),n.to&&wx(n.to)&&(a=n.to)}var i,o,s;if(r&&wx(r)&&(n.from=r),a&&wx(a)&&(n.to=a),"string"==typeof t.timezone&&(n.timeZone=""!==t.timezone?t.timezone:void 0),0!==Object.keys(n).length)return n.value=yx(null!==(i=n.from)&&void 0!==i?i:this.state.from,null!==(o=n.to)&&void 0!==o?o:this.state.to,null!==(s=n.timeZone)&&void 0!==s?s:this.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay,this.state.weekStart),this.setState(n)}constructor(t={}){const n=t.from&&wx(t.from)?t.from:"now-6h",r=t.to&&wx(t.to)?t.to:"now",a=t.timeZone;var i;super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ox(e,t,n[t])}))}return e}({from:n,to:r,timeZone:a,value:yx(n,r,a||(0,e.getTimeZone)(),t.fiscalYearStartMonth,t.UNSAFE_nowDelay,t.weekStart),refreshOnActivate:null!==(i=t.refreshOnActivate)&&void 0!==i?i:{percent:10}},t)),Ox(this,"_urlSync",new mx(this,{keys:["from","to","timezone","time","time.window"]})),Ox(this,"onTimeRangeChange",(e=>{const t={};"string"==typeof e.raw.from?t.from=e.raw.from:t.from=e.raw.from.toISOString(),"string"==typeof e.raw.to?t.to=e.raw.to:t.to=e.raw.to.toISOString(),t.value=yx(t.from,t.to,this.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay,this.state.weekStart),t.from===this.state.from&&t.to===this.state.to||this._urlSync.performBrowserHistoryAction((()=>{this.setState(t)}))})),Ox(this,"onTimeZoneChange",(e=>{this._urlSync.performBrowserHistoryAction((()=>{this.setState({timeZone:e})}))})),Ox(this,"onRefresh",(()=>{this.refreshRange(0),this.publishEvent(new d.RefreshEvent,!0)})),this.addActivationHandler(this._onActivate.bind(this))}},xx=new class extends $v{getByName(e){}isVariableLoadingOrWaitingToUpdate(e){return!1}constructor(){super({variables:[]})}};function Px(e){var t;return null!==(t=Nv(e,(e=>e.state.$timeRange)))&&void 0!==t?t:_x}class Cx extends e.BusEventWithPayload{}function Ex(e){return"object"==typeof e&&"formatter"in e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Cx,"type","scene-variable-changed-value");let jx,Dx={};function kx(e){return Dx[e]||(Dx[e]=(0,ge.property)(e))}class Tx{getValue(e){let{value:t}=this.state,n=t.value;return n=e?kx(e)(t.value):t.value,"string"===n||"number"===n||"boolean"===n?n:String(n)}getValueText(){const{value:e}=this.state;return null!=e.text?String(e.text):String(e)}constructor(e,t){!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"state",void 0),this.state={name:e,value:t,type:"scopedvar"}}}const Rx=new e.Registry((()=>{const t=[{id:Te.Lucene,name:"Lucene",description:"Values are lucene escaped and multi-valued variables generate an OR expression",formatter:e=>"string"==typeof e?Ax(e):Array.isArray(e)?0===e.length?"__empty__":"("+(0,ge.map)(e,(e=>'"'+Ax(e)+'"')).join(" OR ")+")":Ax(`${e}`)},{id:Te.Raw,name:"raw",description:"Keep value as is",formatter:e=>String(e)},{id:Te.Regex,name:"Regex",description:"Values are regex escaped and multi-valued variables generate a (<value>|<value>) expression",formatter:t=>{if("string"==typeof t)return(0,e.escapeRegex)(t);if(Array.isArray(t)){const n=t.map((t=>"string"==typeof t?(0,e.escapeRegex)(t):(0,e.escapeRegex)(String(t))));return 1===n.length?n[0]:"("+n.join("|")+")"}return(0,e.escapeRegex)(`${t}`)}},{id:Te.Pipe,name:"Pipe",description:"Values are separated by | character",formatter:e=>"string"==typeof e?e:Array.isArray(e)?e.join("|"):`${e}`},{id:Te.Distributed,name:"Distributed",description:"Multiple values are formatted like variable=value",formatter:(e,t,n)=>"string"==typeof e?e:Array.isArray(e)?(e=(0,ge.map)(e,((e,t)=>0!==t?n.state.name+"="+e:e)),e.join(",")):`${e}`},{id:Te.CSV,name:"Csv",description:"Comma-separated values",formatter:e=>"string"==typeof e?e:(0,ge.isArray)(e)?e.join(","):String(e)},{id:Te.HTML,name:"HTML",description:"HTML escaping of values",formatter:t=>"string"==typeof t?e.textUtil.escapeHtml(t):(0,ge.isArray)(t)?e.textUtil.escapeHtml(t.join(", ")):e.textUtil.escapeHtml(String(t))},{id:Te.JSON,name:"JSON",description:"JSON stringify value",formatter:e=>"string"==typeof e?e:JSON.stringify(e)},{id:Te.PercentEncode,name:"Percent encode",description:"Useful for URL escaping values",formatter:e=>(0,ge.isArray)(e)?Ix("{"+e.join(",")+"}"):Ix(e)},{id:Te.SingleQuote,name:"Single quote",description:"Single quoted values",formatter:e=>{const t=new RegExp("'","g");if((0,ge.isArray)(e))return(0,ge.map)(e,(e=>`'${(0,ge.replace)(e,t,"\\'")}'`)).join(",");let n="string"==typeof e?e:String(e);return`'${(0,ge.replace)(n,t,"\\'")}'`}},{id:Te.DoubleQuote,name:"Double quote",description:"Double quoted values",formatter:e=>{const t=new RegExp('"',"g");if((0,ge.isArray)(e))return(0,ge.map)(e,(e=>`"${(0,ge.replace)(e,t,'\\"')}"`)).join(",");let n="string"==typeof e?e:String(e);return`"${(0,ge.replace)(n,t,'\\"')}"`}},{id:Te.SQLString,name:"SQL string",description:"SQL string quoting and commas for use in IN statements and other scenarios",formatter:$x},{id:Te.Date,name:"Date",description:"Format date in different ways",formatter:(t,n)=>{let r=NaN;if("number"==typeof t?r=t:"string"==typeof t&&(r=parseInt(t,10)),isNaN(r))return"NaN";var a;const i=null!==(a=n[0])&&void 0!==a?a:"iso";switch(i){case"ms":return String(t);case"seconds":return`${Math.round(r/1e3)}`;case"iso":return(0,e.dateTime)(r).toISOString();default:return(n||[]).length>1?(0,e.dateTime)(r).format(n.join(":")):(0,e.dateTime)(r).format(i)}}},{id:Te.Glob,name:"Glob",description:"Format multi-valued variables using glob syntax, example {value1,value2}",formatter:e=>(0,ge.isArray)(e)&&e.length>1?"{"+e.join(",")+"}":String(e)},{id:Te.Text,name:"Text",description:"Format variables in their text representation. Example in multi-variable scenario A + B + C.",formatter:(e,t,n)=>n.getValueText?n.getValueText():String(e)},{id:Te.QueryParam,name:"Query parameter",description:"Format variables as URL parameters. Example in multi-variable scenario A + B + C => var-foo=A&var-foo=B&var-foo=C.",formatter:(t,n,r)=>{if(r.urlSync){const t=r.urlSync.getUrlState();return e.urlUtil.toUrlParams(t)}return Array.isArray(t)?t.map((e=>Fx(r.state.name,e))).join("&"):Fx(r.state.name,t)}},{id:Te.UriEncode,name:"Percent encode as URI",description:"Useful for URL escaping values, taking into URI syntax characters",formatter:e=>(0,ge.isArray)(e)?Mx("{"+e.join(",")+"}"):Mx(e)}];return t}));function Ax(e){return!1===isNaN(+e)?e:e.replace(/([\!\*\+\-\=<>\s\&\|\(\)\[\]\{\}\^\~\?\:\\/"])/g,"\\$1")}function Ix(e){return"object"==typeof e&&(e=String(e)),Vx(encodeURIComponent(e))}const Mx=e=>Vx(encodeURI(String(e))),Vx=e=>e.replace(/[!'()*]/g,(e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()));function Fx(e,t){return`var-${e}=${Ix(t)}`}const Lx={"'":"''",'"':'\\"'};function $x(e){const t=new RegExp("'|\"","g");var n;if((0,ge.isArray)(e))return(0,ge.map)(e,(e=>`'${(0,ge.replace)(e,t,(e=>null!==(n=Lx[e])&&void 0!==n?n:""))}'`)).join(",");let r="string"==typeof e?e:String(e);var a;return`'${(0,ge.replace)(r,t,(e=>null!==(a=Lx[e])&&void 0!==a?a:""))}'`}const zx="All",Bx="$__all",Nx=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;class qx{formatter(){return this._value}constructor(e){!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"_value",void 0),this._value=e}}function Hx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Wx{getValue(){const e=Px(this._sceneObject);return"__from"===this.state.name?e.state.value.from.valueOf():e.state.value.to.valueOf()}getValueText(){const t=Px(this._sceneObject);return"__from"===this.state.name?(0,e.dateTimeFormat)(t.state.value.from,{timeZone:t.getTimeZone()}):(0,e.dateTimeFormat)(t.state.value.to,{timeZone:t.getTimeZone()})}constructor(e,t){Hx(this,"state",void 0),Hx(this,"_sceneObject",void 0),this.state={name:e,type:"time_macro"},this._sceneObject=t}}class Ux{getValue(){const e=BE(this._sceneObject);if(e){var t;const n=null===(t=e.state.data)||void 0===t?void 0:t.request;return n?"__interval_ms"===this.state.name?n.intervalMs:n.interval:this.state.match}return this.state.match}constructor(e,t,n){Hx(this,"state",void 0),Hx(this,"_sceneObject",void 0),this.state={name:e,type:"time_macro",match:n},this._sceneObject=t}}function Gx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Qx extends $v{validateAndUpdate(){return this.getValueOptions({}).pipe((0,D.map)((e=>(this.updateValueGivenNewOptions(e),{}))))}onCancel(){var e;this.setStateHelper({loading:!1}),null===(e=this.parent)||void 0===e||e.cancel(this)}updateValueGivenNewOptions(e){const{value:t,text:n,options:r}=this.state,a=this.getStateUpdateGivenNewOptions(e,t,n);this.interceptStateUpdateAfterValidation(a),this.setStateHelper(a),(a.value!==t||a.text!==n||this.hasAllValue()&&!(0,ge.isEqual)(e,r))&&this.publishEvent(new Cx(this),!0)}getStateUpdateGivenNewOptions(e,t,n){const r={options:e,loading:!1,value:t,text:n};if(0===e.length)return this.state.defaultToAll||this.state.includeAll?(r.value=Bx,r.text=zx):this.state.isMulti?(r.value=[],r.text=[]):(r.value="",r.text=""),r;if(this.hasAllValue())return this.state.includeAll?r.text=zx:(r.value=e[0].value,r.text=e[0].label,this.state.isMulti&&(r.value=[r.value],r.text=[r.text])),r;if(this.state.isMulti){const a=(Array.isArray(t)?t:[t]).filter((t=>e.find((e=>e.value===t)))),i=a.map((t=>e.find((e=>e.value===t)).label));if(0===a.length){const t=this.getDefaultMultiState(e);r.value=t.value,r.text=t.text}else(0,ge.isEqual)(a,t)||(r.value=a),(0,ge.isEqual)(i,n)||(r.text=i);return r}let a=function(e,t,n){let r;for(const a of n){if(a.value===e)return a;a.label===t&&(r=a)}return r}(t,n,e);return a?(r.text=a.label,r.value=a.value):this.state.defaultToAll?(r.value=Bx,r.text=zx):(r.value=e[0].value,r.text=e[0].label),r}interceptStateUpdateAfterValidation(e){const t=e.value===Bx&&this.state.text===zx;this.skipNextValidation&&e.value!==this.state.value&&e.text!==this.state.text&&!t&&(e.value=this.state.value,e.text=this.state.text),this.skipNextValidation=!1}getValue(){return this.hasAllValue()?this.state.allValue?new Yx(this.state.allValue,this):new Yx(".*",this):this.state.value}getValueText(){return this.hasAllValue()?zx:Array.isArray(this.state.text)?this.state.text.join(" + "):String(this.state.text)}hasAllValue(){const e=this.state.value;return e===Bx||Array.isArray(e)&&e[0]===Bx}getDefaultMultiState(e){return this.state.defaultToAll?{value:[Bx],text:[zx]}:e.length>0?{value:[e[0].value],text:[e[0].label]}:{value:[],text:[]}}changeValueTo(e,t){if(e!==this.state.value||t!==this.state.text){if(t||(t=Array.isArray(e)?e.map((e=>this.findLabelTextForValue(e))):this.findLabelTextForValue(e)),Array.isArray(e)){if(0===e.length){const n=this.getDefaultMultiState(this.state.options);e=n.value,t=n.text}e[e.length-1]===Bx?(e=[Bx],t=[zx]):e[0]===Bx&&e.length>1&&(e.shift(),Array.isArray(t)&&t.shift())}(0,ge.isEqual)(e,this.state.value)&&(0,ge.isEqual)(t,this.state.text)||(this.setStateHelper({value:e,text:t,loading:!1}),this.publishEvent(new Cx(this),!0))}}findLabelTextForValue(e){if(e===Bx)return zx;const t=this.state.options.find((t=>t.value===e));if(t)return t.label;const n=this.state.options.find((t=>t.label===e));return n?n.label:e}setStateHelper(e){var t;t=e,this.setState(t)}getOptionsForSelect(){let e=this.state.options;return this.state.includeAll&&(e=[{value:Bx,label:zx},...e]),Array.isArray(this.state.value)||e.find((e=>e.value===this.state.value))||(e=[{value:this.state.value,label:String(this.state.text)},...e]),e}refreshOptions(){this.getValueOptions({}).subscribe((e=>{this.updateValueGivenNewOptions(e)}))}constructor(...e){super(...e),Gx(this,"_urlSync",new Kx(this)),Gx(this,"skipNextValidation",void 0)}}class Kx{getKey(){return`var-${this._sceneObject.state.name}`}getKeys(){return this._sceneObject.state.skipUrlSync?[]:[this.getKey()]}getUrlState(){if(this._sceneObject.state.skipUrlSync)return{};let e=null,t=this._sceneObject.state.value;return e=Array.isArray(t)?t.map(String):this._sceneObject.state.isMulti?[String(t)]:String(t),{[this.getKey()]:e}}updateFromUrl(e){let t=e[this.getKey()];null!=t&&(this._sceneObject.state.includeAll&&(t=function(e){return(0,ge.isArray)(e)&&e[0]===zx?[Bx]:e===zx?Bx:e}(t)),this._sceneObject.state.allValue&&this._sceneObject.state.allValue===t&&(t=Bx),this._sceneObject.isActive||(this._sceneObject.skipNextValidation=!0),this._sceneObject.changeValueTo(t))}constructor(e){Gx(this,"_sceneObject",void 0),this._sceneObject=e}}class Yx{formatter(e){return e===Te.Text?zx:e===Te.PercentEncode?Rx.get(Te.PercentEncode).formatter(this._value,[],this._variable):e===Te.QueryParam?Rx.get(Te.QueryParam).formatter(zx,[],this._variable):this._value}constructor(e,t){Gx(this,"_value",void 0),Gx(this,"_variable",void 0),this._value=e,this._variable=t}}function Zx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xx(e,t={}){if(e.state.$variables)for(const n of e.state.$variables.state.variables)n.state.skipUrlSync||t[n.state.name]||(t[n.state.name]=n);return e.parent&&Xx(e.parent,t),t}function Jx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eP(t,n,r){return new Proxy({},{get:(a,i)=>{return"name"===i?t.name:"displayName"===i?(0,e.getFieldDisplayName)(t,n,r):"labels"===i||"formattedLabels"===i?t.labels?(o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Jx(e,t,n[t])}))}return e}({},t.labels),s=null!=(s={__values:Object.values(t.labels).sort().join(", "),toString:()=>(0,e.formatLabels)(t.labels,"",!0)})?s:{},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(s)).forEach((function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(s,e))})),o):"":void 0;var o,s}})}function tP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const nP=(0,e.getDisplayProcessor)();function rP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class aP{formatter(e){if(!e)return this._urlQueryParams;const t=e.split(":");if("exclude"===t[0]&&t.length>1){const e=new URLSearchParams(this._urlQueryParams);for(const n of t[1].split(","))e.delete(n);return`?${e}`}if("include"===t[0]&&t.length>1){const e=new URLSearchParams(this._urlQueryParams),n=t[1].split(",");for(const t of e.keys())n.includes(t)||e.delete(t);return`?${e}`}return this._urlQueryParams}constructor(e){rP(this,"_urlQueryParams",void 0),this._urlQueryParams=e}}function iP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const oP=new Map([[e.DataLinkBuiltInVars.includeVars,class{getValue(){const e=Xx(this._sceneObject),t=Rx.get(Te.QueryParam),n=[];for(const r of Object.keys(e)){const a=e[r];if(a instanceof Qx&&a.hasAllValue()&&!a.state.allValue){n.push(t.formatter(Bx,[],a));continue}const i=a.getValue();i&&(Ex(i)?n.push(i.formatter(Te.QueryParam)):n.push(t.formatter(i,[],a)))}return new qx(n.join("&"))}getValueText(){return""}constructor(e,t){Zx(this,"state",void 0),Zx(this,"_sceneObject",void 0),this.state={name:e,type:"url_variable"},this._sceneObject=t}}],[e.DataLinkBuiltInVars.keepTime,class{getValue(){var t,n;const r=null===(t=Px(this._sceneObject).urlSync)||void 0===t?void 0:t.getUrlState();return"browser"===(null===(n=r)||void 0===n?void 0:n.timezone)&&(r.timezone=Intl.DateTimeFormat().resolvedOptions().timeZone),new qx(e.urlUtil.toUrlParams(r))}getValueText(){return""}constructor(e,t){Hx(this,"state",void 0),Hx(this,"_sceneObject",void 0),this.state={name:e,type:"url_variable"},this._sceneObject=t}}],["__value",class{getValue(t){var n;const r=null===(n=this._scopedVars)||void 0===n?void 0:n.__dataContext;if(!r)return this._match;const{frame:a,rowIndex:i,field:o,calculatedValue:s}=r.value;if(s)switch(t){case"numeric":case"raw":return s.numeric;case"time":return"";default:return(0,e.formattedValueToString)(s)}if(null==i)return this._match;if("time"===t){const t=a.fields.find((t=>t.type===e.FieldType.time));return t?t.values.get(i):void 0}if(!o)return this._match;const l=o.values.get(i);if("raw"===t)return l;var u;const c=(null!==(u=o.display)&&void 0!==u?u:nP)(l);return"numeric"===t?c.numeric:(0,e.formattedValueToString)(c)}getValueText(){return""}constructor(e,t,n,r){tP(this,"_match",void 0),tP(this,"_scopedVars",void 0),tP(this,"state",void 0),this._match=n,this._scopedVars=r,this.state={name:e,type:"__value"}}}],["__data",class{getValue(t){var n;const r=null===(n=this._scopedVars)||void 0===n?void 0:n.__dataContext;if(!r||!t)return this._match;const{frame:a,rowIndex:i}=r.value;if(void 0===i||void 0===t)return this._match;const o={name:a.name,refId:a.refId,fields:(0,e.getFieldDisplayValuesProxy)({frame:a,rowIndex:i})};var s;return null!==(s=kx(t)(o))&&void 0!==s?s:""}getValueText(){return""}constructor(e,t,n,r){tP(this,"_match",void 0),tP(this,"_scopedVars",void 0),tP(this,"state",void 0),this._match=n,this._scopedVars=r,this.state={name:e,type:"__data"}}}],["__series",class{getValue(t){var n;const r=null===(n=this._scopedVars)||void 0===n?void 0:n.__dataContext;if(!r||!t)return this._match;if("name"!==t)return this._match;const{frame:a,frameIndex:i}=r.value;return(0,e.getFrameDisplayName)(a,i)}getValueText(){return""}constructor(e,t,n,r){tP(this,"_match",void 0),tP(this,"_scopedVars",void 0),tP(this,"state",void 0),this._match=n,this._scopedVars=r,this.state={name:e,type:"__series"}}}],["__field",class{getValue(e){var t;const n=null===(t=this._scopedVars)||void 0===t?void 0:t.__dataContext;if(!n||!e)return this._match;if(void 0===e||""===e)return this._match;const{frame:r,field:a,data:i}=n.value,o=eP(a,r,i);var s;return null!==(s=kx(e)(o))&&void 0!==s?s:""}getValueText(){return""}constructor(e,t,n,r){tP(this,"_match",void 0),tP(this,"_scopedVars",void 0),tP(this,"state",void 0),this._match=n,this._scopedVars=r,this.state={name:e,type:"__field"}}}],["__url",class{getValue(e){const t=d.locationService.getLocation();var n;const r=null!==(n=d.config.appSubUrl)&&void 0!==n?n:"";switch(null!=e?e:""){case"params":return new aP(t.search);case"path":return r+t.pathname;default:return r+t.pathname+t.search}}getValueText(){return""}constructor(e,t){rP(this,"state",void 0),this.state={name:e,type:"url_macro"}}}],["__from",Wx],["__to",Wx],["__timezone",class{getValue(){const e=Px(this._sceneObject).getTimeZone();return"browser"===e?Intl.DateTimeFormat().resolvedOptions().timeZone:e}getValueText(){return this.getValue()}constructor(e,t){Hx(this,"state",void 0),Hx(this,"_sceneObject",void 0),this.state={name:e,type:"time_macro"},this._sceneObject=t}}],["__user",class{getValue(e){const t=d.config.bootData.user;switch(e){case"login":return t.login;case"email":return t.email;default:return String(t.id)}}getValueText(){return""}constructor(e,t){iP(this,"state",void 0),this.state={name:e,type:"user_macro"}}}],["__org",class{getValue(e){const t=d.config.bootData.user;return"name"===e?t.orgName:String(t.orgId)}getValueText(){return""}constructor(e,t){iP(this,"state",void 0),this.state={name:e,type:"org_macro"}}}],["__interval",Ux],["__interval_ms",Ux]]);function sP(e,t,n,r,a){return t&&"string"==typeof t?(Nx.lastIndex=0,t.replace(Nx,((t,i,o,s,l,u,c)=>{const d=i||o||l,p=s||c||r,h=function(e,t,n,r){if(n&&n.hasOwnProperty(e)){const t=n[e];if(t)return function(e,t){return jx?(jx.state.name=e,jx.state.value=t):jx=new Tx(e,t),jx}(e,t)}const a=dx(e,r);if(a)return a;const i=oP.get(e);return i?new i(e,r,t,n):null}(d,t,n,e);if(!h)return a&&a.push({match:t,variableName:d,fieldPath:u,format:p,value:t,found:!1}),t;const f=function(e,t,n,r){if(null==n)return"";if(Ex(n))return sP(e,n.formatter(r));if(Array.isArray(n)||"object"!=typeof n||(n=`${n}`),"function"==typeof r)return r(n,{name:t.state.name,type:t.state.type,multi:t.state.isMulti,includeAll:t.state.includeAll});let a=[];r?(a=r.split(":"),a.length>1?(r=a[0],a=a.slice(1)):a=[]):r=Te.Glob;let i=Rx.getIfExists(r);return i||(console.error(`Variable format ${r} not found. Using glob format as fallback.`),i=Rx.get(Te.Glob)),i.formatter(n,a,t)}(e,h,h.getValue(u),p);return a&&a.push({match:t,variableName:d,fieldPath:u,format:p,value:f,found:f!==t}),f}))):null!=t?t:""}function lP(e){return"isDataLayer"in e}function uP(e,t,...n){let r=!1;"undefined"!=typeof window&&(r="true"===localStorage.getItem("grafana.debug.scenes")),r&&console.log(`${e}: `,t,...n)}e.DataSourceApi;const cP=new Map;function dP(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function pP(e,t){return hP.apply(this,arguments)}function hP(){var e;return e=function*(e,t){var n;if(null===(n=e)||void 0===n?void 0:n.uid){const t=cP.get(e.uid);if(t)return t}return e&&e.query?e:yield(0,d.getDataSourceSrv)().get(e,t)},hP=function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){dP(i,r,a,o,s,"next",e)}function s(e){dP(i,r,a,o,s,"throw",e)}o(void 0)}))},hP.apply(this,arguments)}class fP{recordCurrentDependencyValuesForSceneObject(e){if(this.clearValues(),e.variableDependency)for(const t of e.variableDependency.getNames()){const n=UE.lookupVariable(t,e);n&&this._values.set(n.state.name,n.getValue())}}cloneAndRecordCurrentValuesForSceneObject(e){const t=new fP;return t.recordCurrentDependencyValuesForSceneObject(e),t}clearValues(){this._values.clear()}hasValues(){return!!this._values}recordCurrentValue(e){this._values.set(e.state.name,e.getValue())}hasRecordedValue(e){return this._values.has(e.state.name)}hasValueChanged(e){return!(!this._values.has(e.state.name)||oE(this._values.get(e.state.name),e.getValue()))}hasDependenciesChanged(e){if(!this._values)return!1;if(!e.variableDependency)return!1;for(const t of e.variableDependency.getNames()){const n=UE.lookupVariable(t,e);if(!n)continue;const r=n.state.name;if(n&&this._values.has(r)&&!oE(this._values.get(r),n.getValue()))return!0}return!1}constructor(){!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"_values",new Map)}}function mP(e){return"object"==typeof e&&"getExtraQueries"in e}function gP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const bP=(e,t)=>(0,D.of)(t),yP=e=>t=>{var n,r;return t.pipe((0,D.mergeMap)((([t,...n])=>{const r=n.flatMap((n=>{var r,a;return null!==(a=null===(r=e.get(n.request.requestId))||void 0===r?void 0:r(t,n))&&void 0!==a?a:(0,D.of)(n)}));return(0,D.forkJoin)([(0,D.of)(t),...r])})),(0,D.map)((([e,...t])=>{return a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){gP(e,t,n[t])}))}return e}({},e),i=null!=(i={series:[...e.series,...t.flatMap((e=>e.series))],annotations:[...null!==(n=e.annotations)&&void 0!==n?n:[],...t.flatMap((e=>null!==(r=e.annotations)&&void 0!==r?r:[]))]})?i:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(i)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(i)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(i,e))})),a;var a,i})))};function vP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){vP(e,t,n[t])}))}return e}function OP(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const SP=0;let _P,xP=new Set;function PP(e){return t=>{const n=UE.getQueryController(e.origin);return n?new D.Observable((r=>{e.cancel||(e.cancel=()=>r.complete()),n.queryStarted(e);let a=!1;const i=t.subscribe({next:t=>{a||t.state===Ae.Loading||(a=!0,n.queryCompleted(e)),r.next(t)},error:e=>r.error(e),complete:()=>{r.complete()}});return()=>{i.unsubscribe(),a||n.queryCompleted(e)}})):t}}const CP=new Set;function EP(e,t=!1){let n=e;t&&(n=[{value:Bx,label:zx},...n]);const r=wE(n.map((e=>e.label)));return e=>r(e).map((e=>n[e]))}function jP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const DP=()=>!0,kP=e=>"$__all"!==e.value,TP=(e,t)=>e.length===t.filter(kP).length?_n.ToggleAllState.allSelected:0===e.length||1===e.length&&e[0]&&"$__all"===e[0].value?_n.ToggleAllState.noneSelected:_n.ToggleAllState.indeterminate;function RP({model:e}){const{value:n,text:a,key:i,options:o,includeAll:s,isReadOnly:l,allowCustomValue:u=!0}=e.useState(),[c,d]=(0,t.useState)(""),[p,h]=(0,t.useState)(!1),f=function(e,t){return{value:e,label:null!=t?t:String(e)}}(n,String(a)),m=(0,t.useMemo)((()=>EP(o,s)),[o,s])(c);return r().createElement(_n.Select,{id:i,isValidNewOption:e=>e.trim().length>0,placeholder:"Select value",width:"auto",disabled:l,value:f,inputValue:c,allowCustomValue:u,virtualized:!0,filterOption:DP,tabSelectsValue:!1,onInputChange:(t,{action:n})=>"input-change"===n?(d(t),e.onSearchChange&&e.onSearchChange(t),t):t,onOpenMenu:()=>{p&&d(String(a))},onCloseMenu:()=>{d("")},options:m,"data-testid":Cn.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${n}`),onChange:t=>{e.changeValueTo(t.value,t.label),p!==t.__isNew__&&h(t.__isNew__)}})}function AP({model:e}){const{value:n,options:a,key:i,maxVisibleValues:o,noValueOnClear:s,includeAll:l,isReadOnly:u,allowCustomValue:c=!0}=e.useState(),d=(0,t.useMemo)((()=>(0,ge.isArray)(n)?n:[n]),[n]),[p,h]=(0,t.useState)(d),[f,m]=(0,t.useState)(""),g=(0,t.useMemo)((()=>EP(a,l)),[a,l]);(0,t.useEffect)((()=>{h(d)}),[d]);const b=a.length>0?"Select value":"",y=g(f);return r().createElement(_n.MultiSelect,{id:i,placeholder:b,width:"auto",inputValue:f,disabled:u,value:p,noMultiValueWrap:!0,maxVisibleValues:null!=o?o:5,tabSelectsValue:!1,virtualized:!0,allowCustomValue:c,toggleAllOptions:{enabled:!0,optionsFilter:kP,determineToggleAllState:TP},options:y,closeMenuOnSelect:!1,components:{Option:IP},isClearable:!0,hideSelectedOptions:!1,onInputChange:(t,{action:n})=>"input-change"===n?(m(t),e.onSearchChange&&e.onSearchChange(t),t):"input-blur"===n?(m(""),""):f,onBlur:()=>{e.changeValueTo(p)},filterOption:DP,"data-testid":Cn.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${p}`),onChange:(t,n)=>{"clear"===n.action&&s&&e.changeValueTo([]),h(t.map((e=>e.value)))}})}const IP=({children:e,data:t,innerProps:n,innerRef:a,isFocused:i,isSelected:o,indeterminate:s,renderOptionLabel:l})=>{const{onMouseMove:u,onMouseOver:c}=n,d=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(n,["onMouseMove","onMouseOver"]),p=(0,_n.useTheme2)(),h=(0,_n.getSelectStyles)(p),f=(0,_n.useStyles2)(MP);var m,g,b;return r().createElement("div",(g=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){jP(e,t,n[t])}))}return e}({ref:a,className:(0,En.cx)(h.option,i&&h.optionFocused)},d),b=null!=(b={"data-testid":"data-testid Select option",title:t.title})?b:{},Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(b)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(b)).forEach((function(e){Object.defineProperty(g,e,Object.getOwnPropertyDescriptor(b,e))})),g),r().createElement("div",{className:f.checkbox},r().createElement(_n.Checkbox,{indeterminate:s,value:o})),r().createElement("div",{className:h.optionBody,"data-testid":Cn.pages.Dashboard.SubMenu.submenuItemValueDropDownOptionTexts(null!==(m=t.label)&&void 0!==m?m:String(t.value))},r().createElement("span",null,e)))};IP.displayName="SelectMenuOptions";const MP=e=>({checkbox:(0,En.css)({marginRight:e.spacing(2)})});class VP{getKey(){return`var-${this._sceneObject.state.name}`}getKeys(){return this._sceneObject.state.skipUrlSync?[]:[this.getKey()]}getUrlState(){return this._sceneObject.state.skipUrlSync?{}:{[this.getKey()]:(e=this._sceneObject.state.value,t=this._sceneObject.state.text,e=Array.isArray(e)?e:[e],t=Array.isArray(t)?t:[t],e.map(((e,n)=>{if(null==e)return"";e=String(e);let r=t[n];return r=null==r?e:String(r),gE(e,r)})))};var e,t}updateFromUrl(e){let t=e[this.getKey()];if(null!=t){this._sceneObject.isActive||(this._sceneObject.skipNextValidation=!0);const{values:e,texts:r}=(n=t,(n=Array.isArray(n)?n:[n]).reduce(((e,t)=>{const[n,r]=(null!=t?t:"").split(",");return e.values.push(mE(n)),e.texts.push(mE(null!=r?r:n)),e}),{values:[],texts:[]}));this._sceneObject.changeValueTo(e,r)}var n}constructor(e){!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"_sceneObject",void 0),this._sceneObject=e}}function FP(e){const t=e.getRoot();return function(e){return"enrichFiltersRequest"in e}(t)?t.enrichFiltersRequest(e):null}function LP(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function $P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zP=new WeakMap;class BP{toString(){}get value(){return this}constructor(e){(function(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)})(this,zP,{writable:!0,value:void 0}),$P(this,"text","__sceneObject"),$P(this,"valueOf",(()=>function(e,t){return t.get?t.get.call(e):t.value}(this,LP(this,zP,"get")))),function(e,t,n){(function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}})(e,LP(e,t,"set"),n)}(this,zP,e)}}function NP(e){return function(e){const t=e.match(/^(\d+)\.(\d+)\.(\d+)/);if(!t)return!1;const n=parseInt(t[1],10),r=parseInt(t[2],10),a=parseInt(t[3],10);return 11===n?0===r&&a>=4||1===r&&a>=2||r>1:10===n?4===r&&a>=8||r>=5:n>11}(d.config.buildInfo.version)?new BP(e):{value:e,text:"__sceneObject"}}function qP(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function HP(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){qP(i,r,a,o,s,"next",e)}function s(e){qP(i,r,a,o,s,"throw",e)}o(void 0)}))}}function WP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function UP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){WP(e,t,n[t])}))}return e}class GP extends Qx{validateAndUpdate(){return this.getValueOptions({}).pipe((0,D.map)((e=>(this._updateValueGivenNewOptions(e),{}))))}_updateValueGivenNewOptions(e){const{value:t,text:n}=this.state,r={options:e,loading:!1,value:null!=t?t:[],text:null!=n?n:[]};this.setState(r)}getValueOptions(e){return this.state.defaultOptions?(0,D.of)(this.state.defaultOptions.map((e=>({label:e.text,value:String(e.value),group:e.group})))):(this.setState({loading:!0,error:null}),(0,D.from)(pP(this.state.datasource,{__sceneObject:NP(this)})).pipe((0,D.mergeMap)((e=>(0,D.from)(this._getKeys(e)).pipe((0,D.tap)((e=>{yE(e)&&this.setState({error:e.error.message})})),(0,D.map)((e=>bE(e))),(0,D.take)(1),(0,D.mergeMap)((e=>{const t=e.map((e=>({label:e.text,value:e.value?String(e.value):e.text,group:e.group})));return(0,D.of)(t)})))))))}getDefaultMultiState(e){return{value:[],text:[]}}constructor(e){var t,n;super((t=UP({isMulti:!0,name:"",value:[],text:[],options:[],datasource:null,baseFilters:[],applyMode:"auto",layout:"horizontal",type:"groupby"},e),n=null!=(n={noValueOnClear:!0})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t)),WP(this,"isLazy",!0),WP(this,"_urlSync",new VP(this));var r=this;WP(this,"_getKeys",function(){var e=HP((function*(e){var t,n;const a=yield null===(t=(n=r.state).getTagKeysProvider)||void 0===t?void 0:t.call(n,r,null);if(a&&a.replace)return a.values;var i,o;if(r.state.defaultOptions)return r.state.defaultOptions.concat(bE(null!==(o=null===(i=a)||void 0===i?void 0:i.values)&&void 0!==o?o:[]));if(!e.getTagKeys)return[];const s=pE(r),l=r.state.baseFilters||[],u=UE.getTimeRange(r).state.value,c=yield e.getTagKeys(UP({filters:l,queries:s,timeRange:u},FP(r)));yE(c)&&r.setState({error:c.error.message});let d=bE(c);a&&(d=d.concat(bE(a.values)));const p=r.state.tagKeyRegexFilter;return p&&(d=d.filter((e=>e.text.match(p)))),d}));return function(t){return e.apply(this,arguments)}}()),"auto"===this.state.applyMode&&this.addActivationHandler((()=>(CP.add(this),()=>CP.delete(this))))}}WP(GP,"Component",(function({model:e}){const{value:n,text:a,key:i,isMulti:o=!0,maxVisibleValues:s,noValueOnClear:l,options:u,includeAll:c,allowCustomValue:d=!0}=e.useState(),p=(0,t.useMemo)((()=>{const e=(0,ge.isArray)(n)?n:[n],t=(0,ge.isArray)(a)?a:[a];var r;return e.map(((e,n)=>({value:e,label:String(null!==(r=t[n])&&void 0!==r?r:e)})))}),[n,a]),[h,f]=(0,t.useState)(!1),[m,g]=(0,t.useState)(!1),[b,y]=(0,t.useState)(""),[v,w]=(0,t.useState)(p),O=(0,t.useMemo)((()=>EP(u,c)),[u,c]);(0,t.useEffect)((()=>{w(p)}),[p]);const S=(t,{action:n})=>"input-change"===n?(y(t),e.onSearchChange&&e.onSearchChange(t),t):"input-blur"===n?(y(""),""):b,_=(0,t.useMemo)((()=>vE(O(b).map(KP))),[O,b]);return o?r().createElement(_n.MultiSelect,{"aria-label":"Group by selector","data-testid":`GroupBySelect-${i}`,id:i,placeholder:"Select value",width:"auto",allowCustomValue:d,inputValue:b,value:v,noMultiValueWrap:!0,maxVisibleValues:null!=s?s:5,tabSelectsValue:!1,virtualized:!0,options:_,filterOption:QP,closeMenuOnSelect:!1,isOpen:m,isClearable:!0,hideSelectedOptions:!1,isLoading:h,components:{Option:IP},onInputChange:S,onBlur:()=>{e.changeValueTo(v.map((e=>e.value)),v.map((e=>e.label)))},onChange:(t,n)=>{"clear"===n.action&&l&&e.changeValueTo([]),w(t)},onOpenMenu:HP((function*(){f(!0),yield(0,D.lastValueFrom)(e.validateAndUpdate()),f(!1),g(!0)})),onCloseMenu:()=>{g(!1)}}):r().createElement(_n.Select,{"aria-label":"Group by selector","data-testid":`GroupBySelect-${i}`,id:i,placeholder:"Select value",width:"auto",inputValue:b,value:v,allowCustomValue:d,noMultiValueWrap:!0,maxVisibleValues:null!=s?s:5,tabSelectsValue:!1,virtualized:!0,options:_,filterOption:QP,closeMenuOnSelect:!0,isOpen:m,isClearable:!0,hideSelectedOptions:!1,noValueOnClear:!0,isLoading:h,onInputChange:S,onChange:(t,n)=>{var r;if("clear"===n.action)return w([]),void(l&&e.changeValueTo([]));(null===(r=t)||void 0===r?void 0:r.value)&&(w([t]),e.changeValueTo([t.value],t.label?[t.label]:void 0))},onOpenMenu:HP((function*(){f(!0),yield(0,D.lastValueFrom)(e.validateAndUpdate()),f(!1),g(!0)})),onCloseMenu:()=>{g(!1)}})}));const QP=()=>!0;function KP(e){const{label:t,value:n,group:r}=e,a={label:t,value:n};return r&&(a.group=r),a}function YP(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function ZP(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){YP(i,r,a,o,s,"next",e)}function s(e){YP(i,r,a,o,s,"throw",e)}o(void 0)}))}}function XP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JP(e,t){return""!==e?{value:e,label:t||e}:null}const eC=()=>!0;function tC({filter:e,model:n}){var a;const i=(0,_n.useStyles2)(nC),[o,s]=(0,t.useState)([]),[l,u]=(0,t.useState)([]),[c,d]=(0,t.useState)(!1),[p,h]=(0,t.useState)(!1),[f,m]=(0,t.useState)(!1),[g,b]=(0,t.useState)(!1),[y,v]=(0,t.useState)(!1),[w,O]=(0,t.useState)(""),[S,_]=(0,t.useState)(!1),[x,P]=(0,t.useState)(e.values?e.values.map(((t,n)=>{var r;return JP(t,null===(r=e.valueLabels)||void 0===r?void 0:r[n])})):[]),C=QC(e.operator),E=JP(e.key,e.keyLabel),j=JP(e.value,null===(a=e.valueLabels)||void 0===a?void 0:a[0]),D=(0,t.useMemo)((()=>function(e){var t;const n=wE(e.map((e=>null!==(t=e.label)&&void 0!==t?t:String(e.value))));return t=>n(t).map((t=>e[t]))}(l)),[l]),k=(0,t.useMemo)((()=>vE(D(w))),[D,w]),T={isMulti:!0,value:x,components:{Option:IP},hideSelectedOptions:!1,closeMenuOnSelect:!1,openMenuOnFocus:!1,onChange:e=>{P(e),e.some((e=>e.__isNew__))&&O("")},onBlur:()=>{var t,r;n._updateFilter(e,{value:null!==(r=null===(t=x[0])||void 0===t?void 0:t.value)&&void 0!==r?r:"",values:x.map((e=>e.value)),valueLabels:x.map((e=>e.label))})}};var R;const A=r().createElement(_n.Select,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){XP(e,t,n[t])}))}return e}({virtualized:!0,allowCustomValue:null===(R=n.state.allowCustomValue)||void 0===R||R,isValidNewOption:e=>e.trim().length>0,allowCreateWhileLoading:!0,createOptionPosition:"first",formatCreateLabel:e=>`Use custom value: ${e}`,disabled:n.state.readOnly,className:(0,En.cx)(i.value,g?i.widthWhenOpen:void 0),width:"auto",value:j,filterOption:eC,placeholder:"Select value",options:k,inputValue:w,onInputChange:(e,{action:t})=>("input-change"===t&&O(e),e),onChange:t=>{n._updateFilter(e,{value:t.value,valueLabels:t.label?[t.label]:[t.value]}),S!==t.__isNew__&&_(t.__isNew__)},isOpen:g&&!p,isLoading:p,openMenuOnFocus:!0,onOpenMenu:ZP((function*(){h(!0),b(!0);const t=yield n._getValuesFor(e);var r,a;h(!1),u(t),S&&O(null!==(a=null===(r=j)||void 0===r?void 0:r.label)&&void 0!==a?a:"")})),onCloseMenu:()=>{b(!1),O("")}},C&&T));var I;const M=r().createElement(_n.Select,{key:p?"loading":"loaded",disabled:n.state.readOnly,className:(0,En.cx)(i.key,f?i.widthWhenOpen:void 0),width:"auto",allowCustomValue:null===(I=n.state.allowCustomValue)||void 0===I||I,value:E,placeholder:"Select label",options:vE(o),onChange:t=>{n._updateFilter(e,{key:t.value,keyLabel:t.label,value:"",valueLabels:[""],values:void 0}),P([])},autoFocus:""===e.key,isOpen:f&&!c,isLoading:c,onOpenMenu:ZP((function*(){m(!0),d(!0);const t=yield n._getKeys(e.key);d(!1),s(t)})),onCloseMenu:()=>{m(!1)},onBlur:()=>{""===e.key&&n._removeFilter(e)},openMenuOnFocus:!0}),V=r().createElement(_n.Select,{className:(0,En.cx)(i.operator,{[i.widthWhenOpen]:y}),value:e.operator,disabled:n.state.readOnly,options:n._getOperators(),onChange:t=>{const r=e.operator,a=t.value,i={operator:a};if(QC(r)&&!QC(a))i.value="",i.valueLabels=[""],i.values=void 0,P([]);else if(!QC(r)&&QC(a)&&e.value){var o,s;i.values=[e.value],P([{value:e.value,label:null!==(s=null===(o=e.valueLabels)||void 0===o?void 0:o[0])&&void 0!==s?s:e.value}])}n._updateFilter(e,i)},onOpenMenu:()=>{v(!0)},onCloseMenu:()=>{v(!1)}});if("vertical"===n.state.layout){if(e.key){var F;const t=r().createElement(GO,{layout:"vertical",label:null!==(F=e.key)&&void 0!==F?F:"",onRemove:()=>n._removeFilter(e)});return r().createElement(_n.Field,{label:t,"data-testid":`AdHocFilter-${e.key}`,className:i.field},r().createElement("div",{className:i.wrapper},V,A))}return r().createElement(_n.Field,{label:"Select label","data-testid":`AdHocFilter-${e.key}`,className:i.field},M)}var L;return r().createElement("div",{className:i.wrapper,"data-testid":`AdHocFilter-${e.key}`},M,V,A,r().createElement(_n.Button,{variant:"secondary","aria-label":"Remove filter",title:"Remove filter",className:i.removeButton,icon:"times","data-testid":`AdHocFilter-remove-${null!==(L=e.key)&&void 0!==L?L:""}`,onClick:()=>n._removeFilter(e)}))}const nC=e=>({field:(0,En.css)({marginBottom:0}),wrapper:(0,En.css)({display:"flex","> *":{"&:not(:first-child)":{marginLeft:-1},"&:first-child":{borderTopRightRadius:0,borderBottomRightRadius:0},"&:last-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:first-child):not(:last-child)":{borderRadius:0},position:"relative",zIndex:0,"&:hover":{zIndex:1},"&:focus-within":{zIndex:2}}}),widthWhenOpen:(0,En.css)({minWidth:e.spacing(16)}),value:(0,En.css)({flexBasis:"content",flexShrink:1,minWidth:"90px"}),key:(0,En.css)({flexBasis:"content",minWidth:"90px",flexShrink:1}),operator:(0,En.css)({flexShrink:0,flexBasis:"content"}),removeButton:(0,En.css)({paddingLeft:e.spacing(1.5),paddingRight:e.spacing(1.5),borderLeft:"none",width:e.spacing(3),marginRight:e.spacing(1),boxSizing:"border-box",position:"relative",left:"1px"})});function rC({model:e,addFilterButtonText:t}){const{_wip:n}=e.useState();return n?r().createElement(tC,{filter:n,model:e}):r().createElement(_n.Button,{variant:"secondary",icon:"plus",title:"Add filter","aria-label":"Add filter","data-testid":"AdHocFilter-add",onClick:()=>e._addWip()},t)}class aC{getKey(){return`var-${this._variable.state.name}`}getKeys(){return[this.getKey()]}getUrlState(){const e=this._variable.state.filters;if(0===e.length)return{[this.getKey()]:[""]};const t=e.filter(GC).map((e=>function(e){const t=[gE(e.key,e.keyLabel),e.operator];var n;return QC(e.operator)?e.values.forEach(((n,r)=>{var a;t.push(gE(n,null===(a=e.valueLabels)||void 0===a?void 0:a[r]))})):t.push(gE(e.value,null===(n=e.valueLabels)||void 0===n?void 0:n[0])),t}(e).map(hE).join("|")));return{[this.getKey()]:t}}updateFromUrl(e){const t=e[this.getKey()];if(null==t)return;const n=function(e){if(Array.isArray(e))return e.map(iC).filter(oC);const t=iC(e);return null===t?[]:[t]}(t);this._variable.setState({filters:n})}constructor(e){!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"_variable",void 0),this._variable=e}}function iC(e){if("string"!=typeof e||0===e.length)return null;const[t,n,r,a,...i]=e.split("|").reduce(((e,t)=>{const[n,r]=t.split(",");return e.push(n,null!=r?r:n),e}),[]).map(mE);return{key:t,keyLabel:n,operator:r,value:i[0],values:QC(r)?i.filter(((e,t)=>t%2==0)):void 0,valueLabels:i.filter(((e,t)=>t%2==1)),condition:""}}function oC(e){return null!==e&&"string"==typeof e.key&&"string"==typeof e.value}function sC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const lC=(0,t.forwardRef)((function(e,n){var{children:a,active:i,addGroupBottomBorder:o,isMultiValueEdit:s,checked:l}=e,u=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,["children","active","addGroupBottomBorder","isMultiValueEdit","checked"]);const c=(0,_n.useStyles2)(uC),d=(0,t.useId)();return r().createElement("div",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){sC(e,t,n[t])}))}return e}({ref:n,role:"option",id:d,"aria-selected":i,className:(0,En.cx)(c.option,i&&c.optionFocused,o&&c.groupBottomBorder)},u),r().createElement("div",{className:c.optionBody,"data-testid":`data-testid ad hoc filter option value ${a}`},r().createElement("span",null,s?r().createElement(_n.Checkbox,{tabIndex:-1,checked:l,className:c.checkbox}):null,a)))})),uC=e=>({option:(0,En.css)({label:"grafana-select-option",top:0,left:0,width:"100%",position:"absolute",padding:e.spacing(1),display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer","&:hover":{background:e.colors.action.hover,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${e.colors.primary.border}`}}}),optionFocused:(0,En.css)({label:"grafana-select-option-focused",background:e.colors.action.focus,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${e.colors.primary.border}`}}),optionBody:(0,En.css)({label:"grafana-select-option-body",display:"flex",fontWeight:e.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),groupBottomBorder:(0,En.css)({borderBottom:`1px solid ${e.colors.border.weak}`}),checkbox:(0,En.css)({paddingRight:e.spacing(.5)}),multiValueApplyWrapper:(0,En.css)({position:"fixed",top:0,left:0,display:"flex",backgroundColor:e.colors.background.primary,color:e.colors.text.primary,boxShadow:e.shadows.z2,overflowY:"auto",zIndex:e.zIndex.dropdown,gap:e.spacing(1.5),padding:`${e.spacing(1.5)} ${e.spacing(1)}`})}),cC=()=>r().createElement(lC,{onClick:e=>e.stopPropagation()},"Loading options..."),dC=()=>r().createElement(lC,{onClick:e=>e.stopPropagation()},"No options found"),pC=({handleFetchOptions:e})=>r().createElement(lC,{onClick:e},"An error has occurred fetching labels. Click to retry"),hC=({onApply:e,floatingElement:t,maxOptionWidth:n,menuHeight:a})=>{var i,o;const s=(0,_n.useStyles2)(uC),l=null===(i=t)||void 0===i?void 0:i.getBoundingClientRect();return r().createElement("div",{className:s.multiValueApplyWrapper,style:{width:`${n}px`,transform:`translate(${null===(o=l)||void 0===o?void 0:o.left}px,${l?l.top+a:0}px)`}},r().createElement(_n.Button,{onClick:e,size:"sm",tabIndex:-1},"Apply"))},fC={key:"operator",operator:"value",value:"key"},mC=(e,t,n,r,a)=>gC(fC[e],t,"value"===e?n:void 0,r,a),gC=(e,t,n,r,a)=>{var i;t(e),null===(i=n)||void 0===i||i(void 0,a),setTimeout((()=>{var e;return null===(e=r)||void 0===e?void 0:e.focus()}))},bC=({filterInputType:e,item:t,filter:n,setFilterMultiValues:r})=>{if("key"===e)return{key:t.value,keyLabel:t.label?t.label:t.value};if("value"===e)return{value:t.value,valueLabels:[t.label?t.label:t.value]};if("operator"===e){var a,i;if(QC(n.operator)&&!QC(t.value))return r([]),{operator:t.value,valueLabels:[(null===(a=n.valueLabels)||void 0===a?void 0:a[0])||(null===(i=n.values)||void 0===i?void 0:i[0])||n.value],values:void 0};if(QC(t.value)&&!QC(n.operator)){var o,s;const e=[(null===(o=n.valueLabels)||void 0===o?void 0:o[0])||(null===(s=n.values)||void 0===s?void 0:s[0])||n.value],a=[n.value];var l,u;return a[0]&&r([{value:a[0],label:null!==(u=null===(l=e)||void 0===l?void 0:l[0])&&void 0!==u?u:a[0]}]),{operator:t.value,valueLabels:e,values:a}}}return{[e]:t.value}},yC="Filter by label values",vC=(e,t,n,r)=>{return"key"===t?yC:"value"===t?n?"Edit values":(null===(a=e.valueLabels)||void 0===a?void 0:a[0])||"":e[t]&&!r?`${e[t]}`:yC;var a},wC=({populateInputOnEdit:e,item:t,filterInputType:n,setInputValue:r,filter:a})=>{var i;e&&!QC(t.value||"")&&"value"===fC[n]?r((null===(i=a)||void 0===i?void 0:i.value)||""):r("")};function OC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){OC(e,t,n[t])}))}return e}const _C=({item:e,handleRemoveMultiValue:n,index:a,handleEditMultiValuePill:i})=>{const o=(0,_n.useStyles2)(xC),s=(0,t.useCallback)((t=>{t.stopPropagation(),t.preventDefault(),i(e)}),[i,e]),l=(0,t.useCallback)((e=>{"Enter"===e.key&&s(e)}),[s]),u=(0,t.useCallback)((t=>{t.stopPropagation(),t.preventDefault(),n(e)}),[n,e]),c=(0,t.useCallback)((e=>{"Enter"===e.key&&u(e)}),[u]);var d,p;return r().createElement("div",{className:(0,En.cx)(o.basePill,o.valuePill),onClick:s,onKeyDown:l,tabIndex:0,id:`${e.value}-${a}`},null!==(d=e.label)&&void 0!==d?d:e.value,r().createElement(_n.Button,{onClick:u,onKeyDownCapture:c,fill:"text",size:"sm",variant:"secondary",className:o.removeButton,tooltip:`Remove filter value - ${null!==(p=e.label)&&void 0!==p?p:e.value}`},r().createElement(_n.Icon,{name:"times",size:"md",id:`${e.value}-${a}-close-icon`})))},xC=e=>{return{basePill:(0,En.css)((t=SC({display:"flex",alignItems:"center",background:e.colors.action.disabledBackground,border:`1px solid ${e.colors.border.weak}`,padding:e.spacing(.125,1,.125,1),color:e.colors.text.primary,overflow:"hidden",whiteSpace:"nowrap",minHeight:e.spacing(2.75)},e.typography.bodySmall),n={cursor:"pointer"},n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t)),valuePill:(0,En.css)({background:e.colors.action.selected,padding:e.spacing(.125,0,.125,1)}),removeButton:(0,En.css)({marginInline:e.spacing(.5),height:"100%",padding:0,cursor:"pointer","&:hover":{color:e.colors.text.primary}})};var t,n};function PC(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function CC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function EC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){CC(e,t,n[t])}))}return e}function jC(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const DC=(0,t.forwardRef)((function({filter:e,model:n,isAlwaysWip:a,handleChangeViewMode:i,focusOnWipInputRef:o,populateInputOnEdit:s},l){var u,c,d,p,h,f,m,g;const[b,y]=(0,t.useState)(!1),[v,w]=(0,t.useState)([]),[O,S]=(0,t.useState)(!1),[_,x]=(0,t.useState)(!1),[P,C]=(0,t.useState)(""),[E,j]=(0,t.useState)(null),[D,k]=(0,t.useState)(a?"key":"value"),[T,R]=(0,t.useState)(!a&&"value"===D),A=(0,_n.useStyles2)(kC),[I,M]=(0,t.useState)([]),[V,F]=(0,t.useState)({});var L;const $=null===(L=n.state.allowCustomValue)||void 0===L||L,z=(0,t.useRef)(null),B=QC((null===(u=e)||void 0===u?void 0:u.operator)||""),N=B&&"value"===D,q=(0,t.useId)(),H=(0,t.useRef)([]),W=(0,t.useRef)([]),U=(0,t.useRef)(a?"key":"value"),G=(0,t.useMemo)((()=>function(e){var t;const n=wE(e.map((e=>null!==(t=e.label)&&void 0!==t?t:e.value)));return(t,r)=>("operator"===r&&""!==t&&(t=`"${t}"`),n(t).map((t=>e[t])))}(v)),[v]),Q=(0,t.useMemo)((()=>!a&&n.state.filters.at(-1)===e),[e,a,n.state.filters]),K=(0,t.useCallback)((()=>{a&&(n._addWip(),k("key"),C(""))}),[n,a]),Y=(0,t.useCallback)(((e,t,n,r)=>{if(n.length){const r=[],a=[];n.forEach((e=>{var t;r.push(null!==(t=e.label)&&void 0!==t?t:e.value),a.push(e.value)})),e._updateFilter(t,{valueLabels:r,values:a,value:a[0]}),M([])}r||setTimeout((()=>{var e;return null===(e=ee.domReference.current)||void 0===e?void 0:e.focus()}))}),[]),Z=(0,t.useCallback)((e=>{M((t=>t.some((t=>t.value===e.value))?t.filter((t=>t.value!==e.value)):[...t,e]))}),[]),X=(0,t.useCallback)(((t,r,a)=>{var o;y(t),a&&["outside-press","escape-key"].includes(a)&&(N&&Y(n,e,I),K(),null===(o=i)||void 0===o||o())}),[e,I,i,Y,K,N,n]),J=(0,t.useMemo)((()=>[q,...I.reduce(((e,t,n)=>[...e,`${t.value}-${n}`,`${t.value}-${n}-close-icon`]),[])]),[q,I]),{refs:ee,floatingStyles:te,context:ne,getReferenceProps:re,getFloatingProps:ae,getItemProps:ie}=(({open:e,onOpenChange:t,activeIndex:n,setActiveIndex:r,outsidePressIdsToIgnore:a,listRef:i,disabledIndicesRef:o})=>{const{refs:s,floatingStyles:l,context:u}=_o({whileElementsMounted:ni,open:e,onOpenChange:t,placement:"bottom-start",middleware:[pi(10),hi({padding:10}),fi({apply({availableHeight:e,availableWidth:t,elements:n}){n.floating.style.maxHeight=`${Math.min(300,e)}px`,n.floating.style.maxWidth=`${t}px`},padding:10})],strategy:"fixed"}),c=Mo(u,{role:"listbox"}),d=So(u,{outsidePress:e=>{if(e.currentTarget instanceof Element){const n=e.currentTarget;let r=n.id;var t;if("path"===n.nodeName&&(r=(null===(t=n.parentElement)||void 0===t?void 0:t.id)||""),a.includes(r))return!1}return!0}}),p=Ao(u,{listRef:i,activeIndex:n,onNavigate:r,virtual:!0,loop:!0,disabledIndices:o.current}),{getReferenceProps:h,getFloatingProps:f,getItemProps:m}=Eo([c,d,p]);return{refs:s,floatingStyles:l,context:u,getReferenceProps:h,getFloatingProps:f,getItemProps:m}})({open:b,onOpenChange:X,activeIndex:E,setActiveIndex:j,outsidePressIdsToIgnore:J,listRef:H,disabledIndicesRef:W});(0,t.useImperativeHandle)(l,(()=>()=>{var e;return null===(e=ee.domReference.current)||void 0===e?void 0:e.focus()}),[ee.domReference]);const oe=(0,t.useCallback)((e=>{M((t=>t.filter((t=>t.value!==e.value)))),setTimeout((()=>{var e;return null===(e=ee.domReference.current)||void 0===e?void 0:e.focus()}))}),[ee.domReference]),se=(e=>e.flatMap((e=>e.options?[e,...e.options]:[e])))(vE(G(T?"":P,D)));$&&"operator"!==D&&P&&se.push({value:P.trim(),label:P.trim(),isCustom:!0});const le=((e,t,n)=>{let r=182;const a=[],i=[];for(let t=0;t<e.length;t++){var o,s,l,u;a.push(null),(null===(o=e[t])||void 0===o?void 0:o.options)&&i.push(t);let n=null!==(u=null!==(l=e[t].label)&&void 0!==l?l:e[t].value)&&void 0!==u?u:"",c=8;8*n.length<6*((null===(s=e[t].description)||void 0===s?void 0:s.length)||0)&&(n=e[t].description,c=6);const d=(e[t].isCustom?n.length+18:n.length)*c+16;d>r&&(r=d)}return t.current=[...a],n.current=[...i],r})(se,H,W),ue=(0,t.useCallback)(function(){var t,r=(t=function*(t){x(!1),S(!0),w([]);let r=[];try{var a;if("key"===t?r=yield n._getKeys(null):"operator"===t?r=n._getOperators():"value"===t&&(r=yield n._getValuesFor(e)),U.current!==t)return;w(r),(null===(a=r[0])||void 0===a?void 0:a.group)?j(1):j(0)}catch(e){x(!0)}S(!1)},function(){var e=this,n=arguments;return new Promise((function(r,a){var i=t.apply(e,n);function o(e){PC(i,r,a,o,s,"next",e)}function s(e){PC(i,r,a,o,s,"throw",e)}o(void 0)}))});return function(e){return r.apply(this,arguments)}}(),[e,n]),ce=Yo({count:se.length,getScrollElement:()=>ee.floating.current,estimateSize:e=>se[e].description?60:38,overscan:5}),de=(0,t.useCallback)(((t,r)=>{if("Backspace"===t.key&&!P){var i;if("value"===D)return r&&I.length?void M((e=>{const t=[...e];return t.splice(-1,1),t})):void k("operator");null===(i=o)||void 0===i||i(),n._handleComboboxBackspace(e),a&&K()}}),[P,D,n,e,a,I.length,K,o]),pe=(0,t.useCallback)(((t,r)=>{var a,o;"Tab"!==t.key||t.shiftKey||(r&&(t.preventDefault(),Y(n,e,I),null===(o=ee.domReference.current)||void 0===o||o.focus()),null===(a=i)||void 0===a||a(),K())}),[e,I,i,Y,K,n,ee.domReference]),he=(0,t.useCallback)(((t,r)=>{var a;"Tab"===t.key&&t.shiftKey&&(r&&(t.preventDefault(),Y(n,e,I,!0)),null===(a=i)||void 0===a||a(),K())}),[e,I,i,Y,K,n]),fe=(0,t.useCallback)(((t,r)=>{if("Enter"===t.key&&null!=E){if(!se[E])return;const t=se[E];var a;r?(Z(t),C("")):(n._updateFilter(e,bC({filterInputType:D,item:t,filter:e,setFilterMultiValues:M})),wC({populateInputOnEdit:s,item:t,filterInputType:D,setInputValue:C,filter:e}),mC(D,k,i,ee.domReference.current,!Q&&void 0),j(null),Q&&(null===(a=o)||void 0===a||a()))}}),[E,se,Z,n,e,D,s,i,ee.domReference,Q,o]),me=(0,t.useCallback)((e=>{var t;const n=e.label||e.value;M((t=>t.filter((t=>t.value!==e.value)))),R(!0),C(n),null===(t=ee.domReference.current)||void 0===t||t.focus(),setTimeout((()=>{var e;null===(e=ee.domReference.current)||void 0===e||e.select()}))}),[ee.domReference]);var ge;(0,t.useEffect)((()=>{b&&ue(D)}),[b,D]),(0,t.useEffect)((()=>{if(!a){var t,n,r,i;if(B&&(null===(n=e)||void 0===n||null===(t=n.values)||void 0===t?void 0:t.length)){const t=e.values.reduce(((t,n,r)=>{var a;return[...t,{label:(null===(a=e.valueLabels)||void 0===a?void 0:a[r])||n,value:n}]}),[]);M(t)}!B&&s&&(C((null===(i=e)||void 0===i?void 0:i.value)||""),setTimeout((()=>{var e;null===(e=ee.domReference.current)||void 0===e||e.select()}))),null===(r=ee.domReference.current)||void 0===r||r.focus()}}),[]),(0,t.useEffect)((()=>{N&&I&&setTimeout((()=>F({})))}),[I,N]),(0,t.useLayoutEffect)((()=>{U.current&&(U.current=D)}),[D]),(0,t.useLayoutEffect)((()=>{var e,t;null!==E&&ce.range&&(E>(null===(e=ce.range)||void 0===e?void 0:e.endIndex)||E<(null===(t=ce.range)||void 0===t?void 0:t.startIndex))&&ce.scrollToIndex(E)}),[E,ce]);const be=null!==(ge=null===(c=e)||void 0===c?void 0:c.keyLabel)&&void 0!==ge?ge:null===(d=e)||void 0===d?void 0:d.key;return r().createElement("div",{className:A.comboboxWrapper},e?r().createElement("div",{className:A.pillWrapper},(null===(p=e)||void 0===p?void 0:p.key)?r().createElement("div",{className:(0,En.cx)(A.basePill,A.keyPill)},be):null,(null===(h=e)||void 0===h?void 0:h.key)&&(null===(f=e)||void 0===f?void 0:f.operator)&&"operator"!==D?r().createElement("div",{id:q,className:(0,En.cx)(A.basePill,A.operatorPill,q),role:"button","aria-label":"Edit filter operator",tabIndex:0,onClick:e=>{e.stopPropagation(),C(""),gC("operator",k,void 0,ee.domReference.current)},onKeyDown:e=>{he(e,B),"Enter"===e.key&&(C(""),gC("operator",k,void 0,ee.domReference.current))}},e.operator):null,r().createElement("div",{ref:z}),N?I.map(((e,t)=>r().createElement(_C,{key:`${e.value}-${t}`,item:e,index:t,handleRemoveMultiValue:oe,handleEditMultiValuePill:me}))):null):null,r().createElement("input",jC(EC({},re({ref:ee.setReference,onChange:function(e){const t=e.target.value;C(t),j(0),T&&R(!1)},value:P,placeholder:vC(e,D,N,a),"aria-autocomplete":"list",onKeyDown(e){b?("operator"===D&&he(e),de(e,N),pe(e,N),fe(e,N)):y(!0)}})),{className:(0,En.cx)(A.inputStyle,{[A.loadingInputPadding]:!O}),onClick:e=>{e.stopPropagation(),y(!0)},onFocus:()=>{y(!0)}})),O?r().createElement(_n.Spinner,{className:A.loadingIndicator,inline:!0}):null,r().createElement(uo,null,b&&r().createElement(yo,{context:ne,initialFocus:-1,visuallyHiddenDismiss:!0,modal:!1},r().createElement(r().Fragment,null,r().createElement("div",{style:jC(EC({},te),{width:`${_?366:le}px`,transform:N?`translate(${(null===(m=z.current)||void 0===m?void 0:m.getBoundingClientRect().left)||0}px, ${((null===(g=ee.domReference.current)||void 0===g?void 0:g.getBoundingClientRect().bottom)||0)+10}px )`:te.transform}),ref:ee.setFloating,className:A.dropdownWrapper,tabIndex:-1},r().createElement("div",jC(EC({style:{height:`${ce.getTotalSize()||38}px`}},ae()),{tabIndex:-1}),O?r().createElement(cC,null):_?r().createElement(pC,{handleFetchOptions:()=>ue(D)}):se.length||$&&"operator"!==D&&P?ce.getVirtualItems().map((t=>{const a=se[t.index],o=t.index;if(a.options)return r().createElement("div",{key:`${a.label}+${o}`,className:(0,En.cx)(A.optionGroupLabel,A.groupTopBorder),style:{height:`${t.size}px`,transform:`translateY(${t.start}px)`}},r().createElement(_n.Text,{weight:"bold",variant:"bodySmall",color:"secondary"},a.label));const l=se[t.index+1],u=l&&!l.group&&!l.options&&a.group;var c;return r().createElement(lC,jC(EC({},ie({key:`${a.value}-${o}`,ref(e){H.current[o]=e},onClick(t){var r;"value"!==D&&t.stopPropagation(),N?(t.preventDefault(),t.stopPropagation(),Z(a),C(""),null===(r=ee.domReference.current)||void 0===r||r.focus()):(n._updateFilter(e,bC({filterInputType:D,item:a,filter:e,setFilterMultiValues:M})),wC({populateInputOnEdit:s,item:a,filterInputType:D,setInputValue:C,filter:e}),mC(D,k,i,ee.domReference.current,!1))}})),{active:E===o,addGroupBottomBorder:u,style:{height:`${t.size}px`,transform:`translateY(${t.start}px)`},"aria-setsize":se.length,"aria-posinset":t.index+1,isMultiValueEdit:N,checked:I.some((e=>e.value===a.value))}),r().createElement("span",null,a.isCustom?"Use custom value: ":""," ",null!==(c=a.label)&&void 0!==c?c:a.value),a.description?r().createElement("div",{className:A.descriptionText},a.description):null)})):r().createElement(dC,null))),N&&!O&&!_&&se.length?r().createElement(hC,{onApply:()=>{Y(n,e,I)},floatingElement:ee.floating.current,maxOptionWidth:le,menuHeight:Math.min(ce.getTotalSize(),300)}):null))))})),kC=e=>({comboboxWrapper:(0,En.css)({display:"flex",flexWrap:"wrap"}),pillWrapper:(0,En.css)({display:"flex",alignItems:"center",flexWrap:"wrap"}),basePill:(0,En.css)(jC(EC({display:"flex",alignItems:"center",background:e.colors.action.disabledBackground,border:`1px solid ${e.colors.border.weak}`,padding:e.spacing(.125,1,.125,1),color:e.colors.text.primary,overflow:"hidden",whiteSpace:"nowrap",minHeight:e.spacing(2.75)},e.typography.bodySmall),{cursor:"pointer"})),keyPill:(0,En.css)({fontWeight:e.typography.fontWeightBold,cursor:"default"}),operatorPill:(0,En.css)({"&:hover":{background:e.colors.action.hover}}),dropdownWrapper:(0,En.css)({backgroundColor:e.colors.background.primary,color:e.colors.text.primary,boxShadow:e.shadows.z2,overflowY:"auto",zIndex:e.zIndex.dropdown}),inputStyle:(0,En.css)({paddingBlock:0,"&:focus":{outline:"none"}}),loadingIndicator:(0,En.css)({color:e.colors.text.secondary,marginLeft:e.spacing(.5)}),loadingInputPadding:(0,En.css)({paddingRight:e.spacing(2.5)}),optionGroupLabel:(0,En.css)({padding:e.spacing(1),position:"absolute",top:0,left:0,width:"100%"}),groupTopBorder:(0,En.css)({"&:not(:first-child)":{borderTop:`1px solid ${e.colors.border.weak}`}}),descriptionText:(0,En.css)(jC(EC({},e.typography.bodySmall),{color:e.colors.text.secondary,paddingTop:e.spacing(.5)}))});function TC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function RC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){TC(e,t,n[t])}))}return e}function AC({filter:e,model:n,readOnly:a,focusOnWipInputRef:i}){var o,s;const l=(0,_n.useStyles2)(IC),[u,c]=(0,t.useState)(!0),[d,p]=(0,t.useState)(!1),h=(0,t.useRef)(null),[f,m]=(0,t.useState)(!1);var g;const b=null!==(g=e.keyLabel)&&void 0!==g?g:e.key,y=(null===(o=e.valueLabels)||void 0===o?void 0:o.join(", "))||(null===(s=e.values)||void 0===s?void 0:s.join(", "))||e.value,v=(0,t.useCallback)(((e,t)=>{var n;null===(n=e)||void 0===n||n.stopPropagation(),a||(p(null!=t?t:!u),c(!u))}),[a,u]);if((0,t.useEffect)((()=>{var e;d&&(null===(e=h.current)||void 0===e||e.focus(),p(!1))}),[d]),(0,t.useEffect)((()=>{e.forceEdit&&u&&(c(!1),n._updateFilter(e,{forceEdit:void 0}))}),[e,n,u]),(0,t.useEffect)((()=>{u&&m((e=>!e&&e))}),[u]),u){const t=r().createElement("span",{className:l.pillText},b," ",e.operator," ",y);return r().createElement("div",{className:(0,En.cx)(l.combinedFilterPill,{[l.readOnlyCombinedFilter]:a}),onClick:e=>{e.stopPropagation(),m(!0),v()},onKeyDown:e=>{"Enter"===e.key&&(m(!0),v())},role:"button","aria-label":`Edit filter with key ${b}`,tabIndex:0,ref:h},y.length<20?t:r().createElement(_n.Tooltip,{content:r().createElement("div",{className:l.tooltipText},y),placement:"top"},t),a?null:r().createElement(_n.IconButton,{onClick:t=>{t.stopPropagation(),n._removeFilter(e),setTimeout((()=>{var e;return null===(e=i)||void 0===e?void 0:e()}))},onKeyDownCapture:t=>{"Enter"===t.key&&(t.preventDefault(),t.stopPropagation(),n._removeFilter(e),setTimeout((()=>{var e;return null===(e=i)||void 0===e?void 0:e()})))},name:"times",size:"md",className:l.removeButton,tooltip:`Remove filter with key ${b}`}))}return r().createElement(DC,{filter:e,model:n,handleChangeViewMode:v,focusOnWipInputRef:i,populateInputOnEdit:f})}const IC=e=>{return{combinedFilterPill:(0,En.css)((t=RC({display:"flex",alignItems:"center",background:e.colors.action.selected,borderRadius:e.shape.radius.default,border:`1px solid ${e.colors.border.weak}`,padding:e.spacing(.125,0,.125,1),color:e.colors.text.primary,overflow:"hidden",whiteSpace:"nowrap",minHeight:e.spacing(2.75)},e.typography.bodySmall),n={fontWeight:e.typography.fontWeightBold,cursor:"pointer","&:hover":{background:e.colors.action.hover}},n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t)),readOnlyCombinedFilter:(0,En.css)({paddingRight:e.spacing(1),cursor:"text","&:hover":{background:e.colors.action.selected}}),removeButton:(0,En.css)({marginInline:e.spacing(.5),cursor:"pointer","&:hover":{color:e.colors.text.primary}}),pillText:(0,En.css)({maxWidth:"200px",width:"100%",textOverflow:"ellipsis",overflow:"hidden"}),tooltipText:(0,En.css)({textAlign:"center"})};var t,n},MC=(0,t.forwardRef)((function({model:e},n){const{_wip:a}=e.useState();return(0,t.useLayoutEffect)((()=>{a||e._addWip()}),[a]),r().createElement(DC,{model:e,filter:a,isAlwaysWip:!0,ref:n})})),VC=(0,t.memo)((function({model:e}){const{filters:n,readOnly:a}=e.useState(),i=(0,_n.useStyles2)(FC),o=(0,t.useRef)();return r().createElement("div",{className:(0,En.cx)(i.comboboxWrapper,{[i.comboboxFocusOutline]:!a}),onClick:()=>{var e,t;null===(e=(t=o).current)||void 0===e||e.call(t)}},r().createElement(_n.Icon,{name:"filter",className:i.filterIcon,size:"lg"}),n.map(((t,n)=>r().createElement(AC,{key:`${n}-${t.key}`,filter:t,model:e,readOnly:a,focusOnWipInputRef:o.current}))),a?null:r().createElement(MC,{model:e,ref:o}))})),FC=e=>({comboboxWrapper:(0,En.css)({display:"flex",flexWrap:"wrap",alignItems:"center",columnGap:e.spacing(1),rowGap:e.spacing(.5),minHeight:e.spacing(4),backgroundColor:e.components.input.background,border:`1px solid ${e.colors.border.strong}`,borderRadius:e.shape.radius.default,paddingInline:e.spacing(1),paddingBlock:e.spacing(.5),flexGrow:1}),comboboxFocusOutline:(0,En.css)({"&:focus-within":{outline:"2px dotted transparent",outlineOffset:"2px",boxShadow:`0 0 0 2px ${e.colors.background.canvas}, 0 0 0px 4px ${e.colors.primary.main}`,transitionTimingFunction:"cubic-bezier(0.19, 1, 0.22, 1)",transitionDuration:"0.2s",transitionProperty:"outline, outline-offset, box-shadow",zIndex:2}}),filterIcon:(0,En.css)({color:e.colors.text.secondary,alignSelf:"center"})});function LC(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function $C(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){LC(i,r,a,o,s,"next",e)}function s(e){LC(i,r,a,o,s,"throw",e)}o(void 0)}))}}function zC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){zC(e,t,n[t])}))}return e}const NC=[{value:"=",description:"Equals"},{value:"!=",description:"Not equal"},{value:"=|",description:"One of. Use to filter on multiple values.",isMulti:!0},{value:"!=|",description:"Not one of. Use to exclude multiple values.",isMulti:!0},{value:"=~",description:"Matches regex"},{value:"!~",description:"Does not match regex"},{value:"<",description:"Less than"},{value:">",description:"Greater than"}];class qC extends $v{setState(e){let t=!1;e.filters&&e.filters!==this.state.filters&&!e.filterExpression&&(e.filterExpression=HC(this.state.expressionBuilder,e.filters),t=e.filterExpression!==this.state.filterExpression),super.setState(e),t&&this.publishEvent(new Cx(this),!0)}updateFilters(e,t){var n,r;let a,i=!1;e&&e!==this.state.filters&&(a=HC(this.state.expressionBuilder,e),i=a!==this.state.filterExpression),super.setState({filters:e,filterExpression:a}),(i&&!0!==(null===(n=t)||void 0===n?void 0:n.skipPublish)||(null===(r=t)||void 0===r?void 0:r.forcePublish))&&this.publishEvent(new Cx(this),!0)}getValue(){return this.state.filterExpression}_updateFilter(e,t){const{filters:n,_wip:r}=this.state;if(e===r)return void("value"in t&&""!==t.value?this.setState({filters:[...n,BC({},r,t)],_wip:void 0}):this.setState({_wip:BC({},e,t)}));const a=this.state.filters.map((n=>n===e?BC({},n,t):n));this.setState({filters:a})}_removeFilter(e){e!==this.state._wip?this.setState({filters:this.state.filters.filter((t=>t!==e))}):this.setState({_wip:void 0})}_removeLastFilter(){const e=this.state.filters.at(-1);e&&this._removeFilter(e)}_handleComboboxBackspace(e){if(this.state.filters.length){let t=this.state.filters.length-1;e!==this.state._wip&&(t=-1),this.setState({filters:this.state.filters.reduce(((n,r,a)=>{return a===t?[...n,(i=BC({},r),o={forceEdit:!0},o=null!=o?o:{},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(o)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(o)).forEach((function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(o,e))})),i)]:r===e?n:[...n,r];var i,o}),[])})}}_getKeys(e){var t=this;return $C((function*(){var n,r;const a=yield null===(n=(r=t.state).getTagKeysProvider)||void 0===n?void 0:n.call(r,t,e);if(a&&a.replace)return bE(a.values).map(UC);if(t.state.defaultKeys)return t.state.defaultKeys.map(UC);const i=yield t._dataSourceSrv.get(t.state.datasource,t._scopedVars);if(!i||!i.getTagKeys)return[];var o;const s=t.state.filters.filter((t=>t.key!==e)).concat(null!==(o=t.state.baseFilters)&&void 0!==o?o:[]),l=UE.getTimeRange(t).state.value,u=t.state.useQueriesAsFilterForOptions?pE(t):void 0,c=yield i.getTagKeys(BC({filters:s,queries:u,timeRange:l},FP(t)));yE(c)&&t.setState({error:c.error.message});let d=bE(c);a&&(d=d.concat(bE(a.values)));const p=t.state.tagKeyRegexFilter;return p&&(d=d.filter((e=>e.text.match(p)))),d.map(UC)}))()}_getValuesFor(e){var t=this;return $C((function*(){var n,r;const a=yield null===(n=(r=t.state).getTagValuesProvider)||void 0===n?void 0:n.call(r,t,e);if(a&&a.replace)return bE(a.values).map(UC);const i=yield t._dataSourceSrv.get(t.state.datasource,t._scopedVars);if(!i||!i.getTagValues)return[];var o;const s=t.state.filters.filter((t=>t.key!==e.key)).concat(null!==(o=t.state.baseFilters)&&void 0!==o?o:[]),l=UE.getTimeRange(t).state.value,u=t.state.useQueriesAsFilterForOptions?pE(t):void 0,c=yield i.getTagValues(BC({key:e.key,filters:s,timeRange:l,queries:u},FP(t)));yE(c)&&t.setState({error:c.error.message});let d=bE(c);return a&&(d=d.concat(bE(a.values))),d.map(UC)}))()}_addWip(){this.setState({_wip:{key:"",value:"",operator:"=",condition:""}})}_getOperators(){return(this.state.supportsMultiValueOperators?NC:NC.filter((e=>!e.isMulti))).map((({value:e,description:t})=>({label:e,value:e,description:t})))}constructor(e){var t,n;super(BC({type:"adhoc",name:null!==(t=e.name)&&void 0!==t?t:"Filters",filters:[],datasource:null,applyMode:"auto",filterExpression:null!==(n=e.filterExpression)&&void 0!==n?n:HC(e.expressionBuilder,e.filters)},e)),zC(this,"_scopedVars",{__sceneObject:NP(this)}),zC(this,"_dataSourceSrv",(0,d.getDataSourceSrv)()),zC(this,"_urlSync",new aC(this)),"auto"===this.state.applyMode&&function(e){var t;if(e.addActivationHandler((()=>(xP.add(e),()=>xP.delete(e)))),_P)return;const n=(0,d.getTemplateSrv)();(null===(t=n)||void 0===t?void 0:t.getAdhocFilters)?(_P=n.getAdhocFilters,n.getAdhocFilters=function(e){if(0===xP.size)return _P.call(n,e);const t=(0,d.getDataSourceSrv)().getInstanceSettings(e);if(!t)return[];for(const e of xP.values()){var r;if((null===(r=e.state.datasource)||void 0===r?void 0:r.uid)===t.uid)return e.state.filters}return[]}.bind(n)):console.log("Failed to patch getAdhocFilters")}(this)}}function HC(e,t){return(null!=e?e:lE)(null!=t?t:[])}zC(qC,"Component",(function({model:e}){const{filters:t,readOnly:n,addFilterButtonText:a}=e.useState(),i=(0,_n.useStyles2)(WC);return"combobox"===e.state.layout?r().createElement(VC,{model:e}):r().createElement("div",{className:i.wrapper},t.map(((t,n)=>r().createElement(r().Fragment,{key:n},r().createElement(tC,{filter:t,model:e})))),!n&&r().createElement(rC,{model:e,key:"'builder",addFilterButtonText:a}))}));const WC=e=>({wrapper:(0,En.css)({display:"flex",flexWrap:"wrap",alignItems:"flex-end",columnGap:e.spacing(2),rowGap:e.spacing(1)})});function UC(e){const{text:t,value:n}=e,r={label:t,value:String(null!=n?n:t)};return"group"in e&&(r.group=e.group),r}function GC(e){return""!==e.key&&""!==e.operator&&""!==e.value}function QC(e){const t=NC.find((t=>t.value===e));return!!t&&Boolean(t.isMulti)}function KC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class YC{getMergedStream(e){(function(e,t){if(e.length!==t.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!0;return!1})(e,this._prevLayers)&&(this._resultsMap=new Map,this._prevLayers=e);const t=e.map((e=>e.getResultsStream())),n=[];for(const t of e)n.push(t.activate());return(0,D.merge)(t).pipe((0,D.mergeAll)(),(0,D.filter)((e=>this._resultsMap.get(e.origin.state.key)!==e)),(0,D.map)((e=>(this._resultsMap.set(e.origin.state.key,e),this._resultsMap.values()))),(0,D.finalize)((()=>{n.forEach((e=>e()))})))}constructor(){KC(this,"_resultsMap",new Map),KC(this,"_prevLayers",[])}}function ZC(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function XC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){XC(e,t,n[t])}))}return e}function eE(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}let tE=100;function nE(){return"SQR"+tE++}class rE extends $v{getResultsStream(){return this._results}_onActivate(){if(this.isQueryModeAuto()){const e=UE.getTimeRange(this),t=this.getClosestExtraQueryProviders();for(const e of t)this._subs.add(e.subscribeToState(((t,n)=>{e.shouldRerun(n,t,this.state.queries)&&this.runQueries()})));this.subscribeToTimeRangeChanges(e),this.shouldRunQueriesOnActivate()&&this.runQueries()}return this._dataLayersSub||this._handleDataLayers(),()=>this._onDeactivate()}_handleDataLayers(){const e=UE.getDataLayers(this);0!==e.length&&(this._dataLayersSub=this._dataLayersMerger.getMergedStream(e).subscribe(this._onLayersReceived.bind(this)))}_onLayersReceived(t){var n,r,a;const i=UE.getTimeRange(this),{dataLayerFilter:o}=this.state;let s,l=[],u=[];for(const n of t)for(let t of n.data.series){var c,d;(null===(c=t.meta)||void 0===c?void 0:c.dataTopic)===e.DataTopic.Annotations&&(l=l.concat(t)),(null===(d=t.meta)||void 0===d?void 0:d.dataTopic)===e.DataTopic.AlertStates&&(u=u.concat(t))}if((null===(n=o)||void 0===n?void 0:n.panelId)&&(l.length>0&&(l=function(e,t){if(!Array.isArray(e)||0===e.length)return e;const n=Array.from({length:e.length},(()=>new Set));let r=0;for(const i of e){for(let e=0;e<i.length;e++){if(n[r].has(e))continue;let o=!0;const s=i.fields.find((e=>"panelId"===e.name)),l=i.fields.find((e=>"source"===e.name));if(l){s&&"dashboard"===l.values[e].type&&(o=[t.panelId,SP].includes(s.values[e]));const n=l.values[e].filter;if(n){var a;const e=[...null!==(a=n.ids)&&void 0!==a?a:[],SP].includes(t.panelId);n.exclude?e&&(o=!1):e||(o=!1)}}o&&n[r].add(e)}r++}const i=[];r=0;for(const t of e){const e=n[r].size,a=[];for(const e of t.fields){const i=[];for(let a=0;a<t.length;a++)n[r].has(a)&&i.push(e.values[a]);a.push(OP(wP({},e),{values:i}))}i.push(OP(wP({},t),{fields:a,length:e})),r++}return i}(l,o)),u.length>0))for(const t of u){const n=new e.DataFrameView(t);for(const e of n)if(e.panelId===o.panelId){s=e;break}}if(iE(l)&&iE(this._layerAnnotations)&&(0,ge.isEqual)(s,null===(r=this.state.data)||void 0===r?void 0:r.alertState))return;this._layerAnnotations=l;const p=this.state.data?this.state.data:eE(JC({},hx),{timeRange:i.state.value});var h;this.setState({data:eE(JC({},p),{annotations:[...null!==(h=this._resultAnnotations)&&void 0!==h?h:[],...l],alertState:null!=s?s:null===(a=this.state.data)||void 0===a?void 0:a.alertState})})}onVariableUpdatesCompleted(){this.isQueryModeAuto()&&this.runQueries()}onAnyVariableChanged(e){this._adhocFiltersVar!==e&&this._groupByVar!==e&&this.isQueryModeAuto()&&(e instanceof qC&&this._isRelevantAutoVariable(e)&&this.runQueries(),e instanceof GP&&this._isRelevantAutoVariable(e)&&this.runQueries())}_isRelevantAutoVariable(e){var t,n,r;const a=null!==(r=this.state.datasource)&&void 0!==r?r:aE(this.state.queries);return"auto"===e.state.applyMode&&(null===(t=a)||void 0===t?void 0:t.uid)===(null===(n=e.state.datasource)||void 0===n?void 0:n.uid)}shouldRunQueriesOnActivate(){return this._variableValueRecorder.hasDependenciesChanged(this)?(uP("SceneQueryRunner","Variable dependency changed while inactive, shouldRunQueriesOnActivate returns true"),!0):!this.state.data||!!this._isDataTimeRangeStale(this.state.data)}_isDataTimeRangeStale(e){const t=UE.getTimeRange(this).state.value,n=e.timeRange;return(t.from.unix()!==n.from.unix()||t.to.unix()!==n.to.unix())&&(uP("SceneQueryRunner","Data time range is stale"),!0)}_onDeactivate(){var e;this._querySub&&(this._querySub.unsubscribe(),this._querySub=void 0),this._dataLayersSub&&(this._dataLayersSub.unsubscribe(),this._dataLayersSub=void 0),null===(e=this._timeSub)||void 0===e||e.unsubscribe(),this._timeSub=void 0,this._timeSubRange=void 0,this._adhocFiltersVar=void 0,this._groupByVar=void 0,this._variableValueRecorder.recordCurrentDependencyValuesForSceneObject(this)}setContainerWidth(e){!this._containerWidth&&e>0?(this._containerWidth=e,this.state.maxDataPointsFromWidth&&!this.state.maxDataPoints&&setTimeout((()=>{this.isActive&&!this.state._hasFetchedData&&this.runQueries()}),0)):e>0&&(this._containerWidth=e)}isDataReadyToDisplay(){return Boolean(this.state._hasFetchedData)}subscribeToTimeRangeChanges(e){this._timeSubRange!==e&&(this._timeSub&&this._timeSub.unsubscribe(),this._timeSubRange=e,this._timeSub=e.subscribeToState((()=>{this.runWithTimeRange(e)})))}runQueries(){const e=UE.getTimeRange(this);this.isQueryModeAuto()&&this.subscribeToTimeRangeChanges(e),this.runWithTimeRange(e)}getMaxDataPoints(){return this.state.maxDataPoints?this.state.maxDataPoints:this.state.maxDataPointsFromWidth&&null!==(e=this._containerWidth)&&void 0!==e?e:500;var e}cancelQuery(){var e;null===(e=this._querySub)||void 0===e||e.unsubscribe(),this._dataLayersSub&&(this._dataLayersSub.unsubscribe(),this._dataLayersSub=void 0),this.setState({data:eE(JC({},this.state.data),{state:Ae.Done})})}runWithTimeRange(e){var t,n=this;return(t=function*(){var t,r,a;if(!n.state.maxDataPoints&&n.state.maxDataPointsFromWidth&&!n._containerWidth)return;if(n._dataLayersSub||n._handleDataLayers(),null===(t=n._querySub)||void 0===t||t.unsubscribe(),n._variableDependency.hasDependencyInLoadingState())return uP("SceneQueryRunner","Variable dependency is in loading state, skipping query execution"),void n.setState({data:eE(JC({},null!==(a=n.state.data)&&void 0!==a?a:hx),{state:Ae.Loading})});const{queries:i}=n.state;if(null===(r=i)||void 0===r?void 0:r.length)try{var o;const t=null!==(o=n.state.datasource)&&void 0!==o?o:aE(i),r=yield pP(t,n._scopedVars);n.findAndSubscribeToAdHocFilters(r.uid);const a=(0,d.getRunRequest)(),{primary:s,secondaries:l,processors:u}=n.prepareRequests(e,r);uP("SceneQueryRunner","Starting runRequest",n.state.key);let c=a(r,s);if(l.length>0){const e=l.map((e=>a(r,e))),t=yP(u);c=(0,D.forkJoin)([c,...e]).pipe(t)}c=c.pipe(PP({type:"data",request:s,origin:n,cancel:()=>n.cancelQuery()})),n._querySub=c.subscribe(n.onDataReceived)}catch(e){console.error("PanelQueryRunner Error",e),n.onDataReceived(eE(JC({},hx,n.state.data),{state:Ae.Error,errors:[(0,d.toDataQueryError)(e)]}))}else n._setNoDataState()},function(){var e=this,n=arguments;return new Promise((function(r,a){var i=t.apply(e,n);function o(e){ZC(i,r,a,o,s,"next",e)}function s(e){ZC(i,r,a,o,s,"throw",e)}o(void 0)}))})()}clone(e){const t=super.clone(e);var n;return this._resultAnnotations&&(t._resultAnnotations=this._resultAnnotations.map((e=>JC({},e)))),this._layerAnnotations&&(t._layerAnnotations=this._layerAnnotations.map((e=>JC({},e)))),t._variableValueRecorder=this._variableValueRecorder.cloneAndRecordCurrentValuesForSceneObject(this),t._containerWidth=this._containerWidth,t._results.next({origin:this,data:null!==(n=this.state.data)&&void 0!==n?n:hx}),t}prepareRequests(t,n){const{minInterval:r,queries:a}=this.state;let i=JC({app:"scenes",requestId:nE(),timezone:t.getTimeZone(),range:t.state.value,interval:"1s",intervalMs:1e3,targets:(0,ge.cloneDeep)(a),maxDataPoints:this.getMaxDataPoints(),scopedVars:this._scopedVars,startTime:Date.now(),liveStreaming:this.state.liveStreaming,rangeRaw:{from:t.state.from,to:t.state.to},cacheTimeout:this.state.cacheTimeout,queryCachingTTL:this.state.queryCachingTTL},function(e){const t=e.getRoot();return function(e){return"enrichDataRequest"in e}(t)?t.enrichDataRequest(e):null}(this));this._adhocFiltersVar&&(i.filters=this._adhocFiltersVar.state.filters.filter(GC)),this._groupByVar&&(i.groupByKeys=this._groupByVar.state.value),i.targets=i.targets.map((e=>{var t;return e.datasource&&(e.datasource.uid===n.uid||(null===(t=n.meta)||void 0===t?void 0:t.mixed)||!d.isExpressionReference||(0,d.isExpressionReference)(e.datasource))||(e.datasource=n.getRef()),e}));const o=r?NE(this,r):n.interval,s=e.rangeUtil.calculateInterval(t.state.value,i.maxDataPoints,o);i.scopedVars=Object.assign({},i.scopedVars,{__interval:{text:s.interval,value:s.interval},__interval_ms:{text:s.intervalMs.toString(),value:s.intervalMs}}),i.interval=s.interval,i.intervalMs=s.intervalMs;const l=t.state.value;let u=[],c=new Map;var p;for(const e of null!==(p=this.getClosestExtraQueryProviders())&&void 0!==p?p:[])for(const{req:t,processor:n}of e.getExtraQueries(i)){const e=nE();u.push(eE(JC({},t),{requestId:e})),c.set(e,null!=n?n:bP)}return i.range=l,{primary:i,secondaries:u,processors:c}}_combineDataLayers(e){return this._layerAnnotations&&this._layerAnnotations.length>0&&(e.annotations=(e.annotations||[]).concat(this._layerAnnotations)),this.state.data&&this.state.data.alertState&&(e.alertState=this.state.data.alertState),e}_setNoDataState(){this.state.data!==hx&&this.setState({data:hx})}getClosestExtraQueryProviders(){const e=new Map;return this.parent?(Nv(this.parent,(t=>(mP(t)&&!e.has(t.constructor)&&e.set(t.constructor,t),t.forEachChild((t=>{mP(t)&&!e.has(t.constructor)&&e.set(t.constructor,t)})),null))),Array.from(e.values())):[]}findAndSubscribeToAdHocFilters(e){const t=function(e){for(const n of xP.values()){var t;if(NE(n,null===(t=n.state.datasource)||void 0===t?void 0:t.uid)===e)return n}}(e);this._adhocFiltersVar!==t&&(this._adhocFiltersVar=t,this._updateExplicitVariableDependencies());const n=function(e){for(const n of CP.values()){var t;if(NE(n,null===(t=n.state.datasource)||void 0===t?void 0:t.uid)===e)return n}}(e);this._groupByVar!==n&&(this._groupByVar=n,this._updateExplicitVariableDependencies())}_updateExplicitVariableDependencies(){const e=[];this._adhocFiltersVar&&e.push(this._adhocFiltersVar.state.name),this._groupByVar&&e.push(this._groupByVar.state.name),this._variableDependency.setVariableNames(e)}isQueryModeAuto(){var e;return"auto"===(null!==(e=this.state.runQueriesMode)&&void 0!==e?e:"auto")}constructor(t){super(t),XC(this,"_querySub",void 0),XC(this,"_dataLayersSub",void 0),XC(this,"_dataLayersMerger",new YC),XC(this,"_timeSub",void 0),XC(this,"_timeSubRange",void 0),XC(this,"_containerWidth",void 0),XC(this,"_variableValueRecorder",new fP),XC(this,"_results",new D.ReplaySubject(1)),XC(this,"_scopedVars",{__sceneObject:NP(this)}),XC(this,"_layerAnnotations",void 0),XC(this,"_resultAnnotations",void 0),XC(this,"_adhocFiltersVar",void 0),XC(this,"_groupByVar",void 0),XC(this,"_variableDependency",new xE(this,{statePaths:["queries","datasource"],onVariableUpdateCompleted:this.onVariableUpdatesCompleted.bind(this),onAnyVariableChanged:this.onAnyVariableChanged.bind(this)})),XC(this,"onDataReceived",(t=>{const n=(0,e.preProcessPanelData)(t,this.state.data);this._resultAnnotations=t.annotations;const r=this._combineDataLayers(n);let a=this.state._hasFetchedData;a||n.state===Ae.Loading||(a=!0),this.setState({data:r,_hasFetchedData:a}),this._results.next({origin:this,data:r})})),this.addActivationHandler((()=>this._onActivate()))}}function aE(e){var t,n;return null!==(n=null===(t=e.find((e=>null!==e.datasource)))||void 0===t?void 0:t.datasource)&&void 0!==n?n:void 0}function iE(e){if(!e)return!0;for(let t=0;t<e.length;t++)if(e[t].length>0)return!1;return!0}function oE(e,t){return e===t||(0,ge.isEqual)(e,t)}function sE(e){try{return JSON.stringify(e,(()=>{const e=new WeakSet;return(t,n)=>{if("object"==typeof n&&null!==n){if(e.has(n))return;e.add(n)}return n}})())}catch(e){console.error(e)}return""}function lE(e){return e.map((e=>function(e){let t="",n=e.operator;var r;if("=|"===n)n="=~",t=null===(r=e.values)||void 0===r?void 0:r.map(cE).join("|");else if("!=|"===n){var a;n="!~",t=null===(a=e.values)||void 0===a?void 0:a.map(cE).join("|")}else t="=~"===n||"!~"===n?cE(e.value):uE(e.value);return`${e.key}${n}"${t}"`}(e))).join(",")}function uE(e){return e.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function cE(e){return uE(function(e){return e.replace(dE,"\\$&")}(e))}const dE=/[*+?()|\\.\[\]{}^$]/g;function pE(e){var t;const n=UE.findAllObjects(e.getRoot(),(e=>e instanceof rE)),r=UE.interpolate(e,null===(t=e.state.datasource)||void 0===t?void 0:t.uid),a=function(e){const t={};for(const n of e)n.state.key&&(n.state.key in t||(t[n.state.key]=[]),t[n.state.key].push(n));return Object.values(t).flatMap((e=>{const t=e.filter((e=>e.isActive));return 0===t.length&&1===e.length?e:t}))}(n).filter((t=>{var n;return UE.interpolate(e,null===(n=t.state.datasource)||void 0===n?void 0:n.uid)===r}));if(0===a.length)return[];const i=[];return a.forEach((e=>{i.push(...e.state.queries)})),i}function hE(e){return null==e?"":/\|/g[Symbol.replace](e,"__gfp__")}function fE(e){return null==e?"":/,/g[Symbol.replace](e,"__gfc__")}function mE(e){return null==e?"":(e=/__gfp__/g[Symbol.replace](e,"|"),e=/__gfc__/g[Symbol.replace](e,","))}function gE(e,t){return t&&e!==t?[e,t].map(fE).join(","):fE(e)}function bE(e){return Array.isArray(e)?e:e.data}function yE(e){return!Array.isArray(e)&&Boolean(e.error)}function vE(e){const t=[],n=new Map;for(const r of e){const e=r.group;if(e){let a=n.get(e);a||(a=[],n.set(e,a),t.push({label:e,options:a})),a.push(r)}else t.push(r)}return t}function wE(e,t=1e4){const n=new Ll,r=Array.from({length:Math.min(t,e.length)},((e,t)=>t));return a=>{if(""===a)return r;const[i,o,s]=n.search(e,a);if(i){if(o&&s){const e=Array(Math.min(s.length,t));for(let t=0;t<e.length;t++)e[t]=o.idx[s[t]];return e}return i.slice(0,t)}return[]}}function OE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class SE extends $v{getValue(){return this.state.value}constructor(e){var t,n;super((t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){OE(e,t,n[t])}))}return e}({type:"constant",value:"",name:""},e),n=null!=(n={skipUrlSync:!0})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t))}}function _E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class xE{hasDependencyOn(e){return this.getNames().has(e)}variableUpdateCompleted(t,n){const r=this.getNames();let a=!1;(r.has(t.state.name)||r.has(e.DataLinkBuiltInVars.includeVars))&&n&&(a=!0),uP("VariableDependencyConfig","variableUpdateCompleted",t.state.name,a,this._isWaitingForVariables),this._options.onAnyVariableChanged&&this._options.onAnyVariableChanged(t),this._options.onVariableUpdateCompleted&&(this._isWaitingForVariables||a)&&this._options.onVariableUpdateCompleted(),a&&(this._options.onReferencedVariableValueChanged&&this._options.onReferencedVariableValueChanged(t),this._options.onReferencedVariableValueChanged||this._options.onVariableUpdateCompleted||this._sceneObject.forceRender())}hasDependencyInLoadingState(){return UE.hasVariableDependencyInLoadingState(this._sceneObject)?(this._isWaitingForVariables=!0,!0):(this._isWaitingForVariables=!1,!1)}getNames(){const e=this._state,t=this._state=this._sceneObject.state;if(!e)return this.scanStateForDependencies(this._state),this._dependencies;if(t!==e)if(this._statePaths){for(const n of this._statePaths)if("*"===n||t[n]!==e[n]){this.scanStateForDependencies(t);break}}else this.scanStateForDependencies(t);return this._dependencies}setVariableNames(e){this._options.variableNames=e,this.scanStateForDependencies(this._state)}setPaths(e){this._statePaths=e}scanStateForDependencies(e){if(this._dependencies.clear(),this.scanCount+=1,this._options.variableNames)for(const e of this._options.variableNames)this._dependencies.add(e);if(this._statePaths)for(const t of this._statePaths){if("*"===t){this.extractVariablesFrom(e);break}{const n=e[t];n&&this.extractVariablesFrom(n)}}}extractVariablesFrom(e){Nx.lastIndex=0;const t=("string"!=typeof e?sE(e):e).matchAll(Nx);if(t)for(const e of t){const[,t,n,,r]=e,a=t||n||r;this._dependencies.add(a)}}handleTimeMacros(){this._sceneObject.addActivationHandler((()=>{const e=UE.getTimeRange(this._sceneObject).subscribeToState(((e,t)=>{const n=this.getNames(),r=n.has("__from"),a=n.has("__to"),i=n.has("__timezone");if(e.value!==t.value)if(r){const t=new SE({name:"__from",value:e.from});this.variableUpdateCompleted(t,!0)}else if(a){const t=new SE({name:"__to",value:e.to});this.variableUpdateCompleted(t,!0)}if(e.timeZone!==t.timeZone&&i){const t=new SE({name:"__timezone",value:e.timeZone});this.variableUpdateCompleted(t,!0)}}));return()=>e.unsubscribe()}))}constructor(e,t){_E(this,"_sceneObject",void 0),_E(this,"_options",void 0),_E(this,"_state",void 0),_E(this,"_dependencies",void 0),_E(this,"_statePaths",void 0),_E(this,"_isWaitingForVariables",void 0),_E(this,"scanCount",void 0),this._sceneObject=e,this._options=t,this._dependencies=new Set,this._isWaitingForVariables=!1,this.scanCount=0,this._statePaths=t.statePaths,this._options.handleTimeMacros&&this.handleTimeMacros()}}const PE=e=>Boolean(e.metricFindQuery)&&!Boolean(e.variables),CE=t=>{if(!t.variables)return!1;if(t.variables.getType()!==e.VariableSupportType.Standard)return!1;const n=t.variables;return"toDataQuery"in n&&Boolean(n.toDataQuery)},EE=t=>{if(!t.variables)return!1;if(t.variables.getType()!==e.VariableSupportType.Custom)return!1;const n=t.variables;return"query"in n&&"editor"in n&&Boolean(n.query)&&Boolean(n.editor)},jE=t=>!!t.variables&&t.variables.getType()===e.VariableSupportType.Datasource;function DE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){DE(e,t,n[t])}))}return e}function TE(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}class RE{getTarget(e){if(CE(this.datasource))return this.datasource.variables.toDataQuery(function(e){var t;const n=null!==(t=e.state.query)&&void 0!==t?t:"";return"string"==typeof n?{query:n,refId:`variable-${e.state.name}`}:null==n.refId?TE(kE({},n),{refId:`variable-${e.state.name}`}):e.state.query}(e));throw new Error("Couldn't create a target with supplied arguments.")}runRequest(e,t){return CE(this.datasource)?this.datasource.variables.query?this._runRequest(this.datasource,t,this.datasource.variables.query.bind(this.datasource.variables)):this._runRequest(this.datasource,t):VE()}constructor(e,t=(0,d.getRunRequest)()){DE(this,"datasource",void 0),DE(this,"_runRequest",void 0),this.datasource=e,this._runRequest=t}}class AE{getTarget(e){if(PE(this.datasource))return e.state.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({variable:t,searchFilter:n},r){return PE(this.datasource)?(0,D.from)(this.datasource.metricFindQuery(t.state.query,TE(kE({},r),{variable:{name:t.state.name,type:t.state.type},searchFilter:n}))).pipe((0,D.mergeMap)((t=>{if(!t||!t.length)return VE();const n=t;return(0,D.of)({series:n,state:e.LoadingState.Done,timeRange:r.range})}))):VE()}constructor(e){DE(this,"datasource",void 0),this.datasource=e}}class IE{getTarget(e){if(EE(this.datasource))return e.state.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest(e,t){return EE(this.datasource)?this.datasource.variables.query?this._runRequest(this.datasource,t,this.datasource.variables.query.bind(this.datasource.variables)):this._runRequest(this.datasource,t):VE()}constructor(e,t=(0,d.getRunRequest)()){DE(this,"datasource",void 0),DE(this,"_runRequest",void 0),this.datasource=e,this._runRequest=t}}class ME{getTarget(e){var t;if(jE(this.datasource))return"string"==typeof e.state.query?e.state.query:TE(kE({},e.state.query),{refId:null!==(t=e.state.query.refId)&&void 0!==t?t:"variable-query"});throw new Error("Couldn't create a target with supplied arguments.")}runRequest(e,t){return jE(this.datasource)?this._runRequest(this.datasource,t,this.datasource.query):VE()}constructor(e,t=(0,d.getRunRequest)()){DE(this,"datasource",void 0),DE(this,"_runRequest",void 0),this.datasource=e,this._runRequest=t}}function VE(){return(0,D.of)({state:e.LoadingState.Done,series:[],timeRange:(0,e.getDefaultTimeRange)()})}const FE=(e,t)=>{const n=[];let r=null;t.lastIndex=0;do{r=t.exec(e),r&&n.push(r)}while(t.global&&r&&""!==r[0]&&void 0!==r[0]);return n};function LE(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function $E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class zE extends Qx{getValueOptions(t){return this.state.query?(this.setState({loading:!0,error:null}),(0,D.from)(pP(this.state.datasource,{__sceneObject:NP(this)})).pipe((0,D.mergeMap)((n=>{const r=function(e){if(CE(e))return new RE(e,(0,d.getRunRequest)());if(PE(e))return new AE(e);if(EE(e))return new IE(e);if(jE(e))return new ME(e);throw new Error(`Couldn't create a query runner for datasource ${e.type}`)}(n),a=r.getTarget(this),i=this.getRequest(a,t.searchFilter);return r.runRequest({variable:this,searchFilter:t.searchFilter},i).pipe(PP({type:"variable",request:i,origin:this}),(0,D.filter)((t=>t.state===e.LoadingState.Done||t.state===e.LoadingState.Error)),(0,D.take)(1),(0,D.mergeMap)((t=>t.state===e.LoadingState.Error?(0,D.throwError)((()=>t.error)):(0,D.of)(t))),(t=>t.pipe((0,D.map)((t=>{const n=t.series;if(!n||!n.length)return[];if(function(t){if(!t)return!1;if(!t.length)return!0;const n=t[0];if((0,e.isDataFrame)(n))return!1;for(const e in n){if(!n.hasOwnProperty(e))continue;if(null!==n[e]&&"string"!=typeof n[e]&&"number"!=typeof n[e])continue;const t=e.toLowerCase();if("text"===t||"value"===t)return!0}return!1}(n))return n;if(0===n[0].fields.length)return[];const r=(0,e.getProcessedDataFrames)(n),a=[];let i=-1,o=-1,s=-1,l=-1;for(const t of r)for(let r=0;r<t.fields.length;r++){const a=t.fields[r],u=(0,e.getFieldDisplayName)(a,t,n).toLowerCase();a.type===e.FieldType.string&&-1===s&&(s=r),"text"===u&&a.type===e.FieldType.string&&-1===o&&(o=r),"value"===u&&a.type===e.FieldType.string&&-1===i&&(i=r),"expandable"!==u||a.type!==e.FieldType.boolean&&a.type!==e.FieldType.number||-1!==l||(l=r)}if(-1===s)throw new Error("Couldn't find any field of type string in the results.");for(const e of n)for(let t=0;t<e.length;t++){const n=-1!==l?e.fields[l].values.get(t):void 0,r=e.fields[s].values.get(t),u=-1!==o?e.fields[o].values.get(t):"",c=-1!==i?e.fields[i].values.get(t):"";-1!==i||-1!==o?-1!==i||-1===o?-1===i||-1!==o?a.push({text:u,value:c,expandable:n}):a.push({text:c,value:c,expandable:n}):a.push({text:u,value:u,expandable:n}):a.push({text:r,value:r,expandable:n})}return a})))),(0,D.mergeMap)((t=>{let n="";return this.state.regex&&(n=UE.interpolate(this,this.state.regex,void 0,"regex")),(0,D.of)(function(t,n,r){let a,i=[];t&&(a=(0,e.stringToJsRegex)(t));for(let e=0;e<r.length;e++){const t=r[e];var o,s;let n=null!==(s=null!==(o=t.text)&&void 0!==o?o:t.value)&&void 0!==s?s:"";var l,u;let w=null!==(u=null!==(l=t.value)&&void 0!==l?l:t.text)&&void 0!==u?u:"";if((0,ge.isNumber)(w)&&(w=w.toString()),(0,ge.isNumber)(n)&&(n=n.toString()),a){const e=FE(w,a);if(!e.length)continue;const t=e.find((e=>e.groups&&e.groups.value)),r=e.find((e=>e.groups&&e.groups.text)),o=e.find((e=>e.length>1)),s=e.length>1&&o;if(t||r){var c,d,p,h,f,m,g,b,y,v;w=null!==(y=null===(d=t)||void 0===d||null===(c=d.groups)||void 0===c?void 0:c.value)&&void 0!==y?y:null===(h=r)||void 0===h||null===(p=h.groups)||void 0===p?void 0:p.text,n=null!==(v=null===(m=r)||void 0===m||null===(f=m.groups)||void 0===f?void 0:f.text)&&void 0!==v?v:null===(b=t)||void 0===b||null===(g=b.groups)||void 0===g?void 0:g.value}else{if(s){for(let t=0;t<e.length;t++){const n=e[t];i.push({label:n[1],value:n[1]})}continue}o&&(n=o[1],w=o[1])}}i.push({label:n,value:w})}return i=(0,ge.uniqBy)(i,"value"),((t,n)=>{if(n===e.VariableSort.disabled)return t;const r=e=>{if(!e.text)return-1;const t=e.text.match(/.*?(\d+).*/);return!t||t.length<2?-1:parseInt(t[1],10)},a=e=>e.sort(((e,t)=>e.text?t.text?e.text.localeCompare(t.text,void 0,{numeric:!0}):1:-1));switch(n){case e.VariableSort.alphabeticalAsc:t=(0,ge.sortBy)(t,"label");break;case e.VariableSort.alphabeticalDesc:t=(0,ge.sortBy)(t,"label").reverse();break;case e.VariableSort.numericalAsc:t=(0,ge.sortBy)(t,r);break;case e.VariableSort.numericalDesc:t=(t=(0,ge.sortBy)(t,r)).reverse();break;case e.VariableSort.alphabeticalCaseInsensitiveAsc:t=(0,ge.sortBy)(t,(e=>(0,ge.toLower)(e.label)));break;case e.VariableSort.alphabeticalCaseInsensitiveDesc:t=(t=(0,ge.sortBy)(t,(e=>(0,ge.toLower)(e.label)))).reverse();break;case e.VariableSort.naturalAsc||7:t=a(t);break;case e.VariableSort.naturalDesc||8:t=(t=a(t)).reverse()}return t})(i,n)}(n,this.state.sort,t))})),(0,D.catchError)((e=>e.cancelled?(0,D.of)([]):(0,D.throwError)((()=>e)))))})))):(0,D.of)([])}getRequest(t,n){const r={__sceneObject:NP(this)};n&&(r.__searchFilter={value:n,text:n});const a=UE.getTimeRange(this).state.value;return{app:e.CoreApp.Dashboard,requestId:M(),timezone:"",range:a,interval:"",intervalMs:0,targets:[t],scopedVars:r,startTime:Date.now()}}constructor(t){super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){$E(e,t,n[t])}))}return e}({type:"query",name:"",value:"",text:"",options:[],datasource:null,regex:"",query:"",refresh:e.VariableRefresh.onDashboardLoad,sort:e.VariableSort.disabled},t)),$E(this,"_variableDependency",new xE(this,{statePaths:["regex","query","datasource"]})),$E(this,"onSearchChange",(e=>{sE(this.state.query).indexOf("__searchFilter")>-1&&this._updateOptionsBasedOnSearchFilter(e)}));var n=this;$E(this,"_updateOptionsBasedOnSearchFilter",(0,ge.debounce)(function(){var e,t=(e=function*(e){const t=yield(0,D.lastValueFrom)(n.getValueOptions({searchFilter:e}));n.setState({options:t,loading:!1})},function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){LE(i,r,a,o,s,"next",e)}function s(e){LE(i,r,a,o,s,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}(),400))}}function BE(e){var t;return null!==(t=Nv(e,(e=>e.state.$data)))&&void 0!==t?t:Sx}function NE(e,t,n,r,a){return""===t||null==t?"":sP(e,t,n,r,a)}function qE(e,t,n,r){if(t(e))return e;let a=null;return e.forEachChild((e=>{if(e===n)return;let r=qE(e,t);r&&(a=r)})),a||(r&&e.parent?qE(e.parent,t,e,!0):null)}function HE(e,t){return qE(e,t,void 0,!0)}function WE(e,t){const n=[];return e.forEachChild((e=>{t(e)&&n.push(e),n.push(...WE(e,t))})),n}$E(zE,"Component",(({model:e})=>function(e){return e.state.isMulti?r().createElement(AP,{model:e}):r().createElement(RP,{model:e})}(e)));const UE={getVariables:function(e){var t;return null!==(t=Nv(e,(e=>e.state.$variables)))&&void 0!==t?t:xx},getData:BE,getTimeRange:Px,getLayout:function(e){return Nv(e,(e=>function(e){return"isDraggable"in e}(e)?e:void 0))||null},getDataLayers:function(e,t=!1){let n=e,r=[];for(;n;){const e=n.state.$data;if(e){if(lP(e)?r=r.concat(e):e.state.$data&&lP(e.state.$data)&&(r=r.concat(e.state.$data)),t&&r.length>0)break;n=n.parent}else n=n.parent}return r},interpolate:NE,lookupVariable:dx,hasVariableDependencyInLoadingState:function(e){if(!e.variableDependency)return!1;for(const t of e.variableDependency.getNames()){if(e instanceof zE&&e.state.name===t){console.warn("Query variable is referencing itself");continue}const n=dx(t,e);if(n&&n.parent.isVariableLoadingOrWaitingToUpdate(n))return!0}return!1},findByKey:function(e,t){const n=HE(e,(e=>e.state.key===t));if(!n)throw new Error("Unable to find scene with key "+t);return n},findByKeyAndType:function(e,t,n){const r=HE(e,(e=>e.state.key===t));if(!r)throw new Error("Unable to find scene with key "+t);if(!(r instanceof n))throw new Error(`Found scene object with key ${t} does not match type ${n.name}`);return r},findObject:HE,findAllObjects:WE,getAncestor:function(e,t){let n=e;for(;n;){if(n instanceof t)return n;n=n.parent}if(!n)throw new Error("Unable to find parent of type "+t.name);return n},findDescendents:function(e,t){function n(e){return e instanceof t}return WE(e,n).filter(n)},getQueryController:function(e){let t=e;for(;t;){if(t.state.$behaviors)for(const e of t.state.$behaviors)if("isQueryController"in e)return e;t=t.parent}},getUrlSyncManager:function(e){let t=e;for(;t;){if("urlSyncManager"in t.state)return t.state.urlSyncManager;t=t.parent}}};class GE extends e.BusEventWithPayload{}function QE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KE(e){return new wb((t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){QE(e,t,n[t])}))}return e}({},e),n=null!=(n={subTitle:"A simple demo stress testing url sync",$timeRange:new Xe,controls:[new Zm({}),new dg({})],$data:Ey({},{maxDataPoints:50}),tabs:[new wb({title:"First",url:`${e.url}/first`,getScene:()=>new Vf({controls:[new Ih({})],$variables:new $h({variables:[new Gh({name:"env",query:"test, dev, prod"})]}),body:new Ag({direction:"column",children:[new Ig({body:fy().setTitle("Fill height").build()}),new Ig({body:new YE({})})]})})}),new wb({title:"Second",url:`${e.url}/manual`,getScene:()=>new Vf({controls:[new Ih({})],$variables:new $h({variables:[new Gh({name:"env",query:"test, dev, prod"})]}),body:new Ag({direction:"column",children:[new Ig({body:fy().setTitle("Fill height").build()})]})})})]})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t));var t,n}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(GE,"type","new-scene-object-added");class YE extends re{addScene(){const e=new Gm({controls:[new Rg,new Ih({}),new Zm({}),new dg({})],$timeRange:new Xe,$variables:new $h({variables:[new Gh({name:"env",query:"test, dev, prod",label:"env (local scene override)"})]}),$data:Ey({},{maxDataPoints:50}),title:"Nested scene added on parent activation",body:new Ag({direction:"column",children:[new Ig({body:fy().setTitle("Fill height").build()})]})});this.publishEvent(new GE(e),!0),this.setState({scene:e})}constructor(e){super(e),QE(this,"onToggle",(()=>{this.state.scene?this.setState({scene:void 0}):this.addScene()})),this.addActivationHandler((()=>{this.addScene()}))}}QE(YE,"Component",(({model:e})=>{const{scene:t}=e.useState();return r().createElement(_n.Stack,{direction:"column",flex:"1"},r().createElement(_n.Button,{variant:"secondary",onClick:e.onToggle},"Toggle sub view"),t&&r().createElement(t.Component,{model:t}))}));var ZE=h(494),XE=Object.defineProperty,JE=Object.defineProperties,ej=Object.getOwnPropertyDescriptors,tj=Object.getOwnPropertySymbols,nj=Object.prototype.hasOwnProperty,rj=Object.prototype.propertyIsEnumerable,aj=(e,t,n)=>t in e?XE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ij=(e,t)=>{for(var n in t||(t={}))nj.call(t,n)&&aj(e,n,t[n]);if(tj)for(var n of tj(t))rj.call(t,n)&&aj(e,n,t[n]);return e},oj=(e,t)=>JE(e,ej(t));const sj=[{label:"1x",value:1},{label:"4x",value:4},{label:"10x",value:10}];class lj extends re{constructor(e){super(ij({trainingLookbackFactorOptions:sj},e)),this._urlSync=new Be(this,{keys:["discoverSeasonalities","interval","trainingLookbackFactor"]})}getExtraQueries(t){var n;const r=[];if(this.state.interval){const{to:a,from:i}=t.range,o=a.diff(i),s=(0,e.dateTime)(a).subtract(null!=(n=this.state.trainingLookbackFactor)?n:4*o);r.push({req:oj(ij({},t),{range:{from:s,to:a,raw:{from:s,to:a}}}),processor:uj(this)})}return r}shouldRerun(e,t){const n=void 0!==e.interval,r=void 0!==t.interval;return!(t.pinned&&r||n===r&&e.trainingLookbackFactor===t.trainingLookbackFactor&&e.interval===t.interval&&e.discoverSeasonalities===t.discoverSeasonalities&&e.pinned===t.pinned)}getUrlState(){var e,t,n;return{interval:null==(e=this.state.interval)?void 0:e.toString(),discoverSeasonalities:null==(t=this.state.discoverSeasonalities)?void 0:t.toString(),trainingLookbackFactor:null==(n=this.state.trainingLookbackFactor)?void 0:n.toString()}}onIntervalChanged(e){this.setState({interval:e})}onDiscoverSeasonalitiesChanged(e){this.setState({discoverSeasonalities:e})}onFactorChanged(e){this.setState({trainingLookbackFactor:e})}onClearFactor(){this.setState({trainingLookbackFactor:void 0})}onPinnedChanged(e){this.setState({pinned:e})}setLatestData(e){this.latestData=e}updateFromUrl(e){if(!e.trainingLookbackFactor&&!e.interval)return;let t,n,r;"string"==typeof e.trainingLookbackFactor?t=parseInt(e.trainingLookbackFactor,10):e.trainingLookbackFactor instanceof Array&&(t=parseInt(e.trainingLookbackFactor[0],10)),"string"==typeof e.interval?n=parseInt(e.interval,10):e.interval instanceof Array&&(n=parseInt(e.interval[0],10)),"string"==typeof e.discoverSeasonalities?r="true"===e.discoverSeasonalities:e.discoverSeasonalities instanceof Array&&(r="true"===e.discoverSeasonalities[0]);const a={};t&&(sj.find((({value:e})=>e===t))?a.trainingLookbackFactor=t:a.trainingLookbackFactor=4),a.interval=n||.95,a.discoverSeasonalities=r||!1,this.setState(a)}}lj.Component=function({model:e}){const t=(0,_n.useStyles2)(fj),{discoverSeasonalities:n,interval:a,pinned:i}=e.useState(),o=()=>{e.onIntervalChanged(void 0===a?.95:void 0),void 0!==a&&e.onPinnedChanged(!1)},s=void 0===a||i?(0,En.cx)(t.slider,t.disabled):t.slider;return r().createElement(_n.ButtonGroup,null,r().createElement(_n.ToolbarButton,{variant:"canvas",tooltip:"Enable baselining",onClick:e=>{e.stopPropagation(),e.preventDefault(),o()}},r().createElement(_n.Checkbox,{label:" ",value:void 0!==a,onClick:o}),"Baseline"),r().createElement("div",{className:s},r().createElement(_n.Slider,{onAfterChange:t=>{e.onIntervalChanged(t)},min:.01,max:.99,step:.01,value:null!=a?a:.95})),r().createElement(_n.ToolbarButton,{variant:"canvas",disabled:void 0===a||i,tooltip:"Discover seasonalities",onClick:t=>{t.stopPropagation(),t.preventDefault(),e.onDiscoverSeasonalitiesChanged(!n)},isHighlighted:null!=n&&n,icon:"gf-interpolation-smooth",iconSize:"sm",iconOnly:!0,className:t.discoverSeasonalitiesButton}),r().createElement(_n.ToolbarButton,{disabled:void 0===a,variant:"canvas",tooltip:"Pin baseline results",onClick:t=>{t.stopPropagation(),t.preventDefault(),e.onPinnedChanged(!i)},isHighlighted:null!=i&&i,icon:"gf-pin",iconSize:"sm",iconOnly:!0}))};const uj=t=>(n,r)=>{if(void 0===t.state.interval)return(0,D.of)(r);if(t.state.pinned&&t.latestData)return(0,D.of)(t.latestData);const{interval:a,discoverSeasonalities:i,onAnomalyDetected:o}=t.state,s=Hu.getTimeRange(t),l=r.series.map((t=>{const n=function(t,n,r,a=!1,i,o){var s,l;const u=function(t){const n=t.fields.findIndex((t=>t.type===e.FieldType.time)),r=t.fields.findIndex((t=>t.type===e.FieldType.number));return!(t.fields.length<2||t.fields[0].values.length<10||-1===n||-1===r)&&{numFieldIdx:r,timeFieldIdx:n}}(t);if(!u)return t;const c=t.fields[u.numFieldIdx],d=t.fields[u.timeFieldIdx],p=d.values.at(-1)-d.values.at(0),h=d.values.at(1)-d.values.at(0),f=new Float64Array(c.values),m=a?Array.from((0,ZE.hF)(f)):[],g=new Uint32Array([...dj(p,h,r),...m]);if(0===g.length)return t;const b=(0,ZE.jL)(g,{impute:!0});b.fit(f);const y=b.predictInSample(n);let v=Array.from(y.point),w=y.intervals?Array.from(y.intervals.lower):void 0,O=y.intervals?Array.from(y.intervals.upper):void 0,S=p/h+1,_=pj(S,h,d.values.at(0));if(void 0!==i){const{from:e,to:t}=i,r=_.findIndex((t=>t>=e.valueOf()));let a=_.findIndex((e=>e>=t.valueOf()));-1===a&&(a=_.length);const o=a-r;S=(t.valueOf()-e.valueOf())/h+1;const s=S-o;if(_=_.slice(r,a),v=v.slice(r,a),w=w?w.slice(r,a):void 0,O=O?O.slice(r,a):void 0,s>0){const e=b.predict(s,n);_=pj(S,h,_[0]),v=v.concat(Array.from(e.point)),w&&O&&e.intervals&&(w=w.concat(Array.from(e.intervals.lower)),O=O.concat(Array.from(e.intervals.upper)))}}if(void 0!==o&&w&&O)for(let e=0;e<v.length;e++){const t=v[e],n=w[e],r=O[e];t<n?o({direction:"lower",idx:e,time:_[e],field:c}):t>r&&o({direction:"upper",idx:e,time:_[e],field:c})}return{fields:hj(null!=(l=null!=(s=c.config.displayNameFromDS)?s:t.name)?l:c.name,d,_,v,w,O),length:_.length}}(t,a,void 0,i,s.state.value,o);return oj(ij({},t),{meta:oj(ij({},t.meta),{baseline:{isBaselineTrainingQuery:!0,origRefId:t.refId}}),refId:`${t.refId}-baseline-training`,fields:n.fields})})),u=oj(ij({},r),{series:l});return t.setLatestData(u),(0,D.of)(u)},cj=Object.values({hourly:36e5,daily:864e5,weekly:6048e5,yearly:31536e6});function dj(t,n,r){const a=(null!=r?r:[]).map((t=>(0,e.durationToMilliseconds)(t)));return cj.concat(a).filter((e=>e<t/2)).map((e=>Math.floor(e/n))).filter((e=>e>1))}function pj(e,t,n){return Array.from({length:e},((e,r)=>r*t+n))}function hj(t,n,r,a,i,o){const s=[oj(ij({},n),{values:r}),{name:`${t} - baseline`,type:e.FieldType.number,values:a,config:{displayNameFromDS:`${t} - baseline`,color:{fixedColor:"blue",mode:ec.Fixed}}}];return i&&o&&(s.push({name:`${t} - lower`,type:e.FieldType.number,values:i,config:{displayNameFromDS:`${t} - lower`,color:{fixedColor:"blue",mode:ec.Fixed},custom:{lineWidth:1,hideFrom:{viz:!1,tooltip:!1,legend:!0}}}}),s.push({name:`${t} - upper`,type:e.FieldType.number,values:o,config:{displayNameFromDS:`${t} - upper`,color:{fixedColor:"blue",mode:ec.Fixed},custom:{fillBelowTo:`${t} - lower`,lineWidth:1,hideFrom:{viz:!1,tooltip:!1,legend:!0}}}})),s}function fj(e){return{disabled:En.css`
      & > div {
        opacity: 0.2;
      }
    `,slider:En.css`
      display: flex;
      width: 120px;
      align-items: center;
      border: 1px solid ${e.colors.secondary.border};
      & > div {
        .rc-slider {
          margin: auto 16px;
        }
        .rc-slider + div {
          display: none;
        }
      }
    `,discoverSeasonalitiesButton:En.css`
      padding-left: calc(1px / 8);
      padding-right: 1px;
    `}}var mj=Object.defineProperty,gj=Object.defineProperties,bj=Object.getOwnPropertyDescriptors,yj=Object.getOwnPropertySymbols,vj=Object.prototype.hasOwnProperty,wj=Object.prototype.propertyIsEnumerable,Oj=(e,t,n)=>t in e?mj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Sj=(e,t)=>{for(var n in t||(t={}))vj.call(t,n)&&Oj(e,n,t[n]);if(yj)for(var n of yj(t))wj.call(t,n)&&Oj(e,n,t[n]);return e};const _j=[{label:"1x",value:1},{label:"4x",value:4},{label:"10x",value:10}];class xj extends re{constructor(e){super(Sj({lookbackFactorOptions:_j},e)),this._urlSync=new Be(this,{keys:["changepointLookbackFactor","changepointEnabled"]})}getExtraQueries(t){var n;const r=[];if(this.state.enabled){const{to:o,from:s}=t.range,l=o.diff(s),u=(0,e.dateTime)(o).subtract(null!=(n=this.state.lookbackFactor)?n:4*l);r.push({req:(a=Sj({},t),i={range:{from:u,to:o,raw:{from:u,to:o}}},gj(a,bj(i))),processor:Pj(this)})}var a,i;return r}shouldRerun(e,t){return e.enabled!==t.enabled}getUrlState(){var e,t;return{changepointLookbackFactor:null==(e=this.state.lookbackFactor)?void 0:e.toString(),changepointEnabled:null==(t=this.state.enabled)?void 0:t.toString()}}onEnabledChanged(e){this.setState({enabled:e})}onFactorChanged(e){this.setState({lookbackFactor:e})}onClearFactor(){this.setState({lookbackFactor:void 0})}updateFromUrl(e){if(!e.changepointLookbackFactor&&!e.changepointEnabled)return;let t,n;"string"==typeof e.changepointLookbackFactor?t=parseInt(e.changepointLookbackFactor,10):e.changepointLookbackFactor instanceof Array&&(t=parseInt(e.changepointLookbackFactor[0],10)),"string"==typeof e.changepointEnabled?n="true"===e.changepointEnabled:"number"==typeof e.changepointEnabled&&(n=1===e.changepointEnabled);const r={};t&&(_j.find((({value:e})=>e===t))?r.lookbackFactor=t:r.lookbackFactor=4),n&&(r.enabled=n),this.setState(r)}}xj.Component=function({model:e}){const{enabled:t}=e.useState(),n=t=>{e.onEnabledChanged(t)};return r().createElement(_n.ButtonGroup,null,r().createElement(_n.ToolbarButton,{variant:"canvas",tooltip:"Enable changepoint detection",onClick:e=>{e.stopPropagation(),e.preventDefault(),n(!t)}},r().createElement(_n.Checkbox,{label:" ",value:null!=t&&t,onClick:()=>n(!t)}),"Changepoints"))};const Pj=t=>(n,r)=>{const a=r.series.map((n=>function(t,n){const r=[],a=[],i=t.fields.find((t=>t.type===e.FieldType.time));if(!i)return{fields:[],length:0};for(const o of t.fields){if(o.type!==e.FieldType.number)continue;const t=ZE.R1.defaultArgpcp(),s=new Float64Array(o.values),l=t.detectChangepoints(s);for(const e of l.indices){const t=i.values[e+1];r.push(t),a.push("Changepoint detected"),null==n||n({idx:e+1,time:t,field:o})}}return{fields:[{name:"time",type:e.FieldType.time,values:r,config:{}},{name:"text",type:e.FieldType.string,values:a,config:{}}],length:r.length,meta:{dataTopic:ye.Annotations}}}(n,t.state.onChangepointDetected)));return(0,D.of)({timeRange:r.timeRange,series:[],state:r.state,annotations:a})};var Cj=Object.defineProperty,Ej=Object.defineProperties,jj=Object.getOwnPropertyDescriptors,Dj=Object.getOwnPropertySymbols,kj=Object.prototype.hasOwnProperty,Tj=Object.prototype.propertyIsEnumerable,Rj=(e,t,n)=>t in e?Cj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Aj=(e,t)=>{for(var n in t||(t={}))kj.call(t,n)&&Rj(e,n,t[n]);if(Dj)for(var n of Dj(t))Tj.call(t,n)&&Rj(e,n,t[n]);return e},Ij=(e,t)=>Ej(e,jj(t));class Mj extends re{constructor(e){super(e),this._urlSync=new Be(this,{keys:["outlierSensitivity","outlierAddAnnotations"]})}onSensitivityChanged(e){this.setState({sensitivity:e})}onAddAnnotationsChanged(e){this.setState({addAnnotations:e})}onPinnedChanged(e){this.setState({pinned:e})}setLatestData(e){this.latestData=e}getExtraQueries(t){const{sensitivity:n}=this.state;return void 0===n?[]:[{req:Ij(Aj({},t),{targets:[]}),processor:(t,r)=>{var a,i,o;if(this.state.pinned&&void 0!==this.latestData)return(0,D.of)(this.latestData);const s=t.series,l=(0,e.outerJoinDataFrames)({frames:s});if(void 0===l)return(0,D.of)(t);void 0!==this.detector&&(null==(a=t.request)?void 0:a.requestId)===this.lastRequestId?this.detector.updateDetector({dbscan:{sensitivity:n}}):this.detector=function(t,n){const r=t.fields.filter((t=>t.type===e.FieldType.number)),a=r[0].values.length,i=new Float64Array(r.flatMap((e=>e.values)));return ZE.hW.dbscan({sensitivity:n}).preprocess(i,a)}(l,n),this.lastRequestId=null==(i=t.request)?void 0:i.requestId;const u=function(t,n,r,a,i){var o,s;const l=r.fields.filter((t=>t.type===e.FieldType.number)),u=r.fields[0].values.length,c=t.detect();if(void 0!==i){const e=0;for(const t of c.seriesResults)for(const n of t.outlierIntervals)i({series:e,start:r.fields[0].values[n.start],end:r.fields[0].values[null!=(o=n.end)?o:u-1]})}const d=1/Math.sqrt(1+(null!=(s=l.length)?s:0)/2),p=e.colorManipulator.alpha("#FFFFFF",d),h=[];if(a){const t=c.seriesResults.flatMap((e=>e.outlierIntervals.map((e=>r.fields[0].values[e.start])))),n=c.seriesResults.flatMap((e=>e.outlierIntervals.map((e=>{var t;return r.fields[0].values[null!=(t=e.end)?t:u-1]})))),a=c.seriesResults.flatMap(((e,t)=>e.outlierIntervals.map((e=>`Outlier detected in series ${l[t].name}`))));h.push({fields:[{name:"time",type:e.FieldType.time,values:t,config:{}},{name:"timeEnd",type:e.FieldType.time,values:n,config:{}},{name:"text",type:e.FieldType.string,values:a,config:{}},{name:"isRegion",type:e.FieldType.boolean,values:Array(t.length).fill(!0),config:{}}],length:t.length,meta:{dataTopic:ye.Annotations}})}return Ij(Aj({},n),{series:[Ij(Aj({},r),{fields:[r.fields[0],...r.fields.slice(1).map(((e,t)=>Ij(Aj({},e),{config:Aj(Aj({},e.config),c.outlyingSeries.includes(t)?{color:{fixedColor:"#f5b73d",mode:ec.Fixed}}:{color:{fixedColor:p,mode:ec.Fixed}})}))),{name:"clusterMin",type:e.FieldType.number,values:c.clusterBand.min,config:{displayNameFromDS:"Cluster Min",color:{fixedColor:"gray",mode:ec.Fixed},custom:{lineWidth:0,hideFrom:{viz:!1,tooltip:!1,legend:!0}}}},{name:"clusterMax",type:e.FieldType.number,values:c.clusterBand.max,config:{displayNameFromDS:"Cluster Max",color:{fixedColor:"gray",mode:ec.Fixed},custom:{fillBelowTo:"Cluster Min",lineWidth:0,hideFrom:{viz:!1,tooltip:!1,legend:!0}}}}]})],annotations:h})}(this.detector,t,l,null==(o=this.state.addAnnotations)||o,this.state.onOutlierDetected);return this.setLatestData(u),(0,D.of)(u)}}]}shouldRerun(e,t){return!t.pinned&&(e.sensitivity!==t.sensitivity||e.addAnnotations!==t.addAnnotations||e.pinned!==t.pinned)}getUrlState(){var e,t;return{outlierSensitivity:null==(e=this.state.sensitivity)?void 0:e.toString(),outlierAddAnnotations:null==(t=this.state.addAnnotations)?void 0:t.toString()}}updateFromUrl(e){if(!e.outlierSensitivity&&!e.outlierAddAnnotations)return;let t,n;"string"==typeof e.outlierSensitivity&&(t=parseFloat(e.outlierSensitivity)),"string"==typeof e.outlierAddAnnotations&&(n="true"===e.outlierAddAnnotations);const r={};r.sensitivity=t||.5,r.addAnnotations=n||!0,this.setState(r)}}function Vj(e){return{disabled:En.css`
      & > div {
        opacity: 0.2;
      }
    `,slider:En.css`
      display: flex;
      width: 120px;
      align-items: center;
      border: 1px solid ${e.colors.secondary.border};
      & > div {
        .rc-slider {
          margin: auto 16px;
        }
        .rc-slider + div {
          display: none;
        }
      }
    `}}function Fj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Fj(e,t,n[t])}))}return e}Mj.Component=function({model:e}){const t=(0,_n.useStyles2)(Vj),{addAnnotations:n,pinned:a,sensitivity:i}=e.useState(),o=()=>{e.onSensitivityChanged(void 0===i?.5:void 0)},s=void 0===i||a?(0,En.cx)(t.slider,t.disabled):t.slider;return r().createElement(_n.ButtonGroup,null,r().createElement(_n.ToolbarButton,{variant:"canvas",tooltip:"Enable outlier detection",onClick:e=>{e.stopPropagation(),e.preventDefault(),o()}},r().createElement(_n.Checkbox,{label:" ",value:void 0!==i,onClick:o}),"Outliers"),r().createElement("div",{className:s},r().createElement(_n.Slider,{onAfterChange:t=>{e.onSensitivityChanged(t)},min:.01,max:.99,step:.01,value:null!=i?i:.5})),r().createElement(_n.ToolbarButton,{disabled:void 0===i||a,variant:"canvas",tooltip:"Add outlier annotations",onClick:t=>{t.stopPropagation(),t.preventDefault(),e.onAddAnnotationsChanged(!(null==n||n))},isHighlighted:null==n||n,icon:"ellipsis-v",iconSize:"sm",iconOnly:!0}),r().createElement(_n.ToolbarButton,{disabled:void 0===i,variant:"canvas",tooltip:"Pin outlier detection results",onClick:t=>{t.stopPropagation(),t.preventDefault(),e.onPinnedChanged(!a)},isHighlighted:null!=a&&a,icon:"gf-pin",iconSize:"sm",iconOnly:!0}))},(0,ZE.Ay)().then((()=>console.debug("Grafana ML initialized")));const $j=[112,118,132,129,121,135,148,148,136,119,104,118,115,126,141,135,125,149,170,170,158,133,114,140,145,150,178,163,172,178,199,199,184,162,146,166,171,180,193,181,183,218,230,242,209,191,172,194,196,196,236,235,229,243,264,272,237,211,180,201,204,188,235,227,234,264,302,293,259,229,203,229,242,233,267,269,270,315,364,347,312,274,237,278,284,277,317,313,318,374,413,405,355,306,271,306,315,301,356,348,355,422,465,467,404,347,305,336,340,318,362,348,363,435,491,505,404,359,310,337,360,342,406,396,420,472,548,559,463,407,362,405,417,391,419,461,472,535,622,606,508,461,390,432,1e4,10001,1e4,10000.2].join(","),zj=[13067.3,13130.5,13198.4,13254.2,13303.7,13353.9,13409.3,13459.2,13504.5,13552.6,13614.3,13669.5,13722.6,13772.1,13832,13862.6,13893,13926.8,13968.9,14004.7,14033.1,14066,14110.1,14155.6,14192.2,14231.7,14281.5,14330.3,14359.3,14396.6,14430.8,14478.4,14515.7,14554.9,14602.5,14646.4,14695.4,14746.6,14807.4,14874.4,14923.3,14988.7,15054.1,15121.7,15184.2,15239.3,15288.9,15346.2,15393.5,15439,15483.5,15531.5,15579.4,15628.5,15677.3,15736.7,15788.3,15839.7,15900.6,15961.5,16018.3,16076.9,16139,16203,16263.3,16327.9,16398.9,16478.3,16538.2,16621.6,16697,16777.2,16833.1,16891.6,16956.8,17026.3,17085.4,17106.9,17169.4,17239.4,17292,17354.2,17414.2,17447.3,17482.6,17526,17568.7,17627.1,17661.5].join(","),Bj=[10,7.4,7.166666666666667,8.666666666666666,6,7,7,8.857142857142858,14,11,15.714285714285714,14,15.833333333333334,12.833333333333334,14.714285714285714,13.833333333333334,16.5,13.833333333333334,12.5,11.285714285714286,11.2,9.5,14,13.833333333333334,12.25,12.666666666666666,12.857142857142858,14.833333333333334,14.125,14.714285714285714,16.2,16,16.285714285714285,18,17.428571428571427,16.625,16.666666666666668,15.6,14,15.428571428571429,15.25,15.875,15.333333333333334,16.285714285714285,17.333333333333332,19.166666666666668,14.428571428571429,13.666666666666666,15.6,15.857142857142858,17.714285714285715,20,20.5,17.428571428571427,16.857142857142858,16.875,17.857142857142858,20.8,19.428571428571427].join(","),Nj=[Array.from({length:100},(()=>100*Math.random())),Array.from({length:100},(()=>100*Math.random())),[...Array.from({length:49},(()=>100*Math.random())),...Array.from({length:2},(()=>1e3*Math.random())),...Array.from({length:49},(()=>100*Math.random()))]];function qj(e,t){return new Cl(Lj({queries:[{refId:"A",datasource:l,scenarioId:"predictable_csv_wave",csvWave:[Lj({timeStep:600,valuesCSV:"0,0,0.5,1,2,2,1,1,0.5,0.3"},e)]}]},t))}function Hj(e){return new wb((t=Lj({},e),n=null!=(n={subTitle:"Time series demos",getScene:()=>new Vf({$data:qj({},{maxDataPointsFromWidth:!1}),$timeRange:new Xe({from:"now-48h",to:"now"}),controls:[new Rg,new Zm({}),new Eg({key:"top"})],key:"Flex layout embedded scene",body:new Ag({direction:"column",children:[new Ag({direction:"row",wrap:"wrap",children:[new Ig({minWidth:"100%",minHeight:300,body:fy().setTitle("Outlier data").setData(new Cl({queries:Nj.map(((e,t)=>({refId:String.fromCharCode(65+t),datasource:l,scenarioId:"predictable_csv_wave",csvWave:[{timeStep:600,valuesCSV:e.join(",")}]}))),maxDataPointsFromWidth:!0})).setHeaderActions([new Mj({sensitivity:.5})]).build()}),new Ig({minWidth:"100%",minHeight:300,body:fy().setTitle("Simple wave").setData(qj({},{maxDataPointsFromWidth:!0})).setHeaderActions([new lj({interval:.95})]).build()}),new Ig({minWidth:"100%",minHeight:300,body:fy().setTitle("Spikey data with changepoints").setData(qj({valuesCSV:$j},{maxDataPointsFromWidth:!0})).setHeaderActions([new lj({}),new xj({enabled:!0})]).build()}),new Ig({minWidth:"100%",minHeight:300,body:fy().setTitle("Realistic repeated series").setData(qj({valuesCSV:Bj},{maxDataPointsFromWidth:!0})).setHeaderActions([new lj({interval:.95})]).build()}),new Ig({minWidth:"100%",minHeight:300,body:fy().setTitle("Sawtooth data").setData(qj({valuesCSV:zj},{maxDataPointsFromWidth:!0})).setHeaderActions([new lj({interval:.95})]).build()})]})]})})})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t));var t,n}function Wj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Uj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Wj(e,t,n[t])}))}return e}function Gj(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Qj(e){return new wb(Gj(Uj({},e),{subTitle:"Illustrating how events traverse the scene graph",getScene:()=>{const e=Array.from("ABC"),t=new Kj({key:"parentScene",children:[...e.map((e=>new Kj({key:e}))),new Kj({key:"SUB",children:e.map((e=>new Kj({key:`SUB-${e}`})))})]});return new Vf({key:"The Embedded Scene",body:t})}}))}class Kj extends re{constructor(e){const t=e.$behaviors||[],n=e.children||[];super(Gj(Uj({},e),{children:n,$behaviors:[...t,Yj]}))}}Wj(Kj,"Component",(function({model:e}){var n,a;const{key:i,children:o,recentEvent:s}=e.useState(),[l,u]=r().useState(!1);(0,t.useEffect)((()=>e.subscribeToEvent(Zj,(e=>{u(!0),setTimeout((()=>u(!1)),500)})).unsubscribe),[e,u]);const c=(0,_n.useTheme2)(),d=null===(n=e.parent)||void 0===n?void 0:n.useState();return r().createElement("div",{style:{border:`${c.colors.border.strong} 4px solid`,borderRadius:8,padding:4,margin:8}},r().createElement("h2",null,"I am: ",r().createElement("em",null,i)),r().createElement("h4",null,"My parent is: ",r().createElement("em",null,null===(a=d)||void 0===a?void 0:a.key)),r().createElement(_n.Stack,{direction:"column",alignItems:"flex-start"},r().createElement(_n.Button,{fullWidth:!1,onClick:()=>e.publishEvent(new Zj(`Bubble by ${i}`),!0)},"Bubble"),r().createElement(_n.Button,{onClick:()=>e.publishEvent(new Zj(`Non-bubble by ${i}`),!1)},"Non-Bubble"),r().createElement(_n.Button,{onClick:()=>e.setState({recentEvent:""})},"Clear"),r().createElement(_n.Button,{onClick:()=>Hu.findDescendents(e,Kj).forEach((e=>e.setState({recentEvent:""})))},"Clear Descendents")),r().createElement("div",{style:{margin:4,border:`${c.colors.border.weak} solid 2px`,transitionDuration:"200ms",background:l?c.colors.action.selected:c.colors.background.primary,transform:l?"scale(1.0, 1.5)":""}},s&&r().createElement(r().Fragment,null,r().createElement("h3",null,"Event:"),r().createElement("h5",null,s))),o.length>0&&r().createElement("div",{style:{border:`${c.colors.border.medium} 3px solid`,borderRadius:4,padding:4,margin:4,display:"inline-block"}},"Children of ",i,":",r().createElement(_n.Stack,null,o.map((e=>r().createElement(e.Component,{key:e.state.key,model:e}))))))}));const Yj=e=>{e.subscribeToEvent(Zj,(t=>{e.setState({recentEvent:t.payload})}))};class Zj extends e.BusEventWithPayload{}function Xj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Xj(e,t,n[t])}))}return e}function eD(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function tD(e){return new wb(eD(Jj({},e),{subTitle:"Test panel series limit feature",getScene:()=>new Vf(eD(Jj({},jy()),{body:new Bg({children:[new fd({title:"Many series",pluginId:"timeseries",seriesLimit:20,$data:Ey({seriesCount:50})})]})}))}))}function nD(){return[{title:"Flex layout",getPage:nv},{title:"Responsive layout",getPage:nw},{title:"Panel menu",getPage:Sv},{title:"Panel context",getPage:yv},{title:"Repeat layout by series",getPage:Cv},{title:"Repeat layout by variable",getPage:AS},{title:"Grid layout",getPage:ov},{title:"Grid with rows",getPage:cv},{title:"Lazy load",getPage:fv},{title:"Variables",getPage:lw},{title:"Adhoc filters",getPage:xO},{title:"Group by (static)",getPage:DO},{title:"Group by (datasource)",getPage:AO},{title:"With drilldowns",getPage:Cw},{title:"Query editor",getPage:Xv},{title:"Dynamic page",getPage:Yy},{title:"Runtime panel plugin",getPage:My},{title:"Runtime data source plugin",getPage:Nw},{title:"Behaviors demo",getPage:Gy},{title:"Time zones demo",getPage:jw},{title:"Split layout",getPage:Iw},{title:"Query cancellation",getPage:Lw},{title:"Cursor sync",getPage:gO},{title:"Time range comparison",getPage:pO},{title:"Data layers",getPage:wO},{title:"Dynamic data layers",getPage:NS},{title:"Transformations",getPage:FO},{title:"Dynamic panel options and field config",getPage:NO},{title:"Data filtering",getPage:XO},{title:"Docs examples",getPage:cO},{title:"Nested scenes and variables",getPage:iS},{title:"CSS Grid Layout",getPage:pS},{title:"Panel header actions",getPage:yS},{title:"Vertical controls layout",getPage:PS},{title:"Interactive table with expandable rows",getPage:DS},{title:"Query controller demo",getPage:FS},{title:"Interop with hooks and context",getPage:ux},{title:"Url sync test",getPage:KE},{title:"Machine Learning",getPage:Hj},{title:"Events on the Scene Graph",getPage:Qj},{title:"Series limit",getPage:tD}].sort(((e,t)=>e.title.localeCompare(t.title)))}function rD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function aD(){return new nb({name:"scenes-demos-app",urlSyncOptions:{updateUrlOnInit:!0,createBrowserHistorySteps:!0},pages:[new wb({title:"Demos",key:"SceneAppPage Demos",url:u(s.Demos),preserveUrlKeys:[],getScene:()=>new Vf({key:"Demos EmbeddedScene",body:new oD}),drilldowns:[{routePath:`${c(":demo")}`,getPage:(e,t)=>{const n=nD(),a=decodeURIComponent(e.params.demo),i=n.find((e=>sD(e.title)===a));return i?i.getPage({title:i.title,url:`${c(sD(i.title))}`,getParentPage:()=>t}):(o=e.url,new wb({title:"Demo not found",subTitle:"So sorry sir but the demo cannot be found.",url:o,getScene:()=>new Vf({body:new Ag({direction:"column",children:[new Ig({body:new cb({component:()=>r().createElement("div",{style:{fontSize:50}},"")})})]})})}));var o}}]})]})}Wj(Zj,"type","example-event");const iD=()=>{const e=function(e){const t=ab.get(e);if(t)return t;const n=e();return ab.set(e,n),n}(aD);return r().createElement(e.Component,{model:e})};class oD extends re{updateLayout(){const{searchQuery:e,body:t}=this.state,n=[],a=new RegExp(e,"i");for(const t of nD())e&&!t.title.match(a)||n.push(new cb({reactNode:r().createElement(_n.Card,{key:t.title,href:c(sD(t.title))},r().createElement(_n.Card.Heading,null,t.title))}));t.setState({children:n})}constructor(){super({body:new Bg({children:[],templateColumns:"repeat(auto-fit, minmax(400px, 1fr))",autoRows:"unset"}),searchQuery:""}),rD(this,"onSearchChange",(e=>{this.setState({searchQuery:e.currentTarget.value}),this.updateLayout()})),this.addActivationHandler((()=>this.updateLayout()))}}function sD(e){const t=e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"");return encodeURIComponent(t)}rD(oD,"Component",(({model:e})=>{const{body:t,searchQuery:n}=e.useState(),a=(0,_n.useStyles2)(lD);return d.config.datasources[l.uid]?r().createElement("div",{className:a.root},r().createElement(_n.Input,{value:n,placeholder:"Search",onChange:e.onSearchChange}),r().createElement(t.Component,{model:t})):r().createElement(_n.Alert,{title:`Missing ${l.uid} datasource`},"These demos depend on ",r().createElement("b",null,"testdata")," datasource: ",r().createElement("code",null,JSON.stringify(l)),". See"," ",r().createElement("a",{href:"https://github.com/grafana/grafana/tree/main/devenv#set-up-your-development-environment"},"https://github.com/grafana/grafana/tree/main/devenv#set-up-your-development-environment")," ","for more details.")}));const lD=e=>({root:(0,En.css)({display:"flex",flexGrow:1,flexDirection:"column",alignSelf:"baseline",gap:e.spacing(2)})});function uD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class cD extends re{constructor(...e){super(...e),uD(this,"onChange",(e=>{this.setState({value:e}),this.state.onChange(e)}))}}function dD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}uD(cD,"Component",(({model:e})=>{const{options:t,value:n}=e.useState();return r().createElement(_n.RadioButtonGroup,{options:t,value:n,onChange:e.onChange})}));class pD extends re{constructor(...e){super(...e),dD(this,"onChange",(e=>{this.setState({value:e.currentTarget.value})}))}}function hD(t){const n={id:e.ValueMatcherID.regex,options:{value:t}};return{id:e.DataTransformerID.filterByValue,options:{type:"include",match:"all",filters:[{fieldName:"handler",config:n}]}}}function fD(t){return()=>n=>n.pipe((0,D.map)((n=>n.filter((n=>(0,e.getFrameDisplayName)(n).toLowerCase().includes(t.toLowerCase()))))))}function mD(t,n){return e.urlUtil.renderUrl(t,n)}function gD(){return new $h({variables:[new Lu({name:"instance",datasource:{uid:"gdev-prometheus"},query:{query:"label_values(grafana_http_request_duration_seconds_sum, instance)",refId:"A"}})]})}function bD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){bD(e,t,n[t])}))}return e}function vD(){const t=new pD({value:""}),n=ky({expr:"sort_desc(avg without(job, instance) (rate(grafana_http_request_duration_seconds_sum[$__rate_interval]) * 1e3)) "}),a=new Ah({$data:n,transformations:[hD("")]});a.addActivationHandler((()=>{const e=t.subscribeToState((e=>{a.setState({transformations:[hD(e.value)]}),a.reprocessTransformations()}));return()=>e.unsubscribe()}));const i=py().setTitle("Handlers").setData(a).setOption("footer",{enablePagination:!0}).setOverrides((e=>e.matchFieldsWithNameByRegex(".*").overrideFilterable(!1).matchFieldsWithName("Time").overrideCustomFieldConfig("hidden",!0).matchFieldsWithName("Value").overrideDisplayName("Duration (Avg)").matchFieldsWithName("handler").overrideLinks([{title:"Go to handler drilldown view",url:"",onBuildUrl:()=>{const e=d.locationService.getSearchObject();return mD(u("grafana-monitoring/handlers/${__value.text:percentencode}"),e)}}]))).build(),o=new Cl({datasource:{uid:"gdev-prometheus"},queries:[{refId:"A",expr:"topk(20, avg without(job, instance) (rate(grafana_http_request_duration_seconds_sum[$__rate_interval])) * 1e3)",range:!0,format:"time_series",legendFormat:"{{method}} {{handler}} (status = {{status_code}})",maxDataPoints:500}]}),s=new Ah({$data:o,transformations:[fD("")]});s.addActivationHandler((()=>{const e=t.subscribeToState((e=>{s.setState({transformations:[fD(e.value)]}),s.reprocessTransformations()}));return()=>e.unsubscribe()}));const l=new kg({$data:s,body:new Ag({direction:"column",children:[]}),getLayoutChild:(t,n,a)=>{return new Ig({key:`panel-${a}`,minHeight:200,$data:new $e({data:(i=yD({},t),o={series:[n]},o=null!=o?o:{},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(o)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(o)).forEach((function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(o,e))})),i)}),body:new Ag({direction:"row",key:`row-${a}`,children:[new Ig({key:`flex1-${a}`,body:fy().setTitle((0,e.getFrameDisplayName)(n)).setOption("legend",{showLegend:!1}).setHeaderActions(r().createElement(_n.LinkButton,{fill:"text",size:"sm",icon:"arrow-right",href:wD(n.fields[1].labels.handler)},"Details")).build()}),new Ig({key:`flex2-${a}`,width:200,body:dy().setTitle("Last").setOption("graphMode",Ce.None).setOption("textMode",Ee.Value).setDisplayName("Last").build()})]})});var i,o}}),c=new Ag({children:[new Ig({body:i})]}),p=new cD({options:[{value:"table",label:"Table"},{value:"graphs",label:"Graphs"}],value:"table",onChange:e=>{"table"===e?c.setState({children:[new Ig({body:i})]}):c.setState({children:[l]})}});return new Vf({$variables:gD(),$data:n,$timeRange:new Xe({from:"now-1h",to:"now"}),controls:[new Ih({}),t,new Rg,p,new Zm({isOnCanvas:!0}),new dg({isOnCanvas:!0})],body:c})}function wD(e){const t=d.locationService.getSearchObject();return mD(u(`grafana-monitoring/handlers/${encodeURIComponent(e)}`),t)}function OD(e){const t=Ty({expr:`avg without(job, instance) (rate(grafana_http_request_duration_seconds_sum{handler="${e}"}[$__rate_interval])) * 1e3`,legendFormat:"{{method}} {{handler}} (status = {{status_code}})"}),n=Ty({expr:`sum without(job, instance) (rate(grafana_http_request_duration_seconds_count{handler="${e}"}[$__rate_interval])) `,legendFormat:"{{method}} {{handler}} (status = {{status_code}})"});return new Vf({$variables:gD(),$timeRange:new Xe({from:"now-1h",to:"now"}),controls:[new Ih({}),new Rg,new Zm({isOnCanvas:!0}),new dg({isOnCanvas:!0})],body:new Ag({direction:"column",children:[new Ig({body:fy().setData(t).setTitle("Request duration avg (ms)").build()}),new Ig({body:fy().setData(n).setTitle("Request count/s").build()})]})})}function SD(){return new Vf({$variables:gD(),$timeRange:new Xe({from:"now-1h",to:"now"}),controls:[new Ih({}),new Rg,new Zm({isOnCanvas:!0}),new dg({isOnCanvas:!0})],body:new Ag({direction:"column",children:[new Ig({height:150,body:new Ag({children:[new Ig({body:_D("grafana_stat_totals_dashboard","Dashboards")}),new Ig({body:_D("grafana_stat_total_users","Users")}),new Ig({body:_D("sum(grafana_stat_totals_datasource)","Data sources")}),new Ig({body:_D("grafana_stat_total_service_account_tokens","Service account tokens")})]})}),new Ig({body:fy().setData(new Cl({datasource:{uid:"gdev-prometheus"},queries:[{refId:"A",expr:'sum(go_memory_classes_total_bytes{job="grafana", instance=~"$instance"})',range:!0,format:"time_series",maxDataPoints:500}]})).setTitle("Memory usage").setOption("legend",{showLegend:!1}).setUnit("bytes").setMin(0).setCustomFieldConfig("lineWidth",2).setCustomFieldConfig("fillOpacity",6).build()}),new Ig({body:fy().setData(new Cl({datasource:{uid:"gdev-prometheus"},queries:[{refId:"A",expr:'sum(go_goroutines{job="grafana", instance=~"$instance"})',range:!0,format:"time_series",maxDataPoints:500}]})).setOption("legend",{showLegend:!1}).setMin(0).setCustomFieldConfig("lineWidth",2).setCustomFieldConfig("fillOpacity",6).setTitle("Go routines").build()})]})})}function _D(t,n){return dy().setData(ky({expr:t})).setTitle(n).setColor({fixedColor:"text",mode:e.FieldColorModeId.Fixed}).build()}function xD(){const e=new Cl({datasource:{uid:"gdev-loki"},queries:[{refId:"A",expr:'{job="grafana"} | logfmt | __error__=``',queryType:"range",maxDataPoints:5e3}]});return new Vf({$variables:gD(),$timeRange:new Xe({from:"now-1h",to:"now"}),controls:[new Ih({}),new Rg,new Zm({isOnCanvas:!0}),new dg({isOnCanvas:!0})],body:new Ag({direction:"column",children:[new Ig({body:uy().setTitle("").setData(e).setOption("showTime",!0).setOption("showLabels",!1).setOption("showCommonLabels",!1).setOption("wrapLogMessage",!0).setOption("prettifyLogMessage",!1).setOption("enableLogDetails",!0).setOption("dedupStrategy",Re.none).setOption("sortOrder",ve.Descending).build()})]})})}function PD(){const e=py().setData(ky({expr:"sort_desc(avg without(job, instance) (rate(grafana_http_request_duration_seconds_sum[$__rate_interval]) * 1e3)) "})).setTitle("Handlers").setOption("footer",{enablePagination:!0}).setOverrides((e=>e.matchFieldsWithNameByRegex(".*").overrideFilterable(!1).matchFieldsWithName("Time").overrideCustomFieldConfig("hidden",!0).matchFieldsWithName("Value").overrideDisplayName("Duration (Avg)").matchFieldsWithName("handler").overrideLinks([{title:"Go to handler drilldown view",url:u("grafana-monitoring/traffic?handler=${__value.text:percentencode}")}]))).build();return new Vf({$variables:gD(),$timeRange:new Xe({from:"now-1h",to:"now"}),controls:[new Ih({}),new Rg,new Zm({isOnCanvas:!0}),new dg({isOnCanvas:!0})],body:new Ag({$behaviors:[new CD],children:[new Ig({body:e})]})})}dD(pD,"Component",(({model:e})=>{const{value:t}=e.useState();return r().createElement(_n.Input,{width:25,placeholder:"Search...",value:t,onChange:e.onChange})}));class CD extends re{onHandlerChanged(e){const t=this.getLayout();null==e?t.setState({children:t.state.children.slice(0,1)}):t.setState({children:[t.state.children[0],this.getDrilldownView(e)]})}getDrilldownView(e){return new Ig({key:"drilldown-flex",body:fy().setData(Ty({expr:`rate(grafana_http_request_duration_seconds_sum{handler="${e}"}[$__rate_interval]) * 1e3`})).setTitle(`Handler: ${e} details`).setHeaderActions(r().createElement(_n.Button,{size:"sm",variant:"secondary",icon:"times",onClick:()=>this.setState({handler:void 0})})).build()})}getUrlState(){return{handler:this.state.handler}}updateFromUrl(e){"string"!=typeof e.handler&&void 0!==e.handler||this.setState({handler:e.handler})}getLayout(){if(this.parent instanceof Ag)return this.parent;throw new Error("Invalid parent")}constructor(){super({}),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"_urlSync",new Be(this,{keys:["handler"]})),this.addActivationHandler((()=>{this._subs.add(this.subscribeToState((e=>this.onHandlerChanged(e.handler)))),this.onHandlerChanged(this.state.handler)}))}}function ED(e,t){const n=decodeURIComponent(e.params.handler),r=u(`grafana-monitoring/handlers/${encodeURIComponent(n)}`);return new wb({title:n,subTitle:"A grafana http handler is responsible for service a specific API request",url:r,getParentPage:()=>t,getScene:()=>OD(n),tabs:[new wb({title:"Metrics",url:r,getScene:()=>OD(n),preserveUrlKeys:["from","to","var-instance"]}),new wb({title:"Logs",url:r+"/logs",getScene:()=>function(e){const t=new Cl({datasource:{uid:"gdev-loki"},queries:[{refId:"A",expr:`{job="grafana"} | logfmt | handler=\`${e}\` | __error__=\`\``,queryType:"range",maxDataPoints:5e3}]});return new Vf({$variables:gD(),$timeRange:new Xe({from:"now-1h",to:"now"}),controls:[new Ih({}),new Rg,new Zm({isOnCanvas:!0}),new dg({isOnCanvas:!0})],body:new Ag({direction:"column",children:[new Ig({body:uy().setData(t).setTitle("").setOption("showTime",!0).setOption("showLabels",!1).setOption("showCommonLabels",!1).setOption("wrapLogMessage",!0).setOption("prettifyLogMessage",!1).setOption("enableLogDetails",!0).setOption("dedupStrategy",Re.none).setOption("sortOrder",ve.Descending).build()})]})})}(n),preserveUrlKeys:["from","to","var-instance"]})]})}const jD=function(){const e=(0,t.useMemo)((()=>new nb({pages:[new wb({title:"Grafana Monitoring",subTitle:"A custom app with embedded scenes to monitor your Grafana server",url:u("grafana-monitoring"),hideFromBreadcrumbs:!1,getScene:SD,tabs:[new wb({title:"Overview",url:u("grafana-monitoring"),getScene:SD,preserveUrlKeys:["from","to","var-instance"]}),new wb({title:"HTTP handlers",url:u("grafana-monitoring/handlers"),getScene:vD,preserveUrlKeys:["from","to","var-instance"],drilldowns:[{routePath:u("grafana-monitoring/handlers/:handler"),getPage:ED}]}),new wb({title:"Traffic",url:u("grafana-monitoring/traffic"),getScene:PD,preserveUrlKeys:["from","to","var-instance"]}),new wb({title:"Logs",url:u("grafana-monitoring/logs"),getScene:xD,preserveUrlKeys:["from","to","var-instance"]})]})]})),[]);return r().createElement(e.Component,{model:e})};function DD({title:e,subTitle:n,children:a}){const i={text:e},{breadcrumbs:o}=(0,t.useContext)(B_);if(o.length>0){let t=i;for(const n of o){if(n.text===e)break;t.parentItem={text:n.text,url:n.url}}}return r().createElement(d.PluginPage,{pageNav:i,subTitle:n,actions:r().createElement(kD,null)},a)}function kD(){return r().createElement(r().Fragment,null,r().createElement(E_,{name:"env"}),r().createElement(C_,null),r().createElement(V_,{withText:!0}))}function TD(){const n=["Slow query","Random walk"].map(e.toOption),[a,i]=(0,t.useState)("Random walk"),o=P_({queries:(0,t.useMemo)((()=>function(e){return"Random walk"===e?[{refId:"A",scenarioId:"random_walk",alias:"random walk"}]:[{refId:"A",scenarioId:"slow_query",alias:"Slow query",stringInput:"2s"}]}(a)),[a]),maxDataPoints:100,datasource:l});return r().createElement(DD,{title:"Dynamic queriues",subTitle:"Rebuild queries based on some user input / state"},r().createElement(_n.Stack,{direction:"column"},r().createElement(_n.Stack,null,r().createElement(_n.Field,{label:"Query scenario"},r().createElement(_n.Select,{value:a,options:n,onChange:e=>i(e.value)}))),r().createElement(J_,null,r().createElement(D_,{title:a,dataProvider:o,viz:nx}))))}function RD(){return r().createElement(DD,{title:"Repeat by variable",subTitle:"Has a nested variable scope with a new variable which we repeat some viz panels by"},r().createElement(L_,{name:"panels",query:"10, 20, 30, 40, 50",initialValue:["10"],isMulti:!0},r().createElement(_n.Stack,{direction:"column"},r().createElement(E_,{name:"panels"}),r().createElement(AD,null))))}function AD(){const[e,t]=function(){const e=t_(),t=Hu.lookupVariable("panels",e);if(!t)return[void 0,!1];t.useState();const n=t.parent.isVariableLoadingOrWaitingToUpdate(t);let r=t.getValue();return null==r?[void 0,n]:(Array.isArray(r)||(r=[r]),[r,n])}();return t||!e?r().createElement("div",null,"Waiting for variable"):r().createElement(J_,null,e.map((e=>r().createElement(ix,{key:e,title:`${e} data points`,maxDataPoints:parseInt(e,10)}))))}function ID(){const[e,n]=(0,t.useState)(nx),a=MD.find((t=>t.value===e)),i=P_({queries:VD,maxDataPoints:50,datasource:l,cacheKey:VD}),o=r().createElement(_n.RadioButtonGroup,{value:e,options:MD,onChange:n,size:"sm"});return r().createElement(DD,{title:"Dynamic visualisation",subTitle:"Rebuild queries based on some user input / state"},r().createElement(_n.Stack,{direction:"column"},r().createElement(J_,null,r().createElement(D_,{title:a.label,dataProvider:i,viz:e,headerActions:o}))))}const MD=[{label:"Graph",value:nx},{label:"Bars",value:rx},{label:"Gradient graph",value:ax}],VD=[{refId:"A",scenarioId:"random_walk",alias:"env = $env"}];function FD(){const[e,t]=r().useState(void 0),[n,a]=r().useState(vS.dontHide),[i,o]=r().useState("/[ACDFG]/"),[s,l]=r().useState(!0),[u,c]=r().useState(Ju.alphabeticalAsc);return r().createElement(DD,{title:"Dynamic variables",subTitle:"Variables added via react rendering"},r().createElement(L_,{name:"job",query:"A, B, C",initialValue:"A"},r().createElement(_n.Stack,{direction:"column"},r().createElement(_n.Stack,null,r().createElement(E_,{name:"job"})),r().createElement(J_,null,r().createElement(ix,{title:"Testing job = $job",queryAlias:"job =$job"})))),r().createElement($_,{name:"dsVar",pluginId:"grafana-testdata-datasource",regex:e},r().createElement(_n.Stack,{direction:"column"},r().createElement(_n.Stack,null,r().createElement(E_,{name:"dsVar"}),r().createElement(_n.Button,{variant:"secondary",onClick:()=>t("/gdev-*/")},"Change regex"),r().createElement(_n.Button,{variant:"secondary",onClick:()=>t(void 0)},"No regex")),r().createElement(J_,null,r().createElement(ix,{title:"Testing datasource = $dsVar",queryAlias:"datasource = $dsVar"})))),r().createElement(z_,{name:"job2",initialValue:"A",query:{query:"*",refId:"A"},datasource:{uid:"gdev-testdata"},regex:i,hide:n,refresh:Xu.onTimeRangeChanged,includeAll:s,sort:u},r().createElement(_n.Stack,{direction:"column"},r().createElement(_n.Stack,null,r().createElement(E_,{name:"job2"}),r().createElement(_n.Button,{variant:"secondary",onClick:()=>a(vS.hideLabel)},"Hide label"),r().createElement(_n.Button,{variant:"secondary",onClick:()=>a(vS.hideVariable)},"Hide variable"),r().createElement(_n.Button,{variant:"secondary",onClick:()=>a(vS.dontHide)},"Unhide variable"),r().createElement(_n.Button,{variant:"secondary",onClick:()=>o("/[BF]/")},"Change regex"),r().createElement(_n.Button,{variant:"secondary",onClick:()=>o(void 0)},"No regex"),r().createElement(_n.Button,{variant:"secondary",onClick:()=>l(!1)},"Remove include all"),r().createElement(_n.Button,{variant:"secondary",onClick:()=>c(Ju.alphabeticalAsc)},"Sort asc"),r().createElement(_n.Button,{variant:"secondary",onClick:()=>c(Ju.alphabeticalDesc)},"Sort desc")),r().createElement(J_,null,r().createElement(ix,{title:"Testing job2 = $job2",queryAlias:"job2 =$job2"})))))}function LD(){return r().createElement(DD,{title:"Nested context",subTitle:"Nested contexts with different time ranges and variables"},r().createElement(_n.Stack,{direction:"column"},r().createElement(J_,null,r().createElement(ix,{title:"Global"})),r().createElement($D,null),r().createElement(e_,{timeRange:{from:"now-10m",to:"now"}},r().createElement(L_,{name:"job",query:"jobA-${env}, jobB-${env}, jobC-${env}"},r().createElement(_n.Stack,{direction:"column"},r().createElement(_n.Stack,{direction:"row",justifyContent:"flex-end"},r().createElement(E_,{name:"job"}),r().createElement(C_,null)),r().createElement(J_,null,r().createElement(ix,{title:"Nested time range",queryAlias:"job = $job"})))))))}function $D(){const e=(0,_n.useTheme2)();return r().createElement("div",{style:{height:1,width:"100%",flexGrow:1,borderTop:`1px solid ${e.colors.border.weak}`,margin:"8px 0"}})}function zD(){return r().createElement(DD,{title:"Interpolation hook",subTitle:"Testing a hook that makes any component re-render when variable or time range change"},r().createElement(_n.Stack,{direction:"column"},r().createElement(ex,{name:"Page"}),r().createElement(BD,null)))}const BD=r().memo((()=>{const e=r_({variables:["env"],timeRange:!0});return r().createElement(_n.Stack,{direction:"column",gap:2},r().createElement(ex,{name:"Memozied component"}),r().createElement("div",null,"$env: ",e("$env")),r().createElement("div",null,"__url_time_range: ",e("$__url_time_range")),r().createElement(_n.Stack,null,r().createElement(_n.Button,{variant:"secondary",onClick:()=>{d.locationService.partial({someParam:"1"})}},"Update query param"),r().createElement(_n.Button,{variant:"secondary",onClick:()=>{d.locationService.partial({"var-env":"prod"})}},"Set env var to prod via url")))}));function ND(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ND(e,t,n[t])}))}return e}function HD(){return r().createElement(DD,{title:"Repeat by series",subTitle:"Repeats visualizations returned by a single query"},r().createElement(L_,{name:"series",label:"Series count",query:"1,2,5,10,20,30",initialValue:"3"},r().createElement(_n.Stack,{direction:"column"},r().createElement(E_,{name:"series"}),r().createElement(WD,null))))}BD.displayName="PageBody";const WD=r().memo((()=>{const t=r_({variables:["series"]}),n=P_({queries:[{uid:"gdev-testdata",refId:"A",scenarioId:"random_walk",alias:"__server_names",seriesCount:parseInt(t("$series"),10)}],maxDataPoints:50}),{data:a}=n.useState();return a?r().createElement(J_,null,a.series.map(((t,n)=>{const i=(0,e.getFrameDisplayName)(t,n),o=new $e({data:(s=qD({},a),l={series:[t]},l=null!=l?l:{},Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(l)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(l)).forEach((function(e){Object.defineProperty(s,e,Object.getOwnPropertyDescriptor(l,e))})),s)});var s,l;return r().createElement(D_,{key:i,title:i,viz:nx,dataProvider:o})}))):null}));function UD(){return r().createElement(N_,null,r().createElement(q_,{text:"Drilldown demo",path:`${tx}/drilldown`}),r().createElement(i.Switch,null,r().createElement(i.Route,{path:`${tx}/drilldown`,component:GD,exact:!0}),r().createElement(i.Route,{path:`${tx}/drilldown/lib/:lib`,component:QD})))}function GD(){const e=P_({queries:[{scenarioId:"csv_file",refId:"A",csvFileName:"js_libraries.csv"}],datasource:l});return r().createElement(DD,{title:"Drilldown demo",subTitle:"The top level page (for the demo)"},r().createElement(J_,null,r().createElement(D_,{title:"JS Libraries",dataProvider:e,viz:KD})))}function QD(){const e=(0,i.useParams)().lib;return r().createElement(DD,{title:`Library: ${e}`,subTitle:"Library details drilldown page"},r().createElement(J_,null,r().createElement(ix,{title:`${e} trends`})))}WD.displayName="RepeatPanelBySeries";const KD=gy().setOverrides((e=>e.matchFieldsWithName("Library").overrideLinks([{title:"Go to library details",url:"${__url.path}/lib/${__value.text}${__url.params}"}]))).build();function YD(){return r().createElement(DD,{title:"Annotations",subTitle:"Annotation demo page"},r().createElement(H_,{name:"GlobalAnno",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"green",name:"New annotation",target:{lines:11,refId:"Anno",scenarioId:"annotations"}}},r().createElement(_n.Stack,{direction:"column",gap:2},r().createElement(e_,null,r().createElement(_n.Stack,{direction:"column"},r().createElement(H_,{name:"AnnoLayer1",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"yellow",name:"New annotation",target:{lines:10,refId:"Anno",scenarioId:"annotations"}}},r().createElement(H_,{name:"AnnoLayer3",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"blue",name:"New annotation",target:{lines:3,refId:"Anno",scenarioId:"annotations"}}},r().createElement(_n.Stack,{direction:"row"},r().createElement(F_,{name:"GlobalAnno"}),r().createElement(F_,{name:"AnnoLayer1"}),r().createElement(F_,{name:"AnnoLayer3"})),r().createElement(J_,null,r().createElement(ix,{title:"Plain graph 1"})))))),r().createElement(e_,null,r().createElement(H_,{name:"AnnoLayer2",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"red",name:"New annotation",target:{lines:15,refId:"Anno",scenarioId:"annotations"}}},r().createElement(F_,{name:"AnnoLayer2"}),r().createElement(J_,null,r().createElement(ix,{title:"Plain graph 2"}),r().createElement(ix,{title:"Plain graph 3"}),r().createElement(ix,{title:"Plain graph 4"})))))))}function ZD(){const[n,a]=(0,t.useState)(e.ReducerID.mean),i=P_({queries:[{uid:"gdev-testdata",refId:"A",scenarioId:"random_walk",alias:"foo"}],maxDataPoints:20}),o={mode:"windowFunctions",window:{windowSize:10,windowSizeMode:"percentage",windowAlignment:"center",field:"foo",reducer:n}},s=function(e){const n=t_(),r=(0,t.useId)();let a=n.findByKey(r);return a||(a=new Ah({key:r,$data:new fh({source:e.data.getRef()}),transformations:e.transformations})),(0,t.useEffect)((()=>n.addToScene(a)),[a,n]),(0,t.useEffect)((()=>{(0,ge.isEqual)(a.state.transformations,e.transformations)||(a.setState({transformations:e.transformations}),a.reprocessTransformations())}),[a,e.transformations]),a}({transformations:[{id:e.DataTransformerID.calculateField,options:o}],data:i});var l;return r().createElement(DD,{title:"Transformations",subTitle:"Transformations demo page"},r().createElement(_n.Select,{onChange:t=>a(null!==(l=t.value)&&void 0!==l?l:e.ReducerID.mean),value:n,options:[{label:"mean",value:e.ReducerID.mean},{label:"variance",value:e.ReducerID.variance}]}),r().createElement(_n.Stack,{direction:"column",gap:2},r().createElement(J_,null,r().createElement(D_,{title:"Viz with transformations",viz:nx,dataProvider:s}))))}function XD(){var e,n;const[a,i]=r().useState(void 0),o=function(e){const n=t_();let r=Hu.lookupVariable(e.name,n);return r||(r=new Lu({name:e.name,datasource:{uid:e.datasource},query:e.query,regex:e.regex})),r instanceof Lu||(r=null),(0,t.useEffect)((()=>{r&&n.addVariable(r)}),[r,n]),(0,t.useEffect)((()=>{var t;(null==(t=null==r?void 0:r.state.datasource)?void 0:t.uid)===e.datasource&&(0,ge.isEqual)(null==r?void 0:r.state.query,e.query)&&(null==r?void 0:r.state.regex)===e.regex||(null==r||r.setState({datasource:{uid:e.datasource},query:e.query,regex:e.regex}),null==r||r.refreshOptions())}),[e,r]),r}({name:"test",datasource:"gdev-testdata",query:"*",regex:a}),s=null===(n=o)||void 0===n||null===(e=n.useState())||void 0===e?void 0:e.options;return s?r().createElement(DD,{title:"useQueryVariable hook",subTitle:"Testing a hook that provides an alternative way of creating a query variable"},r().createElement(_n.Stack,{direction:"column"},r().createElement(_n.Stack,{direction:"column",gap:2},r().createElement("div",null,"Variable label: ",s.map((e=>e.label)).join(",")),r().createElement("div",null,"Variable value: ",s.map((e=>e.value)).join(",")),r().createElement(_n.Button,{variant:"secondary",onClick:()=>{i("/[ABC]/")}},"Update query variable regex"))),r().createElement(J_,null,s.map((e=>r().createElement(ix,{key:e.label,title:`${e.value} Panel`}))))):r().createElement("div",null,"No variable options found")}function JD(){return r().createElement(e_,{timeRange:{from:"now-1h",to:"now"},withQueryController:!0},r().createElement(L_,{name:"env",query:"dev, test, prod",initialValue:"dev"},r().createElement(i.Switch,null,r().createElement(i.Route,{path:`${tx}`,component:ek,exact:!0}),r().createElement(i.Route,{path:`${tx}/repeat-by-variable`,component:RD}),r().createElement(i.Route,{path:`${tx}/repeat-by-series`,component:HD}),r().createElement(i.Route,{path:`${tx}/dynamic-queries`,component:TD}),r().createElement(i.Route,{path:`${tx}/dynamic-viz`,component:ID}),r().createElement(i.Route,{path:`${tx}/dynamic-vars`,component:FD}),r().createElement(i.Route,{path:`${tx}/nested-context`,component:LD}),r().createElement(i.Route,{path:`${tx}/interpolation-hook`,component:zD}),r().createElement(i.Route,{path:`${tx}/query-var-hook`,component:XD}),r().createElement(i.Route,{path:`${tx}/drilldown`,component:UD}),r().createElement(i.Route,{path:`${tx}/annotations`,component:YD}),r().createElement(i.Route,{path:`${tx}/transformations`,component:ZD}))))}function ek(){return r().createElement(DD,{title:"Home",subTitle:"Welcome to the React first demos"},r().createElement(_n.Stack,{direction:"column",gap:2},r().createElement(J_,null,r().createElement(ix,{title:"Welcome",maxDataPoints:50})),r().createElement("h2",null,"Examples"),r().createElement(_n.TextLink,{href:`${tx}/repeat-by-variable`},"Repeat by variable"),r().createElement(_n.TextLink,{href:`${tx}/repeat-by-series`},"Repeat by series"),r().createElement(_n.TextLink,{href:`${tx}/dynamic-queries`},"Dynamic queries"),r().createElement(_n.TextLink,{href:`${tx}/dynamic-viz`},"Dynamic visualization"),r().createElement(_n.TextLink,{href:`${tx}/dynamic-vars`},"Dynamic variables"),r().createElement(_n.TextLink,{href:`${tx}/nested-context`},"Nested contexts"),r().createElement(_n.TextLink,{href:`${tx}/interpolation-hook`},"Interpolation hook"),r().createElement(_n.TextLink,{href:`${tx}/query-var-hook`},"Query variable hook"),r().createElement(_n.TextLink,{href:`${tx}/drilldown`},"Drilldown demo"),r().createElement(_n.TextLink,{href:`${tx}/annotations`},"Annotations demo page"),r().createElement(_n.TextLink,{href:`${tx}/drilldown?from=now-5m&to=now&var-env=prod`},"Link with time range and variables"),r().createElement(_n.TextLink,{href:`${tx}/transformations`},"Transformation demo")))}const tk=()=>t.createElement(i.Switch,null,t.createElement(i.Route,{path:u(`${s.Demos}`),component:iD}),t.createElement(i.Route,{path:u(`${s.GrafanaMonitoring}`),component:jD}),t.createElement(i.Route,{path:u(`${s.ReactDemo}`),component:JD}),t.createElement(i.Redirect,{to:u(s.Demos)}));class nk extends t.PureComponent{render(){return t.createElement(a.Provider,{value:this.props},t.createElement(tk,null))}}const rk=(new e.AppPlugin).setRootPage(nk)})(),f})()));
//# sourceMappingURL=module.js.map