/*! For license information please see module.js.LICENSE.txt */
define(["@emotion/css","@grafana/data","@grafana/runtime","@grafana/ui","lodash","react","react-dom","react-router-dom","rxjs"],((e,t,n,r,a,o,i,s,l)=>(()=>{var u,c,d={362:(e,t,n)=>{"use strict";let r;n.d(t,{BI:()=>k,BM:()=>j,Cy:()=>C,ZP:()=>$,qh:()=>M}),e=n.hmd(e);const a=new Array(128).fill(void 0);function o(e){return a[e]}a.push(void 0,null,!0,!1);let i=0,s=null;function l(){return null!==s&&0!==s.byteLength||(s=new Uint8Array(r.memory.buffer)),s}const u="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},c="function"==typeof u.encodeInto?function(e,t){return u.encodeInto(e,t)}:function(e,t){const n=u.encode(e);return t.set(n),{read:e.length,written:n.length}};function d(e,t,n){if(void 0===n){const n=u.encode(e),r=t(n.length,1)>>>0;return l().subarray(r,r+n.length).set(n),i=n.length,r}let r=e.length,a=t(r,1)>>>0;const o=l();let s=0;for(;s<r;s++){const t=e.charCodeAt(s);if(t>127)break;o[a+s]=t}if(s!==r){0!==s&&(e=e.slice(s)),a=n(a,r,r=s+3*e.length,1)>>>0;const t=l().subarray(a+s,a+r);s+=c(e,t).written,a=n(a,r,s,1)>>>0}return i=s,a}function p(e){return null==e}let f=null;function h(){return null!==f&&0!==f.byteLength||(f=new Int32Array(r.memory.buffer)),f}let m=a.length;function g(e){const t=o(e);return function(e){e<132||(a[e]=m,m=e)}(e),t}function b(e){m===a.length&&a.push(a.length+1);const t=m;return m=a[t],a[t]=e,t}const y="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};function v(e,t){return e>>>=0,y.decode(l().subarray(e,e+t))}"undefined"!=typeof TextDecoder&&y.decode();let w=null;function O(){return null!==w&&0!==w.byteLength||(w=new Float64Array(r.memory.buffer)),w}let S=null;function _(e){const t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){const t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){const t=e.length;let n="[";t>0&&(n+=_(e[0]));for(let r=1;r<t;r++)n+=", "+_(e[r]);return n+="]",n}const n=/\[object ([^\]]+)\]/.exec(toString.call(e));let r;if(!(n.length>1))return toString.call(e);if(r=n[1],"Object"==r)try{return"Object("+JSON.stringify(e)+")"}catch(e){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:r}let x=null;function P(){return null!==x&&0!==x.byteLength||(x=new Uint32Array(r.memory.buffer)),x}function j(e,t){const n=function(e,t){const n=t(4*e.length,4)>>>0;return P().set(e,n/4),i=e.length,n}(e,r.__wbindgen_malloc),a=i,o=r.ets(n,a,p(t)?0:b(t));return I.__wrap(o)}function C(e,t){try{const u=r.__wbindgen_add_to_stack_pointer(-16),c=function(e,t){const n=t(8*e.length,8)>>>0;return O().set(e,n/8),i=e.length,n}(e,r.__wbindgen_malloc),d=i;r.seasonalities(u,c,d,p(t)?0:b(t));var n=h()[u/4+0],a=h()[u/4+1],o=(s=n,l=a,s>>>=0,P().subarray(s/4,s/4+l)).slice();return r.__wbindgen_free(n,4*a,4),o}finally{r.__wbindgen_add_to_stack_pointer(16)}var s,l}function E(e,t){try{return e.apply(this,t)}catch(e){r.__wbindgen_exn_store(b(e))}}"undefined"==typeof FinalizationRegistry||new FinalizationRegistry((e=>r.__wbg_autoets_free(e>>>0)));const D="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>r.__wbg_changepointdetector_free(e>>>0)));class k{static __wrap(e){e>>>=0;const t=Object.create(k.prototype);return t.__wbg_ptr=e,D.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,D.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_changepointdetector_free(e)}static normalGamma(e){try{const a=r.__wbindgen_add_to_stack_pointer(-16);r.changepointdetector_normalGamma(a,p(e)?0:b(e));var t=h()[a/4+0],n=h()[a/4+1];if(h()[a/4+2])throw g(n);return k.__wrap(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}static defaultArgpcp(e){try{const a=r.__wbindgen_add_to_stack_pointer(-16);r.changepointdetector_defaultArgpcp(a,p(e)?0:b(e));var t=h()[a/4+0],n=h()[a/4+1];if(h()[a/4+2])throw g(n);return k.__wrap(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}detectChangepoints(e){return g(r.changepointdetector_detectChangepoints(this.__wbg_ptr,b(e)))}}const T="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>r.__wbg_loadedoutlierdetector_free(e>>>0)));class R{static __wrap(e){e>>>=0;const t=Object.create(R.prototype);return t.__wbg_ptr=e,T.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,T.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_loadedoutlierdetector_free(e)}detect(){return g(r.loadedoutlierdetector_detect(this.__wbg_ptr))}updateDetector(e){try{const n=r.__wbindgen_add_to_stack_pointer(-16);r.loadedoutlierdetector_updateDetector(n,this.__wbg_ptr,b(e));var t=h()[n/4+0];if(h()[n/4+1])throw g(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}}const A="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>r.__wbg_mstl_free(e>>>0)));class I{static __wrap(e){e>>>=0;const t=Object.create(I.prototype);return t.__wbg_ptr=e,A.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,A.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_mstl_free(e)}fit(e){try{const n=r.__wbindgen_add_to_stack_pointer(-16);r.mstl_fit(n,this.__wbg_ptr,b(e));var t=h()[n/4+0];if(h()[n/4+1])throw g(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}predict(e,t){try{const o=r.__wbindgen_add_to_stack_pointer(-16);r.mstl_predict(o,this.__wbg_ptr,e,!p(t),p(t)?0:t);var n=h()[o/4+0],a=h()[o/4+1];if(h()[o/4+2])throw g(a);return g(n)}finally{r.__wbindgen_add_to_stack_pointer(16)}}predictInSample(e){try{const a=r.__wbindgen_add_to_stack_pointer(-16);r.mstl_predictInSample(a,this.__wbg_ptr,!p(e),p(e)?0:e);var t=h()[a/4+0],n=h()[a/4+1];if(h()[a/4+2])throw g(n);return g(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}}const V="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>r.__wbg_outlierdetector_free(e>>>0)));class M{static __wrap(e){e>>>=0;const t=Object.create(M.prototype);return t.__wbg_ptr=e,V.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,V.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_outlierdetector_free(e)}static dbscan(e){try{const a=r.__wbindgen_add_to_stack_pointer(-16);r.outlierdetector_dbscan(a,b(e));var t=h()[a/4+0],n=h()[a/4+1];if(h()[a/4+2])throw g(n);return M.__wrap(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}detect(e,t){return g(r.outlierdetector_detect(this.__wbg_ptr,b(e),t))}preprocess(e,t){const n=r.outlierdetector_preprocess(this.__wbg_ptr,b(e),t);return R.__wrap(n)}}function F(){const t={wbg:{}};return t.wbg.__wbindgen_string_get=function(e,t){const n=o(t),a="string"==typeof n?n:void 0;var s=p(a)?0:d(a,r.__wbindgen_malloc,r.__wbindgen_realloc),l=i;h()[e/4+1]=l,h()[e/4+0]=s},t.wbg.__wbindgen_object_drop_ref=function(e){g(e)},t.wbg.__wbindgen_is_bigint=function(e){return"bigint"==typeof o(e)},t.wbg.__wbindgen_bigint_from_u64=function(e){return b(BigInt.asUintN(64,e))},t.wbg.__wbindgen_jsval_eq=function(e,t){return o(e)===o(t)},t.wbg.__wbindgen_error_new=function(e,t){return b(new Error(v(e,t)))},t.wbg.__wbindgen_boolean_get=function(e){const t=o(e);return"boolean"==typeof t?t?1:0:2},t.wbg.__wbindgen_is_string=function(e){return"string"==typeof o(e)},t.wbg.__wbindgen_number_get=function(e,t){const n=o(t),r="number"==typeof n?n:void 0;O()[e/8+1]=p(r)?0:r,h()[e/4+0]=!p(r)},t.wbg.__wbindgen_is_object=function(e){const t=o(e);return"object"==typeof t&&null!==t},t.wbg.__wbindgen_is_undefined=function(e){return void 0===o(e)},t.wbg.__wbindgen_in=function(e,t){return o(e)in o(t)},t.wbg.__wbindgen_object_clone_ref=function(e){return b(o(e))},t.wbg.__wbindgen_string_new=function(e,t){return b(v(e,t))},t.wbg.__wbg_new_abda76e883ba8a5f=function(){return b(new Error)},t.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const n=d(o(t).stack,r.__wbindgen_malloc,r.__wbindgen_realloc),a=i;h()[e/4+1]=a,h()[e/4+0]=n},t.wbg.__wbg_error_f851667af71bcfc6=function(e,t){let n,a;try{n=e,a=t,console.error(v(e,t))}finally{r.__wbindgen_free(n,a,1)}},t.wbg.__wbg_crypto_1d1f22824a6a080c=function(e){return b(o(e).crypto)},t.wbg.__wbg_process_4a72847cc503995b=function(e){return b(o(e).process)},t.wbg.__wbg_versions_f686565e586dd935=function(e){return b(o(e).versions)},t.wbg.__wbg_node_104a2ff8d6ea03a2=function(e){return b(o(e).node)},t.wbg.__wbg_require_cca90b1a94a0255b=function(){return E((function(){return b(e.require)}),arguments)},t.wbg.__wbindgen_is_function=function(e){return"function"==typeof o(e)},t.wbg.__wbg_msCrypto_eb05e62b530a1508=function(e){return b(o(e).msCrypto)},t.wbg.__wbg_randomFillSync_5c9c955aa56b6049=function(){return E((function(e,t){o(e).randomFillSync(g(t))}),arguments)},t.wbg.__wbg_getRandomValues_3aa56aa6edec874c=function(){return E((function(e,t){o(e).getRandomValues(o(t))}),arguments)},t.wbg.__wbindgen_jsval_loose_eq=function(e,t){return o(e)==o(t)},t.wbg.__wbindgen_as_number=function(e){return+o(e)},t.wbg.__wbindgen_number_new=function(e){return b(e)},t.wbg.__wbg_getwithrefkey_edc2c8960f0f1191=function(e,t){return b(o(e)[o(t)])},t.wbg.__wbg_set_f975102236d3c502=function(e,t,n){o(e)[g(t)]=g(n)},t.wbg.__wbg_String_b9412f8799faab3e=function(e,t){const n=d(String(o(t)),r.__wbindgen_malloc,r.__wbindgen_realloc),a=i;h()[e/4+1]=a,h()[e/4+0]=n},t.wbg.__wbg_get_bd8e338fbd5f5cc8=function(e,t){return b(o(e)[t>>>0])},t.wbg.__wbg_length_cd7af8117672b8b8=function(e){return o(e).length},t.wbg.__wbg_new_16b304a2cfa7ff4a=function(){return b(new Array)},t.wbg.__wbg_newnoargs_e258087cd0daa0ea=function(e,t){return b(new Function(v(e,t)))},t.wbg.__wbg_call_27c0f87801dedf93=function(){return E((function(e,t){return b(o(e).call(o(t)))}),arguments)},t.wbg.__wbg_new_72fb9a18b5ae2624=function(){return b(new Object)},t.wbg.__wbg_self_ce0dbfc45cf2f5be=function(){return E((function(){return b(self.self)}),arguments)},t.wbg.__wbg_window_c6fb939a7f436783=function(){return E((function(){return b(window.window)}),arguments)},t.wbg.__wbg_globalThis_d1e6af4856ba331b=function(){return E((function(){return b(globalThis.globalThis)}),arguments)},t.wbg.__wbg_global_207b558942527489=function(){return E((function(){return b(n.g.global)}),arguments)},t.wbg.__wbg_set_d4638f722068f043=function(e,t,n){o(e)[t>>>0]=g(n)},t.wbg.__wbg_instanceof_ArrayBuffer_836825be07d4c9d2=function(e){let t;try{t=o(e)instanceof ArrayBuffer}catch(e){t=!1}return t},t.wbg.__wbg_call_b3ca7c6051f9bec1=function(){return E((function(e,t,n){return b(o(e).call(o(t),o(n)))}),arguments)},t.wbg.__wbg_isSafeInteger_f7b04ef02296c4d2=function(e){return Number.isSafeInteger(o(e))},t.wbg.__wbg_entries_95cc2c823b285a09=function(e){return b(Object.entries(o(e)))},t.wbg.__wbg_buffer_12d079cc21e14bdb=function(e){return b(o(e).buffer)},t.wbg.__wbg_newwithbyteoffsetandlength_aa4a17c33a06e5cb=function(e,t,n){return b(new Uint8Array(o(e),t>>>0,n>>>0))},t.wbg.__wbg_new_63b92bc8671ed464=function(e){return b(new Uint8Array(o(e)))},t.wbg.__wbg_set_a47bac70306a19a7=function(e,t,n){o(e).set(o(t),n>>>0)},t.wbg.__wbg_length_c20a40f15020d68a=function(e){return o(e).length},t.wbg.__wbg_new_5e4931c0e7b0d773=function(e){return b(new Float64Array(o(e)))},t.wbg.__wbg_set_cb4cf3c3a46bcdd2=function(e,t,n){o(e).set(o(t),n>>>0)},t.wbg.__wbg_length_0382220548385255=function(e){return o(e).length},t.wbg.__wbg_instanceof_Uint8Array_2b3bbecd033d19f6=function(e){let t;try{t=o(e)instanceof Uint8Array}catch(e){t=!1}return t},t.wbg.__wbg_newwithlength_e9b4878cebadb3d3=function(e){return b(new Uint8Array(e>>>0))},t.wbg.__wbg_subarray_a1f73cd4b5b42fe1=function(e,t,n){return b(o(e).subarray(t>>>0,n>>>0))},t.wbg.__wbindgen_bigint_get_as_i64=function(e,t){const n=o(t),a="bigint"==typeof n?n:void 0;(null!==S&&0!==S.byteLength||(S=new BigInt64Array(r.memory.buffer)),S)[e/8+1]=p(a)?BigInt(0):a,h()[e/4+0]=!p(a)},t.wbg.__wbindgen_debug_string=function(e,t){const n=d(_(o(t)),r.__wbindgen_malloc,r.__wbindgen_realloc),a=i;h()[e/4+1]=a,h()[e/4+0]=n},t.wbg.__wbindgen_throw=function(e,t){throw new Error(v(e,t))},t.wbg.__wbindgen_memory=function(){return b(r.memory)},t}async function L(e){if(void 0!==r)return r;void 0===e&&(e=new URL(n(983),n.b));const t=F();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:a,module:o}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return function(e,t){return r=e.exports,L.__wbindgen_wasm_module=t,S=null,w=null,f=null,x=null,s=null,r.__wbindgen_start(),r}(a,o)}const $=L},45:(e,t,n)=>{"use strict";function r(e){var t,n,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(a&&(a+=" "),a+=n);else for(t in e)e[t]&&(a&&(a+=" "),a+=t);return a}function a(){for(var e,t,n=0,a="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(a&&(a+=" "),a+=t);return a}n.r(t),n.d(t,{clsx:()=>a,default:()=>o});const o=a},652:(e,t,n)=>{e=n.nmd(e);var r="__lodash_hash_undefined__",a=1,o=2,i=9007199254740991,s="[object Arguments]",l="[object Array]",u="[object AsyncFunction]",c="[object Boolean]",d="[object Date]",p="[object Error]",f="[object Function]",h="[object GeneratorFunction]",m="[object Map]",g="[object Number]",b="[object Null]",y="[object Object]",v="[object Promise]",w="[object Proxy]",O="[object RegExp]",S="[object Set]",_="[object String]",x="[object Undefined]",P="[object WeakMap]",j="[object ArrayBuffer]",C="[object DataView]",E=/^\[object .+?Constructor\]$/,D=/^(?:0|[1-9]\d*)$/,k={};k["[object Float32Array]"]=k["[object Float64Array]"]=k["[object Int8Array]"]=k["[object Int16Array]"]=k["[object Int32Array]"]=k["[object Uint8Array]"]=k["[object Uint8ClampedArray]"]=k["[object Uint16Array]"]=k["[object Uint32Array]"]=!0,k[s]=k[l]=k[j]=k[c]=k[C]=k[d]=k[p]=k[f]=k[m]=k[g]=k[y]=k[O]=k[S]=k[_]=k[P]=!1;var T="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,R="object"==typeof self&&self&&self.Object===Object&&self,A=T||R||Function("return this")(),I=t&&!t.nodeType&&t,V=I&&e&&!e.nodeType&&e,M=V&&V.exports===I,F=M&&T.process,L=function(){try{return F&&F.binding&&F.binding("util")}catch(e){}}(),$=L&&L.isTypedArray;function N(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function B(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function z(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var q,H,W,U=Array.prototype,G=Function.prototype,Q=Object.prototype,K=A["__core-js_shared__"],Y=G.toString,Z=Q.hasOwnProperty,X=(q=/[^.]+$/.exec(K&&K.keys&&K.keys.IE_PROTO||""))?"Symbol(src)_1."+q:"",J=Q.toString,ee=RegExp("^"+Y.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=M?A.Buffer:void 0,ne=A.Symbol,re=A.Uint8Array,ae=Q.propertyIsEnumerable,oe=U.splice,ie=ne?ne.toStringTag:void 0,se=Object.getOwnPropertySymbols,le=te?te.isBuffer:void 0,ue=(H=Object.keys,W=Object,function(e){return H(W(e))}),ce=Ve(A,"DataView"),de=Ve(A,"Map"),pe=Ve(A,"Promise"),fe=Ve(A,"Set"),he=Ve(A,"WeakMap"),me=Ve(Object,"create"),ge=$e(ce),be=$e(de),ye=$e(pe),ve=$e(fe),we=$e(he),Oe=ne?ne.prototype:void 0,Se=Oe?Oe.valueOf:void 0;function _e(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function xe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Pe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function je(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Pe;++t<n;)this.add(e[t])}function Ce(e){var t=this.__data__=new xe(e);this.size=t.size}function Ee(e,t){for(var n=e.length;n--;)if(Ne(e[n][0],t))return n;return-1}function De(e){return null==e?void 0===e?x:b:ie&&ie in Object(e)?function(e){var t=Z.call(e,ie),n=e[ie];try{e[ie]=void 0;var r=!0}catch(e){}var a=J.call(e);return r&&(t?e[ie]=n:delete e[ie]),a}(e):function(e){return J.call(e)}(e)}function ke(e){return Ge(e)&&De(e)==s}function Te(e,t,n,r,i){return e===t||(null==e||null==t||!Ge(e)&&!Ge(t)?e!=e&&t!=t:function(e,t,n,r,i,u){var f=ze(e),h=ze(t),b=f?l:Fe(e),v=h?l:Fe(t),w=(b=b==s?y:b)==y,x=(v=v==s?y:v)==y,P=b==v;if(P&&qe(e)){if(!qe(t))return!1;f=!0,w=!1}if(P&&!w)return u||(u=new Ce),f||Qe(e)?Re(e,t,n,r,i,u):function(e,t,n,r,i,s,l){switch(n){case C:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case j:return!(e.byteLength!=t.byteLength||!s(new re(e),new re(t)));case c:case d:case g:return Ne(+e,+t);case p:return e.name==t.name&&e.message==t.message;case O:case _:return e==t+"";case m:var u=B;case S:var f=r&a;if(u||(u=z),e.size!=t.size&&!f)return!1;var h=l.get(e);if(h)return h==t;r|=o,l.set(e,t);var b=Re(u(e),u(t),r,i,s,l);return l.delete(e),b;case"[object Symbol]":if(Se)return Se.call(e)==Se.call(t)}return!1}(e,t,b,n,r,i,u);if(!(n&a)){var E=w&&Z.call(e,"__wrapped__"),D=x&&Z.call(t,"__wrapped__");if(E||D){var k=E?e.value():e,T=D?t.value():t;return u||(u=new Ce),i(k,T,n,r,u)}}return!!P&&(u||(u=new Ce),function(e,t,n,r,o,i){var s=n&a,l=Ae(e),u=l.length;if(u!=Ae(t).length&&!s)return!1;for(var c=u;c--;){var d=l[c];if(!(s?d in t:Z.call(t,d)))return!1}var p=i.get(e);if(p&&i.get(t))return p==t;var f=!0;i.set(e,t),i.set(t,e);for(var h=s;++c<u;){var m=e[d=l[c]],g=t[d];if(r)var b=s?r(g,m,d,t,e,i):r(m,g,d,e,t,i);if(!(void 0===b?m===g||o(m,g,n,r,i):b)){f=!1;break}h||(h="constructor"==d)}if(f&&!h){var y=e.constructor,v=t.constructor;y==v||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof v&&v instanceof v||(f=!1)}return i.delete(e),i.delete(t),f}(e,t,n,r,i,u))}(e,t,n,r,Te,i))}function Re(e,t,n,r,i,s){var l=n&a,u=e.length,c=t.length;if(u!=c&&!(l&&c>u))return!1;var d=s.get(e);if(d&&s.get(t))return d==t;var p=-1,f=!0,h=n&o?new je:void 0;for(s.set(e,t),s.set(t,e);++p<u;){var m=e[p],g=t[p];if(r)var b=l?r(g,m,p,t,e,s):r(m,g,p,e,t,s);if(void 0!==b){if(b)continue;f=!1;break}if(h){if(!N(t,(function(e,t){if(a=t,!h.has(a)&&(m===e||i(m,e,n,r,s)))return h.push(t);var a}))){f=!1;break}}else if(m!==g&&!i(m,g,n,r,s)){f=!1;break}}return s.delete(e),s.delete(t),f}function Ae(e){return function(e,t,n){var r=t(e);return ze(e)?r:function(e,t){for(var n=-1,r=t.length,a=e.length;++n<r;)e[a+n]=t[n];return e}(r,n(e))}(e,Ke,Me)}function Ie(e,t){var n,r,a=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?a["string"==typeof t?"string":"hash"]:a.map}function Ve(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!Ue(e)||function(e){return!!X&&X in e}(e))&&(He(e)?ee:E).test($e(e))}(n)?n:void 0}_e.prototype.clear=function(){this.__data__=me?me(null):{},this.size=0},_e.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},_e.prototype.get=function(e){var t=this.__data__;if(me){var n=t[e];return n===r?void 0:n}return Z.call(t,e)?t[e]:void 0},_e.prototype.has=function(e){var t=this.__data__;return me?void 0!==t[e]:Z.call(t,e)},_e.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=me&&void 0===t?r:t,this},xe.prototype.clear=function(){this.__data__=[],this.size=0},xe.prototype.delete=function(e){var t=this.__data__,n=Ee(t,e);return!(n<0||(n==t.length-1?t.pop():oe.call(t,n,1),--this.size,0))},xe.prototype.get=function(e){var t=this.__data__,n=Ee(t,e);return n<0?void 0:t[n][1]},xe.prototype.has=function(e){return Ee(this.__data__,e)>-1},xe.prototype.set=function(e,t){var n=this.__data__,r=Ee(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Pe.prototype.clear=function(){this.size=0,this.__data__={hash:new _e,map:new(de||xe),string:new _e}},Pe.prototype.delete=function(e){var t=Ie(this,e).delete(e);return this.size-=t?1:0,t},Pe.prototype.get=function(e){return Ie(this,e).get(e)},Pe.prototype.has=function(e){return Ie(this,e).has(e)},Pe.prototype.set=function(e,t){var n=Ie(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},je.prototype.add=je.prototype.push=function(e){return this.__data__.set(e,r),this},je.prototype.has=function(e){return this.__data__.has(e)},Ce.prototype.clear=function(){this.__data__=new xe,this.size=0},Ce.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Ce.prototype.get=function(e){return this.__data__.get(e)},Ce.prototype.has=function(e){return this.__data__.has(e)},Ce.prototype.set=function(e,t){var n=this.__data__;if(n instanceof xe){var r=n.__data__;if(!de||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Pe(r)}return n.set(e,t),this.size=n.size,this};var Me=se?function(e){return null==e?[]:(e=Object(e),function(t,n){for(var r=-1,a=null==t?0:t.length,o=0,i=[];++r<a;){var s=t[r];l=s,ae.call(e,l)&&(i[o++]=s)}var l;return i}(se(e)))}:function(){return[]},Fe=De;function Le(e,t){return!!(t=null==t?i:t)&&("number"==typeof e||D.test(e))&&e>-1&&e%1==0&&e<t}function $e(e){if(null!=e){try{return Y.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Ne(e,t){return e===t||e!=e&&t!=t}(ce&&Fe(new ce(new ArrayBuffer(1)))!=C||de&&Fe(new de)!=m||pe&&Fe(pe.resolve())!=v||fe&&Fe(new fe)!=S||he&&Fe(new he)!=P)&&(Fe=function(e){var t=De(e),n=t==y?e.constructor:void 0,r=n?$e(n):"";if(r)switch(r){case ge:return C;case be:return m;case ye:return v;case ve:return S;case we:return P}return t});var Be=ke(function(){return arguments}())?ke:function(e){return Ge(e)&&Z.call(e,"callee")&&!ae.call(e,"callee")},ze=Array.isArray,qe=le||function(){return!1};function He(e){if(!Ue(e))return!1;var t=De(e);return t==f||t==h||t==u||t==w}function We(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}function Ue(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ge(e){return null!=e&&"object"==typeof e}var Qe=$?function(e){return function(t){return e(t)}}($):function(e){return Ge(e)&&We(e.length)&&!!k[De(e)]};function Ke(e){return null!=(t=e)&&We(t.length)&&!He(t)?function(e,t){var n=ze(e),r=!n&&Be(e),a=!n&&!r&&qe(e),o=!n&&!r&&!a&&Qe(e),i=n||r||a||o,s=i?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],l=s.length;for(var u in e)!t&&!Z.call(e,u)||i&&("length"==u||a&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Le(u,l))||s.push(u);return s}(e):function(e){if(n=(t=e)&&t.constructor,t!==("function"==typeof n&&n.prototype||Q))return ue(e);var t,n,r=[];for(var a in Object(e))Z.call(e,a)&&"constructor"!=a&&r.push(a);return r}(e);var t}e.exports=function(e,t){return Te(e,t)}},459:(e,t,n)=>{"use strict";var r=n(704);function a(){}function o(){}o.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,o,i){if(i!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:a};return n.PropTypes=n,n}},216:(e,t,n)=>{e.exports=n(459)()},704:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},892:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraggableCore",{enumerable:!0,get:function(){return d.default}}),t.default=void 0;var a=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=m(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=o?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(a,i,s):a[i]=e[i]}return a.default=e,n&&n.set(e,a),a}(n(650)),o=h(n(216)),i=h(n(729)),s=h(n(45)),l=n(667),u=n(391),c=n(529),d=h(n(838)),p=h(n(710)),f=["axis","bounds","children","defaultPosition","defaultClassName","defaultClassNameDragging","defaultClassNameDragged","position","positionOffset","scale"];function h(e){return e&&e.__esModule?e:{default:e}}function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(m=function(e){return e?n:t})(e)}function g(){return g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},g.apply(this,arguments)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e,t){return O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},O(e,t)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(b,e);var t,n,o,c,h,m=(c=b,h=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_(c);if(h){var n=_(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return S(e)}(this,e)});function b(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),x(S(t=m.call(this,e)),"onDragStart",(function(e,n){if((0,p.default)("Draggable: onDragStart: %j",n),!1===t.props.onStart(e,(0,u.createDraggableData)(S(t),n)))return!1;t.setState({dragging:!0,dragged:!0})})),x(S(t),"onDrag",(function(e,n){if(!t.state.dragging)return!1;(0,p.default)("Draggable: onDrag: %j",n);var r,a,o=(0,u.createDraggableData)(S(t),n),i={x:o.x,y:o.y};if(t.props.bounds){var s=i.x,l=i.y;i.x+=t.state.slackX,i.y+=t.state.slackY;var c=(r=(0,u.getBoundPosition)(S(t),i.x,i.y),a=2,function(e){if(Array.isArray(e))return e}(r)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw a}}return o}}(r,a)||function(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(r,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=c[0],f=c[1];i.x=d,i.y=f,i.slackX=t.state.slackX+(s-i.x),i.slackY=t.state.slackY+(l-i.y),o.x=i.x,o.y=i.y,o.deltaX=i.x-t.state.x,o.deltaY=i.y-t.state.y}if(!1===t.props.onDrag(e,o))return!1;t.setState(i)})),x(S(t),"onDragStop",(function(e,n){if(!t.state.dragging)return!1;if(!1===t.props.onStop(e,(0,u.createDraggableData)(S(t),n)))return!1;(0,p.default)("Draggable: onDragStop: %j",n);var r={dragging:!1,slackX:0,slackY:0};if(Boolean(t.props.position)){var a=t.props.position,o=a.x,i=a.y;r.x=o,r.y=i}t.setState(r)})),t.state={dragging:!1,dragged:!1,x:e.position?e.position.x:e.defaultPosition.x,y:e.position?e.position.y:e.defaultPosition.y,prevPropsPosition:y({},e.position),slackX:0,slackY:0,isElementSVG:!1},!e.position||e.onDrag||e.onStop||console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element."),t}return t=b,o=[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.position,r=t.prevPropsPosition;return!n||r&&n.x===r.x&&n.y===r.y?null:((0,p.default)("Draggable: getDerivedStateFromProps %j",{position:n,prevPropsPosition:r}),{x:n.x,y:n.y,prevPropsPosition:y({},n)})}}],(n=[{key:"componentDidMount",value:function(){void 0!==window.SVGElement&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}},{key:"componentWillUnmount",value:function(){this.setState({dragging:!1})}},{key:"findDOMNode",value:function(){var e,t,n;return null!==(e=null===(t=this.props)||void 0===t||null===(n=t.nodeRef)||void 0===n?void 0:n.current)&&void 0!==e?e:i.default.findDOMNode(this)}},{key:"render",value:function(){var e,t=this.props,n=(t.axis,t.bounds,t.children),r=t.defaultPosition,o=t.defaultClassName,i=t.defaultClassNameDragging,c=t.defaultClassNameDragged,p=t.position,h=t.positionOffset,m=(t.scale,function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(t,f)),b={},v=null,w=!Boolean(p)||this.state.dragging,O=p||r,S={x:(0,u.canDragX)(this)&&w?this.state.x:O.x,y:(0,u.canDragY)(this)&&w?this.state.y:O.y};this.state.isElementSVG?v=(0,l.createSVGTransform)(S,h):b=(0,l.createCSSTransform)(S,h);var _=(0,s.default)(n.props.className||"",o,(x(e={},i,this.state.dragging),x(e,c,this.state.dragged),e));return a.createElement(d.default,g({},m,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),a.cloneElement(a.Children.only(n),{className:_,style:y(y({},n.props.style),b),transform:v}))}}])&&w(t.prototype,n),o&&w(t,o),Object.defineProperty(t,"prototype",{writable:!1}),b}(a.Component);t.default=P,x(P,"displayName","Draggable"),x(P,"propTypes",y(y({},d.default.propTypes),{},{axis:o.default.oneOf(["both","x","y","none"]),bounds:o.default.oneOfType([o.default.shape({left:o.default.number,right:o.default.number,top:o.default.number,bottom:o.default.number}),o.default.string,o.default.oneOf([!1])]),defaultClassName:o.default.string,defaultClassNameDragging:o.default.string,defaultClassNameDragged:o.default.string,defaultPosition:o.default.shape({x:o.default.number,y:o.default.number}),positionOffset:o.default.shape({x:o.default.oneOfType([o.default.number,o.default.string]),y:o.default.oneOfType([o.default.number,o.default.string])}),position:o.default.shape({x:o.default.number,y:o.default.number}),className:c.dontSetMe,style:c.dontSetMe,transform:c.dontSetMe})),x(P,"defaultProps",y(y({},d.default.defaultProps),{},{axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1}))},838:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=o?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(a,i,s):a[i]=e[i]}return a.default=e,n&&n.set(e,a),a}(n(650)),o=d(n(216)),i=d(n(729)),s=n(667),l=n(391),u=n(529),c=d(n(710));function d(e){return e&&e.__esModule?e:{default:e}}function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t){return g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},g(e,t)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w={start:"touchstart",move:"touchmove",stop:"touchend"},O={start:"mousedown",move:"mousemove",stop:"mouseup"},S=O,_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(p,e);var t,n,o,u,d=(o=p,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=y(o);if(u){var n=y(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return b(e)}(this,e)});function p(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return v(b(e=d.call.apply(d,[this].concat(n))),"state",{dragging:!1,lastX:NaN,lastY:NaN,touchIdentifier:null}),v(b(e),"mounted",!1),v(b(e),"handleDragStart",(function(t){if(e.props.onMouseDown(t),!e.props.allowAnyClick&&"number"==typeof t.button&&0!==t.button)return!1;var n=e.findDOMNode();if(!n||!n.ownerDocument||!n.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");var r=n.ownerDocument;if(!(e.props.disabled||!(t.target instanceof r.defaultView.Node)||e.props.handle&&!(0,s.matchesSelectorAndParentsTo)(t.target,e.props.handle,n)||e.props.cancel&&(0,s.matchesSelectorAndParentsTo)(t.target,e.props.cancel,n))){"touchstart"===t.type&&t.preventDefault();var a=(0,s.getTouchIdentifier)(t);e.setState({touchIdentifier:a});var o=(0,l.getControlPosition)(t,a,b(e));if(null!=o){var i=o.x,u=o.y,d=(0,l.createCoreData)(b(e),i,u);(0,c.default)("DraggableCore: handleDragStart: %j",d),(0,c.default)("calling",e.props.onStart),!1!==e.props.onStart(t,d)&&!1!==e.mounted&&(e.props.enableUserSelectHack&&(0,s.addUserSelectStyles)(r),e.setState({dragging:!0,lastX:i,lastY:u}),(0,s.addEvent)(r,S.move,e.handleDrag),(0,s.addEvent)(r,S.stop,e.handleDragStop))}}})),v(b(e),"handleDrag",(function(t){var n=(0,l.getControlPosition)(t,e.state.touchIdentifier,b(e));if(null!=n){var r=n.x,a=n.y;if(Array.isArray(e.props.grid)){var o=r-e.state.lastX,i=a-e.state.lastY,s=f((0,l.snapToGrid)(e.props.grid,o,i),2);if(o=s[0],i=s[1],!o&&!i)return;r=e.state.lastX+o,a=e.state.lastY+i}var u=(0,l.createCoreData)(b(e),r,a);if((0,c.default)("DraggableCore: handleDrag: %j",u),!1!==e.props.onDrag(t,u)&&!1!==e.mounted)e.setState({lastX:r,lastY:a});else try{e.handleDragStop(new MouseEvent("mouseup"))}catch(t){var d=document.createEvent("MouseEvents");d.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.handleDragStop(d)}}})),v(b(e),"handleDragStop",(function(t){if(e.state.dragging){var n=(0,l.getControlPosition)(t,e.state.touchIdentifier,b(e));if(null!=n){var r=n.x,a=n.y;if(Array.isArray(e.props.grid)){var o=r-e.state.lastX||0,i=a-e.state.lastY||0,u=f((0,l.snapToGrid)(e.props.grid,o,i),2);o=u[0],i=u[1],r=e.state.lastX+o,a=e.state.lastY+i}var d=(0,l.createCoreData)(b(e),r,a);if(!1===e.props.onStop(t,d)||!1===e.mounted)return!1;var p=e.findDOMNode();p&&e.props.enableUserSelectHack&&(0,s.removeUserSelectStyles)(p.ownerDocument),(0,c.default)("DraggableCore: handleDragStop: %j",d),e.setState({dragging:!1,lastX:NaN,lastY:NaN}),p&&((0,c.default)("DraggableCore: Removing handlers"),(0,s.removeEvent)(p.ownerDocument,S.move,e.handleDrag),(0,s.removeEvent)(p.ownerDocument,S.stop,e.handleDragStop))}}})),v(b(e),"onMouseDown",(function(t){return S=O,e.handleDragStart(t)})),v(b(e),"onMouseUp",(function(t){return S=O,e.handleDragStop(t)})),v(b(e),"onTouchStart",(function(t){return S=w,e.handleDragStart(t)})),v(b(e),"onTouchEnd",(function(t){return S=w,e.handleDragStop(t)})),e}return t=p,(n=[{key:"componentDidMount",value:function(){this.mounted=!0;var e=this.findDOMNode();e&&(0,s.addEvent)(e,w.start,this.onTouchStart,{passive:!1})}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var e=this.findDOMNode();if(e){var t=e.ownerDocument;(0,s.removeEvent)(t,O.move,this.handleDrag),(0,s.removeEvent)(t,w.move,this.handleDrag),(0,s.removeEvent)(t,O.stop,this.handleDragStop),(0,s.removeEvent)(t,w.stop,this.handleDragStop),(0,s.removeEvent)(e,w.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,s.removeUserSelectStyles)(t)}}},{key:"findDOMNode",value:function(){var e,t,n;return null!==(e=this.props)&&void 0!==e&&e.nodeRef?null===(t=this.props)||void 0===t||null===(n=t.nodeRef)||void 0===n?void 0:n.current:i.default.findDOMNode(this)}},{key:"render",value:function(){return a.cloneElement(a.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}}])&&m(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(a.Component);t.default=_,v(_,"displayName","DraggableCore"),v(_,"propTypes",{allowAnyClick:o.default.bool,disabled:o.default.bool,enableUserSelectHack:o.default.bool,offsetParent:function(e,t){if(e[t]&&1!==e[t].nodeType)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:o.default.arrayOf(o.default.number),handle:o.default.string,cancel:o.default.string,nodeRef:o.default.object,onStart:o.default.func,onDrag:o.default.func,onStop:o.default.func,onMouseDown:o.default.func,scale:o.default.number,className:u.dontSetMe,style:u.dontSetMe,transform:u.dontSetMe}),v(_,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1})},294:(e,t,n)=>{"use strict";var r=n(892),a=r.default,o=r.DraggableCore;e.exports=a,e.exports.default=a,e.exports.DraggableCore=o},667:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.addClassName=f,t.addEvent=function(e,t,n,r){if(e){var a=l({capture:!0},r);e.addEventListener?e.addEventListener(t,n,a):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}},t.addUserSelectStyles=function(e){if(e){var t=e.getElementById("react-draggable-style-el");t||((t=e.createElement("style")).type="text/css",t.id="react-draggable-style-el",t.innerHTML=".react-draggable-transparent-selection *::-moz-selection {all: inherit;}\n",t.innerHTML+=".react-draggable-transparent-selection *::selection {all: inherit;}\n",e.getElementsByTagName("head")[0].appendChild(t)),e.body&&f(e.body,"react-draggable-transparent-selection")}},t.createCSSTransform=function(e,t){var n=p(e,t,"px");return u({},(0,o.browserPrefixToKey)("transform",o.default),n)},t.createSVGTransform=function(e,t){return p(e,t,"")},t.getTouch=function(e,t){return e.targetTouches&&(0,a.findInArray)(e.targetTouches,(function(e){return t===e.identifier}))||e.changedTouches&&(0,a.findInArray)(e.changedTouches,(function(e){return t===e.identifier}))},t.getTouchIdentifier=function(e){return e.targetTouches&&e.targetTouches[0]?e.targetTouches[0].identifier:e.changedTouches&&e.changedTouches[0]?e.changedTouches[0].identifier:void 0},t.getTranslation=p,t.innerHeight=function(e){var t=e.clientHeight,n=e.ownerDocument.defaultView.getComputedStyle(e);return(t-=(0,a.int)(n.paddingTop))-(0,a.int)(n.paddingBottom)},t.innerWidth=function(e){var t=e.clientWidth,n=e.ownerDocument.defaultView.getComputedStyle(e);return(t-=(0,a.int)(n.paddingLeft))-(0,a.int)(n.paddingRight)},t.matchesSelector=d,t.matchesSelectorAndParentsTo=function(e,t,n){var r=e;do{if(d(r,t))return!0;if(r===n)return!1;r=r.parentNode}while(r);return!1},t.offsetXYFromParent=function(e,t,n){var r=t===t.ownerDocument.body?{left:0,top:0}:t.getBoundingClientRect();return{x:(e.clientX+t.scrollLeft-r.left)/n,y:(e.clientY+t.scrollTop-r.top)/n}},t.outerHeight=function(e){var t=e.clientHeight,n=e.ownerDocument.defaultView.getComputedStyle(e);return(t+=(0,a.int)(n.borderTopWidth))+(0,a.int)(n.borderBottomWidth)},t.outerWidth=function(e){var t=e.clientWidth,n=e.ownerDocument.defaultView.getComputedStyle(e);return(t+=(0,a.int)(n.borderLeftWidth))+(0,a.int)(n.borderRightWidth)},t.removeClassName=h,t.removeEvent=function(e,t,n,r){if(e){var a=l({capture:!0},r);e.removeEventListener?e.removeEventListener(t,n,a):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null}},t.removeUserSelectStyles=function(e){if(e)try{if(e.body&&h(e.body,"react-draggable-transparent-selection"),e.selection)e.selection.empty();else{var t=(e.defaultView||window).getSelection();t&&"Caret"!==t.type&&t.removeAllRanges()}}catch(e){}};var a=n(529),o=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var l=o?Object.getOwnPropertyDescriptor(e,s):null;l&&(l.get||l.set)?Object.defineProperty(a,s,l):a[s]=e[s]}return a.default=e,n&&n.set(e,a),a}(n(781));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c="";function d(e,t){return c||(c=(0,a.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],(function(t){return(0,a.isFunction)(e[t])}))),!!(0,a.isFunction)(e[c])&&e[c](t)}function p(e,t,n){var r=e.x,a=e.y,o="translate(".concat(r).concat(n,",").concat(a).concat(n,")");if(t){var i="".concat("string"==typeof t.x?t.x:t.x+n),s="".concat("string"==typeof t.y?t.y:t.y+n);o="translate(".concat(i,", ").concat(s,")")+o}return o}function f(e,t){e.classList?e.classList.add(t):e.className.match(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)")))||(e.className+=" ".concat(t))}function h(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)"),"g"),"")}},781:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.browserPrefixToKey=a,t.browserPrefixToStyle=function(e,t){return t?"-".concat(t.toLowerCase(),"-").concat(e):e},t.default=void 0,t.getPrefix=r;var n=["Moz","Webkit","O","ms"];function r(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"transform";if("undefined"==typeof window)return"";var o=null===(e=window.document)||void 0===e||null===(t=e.documentElement)||void 0===t?void 0:t.style;if(!o)return"";if(r in o)return"";for(var i=0;i<n.length;i++)if(a(r,n[i])in o)return n[i];return""}function a(e,t){return t?"".concat(t).concat(function(e){for(var t="",n=!0,r=0;r<e.length;r++)n?(t+=e[r].toUpperCase(),n=!1):"-"===e[r]?n=!0:t+=e[r];return t}(e)):e}var o=r();t.default=o},710:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){}},391:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canDragX=function(e){return"both"===e.props.axis||"x"===e.props.axis},t.canDragY=function(e){return"both"===e.props.axis||"y"===e.props.axis},t.createCoreData=function(e,t,n){var a=e.state,i=!(0,r.isNum)(a.lastX),s=o(e);return i?{node:s,deltaX:0,deltaY:0,lastX:t,lastY:n,x:t,y:n}:{node:s,deltaX:t-a.lastX,deltaY:n-a.lastY,lastX:a.lastX,lastY:a.lastY,x:t,y:n}},t.createDraggableData=function(e,t){var n=e.props.scale;return{node:t.node,x:e.state.x+t.deltaX/n,y:e.state.y+t.deltaY/n,deltaX:t.deltaX/n,deltaY:t.deltaY/n,lastX:e.state.x,lastY:e.state.y}},t.getBoundPosition=function(e,t,n){if(!e.props.bounds)return[t,n];var i=e.props.bounds;i="string"==typeof i?i:function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}(i);var s=o(e);if("string"==typeof i){var l,u=s.ownerDocument,c=u.defaultView;if(!((l="parent"===i?s.parentNode:u.querySelector(i))instanceof c.HTMLElement))throw new Error('Bounds selector "'+i+'" could not find an element.');var d=l,p=c.getComputedStyle(s),f=c.getComputedStyle(d);i={left:-s.offsetLeft+(0,r.int)(f.paddingLeft)+(0,r.int)(p.marginLeft),top:-s.offsetTop+(0,r.int)(f.paddingTop)+(0,r.int)(p.marginTop),right:(0,a.innerWidth)(d)-(0,a.outerWidth)(s)-s.offsetLeft+(0,r.int)(f.paddingRight)-(0,r.int)(p.marginRight),bottom:(0,a.innerHeight)(d)-(0,a.outerHeight)(s)-s.offsetTop+(0,r.int)(f.paddingBottom)-(0,r.int)(p.marginBottom)}}return(0,r.isNum)(i.right)&&(t=Math.min(t,i.right)),(0,r.isNum)(i.bottom)&&(n=Math.min(n,i.bottom)),(0,r.isNum)(i.left)&&(t=Math.max(t,i.left)),(0,r.isNum)(i.top)&&(n=Math.max(n,i.top)),[t,n]},t.getControlPosition=function(e,t,n){var r="number"==typeof t?(0,a.getTouch)(e,t):null;if("number"==typeof t&&!r)return null;var i=o(n),s=n.props.offsetParent||i.offsetParent||i.ownerDocument.body;return(0,a.offsetXYFromParent)(r||e,s,n.props.scale)},t.snapToGrid=function(e,t,n){return[Math.round(t/e[0])*e[0],Math.round(n/e[1])*e[1]]};var r=n(529),a=n(667);function o(e){var t=e.findDOMNode();if(!t)throw new Error("<DraggableCore>: Unmounted during event!");return t}},529:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dontSetMe=function(e,t,n){if(e[t])return new Error("Invalid prop ".concat(t," passed to ").concat(n," - do not set this, set it on the child."))},t.findInArray=function(e,t){for(var n=0,r=e.length;n<r;n++)if(t.apply(t,[e[n],n,e]))return e[n]},t.int=function(e){return parseInt(e,10)},t.isFunction=function(e){return"function"==typeof e||"[object Function]"===Object.prototype.toString.call(e)},t.isNum=function(e){return"number"==typeof e&&!isNaN(e)}},844:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=p(n(650)),o=p(n(216)),i=n(294),s=n(453),l=n(107),u=n(698),c=n(450),d=p(n(45));function p(e){return e&&e.__esModule?e:{default:e}}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t){return g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},g(e,t)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(f,e);var t,n,o,c,p=(o=f,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=y(o);if(c){var n=y(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return b(e)}(this,e)});function f(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return v(b(e=p.call.apply(p,[this].concat(n))),"state",{resizing:null,dragging:null,className:""}),v(b(e),"elementRef",a.default.createRef()),v(b(e),"onDragStart",(function(t,n){var r=n.node,a=e.props,o=a.onDragStart,i=a.transformScale;if(o){var s={top:0,left:0},l=r.offsetParent;if(l){var c=l.getBoundingClientRect(),d=r.getBoundingClientRect(),p=d.left/i,f=c.left/i,h=d.top/i,m=c.top/i;s.left=p-f+l.scrollLeft,s.top=h-m+l.scrollTop,e.setState({dragging:s});var g=(0,u.calcXY)(e.getPositionParams(),s.top,s.left,e.props.w,e.props.h),y=g.x,v=g.y;return o.call(b(e),e.props.i,y,v,{e:t,node:r,newPosition:s})}}})),v(b(e),"onDrag",(function(t,n){var r=n.node,a=n.deltaX,o=n.deltaY,i=e.props.onDrag;if(i){if(!e.state.dragging)throw new Error("onDrag called before onDragStart.");var s=e.state.dragging.top+o,l=e.state.dragging.left+a,c=e.props,d=c.isBounded,p=c.i,f=c.w,h=c.h,m=c.containerWidth,g=e.getPositionParams();if(d){var y=r.offsetParent;if(y){var v=e.props,w=v.margin,O=v.rowHeight,S=y.clientHeight-(0,u.calcGridItemWHPx)(h,O,w[1]);s=(0,u.clamp)(s,0,S);var _=(0,u.calcGridColWidth)(g),x=m-(0,u.calcGridItemWHPx)(f,_,w[0]);l=(0,u.clamp)(l,0,x)}}var P={top:s,left:l};e.setState({dragging:P});var j=(0,u.calcXY)(g,s,l,f,h),C=j.x,E=j.y;return i.call(b(e),p,C,E,{e:t,node:r,newPosition:P})}})),v(b(e),"onDragStop",(function(t,n){var r=n.node,a=e.props.onDragStop;if(a){if(!e.state.dragging)throw new Error("onDragEnd called before onDragStart.");var o=e.props,i=o.w,s=o.h,l=o.i,c=e.state.dragging,d=c.left,p=c.top,f={top:p,left:d};e.setState({dragging:null});var h=(0,u.calcXY)(e.getPositionParams(),p,d,i,s),m=h.x,g=h.y;return a.call(b(e),l,m,g,{e:t,node:r,newPosition:f})}})),v(b(e),"onResizeStop",(function(t,n){e.onResizeHandler(t,n,"onResizeStop")})),v(b(e),"onResizeStart",(function(t,n){e.onResizeHandler(t,n,"onResizeStart")})),v(b(e),"onResize",(function(t,n){e.onResizeHandler(t,n,"onResize")})),e}return t=f,n=[{key:"shouldComponentUpdate",value:function(e,t){if(this.props.children!==e.children)return!0;if(this.props.droppingPosition!==e.droppingPosition)return!0;var n=(0,u.calcGridItemPosition)(this.getPositionParams(this.props),this.props.x,this.props.y,this.props.w,this.props.h,this.state),r=(0,u.calcGridItemPosition)(this.getPositionParams(e),e.x,e.y,e.w,e.h,t);return!(0,l.fastPositionEqual)(n,r)||this.props.useCSSTransforms!==e.useCSSTransforms}},{key:"componentDidMount",value:function(){this.moveDroppingItem({})}},{key:"componentDidUpdate",value:function(e){this.moveDroppingItem(e)}},{key:"moveDroppingItem",value:function(e){var t=this.props.droppingPosition;if(t){var n=this.elementRef.current;if(n){var r=e.droppingPosition||{left:0,top:0},a=this.state.dragging,o=a&&t.left!==r.left||t.top!==r.top;if(a){if(o){var i=t.left-a.left,s=t.top-a.top;this.onDrag(t.e,{node:n,deltaX:i,deltaY:s})}}else this.onDragStart(t.e,{node:n,deltaX:t.left,deltaY:t.top})}}}},{key:"getPositionParams",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return{cols:e.cols,containerPadding:e.containerPadding,containerWidth:e.containerWidth,margin:e.margin,maxRows:e.maxRows,rowHeight:e.rowHeight}}},{key:"createStyle",value:function(e){var t,n=this.props,r=n.usePercentages,a=n.containerWidth;return n.useCSSTransforms?t=(0,l.setTransform)(e):(t=(0,l.setTopLeft)(e),r&&(t.left=(0,l.perc)(e.left/a),t.width=(0,l.perc)(e.width/a))),t}},{key:"mixinDraggable",value:function(e,t){return a.default.createElement(i.DraggableCore,{disabled:!t,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,handle:this.props.handle,cancel:".react-resizable-handle"+(this.props.cancel?","+this.props.cancel:""),scale:this.props.transformScale,nodeRef:this.elementRef},e)}},{key:"mixinResizable",value:function(e,t,n){var r=this.props,o=r.cols,i=r.x,l=r.minW,c=r.minH,d=r.maxW,p=r.maxH,f=r.transformScale,h=r.resizeHandles,m=r.resizeHandle,g=this.getPositionParams(),b=(0,u.calcGridItemPosition)(g,0,0,o-i,0).width,y=(0,u.calcGridItemPosition)(g,0,0,l,c),v=(0,u.calcGridItemPosition)(g,0,0,d,p),w=[y.width,y.height],O=[Math.min(v.width,b),Math.min(v.height,1/0)];return a.default.createElement(s.Resizable,{draggableOpts:{disabled:!n},className:n?void 0:"react-resizable-hide",width:t.width,height:t.height,minConstraints:w,maxConstraints:O,onResizeStop:this.onResizeStop,onResizeStart:this.onResizeStart,onResize:this.onResize,transformScale:f,resizeHandles:h,handle:m},e)}},{key:"onResizeHandler",value:function(e,t,n){var r=t.node,a=t.size,o=this.props[n];if(o){var i=this.props,s=i.cols,l=i.x,c=i.y,d=i.i,p=i.maxH,f=i.minH,h=this.props,m=h.minW,g=h.maxW,b=(0,u.calcWH)(this.getPositionParams(),a.width,a.height,l,c),y=b.w,v=b.h;m=Math.max(m,1),g=Math.min(g,s-l),y=(0,u.clamp)(y,m,g),v=(0,u.clamp)(v,f,p),this.setState({resizing:"onResizeStop"===n?null:a}),o.call(this,d,y,v,{e,node:r,size:a})}}},{key:"render",value:function(){var e=this.props,t=e.x,n=e.y,r=e.w,o=e.h,i=e.isDraggable,s=e.isResizable,l=e.droppingPosition,c=e.useCSSTransforms,p=(0,u.calcGridItemPosition)(this.getPositionParams(),t,n,r,o,this.state),f=a.default.Children.only(this.props.children),m=a.default.cloneElement(f,{ref:this.elementRef,className:(0,d.default)("react-grid-item",f.props.className,this.props.className,{static:this.props.static,resizing:Boolean(this.state.resizing),"react-draggable":i,"react-draggable-dragging":Boolean(this.state.dragging),dropping:Boolean(l),cssTransforms:c}),style:h(h(h({},this.props.style),f.props.style),this.createStyle(p))});return m=this.mixinResizable(m,p,s),this.mixinDraggable(m,i)}}],n&&m(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(a.default.Component);t.default=w,v(w,"propTypes",{children:o.default.element,cols:o.default.number.isRequired,containerWidth:o.default.number.isRequired,rowHeight:o.default.number.isRequired,margin:o.default.array.isRequired,maxRows:o.default.number.isRequired,containerPadding:o.default.array.isRequired,x:o.default.number.isRequired,y:o.default.number.isRequired,w:o.default.number.isRequired,h:o.default.number.isRequired,minW:function(e,t){var n=e[t];return"number"!=typeof n?new Error("minWidth not Number"):n>e.w||n>e.maxW?new Error("minWidth larger than item width/maxWidth"):void 0},maxW:function(e,t){var n=e[t];return"number"!=typeof n?new Error("maxWidth not Number"):n<e.w||n<e.minW?new Error("maxWidth smaller than item width/minWidth"):void 0},minH:function(e,t){var n=e[t];return"number"!=typeof n?new Error("minHeight not Number"):n>e.h||n>e.maxH?new Error("minHeight larger than item height/maxHeight"):void 0},maxH:function(e,t){var n=e[t];return"number"!=typeof n?new Error("maxHeight not Number"):n<e.h||n<e.minH?new Error("maxHeight smaller than item height/minHeight"):void 0},i:o.default.string.isRequired,resizeHandles:c.resizeHandleAxesType,resizeHandle:c.resizeHandleType,onDragStop:o.default.func,onDragStart:o.default.func,onDrag:o.default.func,onResizeStop:o.default.func,onResizeStart:o.default.func,onResize:o.default.func,isDraggable:o.default.bool.isRequired,isResizable:o.default.bool.isRequired,isBounded:o.default.bool.isRequired,static:o.default.bool,useCSSTransforms:o.default.bool.isRequired,transformScale:o.default.number,className:o.default.string,handle:o.default.string,cancel:o.default.string,droppingPosition:o.default.shape({e:o.default.object.isRequired,left:o.default.number.isRequired,top:o.default.number.isRequired})}),v(w,"defaultProps",{className:"",cancel:"",handle:"",minH:1,minW:1,maxH:1/0,maxW:1/0,transformScale:1})},359:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=o?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(a,i,s):a[i]=e[i]}return a.default=e,n&&n.set(e,a),a}(n(650)),o=d(n(652)),i=d(n(45)),s=n(107),l=n(698),u=d(n(844)),c=d(n(450));function d(e){return e&&e.__esModule?e:{default:e}}function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},y(e,t)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S="react-grid-layout",_=!1;try{_=/firefox/i.test(navigator.userAgent)}catch(e){}var x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(x,e);var t,n,c,d,p,f=(d=x,p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(d);if(p){var n=w(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}(this,e)});function x(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,x);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return O(v(e=f.call.apply(f,[this].concat(n))),"state",{activeDrag:null,layout:(0,s.synchronizeLayoutWithChildren)(e.props.layout,e.props.children,e.props.cols,(0,s.compactType)(e.props),e.props.allowOverlap),mounted:!1,oldDragItem:null,oldLayout:null,oldResizeItem:null,droppingDOMNode:null,children:[]}),O(v(e),"dragEnterCounter",0),O(v(e),"onDragStart",(function(t,n,r,a){var o=a.e,i=a.node,l=e.state.layout,u=(0,s.getLayoutItem)(l,t);if(u)return e.setState({oldDragItem:(0,s.cloneLayoutItem)(u),oldLayout:l}),e.props.onDragStart(l,u,u,null,o,i)})),O(v(e),"onDrag",(function(t,n,r,a){var o=a.e,i=a.node,l=e.state.oldDragItem,u=e.state.layout,c=e.props,d=c.cols,p=c.allowOverlap,f=c.preventCollision,h=(0,s.getLayoutItem)(u,t);if(h){var m={w:h.w,h:h.h,x:h.x,y:h.y,placeholder:!0,i:t};u=(0,s.moveElement)(u,h,n,r,!0,f,(0,s.compactType)(e.props),d,p),e.props.onDrag(u,l,h,m,o,i),e.setState({layout:p?u:(0,s.compact)(u,(0,s.compactType)(e.props),d),activeDrag:m})}})),O(v(e),"onDragStop",(function(t,n,r,a){var o=a.e,i=a.node;if(e.state.activeDrag){var l=e.state.oldDragItem,u=e.state.layout,c=e.props,d=c.cols,p=c.preventCollision,f=c.allowOverlap,h=(0,s.getLayoutItem)(u,t);if(h){u=(0,s.moveElement)(u,h,n,r,!0,p,(0,s.compactType)(e.props),d,f),e.props.onDragStop(u,l,h,null,o,i);var m=f?u:(0,s.compact)(u,(0,s.compactType)(e.props),d),g=e.state.oldLayout;e.setState({activeDrag:null,layout:m,oldDragItem:null,oldLayout:null}),e.onLayoutMaybeChanged(m,g)}}})),O(v(e),"onResizeStart",(function(t,n,r,a){var o=a.e,i=a.node,l=e.state.layout,u=(0,s.getLayoutItem)(l,t);u&&(e.setState({oldResizeItem:(0,s.cloneLayoutItem)(u),oldLayout:e.state.layout}),e.props.onResizeStart(l,u,u,null,o,i))})),O(v(e),"onResize",(function(t,n,r,a){var o=a.e,i=a.node,l=e.state,u=l.layout,c=l.oldResizeItem,d=e.props,p=d.cols,f=d.preventCollision,g=d.allowOverlap,b=(0,s.withLayoutItem)(u,t,(function(e){var t;if(f&&!g){var a=(0,s.getAllCollisions)(u,h(h({},e),{},{w:n,h:r})).filter((function(t){return t.i!==e.i}));if(t=a.length>0){var o=1/0,i=1/0;a.forEach((function(t){t.x>e.x&&(o=Math.min(o,t.x)),t.y>e.y&&(i=Math.min(i,t.y))})),Number.isFinite(o)&&(e.w=o-e.x),Number.isFinite(i)&&(e.h=i-e.y)}}return t||(e.w=n,e.h=r),e})),y=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw a}}return o}}(e,t)||m(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(b,2),v=y[0],w=y[1];if(w){var O={w:w.w,h:w.h,x:w.x,y:w.y,static:!0,i:t};e.props.onResize(v,c,w,O,o,i),e.setState({layout:g?v:(0,s.compact)(v,(0,s.compactType)(e.props),p),activeDrag:O})}})),O(v(e),"onResizeStop",(function(t,n,r,a){var o=a.e,i=a.node,l=e.state,u=l.layout,c=l.oldResizeItem,d=e.props,p=d.cols,f=d.allowOverlap,h=(0,s.getLayoutItem)(u,t);e.props.onResizeStop(u,c,h,null,o,i);var m=f?u:(0,s.compact)(u,(0,s.compactType)(e.props),p),g=e.state.oldLayout;e.setState({activeDrag:null,layout:m,oldResizeItem:null,oldLayout:null}),e.onLayoutMaybeChanged(m,g)})),O(v(e),"onDragOver",(function(t){var n;if(t.preventDefault(),t.stopPropagation(),_&&(null===(n=t.nativeEvent.target)||void 0===n||!n.classList.contains(S)))return!1;var r=e.props,o=r.droppingItem,i=r.onDropDragOver,s=r.margin,u=r.cols,c=r.rowHeight,d=r.maxRows,p=r.width,f=r.containerPadding,b=r.transformScale,y=null==i?void 0:i(t);if(!1===y)return e.state.droppingDOMNode&&e.removeDroppingPlaceholder(),!1;var v,w=h(h({},o),y),O=e.state.layout,x=t.nativeEvent,P=x.layerX,j=x.layerY,C={left:P/b,top:j/b,e:t};if(e.state.droppingDOMNode){if(e.state.droppingPosition){var E=e.state.droppingPosition,D=E.left,k=E.top;(D!=P||k!=j)&&e.setState({droppingPosition:C})}}else{var T={cols:u,margin:s,maxRows:d,rowHeight:c,containerWidth:p,containerPadding:f||s},R=(0,l.calcXY)(T,j,P,w.w,w.h);e.setState({droppingDOMNode:a.createElement("div",{key:w.i}),droppingPosition:C,layout:[].concat((v=O,function(e){if(Array.isArray(e))return g(e)}(v)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(v)||m(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[h(h({},w),{},{x:R.x,y:R.y,static:!1,isDraggable:!0})])})}})),O(v(e),"removeDroppingPlaceholder",(function(){var t=e.props,n=t.droppingItem,r=t.cols,a=e.state.layout,o=(0,s.compact)(a.filter((function(e){return e.i!==n.i})),(0,s.compactType)(e.props),r);e.setState({layout:o,droppingDOMNode:null,activeDrag:null,droppingPosition:void 0})})),O(v(e),"onDragLeave",(function(t){t.preventDefault(),t.stopPropagation(),e.dragEnterCounter--,0===e.dragEnterCounter&&e.removeDroppingPlaceholder()})),O(v(e),"onDragEnter",(function(t){t.preventDefault(),t.stopPropagation(),e.dragEnterCounter++})),O(v(e),"onDrop",(function(t){t.preventDefault(),t.stopPropagation();var n=e.props.droppingItem,r=e.state.layout,a=r.find((function(e){return e.i===n.i}));e.dragEnterCounter=0,e.removeDroppingPlaceholder(),e.props.onDrop(r,a,t)})),e}return t=x,c=[{key:"getDerivedStateFromProps",value:function(e,t){var n;return t.activeDrag?null:((0,o.default)(e.layout,t.propsLayout)&&e.compactType===t.compactType?(0,s.childrenEqual)(e.children,t.children)||(n=t.layout):n=e.layout,n?{layout:(0,s.synchronizeLayoutWithChildren)(n,e.children,e.cols,(0,s.compactType)(e),e.allowOverlap),compactType:e.compactType,children:e.children,propsLayout:e.layout}:null)}}],(n=[{key:"componentDidMount",value:function(){this.setState({mounted:!0}),this.onLayoutMaybeChanged(this.state.layout,this.props.layout)}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.children!==e.children||!(0,s.fastRGLPropsEqual)(this.props,e,o.default)||this.state.activeDrag!==t.activeDrag||this.state.mounted!==t.mounted||this.state.droppingPosition!==t.droppingPosition}},{key:"componentDidUpdate",value:function(e,t){if(!this.state.activeDrag){var n=this.state.layout,r=t.layout;this.onLayoutMaybeChanged(n,r)}}},{key:"containerHeight",value:function(){if(this.props.autoSize){var e=(0,s.bottom)(this.state.layout),t=this.props.containerPadding?this.props.containerPadding[1]:this.props.margin[1];return e*this.props.rowHeight+(e-1)*this.props.margin[1]+2*t+"px"}}},{key:"onLayoutMaybeChanged",value:function(e,t){t||(t=this.state.layout),(0,o.default)(t,e)||this.props.onLayoutChange(e)}},{key:"placeholder",value:function(){var e=this.state.activeDrag;if(!e)return null;var t=this.props,n=t.width,r=t.cols,o=t.margin,i=t.containerPadding,s=t.rowHeight,l=t.maxRows,c=t.useCSSTransforms,d=t.transformScale;return a.createElement(u.default,{w:e.w,h:e.h,x:e.x,y:e.y,i:e.i,className:"react-grid-placeholder",containerWidth:n,cols:r,margin:o,containerPadding:i||o,maxRows:l,rowHeight:s,isDraggable:!1,isResizable:!1,isBounded:!1,useCSSTransforms:c,transformScale:d},a.createElement("div",null))}},{key:"processGridItem",value:function(e,t){if(e&&e.key){var n=(0,s.getLayoutItem)(this.state.layout,String(e.key));if(!n)return null;var r=this.props,o=r.width,i=r.cols,l=r.margin,c=r.containerPadding,d=r.rowHeight,p=r.maxRows,f=r.isDraggable,h=r.isResizable,m=r.isBounded,g=r.useCSSTransforms,b=r.transformScale,y=r.draggableCancel,v=r.draggableHandle,w=r.resizeHandles,O=r.resizeHandle,S=this.state,_=S.mounted,x=S.droppingPosition,P="boolean"==typeof n.isDraggable?n.isDraggable:!n.static&&f,j="boolean"==typeof n.isResizable?n.isResizable:!n.static&&h,C=n.resizeHandles||w,E=P&&m&&!1!==n.isBounded;return a.createElement(u.default,{containerWidth:o,cols:i,margin:l,containerPadding:c||l,maxRows:p,rowHeight:d,cancel:y,handle:v,onDragStop:this.onDragStop,onDragStart:this.onDragStart,onDrag:this.onDrag,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,isDraggable:P,isResizable:j,isBounded:E,useCSSTransforms:g&&_,usePercentages:!_,transformScale:b,w:n.w,h:n.h,x:n.x,y:n.y,i:n.i,minH:n.minH,minW:n.minW,maxH:n.maxH,maxW:n.maxW,static:n.static,droppingPosition:t?x:void 0,resizeHandles:C,resizeHandle:O},e)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.style,o=t.isDroppable,l=t.innerRef,u=(0,i.default)(S,n),c=h({height:this.containerHeight()},r);return a.createElement("div",{ref:l,className:u,style:c,onDrop:o?this.onDrop:s.noop,onDragLeave:o?this.onDragLeave:s.noop,onDragEnter:o?this.onDragEnter:s.noop,onDragOver:o?this.onDragOver:s.noop},a.Children.map(this.props.children,(function(t){return e.processGridItem(t)})),o&&this.state.droppingDOMNode&&this.processGridItem(this.state.droppingDOMNode,!0),this.placeholder())}}])&&b(t.prototype,n),c&&b(t,c),Object.defineProperty(t,"prototype",{writable:!1}),x}(a.Component);t.default=x,O(x,"displayName","ReactGridLayout"),O(x,"propTypes",c.default),O(x,"defaultProps",{autoSize:!0,cols:12,className:"",style:{},draggableHandle:"",draggableCancel:"",containerPadding:null,rowHeight:150,maxRows:1/0,layout:[],margin:[10,10],isBounded:!1,isDraggable:!0,isResizable:!0,allowOverlap:!1,isDroppable:!1,useCSSTransforms:!0,transformScale:1,verticalCompact:!0,compactType:"vertical",preventCollision:!1,droppingItem:{i:"__dropping-elem__",h:1,w:1},resizeHandles:["se"],onLayoutChange:s.noop,onDragStart:s.noop,onDrag:s.noop,onDragStop:s.noop,onResizeStart:s.noop,onResize:s.noop,onResizeStop:s.noop,onDrop:s.noop,onDropDragOver:s.noop})},450:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resizeHandleType=t.resizeHandleAxesType=t.default=void 0;var r=o(n(216)),a=o(n(650));function o(e){return e&&e.__esModule?e:{default:e}}var i=r.default.arrayOf(r.default.oneOf(["s","w","e","n","sw","nw","se","ne"]));t.resizeHandleAxesType=i;var s=r.default.oneOfType([r.default.node,r.default.func]);t.resizeHandleType=s;var l={className:r.default.string,style:r.default.object,width:r.default.number,autoSize:r.default.bool,cols:r.default.number,draggableCancel:r.default.string,draggableHandle:r.default.string,verticalCompact:function(e){e.verticalCompact},compactType:r.default.oneOf(["vertical","horizontal"]),layout:function(e){var t=e.layout;void 0!==t&&n(107).validateLayout(t,"layout")},margin:r.default.arrayOf(r.default.number),containerPadding:r.default.arrayOf(r.default.number),rowHeight:r.default.number,maxRows:r.default.number,isBounded:r.default.bool,isDraggable:r.default.bool,isResizable:r.default.bool,allowOverlap:r.default.bool,preventCollision:r.default.bool,useCSSTransforms:r.default.bool,transformScale:r.default.number,isDroppable:r.default.bool,resizeHandles:i,resizeHandle:s,onLayoutChange:r.default.func,onDragStart:r.default.func,onDrag:r.default.func,onDragStop:r.default.func,onResizeStart:r.default.func,onResize:r.default.func,onResizeStop:r.default.func,onDrop:r.default.func,droppingItem:r.default.shape({i:r.default.string.isRequired,w:r.default.number.isRequired,h:r.default.number.isRequired}),children:function(e,t){var n=e[t],r={};a.default.Children.forEach(n,(function(e){if(null!=(null==e?void 0:e.key)){if(r[e.key])throw new Error('Duplicate child key "'+e.key+'" found! This will cause problems in ReactGridLayout.');r[e.key]=!0}}))},innerRef:r.default.any};t.default=l},125:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}t.default=void 0;var a=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=o?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(a,i,s):a[i]=e[i]}return a.default=e,n&&n.set(e,a),a}(n(650)),o=d(n(216)),i=d(n(652)),s=n(107),l=n(996),u=d(n(359)),c=["breakpoint","breakpoints","cols","layouts","margin","containerPadding","onBreakpointChange","onLayoutChange","onWidthChange"];function d(e){return e&&e.__esModule?e:{default:e}}function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}function f(){return f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=function(e){return Object.prototype.toString.call(e)};function S(e,t){return null==e?null:Array.isArray(e)?e:e[t]}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(O,e);var t,n,o,d,p,h=(d=O,p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(d);if(p){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}(this,e)});function O(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,O);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return w(y(e=h.call.apply(h,[this].concat(n))),"state",e.generateInitialState()),w(y(e),"onLayoutChange",(function(t){e.props.onLayoutChange(t,m(m({},e.props.layouts),{},w({},e.state.breakpoint,t)))})),e}return t=O,o=[{key:"getDerivedStateFromProps",value:function(e,t){if(!(0,i.default)(e.layouts,t.layouts)){var n=t.breakpoint,r=t.cols;return{layout:(0,l.findOrGenerateResponsiveLayout)(e.layouts,e.breakpoints,n,n,r,e.compactType),layouts:e.layouts}}return null}}],(n=[{key:"generateInitialState",value:function(){var e=this.props,t=e.width,n=e.breakpoints,r=e.layouts,a=e.cols,o=(0,l.getBreakpointFromWidth)(n,t),i=(0,l.getColsFromBreakpoint)(o,a),s=!1===this.props.verticalCompact?null:this.props.compactType;return{layout:(0,l.findOrGenerateResponsiveLayout)(r,n,o,o,i,s),breakpoint:o,cols:i}}},{key:"componentDidUpdate",value:function(e){this.props.width==e.width&&this.props.breakpoint===e.breakpoint&&(0,i.default)(this.props.breakpoints,e.breakpoints)&&(0,i.default)(this.props.cols,e.cols)||this.onWidthChange(e)}},{key:"onWidthChange",value:function(e){var t=this.props,n=t.breakpoints,r=t.cols,a=t.layouts,o=t.compactType,i=this.props.breakpoint||(0,l.getBreakpointFromWidth)(this.props.breakpoints,this.props.width),u=this.state.breakpoint,c=(0,l.getColsFromBreakpoint)(i,r),d=m({},a);if(u!==i||e.breakpoints!==n||e.cols!==r){u in d||(d[u]=(0,s.cloneLayout)(this.state.layout));var p=(0,l.findOrGenerateResponsiveLayout)(d,n,i,u,c,o);p=(0,s.synchronizeLayoutWithChildren)(p,this.props.children,c,o,this.props.allowOverlap),d[i]=p,this.props.onLayoutChange(p,d),this.props.onBreakpointChange(i,c),this.setState({breakpoint:i,layout:p,cols:c})}var f=S(this.props.margin,i),h=S(this.props.containerPadding,i);this.props.onWidthChange(this.props.width,f,c,h)}},{key:"render",value:function(){var e=this.props,t=(e.breakpoint,e.breakpoints,e.cols,e.layouts,e.margin),n=e.containerPadding,r=(e.onBreakpointChange,e.onLayoutChange,e.onWidthChange,function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,c));return a.createElement(u.default,f({},r,{margin:S(t,this.state.breakpoint),containerPadding:S(n,this.state.breakpoint),onLayoutChange:this.onLayoutChange,layout:this.state.layout,cols:this.state.cols}))}}])&&g(t.prototype,n),o&&g(t,o),Object.defineProperty(t,"prototype",{writable:!1}),O}(a.Component);t.default=_,w(_,"propTypes",{breakpoint:o.default.string,breakpoints:o.default.object,allowOverlap:o.default.bool,cols:o.default.object,margin:o.default.oneOfType([o.default.array,o.default.object]),containerPadding:o.default.oneOfType([o.default.array,o.default.object]),layouts:function(e,t){if("[object Object]"!==O(e[t]))throw new Error("Layout property must be an object. Received: "+O(e[t]));Object.keys(e[t]).forEach((function(t){if(!(t in e.breakpoints))throw new Error("Each key in layouts must align with a key in breakpoints.");(0,s.validateLayout)(e.layouts[t],"layouts."+t)}))},width:o.default.number.isRequired,onBreakpointChange:o.default.func,onLayoutChange:o.default.func,onWidthChange:o.default.func}),w(_,"defaultProps",{breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},containerPadding:{lg:null,md:null,sm:null,xs:null,xxs:null},layouts:{},margin:[10,10],allowOverlap:!1,onBreakpointChange:s.noop,onLayoutChange:s.noop,onWidthChange:s.noop})},698:(e,t)=>{"use strict";function n(e){var t=e.margin,n=e.containerPadding,r=e.containerWidth,a=e.cols;return(r-t[0]*(a-1)-2*n[0])/a}function r(e,t,n){return Number.isFinite(e)?Math.round(t*e+Math.max(0,e-1)*n):e}function a(e,t,n){return Math.max(Math.min(e,n),t)}Object.defineProperty(t,"__esModule",{value:!0}),t.calcGridColWidth=n,t.calcGridItemPosition=function(e,t,a,o,i,s){var l=e.margin,u=e.containerPadding,c=e.rowHeight,d=n(e),p={};return s&&s.resizing?(p.width=Math.round(s.resizing.width),p.height=Math.round(s.resizing.height)):(p.width=r(o,d,l[0]),p.height=r(i,c,l[1])),s&&s.dragging?(p.top=Math.round(s.dragging.top),p.left=Math.round(s.dragging.left)):(p.top=Math.round((c+l[1])*a+u[1]),p.left=Math.round((d+l[0])*t+u[0])),p},t.calcGridItemWHPx=r,t.calcWH=function(e,t,r,o,i){var s=e.margin,l=e.maxRows,u=e.cols,c=e.rowHeight,d=n(e),p=Math.round((t+s[0])/(d+s[0])),f=Math.round((r+s[1])/(c+s[1]));return{w:p=a(p,0,u-o),h:f=a(f,0,l-i)}},t.calcXY=function(e,t,r,o,i){var s=e.margin,l=e.cols,u=e.rowHeight,c=e.maxRows,d=n(e),p=Math.round((r-s[0])/(d+s[0])),f=Math.round((t-s[1])/(u+s[1]));return{x:p=a(p,0,l-o),y:f=a(f,0,c-i)}},t.clamp=a},248:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}t.default=function(e){var t;return t=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(y,t);var n,o,l,u,b=(n=y,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(n);if(o){var a=h(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}(this,e)});function y(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return m(f(e=b.call.apply(b,[this].concat(n))),"state",{width:1280}),m(f(e),"elementRef",a.createRef()),m(f(e),"mounted",!1),m(f(e),"onWindowResize",(function(){if(e.mounted){var t=e.elementRef.current;t instanceof HTMLElement&&t.offsetWidth&&e.setState({width:t.offsetWidth})}})),e}return l=y,(u=[{key:"componentDidMount",value:function(){this.mounted=!0,window.addEventListener("resize",this.onWindowResize),this.onWindowResize()}},{key:"componentWillUnmount",value:function(){this.mounted=!1,window.removeEventListener("resize",this.onWindowResize)}},{key:"render",value:function(){var t=this.props,n=t.measureBeforeMount,r=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(t,s);return n&&!this.mounted?a.createElement("div",{className:(0,i.default)(this.props.className,g),style:this.props.style,ref:this.elementRef}):a.createElement(e,c({innerRef:this.elementRef},r,this.state))}}])&&d(l.prototype,u),Object.defineProperty(l,"prototype",{writable:!1}),y}(a.Component),m(t,"defaultProps",{measureBeforeMount:!1}),m(t,"propTypes",{measureBeforeMount:o.default.bool}),t};var a=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=o?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(a,i,s):a[i]=e[i]}return a.default=e,n&&n.set(e,a),a}(n(650)),o=l(n(216)),i=l(n(45)),s=["measureBeforeMount"];function l(e){return e&&e.__esModule?e:{default:e}}function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g="react-grid-layout"},5:e=>{e.exports=function(e,t,n){return e===t||e.className===t.className&&n(e.style,t.style)&&e.width===t.width&&e.autoSize===t.autoSize&&e.cols===t.cols&&e.draggableCancel===t.draggableCancel&&e.draggableHandle===t.draggableHandle&&n(e.verticalCompact,t.verticalCompact)&&n(e.compactType,t.compactType)&&n(e.layout,t.layout)&&n(e.margin,t.margin)&&n(e.containerPadding,t.containerPadding)&&e.rowHeight===t.rowHeight&&e.maxRows===t.maxRows&&e.isBounded===t.isBounded&&e.isDraggable===t.isDraggable&&e.isResizable===t.isResizable&&e.allowOverlap===t.allowOverlap&&e.preventCollision===t.preventCollision&&e.useCSSTransforms===t.useCSSTransforms&&e.transformScale===t.transformScale&&e.isDroppable===t.isDroppable&&n(e.resizeHandles,t.resizeHandles)&&n(e.resizeHandle,t.resizeHandle)&&e.onLayoutChange===t.onLayoutChange&&e.onDragStart===t.onDragStart&&e.onDrag===t.onDrag&&e.onDragStop===t.onDragStop&&e.onResizeStart===t.onResizeStart&&e.onResize===t.onResize&&e.onResizeStop===t.onResizeStop&&e.onDrop===t.onDrop&&n(e.droppingItem,t.droppingItem)&&n(e.innerRef,t.innerRef)}},996:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findOrGenerateResponsiveLayout=function(e,t,n,o,i,s){if(e[n])return(0,r.cloneLayout)(e[n]);for(var l=e[o],u=a(t),c=u.slice(u.indexOf(n)),d=0,p=c.length;d<p;d++){var f=c[d];if(e[f]){l=e[f];break}}return l=(0,r.cloneLayout)(l||[]),(0,r.compact)((0,r.correctBounds)(l,{cols:i}),s,i)},t.getBreakpointFromWidth=function(e,t){for(var n=a(e),r=n[0],o=1,i=n.length;o<i;o++){var s=n[o];t>e[s]&&(r=s)}return r},t.getColsFromBreakpoint=function(e,t){if(!t[e])throw new Error("ResponsiveReactGridLayout: `cols` entry for breakpoint "+e+" is missing!");return t[e]},t.sortBreakpoints=a;var r=n(107);function a(e){return Object.keys(e).sort((function(t,n){return e[t]-e[n]}))}},107:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bottom=d,t.childrenEqual=function(e,t){return(0,r.default)(a.default.Children.map(e,(function(e){return null==e?void 0:e.key})),a.default.Children.map(t,(function(e){return null==e?void 0:e.key})))},t.cloneLayout=p,t.cloneLayoutItem=h,t.collides=g,t.compact=b,t.compactItem=w,t.compactType=function(e){var t=e||{},n=t.verticalCompact,r=t.compactType;return!1===n?null:r},t.correctBounds=O,t.fastPositionEqual=function(e,t){return e.left===t.left&&e.top===t.top&&e.width===t.width&&e.height===t.height},t.fastRGLPropsEqual=void 0,t.getAllCollisions=x,t.getFirstCollision=_,t.getLayoutItem=S,t.getStatics=P,t.modifyLayout=f,t.moveElement=j,t.moveElementAwayFromCollision=C,t.noop=void 0,t.perc=function(e){return 100*e+"%"},t.setTopLeft=function(e){var t=e.top,n=e.left,r=e.width,a=e.height;return{top:"".concat(t,"px"),left:"".concat(n,"px"),width:"".concat(r,"px"),height:"".concat(a,"px"),position:"absolute"}},t.setTransform=function(e){var t=e.top,n=e.left,r=e.width,a=e.height,o="translate(".concat(n,"px,").concat(t,"px)");return{transform:o,WebkitTransform:o,MozTransform:o,msTransform:o,OTransform:o,width:"".concat(r,"px"),height:"".concat(a,"px"),position:"absolute"}},t.sortLayoutItems=E,t.sortLayoutItemsByColRow=k,t.sortLayoutItemsByRowCol=D,t.synchronizeLayoutWithChildren=function(e,t,n,r,o){e=e||[];var i=[];a.default.Children.forEach(t,(function(t){if(null!=(null==t?void 0:t.key)){var n=S(e,String(t.key));if(n)i.push(h(n));else{!u&&t.props._grid&&console.warn("`_grid` properties on children have been deprecated as of React 15.2. Please use `data-grid` or add your properties directly to the `layout`.");var r=t.props["data-grid"]||t.props._grid;r?(u||T([r],"ReactGridLayout.children"),i.push(h(s(s({},r),{},{i:t.key})))):i.push(h({w:1,h:1,x:0,y:d(i),i:String(t.key)}))}}}));var l=O(i,{cols:n});return o?l:b(l,r,n)},t.validateLayout=T,t.withLayoutItem=function(e,t,n){var r=S(e,t);return r?[e=f(e,r=n(h(r))),r]:[e,null]};var r=o(n(652)),a=o(n(650));function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=!0,c=!1;function d(e){for(var t,n=0,r=0,a=e.length;r<a;r++)(t=e[r].y+e[r].h)>n&&(n=t);return n}function p(e){for(var t=Array(e.length),n=0,r=e.length;n<r;n++)t[n]=h(e[n]);return t}function f(e,t){for(var n=Array(e.length),r=0,a=e.length;r<a;r++)t.i===e[r].i?n[r]=t:n[r]=e[r];return n}function h(e){return{w:e.w,h:e.h,x:e.x,y:e.y,i:e.i,minW:e.minW,maxW:e.maxW,minH:e.minH,maxH:e.maxH,moved:Boolean(e.moved),static:Boolean(e.static),isDraggable:e.isDraggable,isResizable:e.isResizable,resizeHandles:e.resizeHandles,isBounded:e.isBounded}}var m=n(5);function g(e,t){return!(e.i===t.i||e.x+e.w<=t.x||e.x>=t.x+t.w||e.y+e.h<=t.y||e.y>=t.y+t.h)}function b(e,t,n){for(var r=P(e),a=E(e,t),o=Array(e.length),i=0,s=a.length;i<s;i++){var l=h(a[i]);l.static||(l=w(r,l,t,n,a),r.push(l)),o[e.indexOf(a[i])]=l,l.moved=!1}return o}t.fastRGLPropsEqual=m;var y={x:"w",y:"h"};function v(e,t,n,r){var a=y[r];t[r]+=1;for(var o=e.map((function(e){return e.i})).indexOf(t.i)+1;o<e.length;o++){var i=e[o];if(!i.static){if(i.y>t.y+t.h)break;g(t,i)&&v(e,i,n+t[a],r)}}t[r]=n}function w(e,t,n,r,a){var o,i="horizontal"===n;if("vertical"===n)for(t.y=Math.min(d(e),t.y);t.y>0&&!_(e,t);)t.y--;else if(i)for(;t.x>0&&!_(e,t);)t.x--;for(;o=_(e,t);)i?v(a,t,o.x+o.w,"x"):v(a,t,o.y+o.h,"y"),i&&t.x+t.w>r&&(t.x=r-t.w,t.y++);return t.y=Math.max(t.y,0),t.x=Math.max(t.x,0),t}function O(e,t){for(var n=P(e),r=0,a=e.length;r<a;r++){var o=e[r];if(o.x+o.w>t.cols&&(o.x=t.cols-o.w),o.x<0&&(o.x=0,o.w=t.cols),o.static)for(;_(n,o);)o.y++;else n.push(o)}return e}function S(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n].i===t)return e[n]}function _(e,t){for(var n=0,r=e.length;n<r;n++)if(g(e[n],t))return e[n]}function x(e,t){return e.filter((function(e){return g(e,t)}))}function P(e){return e.filter((function(e){return e.static}))}function j(e,t,n,r,a,o,i,s,l){if(t.static&&!0!==t.isDraggable)return e;if(t.y===r&&t.x===n)return e;R("Moving element ".concat(t.i," to [").concat(String(n),",").concat(String(r),"] from [").concat(t.x,",").concat(t.y,"]"));var u=t.x,c=t.y;"number"==typeof n&&(t.x=n),"number"==typeof r&&(t.y=r),t.moved=!0;var d=E(e,i);("vertical"===i&&"number"==typeof r?c>=r:"horizontal"===i&&"number"==typeof n&&u>=n)&&(d=d.reverse());var f=x(d,t),h=f.length>0;if(h&&l)return p(e);if(h&&o)return R("Collision prevented on ".concat(t.i,", reverting.")),t.x=u,t.y=c,t.moved=!1,e;for(var m=0,g=f.length;m<g;m++){var b=f[m];R("Resolving collision between ".concat(t.i," at [").concat(t.x,",").concat(t.y,"] and ").concat(b.i," at [").concat(b.x,",").concat(b.y,"]")),b.moved||(e=b.static?C(e,b,t,a,i,s):C(e,t,b,a,i,s))}return e}function C(e,t,n,r,a,o){var i="horizontal"===a,s="horizontal"!==a,l=t.static;if(r){r=!1;var u={x:i?Math.max(t.x-n.w,0):n.x,y:s?Math.max(t.y-n.h,0):n.y,w:n.w,h:n.h,i:"-1"};if(!_(e,u))return R("Doing reverse collision on ".concat(n.i," up to [").concat(u.x,",").concat(u.y,"].")),j(e,n,i?u.x:void 0,s?u.y:void 0,r,l,a,o)}return j(e,n,i?n.x+1:void 0,s?n.y+1:void 0,r,l,a,o)}function E(e,t){return"horizontal"===t?k(e):"vertical"===t?D(e):e}function D(e){return e.slice(0).sort((function(e,t){return e.y>t.y||e.y===t.y&&e.x>t.x?1:e.y===t.y&&e.x===t.x?0:-1}))}function k(e){return e.slice(0).sort((function(e,t){return e.x>t.x||e.x===t.x&&e.y>t.y?1:-1}))}function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Layout",n=["x","y","w","h"];if(!Array.isArray(e))throw new Error(t+" must be an array!");for(var r=0,a=e.length;r<a;r++)for(var o=e[r],i=0;i<n.length;i++)if("number"!=typeof o[n[i]])throw new Error("ReactGridLayout: "+t+"["+r+"]."+n[i]+" must be a number!")}function R(){var e;c&&(e=console).log.apply(e,arguments)}t.noop=function(){}},121:(e,t,n)=>{e.exports=n(359).default,e.exports.utils=n(107),e.exports.Responsive=n(125).default,e.exports.Responsive.utils=n(996),e.exports.WidthProvider=n(248).default},9:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(n(650)),a=n(294),o=n(458),i=n(93),s=["children","className","draggableOpts","width","height","handle","handleSize","lockAspectRatio","axis","minConstraints","maxConstraints","onResize","onResizeStop","onResizeStart","resizeHandles","transformScale"];function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}var h=function(e){var t,n;function i(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).handleRefs={},t.lastHandleRect=null,t.slack=null,t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,f(t,n);var l=i.prototype;return l.componentWillUnmount=function(){this.resetData()},l.resetData=function(){this.lastHandleRect=this.slack=null},l.runConstraints=function(e,t){var n=this.props,r=n.minConstraints,a=n.maxConstraints,o=n.lockAspectRatio;if(!r&&!a&&!o)return[e,t];if(o){var i=this.props.width/this.props.height,s=e-this.props.width,l=t-this.props.height;Math.abs(s)>Math.abs(l*i)?t=e/i:e=t*i}var u=e,c=t,d=this.slack||[0,0],p=d[0],f=d[1];return e+=p,t+=f,r&&(e=Math.max(r[0],e),t=Math.max(r[1],t)),a&&(e=Math.min(a[0],e),t=Math.min(a[1],t)),this.slack=[p+(u-e),f+(c-t)],[e,t]},l.resizeHandler=function(e,t){var n=this;return function(r,a){var o=a.node,i=a.deltaX,s=a.deltaY;"onResizeStart"===e&&n.resetData();var l=("both"===n.props.axis||"x"===n.props.axis)&&"n"!==t&&"s"!==t,u=("both"===n.props.axis||"y"===n.props.axis)&&"e"!==t&&"w"!==t;if(l||u){var c=t[0],d=t[t.length-1],p=o.getBoundingClientRect();null!=n.lastHandleRect&&("w"===d&&(i+=p.left-n.lastHandleRect.left),"n"===c&&(s+=p.top-n.lastHandleRect.top)),n.lastHandleRect=p,"w"===d&&(i=-i),"n"===c&&(s=-s);var f=n.props.width+(l?i/n.props.transformScale:0),h=n.props.height+(u?s/n.props.transformScale:0),m=n.runConstraints(f,h);f=m[0],h=m[1];var g=f!==n.props.width||h!==n.props.height,b="function"==typeof n.props[e]?n.props[e]:null;b&&!("onResize"===e&&!g)&&(null==r.persist||r.persist(),b(r,{node:o,size:{width:f,height:h},handle:t})),"onResizeStop"===e&&n.resetData()}}},l.renderResizeHandle=function(e,t){var n=this.props.handle;if(!n)return r.createElement("span",{className:"react-resizable-handle react-resizable-handle-"+e,ref:t});if("function"==typeof n)return n(e,t);var a=d({ref:t},"string"==typeof n.type?{}:{handleAxis:e});return r.cloneElement(n,a)},l.render=function(){var e=this,t=this.props,n=t.children,i=t.className,l=t.draggableOpts,c=(t.width,t.height,t.handle,t.handleSize,t.lockAspectRatio,t.axis,t.minConstraints,t.maxConstraints,t.onResize,t.onResizeStop,t.onResizeStart,t.resizeHandles),p=(t.transformScale,function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(t,s));return(0,o.cloneElement)(n,d(d({},p),{},{className:(i?i+" ":"")+"react-resizable",children:[].concat(n.props.children,c.map((function(t){var n,o=null!=(n=e.handleRefs[t])?n:e.handleRefs[t]=r.createRef();return r.createElement(a.DraggableCore,u({},l,{nodeRef:o,key:"resizableHandle-"+t,onStop:e.resizeHandler("onResizeStop",t),onStart:e.resizeHandler("onResizeStart",t),onDrag:e.resizeHandler("onResize",t)}),e.renderResizeHandle(t,o))})))}))},i}(r.Component);t.default=h,h.propTypes=i.resizableProps,h.defaultProps={axis:"both",handleSize:[20,20],lockAspectRatio:!1,minConstraints:[20,20],maxConstraints:[1/0,1/0],resizeHandles:["se"],transformScale:1}},377:(e,t,n)=>{"use strict";t.default=void 0;var r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(n(650)),a=l(n(216)),o=l(n(9)),i=n(93),s=["handle","handleSize","onResize","onResizeStart","onResizeStop","draggableOpts","minConstraints","maxConstraints","lockAspectRatio","axis","width","height","resizeHandles","style","transformScale"];function l(e){return e&&e.__esModule?e:{default:e}}function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}var m=function(e){var t,n;function a(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={width:t.props.width,height:t.props.height,propsWidth:t.props.width,propsHeight:t.props.height},t.onResize=function(e,n){var r=n.size;t.props.onResize?(null==e.persist||e.persist(),t.setState(r,(function(){return t.props.onResize&&t.props.onResize(e,n)}))):t.setState(r)},t}return n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,h(t,n),a.getDerivedStateFromProps=function(e,t){return t.propsWidth!==e.width||t.propsHeight!==e.height?{width:e.width,height:e.height,propsWidth:e.width,propsHeight:e.height}:null},a.prototype.render=function(){var e=this.props,t=e.handle,n=e.handleSize,a=(e.onResize,e.onResizeStart),i=e.onResizeStop,l=e.draggableOpts,u=e.minConstraints,d=e.maxConstraints,f=e.lockAspectRatio,h=e.axis,m=(e.width,e.height,e.resizeHandles),g=e.style,b=e.transformScale,y=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,s);return r.createElement(o.default,{axis:h,draggableOpts:l,handle:t,handleSize:n,height:this.state.height,lockAspectRatio:f,maxConstraints:d,minConstraints:u,onResizeStart:a,onResize:this.onResize,onResizeStop:i,resizeHandles:m,transformScale:b,width:this.state.width},r.createElement("div",c({},y,{style:p(p({},g),{},{width:this.state.width+"px",height:this.state.height+"px"})})))},a}(r.Component);t.default=m,m.propTypes=p(p({},i.resizableProps),{},{children:a.default.element})},93:(e,t,n)=>{"use strict";t.__esModule=!0,t.resizableProps=void 0;var r,a=(r=n(216))&&r.__esModule?r:{default:r};n(294);var o={axis:a.default.oneOf(["both","x","y","none"]),className:a.default.string,children:a.default.element.isRequired,draggableOpts:a.default.shape({allowAnyClick:a.default.bool,cancel:a.default.string,children:a.default.node,disabled:a.default.bool,enableUserSelectHack:a.default.bool,offsetParent:a.default.node,grid:a.default.arrayOf(a.default.number),handle:a.default.string,nodeRef:a.default.object,onStart:a.default.func,onDrag:a.default.func,onStop:a.default.func,onMouseDown:a.default.func,scale:a.default.number}),height:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,o=t[0];return"both"===o.axis||"y"===o.axis?(r=a.default.number).isRequired.apply(r,t):a.default.number.apply(a.default,t)},handle:a.default.oneOfType([a.default.node,a.default.func]),handleSize:a.default.arrayOf(a.default.number),lockAspectRatio:a.default.bool,maxConstraints:a.default.arrayOf(a.default.number),minConstraints:a.default.arrayOf(a.default.number),onResizeStop:a.default.func,onResizeStart:a.default.func,onResize:a.default.func,resizeHandles:a.default.arrayOf(a.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),transformScale:a.default.number,width:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,o=t[0];return"both"===o.axis||"x"===o.axis?(r=a.default.number).isRequired.apply(r,t):a.default.number.apply(a.default,t)}};t.resizableProps=o},458:(e,t,n)=>{"use strict";t.__esModule=!0,t.cloneElement=function(e,t){return t.style&&e.props.style&&(t.style=i(i({},e.props.style),t.style)),t.className&&e.props.className&&(t.className=e.props.className+" "+t.className),a.default.cloneElement(e,t)};var r,a=(r=n(650))&&r.__esModule?r:{default:r};function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},453:(e,t,n)=>{"use strict";e.exports=function(){throw new Error("Don't instantiate Resizable directly! Use require('react-resizable').Resizable")},e.exports.Resizable=n(9).default,e.exports.ResizableBox=n(377).default},983:(e,t,n)=>{"use strict";e.exports=n.p+"da1ddf82b1124a99aaa5.wasm"},644:t=>{"use strict";t.exports=e},305:e=>{"use strict";e.exports=t},545:e=>{"use strict";e.exports=n},388:e=>{"use strict";e.exports=r},980:e=>{"use strict";e.exports=a},650:e=>{"use strict";e.exports=o},729:e=>{"use strict";e.exports=i},814:e=>{"use strict";e.exports=s},177:e=>{"use strict";e.exports=l}},p={};function f(e){var t=p[e];if(void 0!==t)return t.exports;var n=p[e]={id:e,loaded:!1,exports:{}};return d[e](n,n.exports,f),n.loaded=!0,n.exports}f.m=d,f.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return f.d(t,{a:t}),t},c=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,f.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var n=Object.create(null);f.r(n);var r={};u=u||[null,c({}),c([]),c(c)];for(var a=2&t&&e;"object"==typeof a&&!~u.indexOf(a);a=c(a))Object.getOwnPropertyNames(a).forEach((t=>r[t]=()=>e[t]));return r.default=()=>e,f.d(n,r),n},f.d=(e,t)=>{for(var n in t)f.o(t,n)&&!f.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},f.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),f.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),f.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),f.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},f.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),f.p="public/plugins/grafana-scenes-app/",f.b=document.baseURI||self.location.href;var h={};return(()=>{"use strict";f.r(h),f.d(h,{plugin:()=>ZE});var e=f(305),t=f(650),n=f.t(t,2),r=f.n(t);const a=r().createContext(null);var o=f(814);const i=`/a/${JSON.parse('{"id":"grafana-scenes-app"}').id}`;var s;!function(e){e.Home="",e.Demos="demos",e.GrafanaMonitoring="grafana-monitoring",e.ReactDemo="react-only"}(s||(s={}));const l={uid:"gdev-testdata",type:"testdata"};function u(e){return`${i}/${e}`}function c(e){return`${u(s.Demos)}/${e}`}var d=f(545),p=Object.defineProperty,m=Object.getOwnPropertySymbols,g=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable,y=(e,t,n)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,v=(e,t)=>{for(var n in t||(t={}))g.call(t,n)&&y(e,n,t[n]);if(m)for(var n of m(t))b.call(t,n)&&y(e,n,t[n]);return e};function w(t,n,r){const a=v({},n);if(r)for(const e of Object.keys(a))r.includes(e)||delete a[e];return e.urlUtil.renderUrl(e.locationUtil.assureBaseUrl(t),a)}function O(e,t){return r().createElement(e.Component,{model:e,routeProps:t})}var S=Object.defineProperty,_=Object.defineProperties,x=Object.getOwnPropertyDescriptors,P=Object.getOwnPropertySymbols,j=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable,E=(e,t,n)=>t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const D=new Map;var k=f(177);const T={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let R;const A=new Uint8Array(16);function I(){if(!R&&(R="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!R))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return R(A)}const V=[];for(let e=0;e<256;++e)V.push((e+256).toString(16).slice(1));const M=function(e,t,n){if(T.randomUUID&&!t&&!e)return T.randomUUID();const r=(e=e||{}).random||(e.rng||I)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return(V[e[t+0]]+V[e[t+1]]+V[e[t+2]]+V[e[t+3]]+"-"+V[e[t+4]]+V[e[t+5]]+"-"+V[e[t+6]]+V[e[t+7]]+"-"+V[e[t+8]]+V[e[t+9]]+"-"+V[e[t+10]]+V[e[t+11]]+V[e[t+12]]+V[e[t+13]]+V[e[t+14]]+V[e[t+15]]).toLowerCase()}(r)};var F=Object.defineProperty,L=Object.defineProperties,$=Object.getOwnPropertyDescriptors,N=Object.getOwnPropertySymbols,B=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable,q=(e,t,n)=>t in e?F(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function H(e){var n,a=e,{model:o}=a,i=((e,t)=>{var n={};for(var r in e)B.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&N)for(var r of N(e))t.indexOf(r)<0&&z.call(e,r)&&(n[r]=e[r]);return n})(a,["model"]);const s=null!=(n=o.constructor.Component)?n:U,[l,u]=(0,t.useState)(0);return(0,t.useEffect)((()=>{const e=o.activate();return u((e=>e+1)),e}),[o]),o.isActive?r().createElement(s,(c=((e,t)=>{for(var n in t||(t={}))B.call(t,n)&&q(e,n,t[n]);if(N)for(var n of N(t))z.call(t,n)&&q(e,n,t[n]);return e})({},i),L(c,$({model:o})))):null;var c}const W=r().memo(H);function U(e){return null}class G extends e.BusEventWithPayload{}G.type="scene-object-state-change";class Q extends e.BusEventWithPayload{}Q.type="scene-object-user-action";var K,Y=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};class Z{resolve(){return Y(this,e=K,"read from private field"),e.get(this);var e}constructor(e){var t,n;((e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,void 0)})(this,K),n=e,Y(this,t=K,"write to private field"),t.set(this,n)}}K=new WeakMap;var X=Object.defineProperty,J=Object.getOwnPropertySymbols,ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable,ne=(e,t,n)=>t in e?X(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,re=(e,t)=>{for(var n in t||(t={}))ee.call(t,n)&&ne(e,n,t[n]);if(J)for(var n of J(t))te.call(t,n)&&ne(e,n,t[n]);return e};class ae{get state(){return this._state}get isActive(){return this._isActive}get parent(){return this._parent}get variableDependency(){return this._variableDependency}get urlSync(){return this._urlSync}get Component(){return W}_setParent(e){ie(e,(e=>{e._parent&&e._parent!==this&&console.warn("SceneObject already has a parent set that is different from the new parent. You cannot share the same SceneObject instance in multiple scenes or in multiple different places of the same scene graph. Use SceneObject.clone() to duplicate a SceneObject or store a state key reference and use sceneGraph.findObject to locate it.",e,this),e._parent=this}))}clearParent(){this._parent=void 0}subscribeToState(e){return this._events.subscribe(G,(t=>{t.payload.changedObject===this&&e(t.payload.newState,t.payload.prevState)}))}subscribeToEvent(e,t){return this._events.subscribe(e,t)}setState(e){const t=this._state,n=re(re({},this._state),e);this._state=Object.freeze(n),this._setParent(e),this._handleActivationOfChangedStateProps(t,n),this.publishEvent(new G({prevState:t,newState:n,partialUpdate:e,changedObject:this}),!0)}_handleActivationOfChangedStateProps(e,t){this.isActive&&(e.$behaviors!==t.$behaviors&&this._handleChangedBehaviors(e.$behaviors,t.$behaviors),e.$data!==t.$data&&this._handleChangedStateActivation(e.$data,t.$data),e.$variables!==t.$variables&&this._handleChangedStateActivation(e.$variables,t.$variables),e.$timeRange!==t.$timeRange&&this._handleChangedStateActivation(e.$timeRange,t.$timeRange))}_handleChangedStateActivation(e,t){if(e){const t=this._deactivationHandlers.get(e);t&&(t(),this._deactivationHandlers.delete(e))}t&&this._deactivationHandlers.set(t,t.activate())}_handleChangedBehaviors(e,t){if(e)for(const n of e)if(!t||!t.includes(n)){const e=this._deactivationHandlers.get(n);e&&(e(),this._deactivationHandlers.delete(n))}if(t)for(const n of t)e&&e.includes(n)||this._activateBehavior(n)}publishEvent(e,t){this._events.publish(e),t&&this.parent&&this.parent.publishEvent(e,t)}getRoot(){return this._parent?this._parent.getRoot():this}_internalActivate(){this._isActive=!0;const{$data:e,$variables:t,$timeRange:n,$behaviors:r}=this.state;if(this._activationHandlers.forEach((e=>{const t=e();t&&this._deactivationHandlers.set(t,t)})),n&&!n.isActive&&this._deactivationHandlers.set(n,n.activate()),t&&!t.isActive&&this._deactivationHandlers.set(t,t.activate()),e&&!e.isActive&&this._deactivationHandlers.set(e,e.activate()),r)for(const e of r)this._activateBehavior(e)}_activateBehavior(e){if(e instanceof ae)this._deactivationHandlers.set(e,e.activate());else if("function"==typeof e){const t=e(this);t&&this._deactivationHandlers.set(e,t)}}activate(){this.isActive||this._internalActivate(),this._refCount++;let e=!1;return()=>{if(this._refCount--,e)throw new Error("SceneObject cancelation handler returned by activate() called a second time");e=!0,0===this._refCount&&this._internalDeactivate()}}_internalDeactivate(){this._isActive=!1;for(let e of this._deactivationHandlers.values())e();this._deactivationHandlers.clear(),this._events.removeAllListeners(),this._subs.unsubscribe(),this._subs=new k.Subscription}useState(){return oe(this)}forceRender(){this.setState({})}clone(e){return function(e,t){const n=fe(e.state,t);return new e.constructor(n)}(this,e)}addActivationHandler(e){this._activationHandlers.push(e)}forEachChild(e){ie(this.state,e)}getRef(){return this._ref||(this._ref=new Z(this)),this._ref}constructor(t){this._isActive=!1,this._activationHandlers=[],this._deactivationHandlers=new Map,this._subs=new k.Subscription,this._refCount=0,t.key||(t.key=M()),this._events=new e.EventBusSrv,this._state=Object.freeze(t),this._setParent(this._state)}}function oe(e,n){var r;const[a,o]=(0,t.useState)(e.state),i=e.state,s=null!=(r=null==n?void 0:n.shouldActivateOrKeepAlive)&&r;return(0,t.useEffect)((()=>{let t;s&&(t=e.activate());const n=e.subscribeToState((e=>{o(e)}));return e.state!==i&&o(e.state),()=>{n.unsubscribe(),t&&t()}}),[e,s]),e.state}function ie(e,t){for(const n of Object.values(e))if(n instanceof ae&&t(n),Array.isArray(n))for(const e of n)e instanceof ae&&t(e)}var se=Object.defineProperty,le=Object.getOwnPropertySymbols,ue=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable,de=(e,t,n)=>t in e?se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,pe=(e,t)=>{for(var n in t||(t={}))ue.call(t,n)&&de(e,n,t[n]);if(le)for(var n of le(t))ce.call(t,n)&&de(e,n,t[n]);return e};function fe(e,t){const n=pe({},e);for(const e in n){const t=n[e];if(t instanceof ae&&(n[e]=t.clone()),t instanceof Z)throw new Error("Cannot clone a SceneObject with a SceneObjectRef in state");if(Array.isArray(t)){const r=[];for(const e of t)e instanceof ae?r.push(e.clone()):r.push(e);n[e]=r}}return Object.assign(n,t),n}function he(e,t){let n,r=e;for(;r&&!n;)n=t(r),r=r.parent;return n}class me extends e.DataSourceApi{testDatasource(){return Promise.resolve({})}constructor(t,n){super({name:"RuntimeDataSource-"+t,uid:n,type:t,id:1,readOnly:!0,jsonData:{},access:"direct",meta:{id:t,name:"RuntimeDataSource-"+t,type:e.PluginType.datasource,info:{author:{name:""},description:"",links:[],logos:{large:"",small:""},screenshots:[],updated:"",version:""},module:"",baseUrl:""}})}}const ge=new Map;var be=f(980);function ye(e,t){const n=t.state.$variables;if(!n)return t.parent?ye(e,t.parent):null;return n.getByName(e)||(t.parent?ye(e,t.parent):null)}var ve=(e=>(e.AlertStates="alertStates",e.Annotations="annotations",e.Series="series",e))(ve||{}),we=(e=>(e.Ascending="Ascending",e.Descending="Descending",e))(we||{}),Oe=(e=>(e.Bars="bars",e.Line="line",e.Points="points",e))(Oe||{}),Se=(e=>(e.Linear="linear",e.Smooth="smooth",e.StepAfter="stepAfter",e.StepBefore="stepBefore",e))(Se||{}),_e=(e=>(e.Hue="hue",e.None="none",e.Opacity="opacity",e.Scheme="scheme",e))(_e||{}),xe=(e=>(e.None="none",e.Normal="normal",e.Percent="percent",e))(xe||{}),Pe=(e=>(e.Hidden="hidden",e.List="list",e.Table="table",e))(Pe||{}),je=(e=>(e.Auto="auto",e.Horizontal="horizontal",e.Vertical="vertical",e))(je||{}),Ce=(e=>(e.Area="area",e.Line="line",e.None="none",e))(Ce||{}),Ee=(e=>(e.Auto="auto",e.Name="name",e.None="none",e.Value="value",e.ValueAndName="value_and_name",e))(Ee||{}),De=(e=>(e.Multi="multi",e.None="none",e.Single="single",e))(De||{}),ke=(e=>(e.Basic="basic",e.Gradient="gradient",e.Lcd="lcd",e))(ke||{}),Te=(e=>(e.Auto="auto",e.BasicGauge="basic",e.ColorBackground="color-background",e.ColorBackgroundSolid="color-background-solid",e.ColorText="color-text",e.Custom="custom",e.DataLinks="data-links",e.Gauge="gauge",e.GradientGauge="gradient-gauge",e.Image="image",e.JSONView="json-view",e.LcdGauge="lcd-gauge",e.Sparkline="sparkline",e))(Te||{}),Re=(e=>(e.CSV="csv",e.Date="date",e.Distributed="distributed",e.DoubleQuote="doublequote",e.Glob="glob",e.HTML="html",e.JSON="json",e.Lucene="lucene",e.PercentEncode="percentencode",e.Pipe="pipe",e.QueryParam="queryparam",e.Raw="raw",e.Regex="regex",e.SQLString="sqlstring",e.SingleQuote="singlequote",e.Text="text",e.UriEncode="uriencode",e))(Re||{}),Ae=(e=>(e.exact="exact",e.none="none",e.numbers="numbers",e.signature="signature",e))(Ae||{});Te.Auto;var Ie=(e=>(e.NotStarted="NotStarted",e.Loading="Loading",e.Streaming="Streaming",e.Done="Done",e.Error="Error",e))(Ie||{}),Ve=Object.defineProperty,Me=Object.getOwnPropertySymbols,Fe=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable,$e=(e,t,n)=>t in e?Ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Ne extends ae{getResultsStream(){const e={origin:this,data:this.state.data};return(0,k.of)(e)}constructor(e){super(((e,t)=>{for(var n in t||(t={}))Fe.call(t,n)&&$e(e,n,t[n]);if(Me)for(var n of Me(t))Le.call(t,n)&&$e(e,n,t[n]);return e})({data:Be},e))}}const Be={state:Ie.Done,series:[],timeRange:(0,e.getDefaultTimeRange)()};class ze{getKeys(){return"function"==typeof this._keys?this._keys():this._keys}getUrlState(){return this._sceneObject.getUrlState()}updateFromUrl(e){this._sceneObject.updateFromUrl(e)}performBrowserHistoryAction(e){this._nextChangeShouldAddHistoryStep=!0,e(),this._nextChangeShouldAddHistoryStep=!1}shouldCreateHistoryStep(e){return this._nextChangeShouldAddHistoryStep}constructor(e,t){this._sceneObject=e,this._nextChangeShouldAddHistoryStep=!1,this._keys=t.keys}}const qe=/^\d+[yYmMsSwWhHdD]$/;function He(t){if("string"!=typeof t)return null;if(-1!==t.indexOf("now"))return t;if(qe.test(t))return t;if(8===t.length){const n=(0,e.toUtc)(t,"YYYYMMDD");if(n.isValid())return n.toISOString()}else if(15===t.length){const n=(0,e.toUtc)(t,"YYYYMMDDTHHmmss");if(n.isValid())return n.toISOString()}else if(19===t.length){const n=(0,e.toUtc)(t,"YYYY-MM-DD HH:mm:ss");if(n.isValid())return n.toISOString()}else if(24===t.length)return(0,e.toUtc)(t).toISOString();const n=parseInt(t,10);return isNaN(n)?null:(0,e.toUtc)(n).toISOString()}function We(t,n,r,a,o){const i=o&&"now"===n;return{from:e.dateMath.parse(t,!1,r,a),to:e.dateMath.parse(i?"now-"+o:n,!0,r,a),raw:{from:t,to:n}}}function Ue(t,n,r){return(0,e.isDateTime)(t)?t.isValid():e.dateMath.isMathString(t)?e.dateMath.isValid(t):(0,e.dateTimeParse)(t,{roundUp:n,timeZone:r}).isValid()}var Ge=Object.defineProperty,Qe=Object.getOwnPropertySymbols,Ke=Object.prototype.hasOwnProperty,Ye=Object.prototype.propertyIsEnumerable,Ze=(e,t,n)=>t in e?Ge(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Xe extends ae{_onActivate(){if(!this.state.timeZone){const e=this.getTimeZoneSource();e!==this&&this._subs.add(e.subscribeToState(((t,n)=>{void 0!==t.timeZone&&t.timeZone!==n.timeZone&&this.setState({value:We(this.state.from,this.state.to,e.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay)})})))}e.rangeUtil.isRelativeTimeRange(this.state.value.raw)&&this.refreshIfStale()}refreshIfStale(){var e,t,n,r;let a;void 0!==(null==(t=null==(e=this.state)?void 0:e.refreshOnActivate)?void 0:t.percent)&&(a=this.calculatePercentOfInterval(this.state.refreshOnActivate.percent)),void 0!==(null==(r=null==(n=this.state)?void 0:n.refreshOnActivate)?void 0:r.afterMs)&&(a=Math.min(this.state.refreshOnActivate.afterMs,null!=a?a:1/0)),void 0!==a&&this.refreshRange(a)}getTimeZoneSource(){if(!this.parent||!this.parent.parent)return this;return he(this.parent.parent,(e=>{if(e.state.$timeRange&&e.state.$timeRange.state.timeZone)return e.state.$timeRange}))||this}refreshRange(t){var n;const r=We(this.state.from,this.state.to,null!=(n=this.state.timeZone)?n:(0,e.getTimeZone)(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay);r.to.diff(this.state.value.to,"milliseconds")>=t&&this.setState({value:r})}calculatePercentOfInterval(e){const t=this.state.value.to.diff(this.state.value.from,"milliseconds");return Math.ceil(t/e)}getTimeZone(){if(this.state.timeZone)return this.state.timeZone;const t=this.getTimeZoneSource();return t!==this?t.state.timeZone:(0,e.getTimeZone)()}getUrlState(){const e=d.locationService.getSearchObject(),t={from:this.state.from,to:this.state.to};return this.state.timeZone&&(t.timezone=this.state.timeZone),e.time&&e["time.window"]&&(t.time=null,t["time.window"]=null),t}updateFromUrl(t){var n,r,a;const o={};let i=He(t.from),s=He(t.to);if(t.time&&t["time.window"]){const n=function(t,n){const r=isNaN(Date.parse(t))?parseInt(t,10):Date.parse(t);let a;return a=n.match(/^\d+$/)&&parseInt(n,10)?parseInt(n,10):e.rangeUtil.intervalToMs(n),{from:(0,e.toUtc)(r-a/2).toISOString(),to:(0,e.toUtc)(r+a/2).toISOString()}}(Array.isArray(t.time)?t.time[0]:t.time,Array.isArray(t["time.window"])?t["time.window"][0]:t["time.window"]);n.from&&Ue(n.from)&&(i=n.from),n.to&&Ue(n.to)&&(s=n.to)}if(i&&Ue(i)&&(o.from=i),s&&Ue(s)&&(o.to=s),"string"==typeof t.timezone&&(o.timeZone=""!==t.timezone?t.timezone:void 0),0!==Object.keys(o).length)return o.value=We(null!=(n=o.from)?n:this.state.from,null!=(r=o.to)?r:this.state.to,null!=(a=o.timeZone)?a:this.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay),this.setState(o)}constructor(t={}){var n;const r=t.from&&Ue(t.from)?t.from:"now-6h",a=t.to&&Ue(t.to)?t.to:"now",o=t.timeZone;super(((e,t)=>{for(var n in t||(t={}))Ke.call(t,n)&&Ze(e,n,t[n]);if(Qe)for(var n of Qe(t))Ye.call(t,n)&&Ze(e,n,t[n]);return e})({from:r,to:a,timeZone:o,value:We(r,a,o||(0,e.getTimeZone)(),t.fiscalYearStartMonth,t.UNSAFE_nowDelay),refreshOnActivate:null!=(n=t.refreshOnActivate)?n:{percent:10}},t)),this._urlSync=new ze(this,{keys:["from","to","timezone","time","time.window"]}),this.onTimeRangeChange=e=>{const t={};"string"==typeof e.raw.from?t.from=e.raw.from:t.from=e.raw.from.toISOString(),"string"==typeof e.raw.to?t.to=e.raw.to:t.to=e.raw.to.toISOString(),t.value=We(t.from,t.to,this.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay),t.from===this.state.from&&t.to===this.state.to||this._urlSync.performBrowserHistoryAction((()=>{this.setState(t)}))},this.onTimeZoneChange=e=>{this._urlSync.performBrowserHistoryAction((()=>{this.setState({timeZone:e})}))},this.onRefresh=()=>{this.setState({value:We(this.state.from,this.state.to,this.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay)}),this.publishEvent(new d.RefreshEvent,!0)},this.addActivationHandler(this._onActivate.bind(this))}}const Je=new Ne,et=new Xe,tt=new class extends ae{getByName(e){}isVariableLoadingOrWaitingToUpdate(e){return!1}constructor(){super({variables:[]})}};function nt(e){var t;return null!=(t=he(e,(e=>e.state.$timeRange)))?t:et}class rt extends e.BusEventWithPayload{}function at(e){return"object"==typeof e&&"formatter"in e}rt.type="scene-variable-changed-value";let ot,it={};function st(e){return it[e]||(it[e]=(0,be.property)(e))}class lt{getValue(e){let{value:t}=this.state,n=t.value;return n=e?st(e)(t.value):t.value,"string"===n||"number"===n||"boolean"===n?n:String(n)}getValueText(){const{value:e}=this.state;return null!=e.text?String(e.text):String(e)}constructor(e,t){this.state={name:e,value:t,type:"scopedvar"}}}const ut=new e.Registry((()=>{const t=[{id:Re.Lucene,name:"Lucene",description:"Values are lucene escaped and multi-valued variables generate an OR expression",formatter:e=>"string"==typeof e?ct(e):Array.isArray(e)?0===e.length?"__empty__":"("+(0,be.map)(e,(e=>'"'+ct(e)+'"')).join(" OR ")+")":ct(`${e}`)},{id:Re.Raw,name:"raw",description:"Keep value as is",formatter:e=>String(e)},{id:Re.Regex,name:"Regex",description:"Values are regex escaped and multi-valued variables generate a (<value>|<value>) expression",formatter:t=>{if("string"==typeof t)return(0,e.escapeRegex)(t);if(Array.isArray(t)){const n=t.map((t=>"string"==typeof t?(0,e.escapeRegex)(t):(0,e.escapeRegex)(String(t))));return 1===n.length?n[0]:"("+n.join("|")+")"}return(0,e.escapeRegex)(`${t}`)}},{id:Re.Pipe,name:"Pipe",description:"Values are separated by | character",formatter:e=>"string"==typeof e?e:Array.isArray(e)?e.join("|"):`${e}`},{id:Re.Distributed,name:"Distributed",description:"Multiple values are formatted like variable=value",formatter:(e,t,n)=>"string"==typeof e?e:Array.isArray(e)?(e=(0,be.map)(e,((e,t)=>0!==t?n.state.name+"="+e:e)),e.join(",")):`${e}`},{id:Re.CSV,name:"Csv",description:"Comma-separated values",formatter:e=>"string"==typeof e?e:(0,be.isArray)(e)?e.join(","):String(e)},{id:Re.HTML,name:"HTML",description:"HTML escaping of values",formatter:t=>"string"==typeof t?e.textUtil.escapeHtml(t):(0,be.isArray)(t)?e.textUtil.escapeHtml(t.join(", ")):e.textUtil.escapeHtml(String(t))},{id:Re.JSON,name:"JSON",description:"JSON stringify value",formatter:e=>"string"==typeof e?e:JSON.stringify(e)},{id:Re.PercentEncode,name:"Percent encode",description:"Useful for URL escaping values",formatter:e=>(0,be.isArray)(e)?dt("{"+e.join(",")+"}"):dt(e)},{id:Re.SingleQuote,name:"Single quote",description:"Single quoted values",formatter:e=>{const t=new RegExp("'","g");if((0,be.isArray)(e))return(0,be.map)(e,(e=>`'${(0,be.replace)(e,t,"\\'")}'`)).join(",");let n="string"==typeof e?e:String(e);return`'${(0,be.replace)(n,t,"\\'")}'`}},{id:Re.DoubleQuote,name:"Double quote",description:"Double quoted values",formatter:e=>{const t=new RegExp('"',"g");if((0,be.isArray)(e))return(0,be.map)(e,(e=>`"${(0,be.replace)(e,t,'\\"')}"`)).join(",");let n="string"==typeof e?e:String(e);return`"${(0,be.replace)(n,t,'\\"')}"`}},{id:Re.SQLString,name:"SQL string",description:"SQL string quoting and commas for use in IN statements and other scenarios",formatter:gt},{id:Re.Date,name:"Date",description:"Format date in different ways",formatter:(t,n)=>{var r;let a=NaN;if("number"==typeof t?a=t:"string"==typeof t&&(a=parseInt(t,10)),isNaN(a))return"NaN";const o=null!=(r=n[0])?r:"iso";switch(o){case"ms":return String(t);case"seconds":return`${Math.round(a/1e3)}`;case"iso":return(0,e.dateTime)(a).toISOString();default:return(n||[]).length>1?(0,e.dateTime)(a).format(n.join(":")):(0,e.dateTime)(a).format(o)}}},{id:Re.Glob,name:"Glob",description:"Format multi-valued variables using glob syntax, example {value1,value2}",formatter:e=>(0,be.isArray)(e)&&e.length>1?"{"+e.join(",")+"}":String(e)},{id:Re.Text,name:"Text",description:"Format variables in their text representation. Example in multi-variable scenario A + B + C.",formatter:(e,t,n)=>n.getValueText?n.getValueText():String(e)},{id:Re.QueryParam,name:"Query parameter",description:"Format variables as URL parameters. Example in multi-variable scenario A + B + C => var-foo=A&var-foo=B&var-foo=C.",formatter:(t,n,r)=>{if(r.urlSync){const t=r.urlSync.getUrlState();return e.urlUtil.toUrlParams(t)}return Array.isArray(t)?t.map((e=>ht(r.state.name,e))).join("&"):ht(r.state.name,t)}},{id:Re.UriEncode,name:"Percent encode as URI",description:"Useful for URL escaping values, taking into URI syntax characters",formatter:e=>(0,be.isArray)(e)?pt("{"+e.join(",")+"}"):pt(e)}];return t}));function ct(e){return!1===isNaN(+e)?e:e.replace(/([\!\*\+\-\=<>\s\&\|\(\)\[\]\{\}\^\~\?\:\\/"])/g,"\\$1")}function dt(e){return"object"==typeof e&&(e=String(e)),ft(encodeURIComponent(e))}const pt=e=>ft(encodeURI(String(e))),ft=e=>e.replace(/[!'()*]/g,(e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()));function ht(e,t){return`var-${e}=${dt(t)}`}const mt={"'":"''",'"':'\\"'};function gt(e){const t=new RegExp("'|\"","g");if((0,be.isArray)(e))return(0,be.map)(e,(e=>`'${(0,be.replace)(e,t,(e=>{var t;return null!=(t=mt[e])?t:""}))}'`)).join(",");let n="string"==typeof e?e:String(e);return`'${(0,be.replace)(n,t,(e=>{var t;return null!=(t=mt[e])?t:""}))}'`}const bt="All",yt="$__all",vt="$__auto",wt=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;class Ot{formatter(){return this._value}constructor(e){this._value=e}}class St{getValue(){const e=nt(this._sceneObject);return"__from"===this.state.name?e.state.value.from.valueOf():e.state.value.to.valueOf()}getValueText(){const t=nt(this._sceneObject);return"__from"===this.state.name?(0,e.dateTimeFormat)(t.state.value.from,{timeZone:t.getTimeZone()}):(0,e.dateTimeFormat)(t.state.value.to,{timeZone:t.getTimeZone()})}constructor(e,t){this.state={name:e,type:"time_macro"},this._sceneObject=t}}class _t{getValue(){var e;const t=fu(this._sceneObject);if(t){const n=null==(e=t.state.data)?void 0:e.request;return n?"__interval_ms"===this.state.name?n.intervalMs:n.interval:this.state.match}return this.state.match}constructor(e,t,n){this.state={name:e,type:"time_macro",match:n},this._sceneObject=t}}function xt(e,t){e.setState(t)}function Pt(){return d.useLocationService?(0,d.useLocationService)():d.locationService}class jt extends ae{validateAndUpdate(){return this.getValueOptions({}).pipe((0,k.map)((e=>(this.updateValueGivenNewOptions(e),{}))))}onCancel(){this.setStateHelper({loading:!1});const e=this.parent;null==e||e.cancel(this)}updateValueGivenNewOptions(e){const{value:t,text:n,options:r}=this.state,a=this.getStateUpdateGivenNewOptions(e,t,n);this.interceptStateUpdateAfterValidation(a),this.setStateHelper(a),(a.value!==t||a.text!==n||this.hasAllValue()&&!(0,be.isEqual)(e,r))&&this.publishEvent(new rt(this),!0)}getStateUpdateGivenNewOptions(e,t,n){const r={options:e,loading:!1,value:t,text:n};if(0===e.length)return this.state.defaultToAll||this.state.includeAll?(r.value=yt,r.text=bt):this.state.isMulti?(r.value=[],r.text=[]):(r.value="",r.text=""),r;if(this.hasAllValue())return this.state.includeAll||(r.value=e[0].value,r.text=e[0].label,this.state.isMulti&&(r.value=[r.value],r.text=[r.text])),r;if(this.state.isMulti){const a=(Array.isArray(t)?t:[t]).filter((t=>e.find((e=>e.value===t)))),o=a.map((t=>e.find((e=>e.value===t)).label));if(0===a.length){const t=this.getDefaultMultiState(e);r.value=t.value,r.text=t.text}else(0,be.isEqual)(a,t)||(r.value=a),(0,be.isEqual)(o,n)||(r.text=o);return r}let a=function(e,t,n){let r;for(const a of n){if(a.value===e)return a;a.label===t&&(r=a)}return r}(t,n,e);return a?(r.text=a.label,r.value=a.value):this.state.defaultToAll?(r.value=yt,r.text=bt):(r.value=e[0].value,r.text=e[0].label),r}interceptStateUpdateAfterValidation(e){const t=e.value===yt&&this.state.text===bt;this.skipNextValidation&&e.value!==this.state.value&&e.text!==this.state.text&&!t&&(e.value=this.state.value,e.text=this.state.text),this.skipNextValidation=!1}getValue(){return this.hasAllValue()?this.state.allValue?new Et(this.state.allValue,this):this.state.options.map((e=>e.value)):this.state.value}getValueText(){return this.hasAllValue()?bt:Array.isArray(this.state.text)?this.state.text.join(" + "):String(this.state.text)}hasAllValue(){const e=this.state.value;return e===yt||Array.isArray(e)&&e[0]===yt}getDefaultMultiState(e){return this.state.defaultToAll?{value:[yt],text:[bt]}:e.length>0?{value:[e[0].value],text:[e[0].label]}:{value:[],text:[]}}changeValueTo(e,t){if(e!==this.state.value||t!==this.state.text){if(t||(t=Array.isArray(e)?e.map((e=>this.findLabelTextForValue(e))):this.findLabelTextForValue(e)),Array.isArray(e)){if(0===e.length){const n=this.getDefaultMultiState(this.state.options);e=n.value,t=n.text}e[e.length-1]===yt?(e=[yt],t=[bt]):e[0]===yt&&e.length>1&&(e.shift(),Array.isArray(t)&&t.shift())}(0,be.isEqual)(e,this.state.value)&&(0,be.isEqual)(t,this.state.text)||(this.setStateHelper({value:e,text:t,loading:!1}),this.publishEvent(new rt(this),!0))}}findLabelTextForValue(e){if(e===yt)return bt;const t=this.state.options.find((t=>t.value===e));if(t)return t.label;const n=this.state.options.find((t=>t.label===e));return n?n.label:e}setStateHelper(e){xt(this,e)}getOptionsForSelect(){let e=this.state.options;return this.state.includeAll&&(e=[{value:yt,label:bt},...e]),Array.isArray(this.state.value)||e.find((e=>e.value===this.state.value))||(e=[{value:this.state.value,label:String(this.state.text)},...e]),e}refreshOptions(){this.getValueOptions({}).subscribe((e=>{this.updateValueGivenNewOptions(e)}))}constructor(){super(...arguments),this._urlSync=new Ct(this)}}class Ct{getKey(){return`var-${this._sceneObject.state.name}`}getKeys(){return this._sceneObject.state.skipUrlSync?[]:[this.getKey()]}getUrlState(){if(this._sceneObject.state.skipUrlSync)return{};let e=null,t=this._sceneObject.state.value;return e=Array.isArray(t)?t.map(String):this._sceneObject.state.isMulti?[String(t)]:String(t),{[this.getKey()]:e}}updateFromUrl(e){let t=e[this.getKey()];null!=t&&(this._sceneObject.state.includeAll&&(t=function(e){return(0,be.isArray)(e)&&e[0]===bt?[yt]:e===bt?yt:e}(t)),this._sceneObject.state.allValue&&this._sceneObject.state.allValue===t&&(t=yt),this._sceneObject.isActive||(this._sceneObject.skipNextValidation=!0),this._sceneObject.changeValueTo(t))}constructor(e){this._sceneObject=e}}class Et{formatter(e){return e===Re.Text?bt:e===Re.PercentEncode?ut.get(Re.PercentEncode).formatter(this._value,[],this._variable):e===Re.QueryParam?ut.get(Re.QueryParam).formatter(bt,[],this._variable):this._value}constructor(e,t){this._value=e,this._variable=t}}function Dt(e,t={}){if(e.state.$variables)for(const n of e.state.$variables.state.variables)n.state.skipUrlSync||t[n.state.name]||(t[n.state.name]=n);return e.parent&&Dt(e.parent,t),t}var kt=Object.defineProperty,Tt=Object.defineProperties,Rt=Object.getOwnPropertyDescriptors,At=Object.getOwnPropertySymbols,It=Object.prototype.hasOwnProperty,Vt=Object.prototype.propertyIsEnumerable,Mt=(e,t,n)=>t in e?kt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const Ft=(0,e.getDisplayProcessor)();class Lt{formatter(e){if(!e)return this._urlQueryParams;const t=e.split(":");if("exclude"===t[0]&&t.length>1){const e=new URLSearchParams(this._urlQueryParams);for(const n of t[1].split(","))e.delete(n);return`?${e}`}if("include"===t[0]&&t.length>1){const e=new URLSearchParams(this._urlQueryParams),n=t[1].split(",");for(const t of e.keys())n.includes(t)||e.delete(t);return`?${e}`}return this._urlQueryParams}constructor(e){this._urlQueryParams=e}}const $t=new Map([[e.DataLinkBuiltInVars.includeVars,class{getValue(){const e=Dt(this._sceneObject),t=ut.get(Re.QueryParam),n=[];for(const r of Object.keys(e)){const a=e[r];if(a instanceof jt&&a.hasAllValue()&&!a.state.allValue){n.push(t.formatter(yt,[],a));continue}const o=a.getValue();o&&(at(o)?n.push(o.formatter(Re.QueryParam)):n.push(t.formatter(o,[],a)))}return new Ot(n.join("&"))}getValueText(){return""}constructor(e,t){this.state={name:e,type:"url_variable"},this._sceneObject=t}}],[e.DataLinkBuiltInVars.keepTime,class{getValue(){var t;const n=null==(t=nt(this._sceneObject).urlSync)?void 0:t.getUrlState();return new Ot(e.urlUtil.toUrlParams(n))}getValueText(){return""}constructor(e,t){this.state={name:e,type:"url_variable"},this._sceneObject=t}}],["__value",class{getValue(t){var n,r;const a=null==(n=this._scopedVars)?void 0:n.__dataContext;if(!a)return this._match;const{frame:o,rowIndex:i,field:s,calculatedValue:l}=a.value;if(l)switch(t){case"numeric":case"raw":return l.numeric;case"time":return"";default:return(0,e.formattedValueToString)(l)}if(null==i)return this._match;if("time"===t){const t=o.fields.find((t=>t.type===e.FieldType.time));return t?t.values.get(i):void 0}if(!s)return this._match;const u=s.values.get(i);if("raw"===t)return u;const c=(null!=(r=s.display)?r:Ft)(u);return"numeric"===t?c.numeric:(0,e.formattedValueToString)(c)}getValueText(){return""}constructor(e,t,n,r){this._match=n,this._scopedVars=r,this.state={name:e,type:"__value"}}}],["__data",class{getValue(t){var n,r;const a=null==(n=this._scopedVars)?void 0:n.__dataContext;if(!a||!t)return this._match;const{frame:o,rowIndex:i}=a.value;if(void 0===i||void 0===t)return this._match;const s={name:o.name,refId:o.refId,fields:(0,e.getFieldDisplayValuesProxy)({frame:o,rowIndex:i})};return null!=(r=st(t)(s))?r:""}getValueText(){return""}constructor(e,t,n,r){this._match=n,this._scopedVars=r,this.state={name:e,type:"__data"}}}],["__series",class{getValue(t){var n;const r=null==(n=this._scopedVars)?void 0:n.__dataContext;if(!r||!t)return this._match;if("name"!==t)return this._match;const{frame:a,frameIndex:o}=r.value;return(0,e.getFrameDisplayName)(a,o)}getValueText(){return""}constructor(e,t,n,r){this._match=n,this._scopedVars=r,this.state={name:e,type:"__series"}}}],["__field",class{getValue(t){var n,r;const a=null==(n=this._scopedVars)?void 0:n.__dataContext;if(!a||!t)return this._match;if(void 0===t||""===t)return this._match;const{frame:o,field:i,data:s}=a.value,l=function(t,n,r){return new Proxy({},{get:(a,o)=>{return"name"===o?t.name:"displayName"===o?(0,e.getFieldDisplayName)(t,n,r):"labels"===o||"formattedLabels"===o?t.labels?(i=((e,t)=>{for(var n in t||(t={}))It.call(t,n)&&Mt(e,n,t[n]);if(At)for(var n of At(t))Vt.call(t,n)&&Mt(e,n,t[n]);return e})({},t.labels),s={__values:Object.values(t.labels).sort().join(", "),toString:()=>(0,e.formatLabels)(t.labels,"",!0)},Tt(i,Rt(s))):"":void 0;var i,s}})}(i,o,s);return null!=(r=st(t)(l))?r:""}getValueText(){return""}constructor(e,t,n,r){this._match=n,this._scopedVars=r,this.state={name:e,type:"__field"}}}],["__url",class{getValue(e){var t;const n=d.locationService.getLocation(),r=null!=(t=d.config.appSubUrl)?t:"";switch(null!=e?e:""){case"params":return new Lt(n.search);case"path":return r+n.pathname;default:return r+n.pathname+n.search}}getValueText(){return""}constructor(e,t){this.state={name:e,type:"url_macro"}}}],["__from",St],["__to",St],["__timezone",class{getValue(){const e=nt(this._sceneObject).getTimeZone();return"browser"===e?Intl.DateTimeFormat().resolvedOptions().timeZone:e}getValueText(){return this.getValue()}constructor(e,t){this.state={name:e,type:"time_macro"},this._sceneObject=t}}],["__user",class{getValue(e){const t=d.config.bootData.user;switch(e){case"login":return t.login;case"email":return t.email;default:return String(t.id)}}getValueText(){return""}constructor(e,t){this.state={name:e,type:"user_macro"}}}],["__org",class{getValue(e){const t=d.config.bootData.user;return"name"===e?t.orgName:String(t.orgId)}getValueText(){return""}constructor(e,t){this.state={name:e,type:"org_macro"}}}],["__interval",_t],["__interval_ms",_t]]);function Nt(e,t,n,r,a){return t&&"string"==typeof t?(wt.lastIndex=0,t.replace(wt,((t,o,i,s,l,u,c)=>{const d=o||i||l,p=s||c||r,f=function(e,t,n,r){if(n&&n.hasOwnProperty(e)){const t=n[e];if(t)return function(e,t){return ot?(ot.state.name=e,ot.state.value=t):ot=new lt(e,t),ot}(e,t)}const a=ye(e,r);if(a)return a;const o=$t.get(e);return o?new o(e,r,t,n):null}(d,t,n,e);if(!f)return a&&a.push({match:t,variableName:d,fieldPath:u,format:p,value:t,found:!1}),t;const h=function(e,t,n,r){if(null==n)return"";if(at(n))return Nt(e,n.formatter(r));if(Array.isArray(n)||"object"!=typeof n||(n=`${n}`),"function"==typeof r)return r(n,{name:t.state.name,type:t.state.type,multi:t.state.isMulti,includeAll:t.state.includeAll});let a=[];r?(a=r.split(":"),a.length>1?(r=a[0],a=a.slice(1)):a=[]):r=Re.Glob;let o=ut.getIfExists(r);return o||(console.error(`Variable format ${r} not found. Using glob format as fallback.`),o=ut.get(Re.Glob)),o.formatter(n,a,t)}(e,f,f.getValue(u),p);return a&&a.push({match:t,variableName:d,fieldPath:u,format:p,value:h,found:h!==t}),h}))):null!=t?t:""}function Bt(e){return void 0!==e.useState}function zt(e){return"enrichDataRequest"in e}function qt(e){return"isDataLayer"in e}var Ht,Wt=(e,t,n)=>(((e,t,n)=>{if(!t.has(e))throw TypeError("Cannot read from private field")})(e,t),n?n.call(e):t.get(e));class Ut extends ae{queryStarted(e){Wt(this,Ht).add(e),this.changeRunningQueryCount(1),this.state.isRunning||this.setState({isRunning:!0})}queryCompleted(e){Wt(this,Ht).has(e)&&(Wt(this,Ht).delete(e),this.changeRunningQueryCount(-1),0===Wt(this,Ht).size&&this.setState({isRunning:!1}))}changeRunningQueryCount(e){var t;window.__grafanaRunningQueryCount=(null!=(t=window.__grafanaRunningQueryCount)?t:0)+e}cancelAll(){var e;for(const t of Wt(this,Ht).values())null==(e=t.cancel)||e.call(t)}constructor(){super({isRunning:!1}),this.isQueryController=!0,((e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)})(this,Ht,new Set),this.addActivationHandler((()=>()=>Wt(this,Ht).clear()))}}function Gt(e,t,...n){let r=!1;"undefined"!=typeof window&&(r="true"===localStorage.getItem("grafana.debug.scenes")),r&&console.log(`${e}: `,t,...n)}function Qt(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function Kt(e,t){return Yt.apply(this,arguments)}function Yt(){var e;return e=function*(e,t){if(null==e?void 0:e.uid){const t=ge.get(e.uid);if(t)return t}return e&&e.query?e:yield(0,d.getDataSourceSrv)().get(e,t)},Yt=function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){Qt(o,r,a,i,s,"next",e)}function s(e){Qt(o,r,a,i,s,"throw",e)}i(void 0)}))},Yt.apply(this,arguments)}Ht=new WeakMap;class Zt{recordCurrentDependencyValuesForSceneObject(e){if(this.clearValues(),e.variableDependency)for(const t of e.variableDependency.getNames()){const n=yu.lookupVariable(t,e);n&&this._values.set(n.state.name,n.getValue())}}cloneAndRecordCurrentValuesForSceneObject(e){const t=new Zt;return t.recordCurrentDependencyValuesForSceneObject(e),t}clearValues(){this._values.clear()}hasValues(){return!!this._values}recordCurrentValue(e){this._values.set(e.state.name,e.getValue())}hasRecordedValue(e){return this._values.has(e.state.name)}hasValueChanged(e){return!(!this._values.has(e.state.name)||El(this._values.get(e.state.name),e.getValue()))}hasDependenciesChanged(e){if(!this._values)return!1;if(!e.variableDependency)return!1;for(const t of e.variableDependency.getNames()){const n=yu.lookupVariable(t,e);if(!n)continue;const r=n.state.name;if(n&&this._values.has(r)&&!El(this._values.get(r),n.getValue()))return!0}return!1}constructor(){this._values=new Map}}function Xt(e){return"object"==typeof e&&"getExtraQueries"in e}var Jt=Object.defineProperty,en=Object.defineProperties,tn=Object.getOwnPropertyDescriptors,nn=Object.getOwnPropertySymbols,rn=Object.prototype.hasOwnProperty,an=Object.prototype.propertyIsEnumerable,on=(e,t,n)=>t in e?Jt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const sn=(e,t)=>(0,k.of)(t);var ln=Object.defineProperty,un=Object.defineProperties,cn=Object.getOwnPropertyDescriptors,dn=Object.getOwnPropertySymbols,pn=Object.prototype.hasOwnProperty,fn=Object.prototype.propertyIsEnumerable,hn=(e,t,n)=>t in e?ln(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,mn=(e,t)=>{for(var n in t||(t={}))pn.call(t,n)&&hn(e,n,t[n]);if(dn)for(var n of dn(t))fn.call(t,n)&&hn(e,n,t[n]);return e},gn=(e,t)=>un(e,cn(t));function bn(e){const t=e.getRoot();return zt(t)?t.enrichDataRequest(e):null}let yn,vn=new Set;function wn(e){return t=>{const n=yu.getQueryController(e.origin);return n?new k.Observable((r=>{e.cancel||(e.cancel=()=>r.complete()),n.queryStarted(e);let a=!1;const o=t.subscribe({next:t=>{a||t.state===Ie.Loading||(a=!0,n.queryCompleted(e)),r.next(t)},error:e=>r.error(e),complete:()=>{r.complete()}});return()=>{o.unsubscribe(),a||n.queryCompleted(e)}})):t}}const On=new Set;var Sn=f(388);const _n={RadioButton:{container:"data-testid radio-button"},Breadcrumbs:{breadcrumb:e=>`data-testid ${e} breadcrumb`},TimePicker:{openButton:"data-testid TimePicker Open Button",overlayContent:"data-testid TimePicker Overlay Content",fromField:"data-testid Time Range from field",toField:"data-testid Time Range to field",applyTimeRange:"data-testid TimePicker submit button",copyTimeRange:"data-testid TimePicker copy button",pasteTimeRange:"data-testid TimePicker paste button",calendar:{label:"data-testid Time Range calendar",openButton:"data-testid Open time range calendar",closeButton:"data-testid Close time range Calendar"},absoluteTimeRangeTitle:"data-testid-absolute-time-range-narrow"},DataSourcePermissions:{form:()=>'form[name="addPermission"]',roleType:"Role to add new permission to",rolePicker:"Built-in role picker",permissionLevel:"Permission Level"},DateTimePicker:{input:"data-testid date-time-input"},DataSource:{TestData:{QueryTab:{scenarioSelectContainer:"Test Data Query scenario select container",scenarioSelect:"Test Data Query scenario select",max:"TestData max",min:"TestData min",noise:"TestData noise",seriesCount:"TestData series count",spread:"TestData spread",startValue:"TestData start value",drop:"TestData drop values"}},DataSourceHttpSettings:{urlInput:"data-testid Datasource HTTP settings url"},Jaeger:{traceIDInput:"Trace ID"},Prometheus:{configPage:{connectionSettings:"Data source connection URL",manageAlerts:"prometheus-alerts-manager",scrapeInterval:"data-testid scrape interval",queryTimeout:"data-testid query timeout",defaultEditor:"data-testid default editor",disableMetricLookup:"disable-metric-lookup",prometheusType:"data-testid prometheus type",prometheusVersion:"data-testid prometheus version",cacheLevel:"data-testid cache level",incrementalQuerying:"prometheus-incremental-querying",queryOverlapWindow:"data-testid query overlap window",disableRecordingRules:"disable-recording-rules",customQueryParameters:"data-testid custom query parameters",httpMethod:"data-testid http method",exemplarsAddButton:"data-testid Add exemplar config button",internalLinkSwitch:"data-testid Internal link switch"},queryEditor:{explain:"data-testid prometheus explain switch wrapper",editorToggle:"data-testid QueryEditorModeToggle",options:"data-testid prometheus options",legend:"data-testid prometheus legend wrapper",format:"data-testid prometheus format",step:"prometheus-step",type:"data-testid prometheus type",exemplars:"prometheus-exemplars",builder:{metricSelect:"data-testid metric select",hints:"data-testid prometheus hints",metricsExplorer:"data-testid metrics explorer",queryAdvisor:"data-testid query advisor"},code:{queryField:"data-testid prometheus query field",metricsBrowser:{openButton:"data-testid open metrics browser",selectMetric:"data-testid select a metric",metricList:"data-testid metric list",labelNamesFilter:"data-testid label names filter",labelValuesFilter:"data-testid label values filter",useQuery:"data-testid use query",useAsRateQuery:"data-testid use as rate query",validateSelector:"data-testid validate selector",clear:"data-testid clear"}}},exemplarMarker:"data-testid Exemplar marker",variableQueryEditor:{queryType:"data-testid query type",labelnames:{metricRegex:"data-testid label names metric regex"},labelValues:{labelSelect:"data-testid label values label select"},metricNames:{metricRegex:"data-testid metric names metric regex"},varQueryResult:"data-testid variable query result",seriesQuery:"data-testid prometheus series query",classicQuery:"data-testid prometheus classic query"},annotations:{minStep:"prometheus-annotation-min-step",title:"data-testid prometheus annotation title",tags:"data-testid prometheus annotation tags",text:"data-testid prometheus annotation text",seriesValueAsTimestamp:"data-testid prometheus annotation series value as timestamp"}}},Menu:{MenuComponent:e=>`${e} menu`,MenuGroup:e=>`${e} menu group`,MenuItem:e=>`${e} menu item`,SubMenu:{container:"data-testid SubMenu container",icon:"data-testid SubMenu icon"}},Panels:{Panel:{title:e=>`data-testid Panel header ${e}`,headerItems:e=>`data-testid Panel header item ${e}`,menuItems:e=>`data-testid Panel menu item ${e}`,menu:e=>`data-testid Panel menu ${e}`,containerByTitle:e=>`${e} panel`,headerCornerInfo:e=>`Panel header ${e}`,status:e=>`data-testid Panel status ${e}`,loadingBar:()=>"Panel loading bar",HoverWidget:{container:"data-testid hover-header-container",dragIcon:"data-testid drag-icon"},PanelDataErrorMessage:"data-testid Panel data error message"},Visualization:{Graph:{container:"Graph container",VisualizationTab:{legendSection:"Legend section"},Legend:{legendItemAlias:e=>`gpl alias ${e}`,showLegendSwitch:"gpl show legend"},xAxis:{labels:()=>"div.flot-x-axis > div.flot-tick-label"}},BarGauge:{value:"Bar gauge value",valueV2:"data-testid Bar gauge value"},PieChart:{svgSlice:"data testid Pie Chart Slice"},Text:{container:()=>".markdown-html"},Table:{header:"table header",footer:"table-footer",body:"data-testid table body"}}},VizLegend:{seriesName:e=>`data-testid VizLegend series ${e}`},Drawer:{General:{title:e=>`Drawer title ${e}`,expand:"Drawer expand",contract:"Drawer contract",close:"data-testid Drawer close",rcContentWrapper:()=>".rc-drawer-content-wrapper",subtitle:"data-testid drawer subtitle"},DashboardSaveDrawer:{saveButton:"data-testid Save dashboard drawer button",saveAsButton:"data-testid Save as dashboard drawer button",saveAsTitleInput:"Save dashboard title field"}},PanelEditor:{General:{content:"Panel editor content"},OptionsPane:{content:"Panel editor option pane content",select:"Panel editor option pane select",fieldLabel:e=>`${e} field property editor`,fieldInput:e=>`data-testid Panel editor option pane field input ${e}`},DataPane:{content:"Panel editor data pane content"},applyButton:"data-testid Apply changes and go back to dashboard",toggleVizPicker:"data-testid toggle-viz-picker",toggleVizOptions:"data-testid toggle-viz-options",toggleTableView:"toggle-table-view",showZoomField:"Map controls Show zoom control field property editor",showAttributionField:"Map controls Show attribution field property editor",showScaleField:"Map controls Show scale field property editor",showMeasureField:"Map controls Show measure tools field property editor",showDebugField:"Map controls Show debug field property editor",measureButton:"show measure tools"},PanelInspector:{Data:{content:"Panel inspector Data content"},Stats:{content:"Panel inspector Stats content"},Json:{content:"Panel inspector Json content"},Query:{content:"Panel inspector Query content",refreshButton:"Panel inspector Query refresh button",jsonObjectKeys:()=>".json-formatter-key"}},Tab:{title:e=>`Tab ${e}`,active:()=>'[class*="-activeTabStyle"]'},RefreshPicker:{runButton:"RefreshPicker run button",intervalButton:"RefreshPicker interval button",runButtonV2:"data-testid RefreshPicker run button",intervalButtonV2:"data-testid RefreshPicker interval button"},QueryTab:{content:"Query editor tab content",queryInspectorButton:"Query inspector button",queryHistoryButton:"data-testid query-history-button",addQuery:"data-testid query-tab-add-query",queryGroupTopSection:"data-testid query group top section",addExpression:"data-testid query-tab-add-expression"},QueryHistory:{queryText:"Query text"},QueryEditorRows:{rows:"Query editor row"},QueryEditorRow:{actionButton:e=>`data-testid ${e}`,title:e=>`Query editor row title ${e}`,container:e=>`Query editor row ${e}`},AlertTab:{content:"data-testid Alert editor tab content"},AlertRules:{groupToggle:"data-testid group-collapse-toggle",toggle:"data-testid collapse-toggle",expandedContent:"data-testid expanded-content"},Alert:{alert:e=>`Alert ${e}`,alertV2:e=>`data-testid Alert ${e}`},TransformTab:{content:"data-testid Transform editor tab content",newTransform:e=>`data-testid New transform ${e}`,transformationEditor:e=>`data-testid Transformation editor ${e}`,transformationEditorDebugger:e=>`data-testid Transformation editor debugger ${e}`},Transforms:{card:e=>`data-testid New transform ${e}`,disableTransformationButton:"data-testid Disable transformation button",Reduce:{modeLabel:"data-testid Transform mode label",calculationsLabel:"data-testid Transform calculations label"},SpatialOperations:{actionLabel:"root Action field property editor",locationLabel:"root Location Mode field property editor",location:{autoOption:"Auto location option",coords:{option:"Coords location option",latitudeFieldLabel:"root Latitude field field property editor",longitudeFieldLabel:"root Longitude field field property editor"},geohash:{option:"Geohash location option",geohashFieldLabel:"root Geohash field field property editor"},lookup:{option:"Lookup location option",lookupFieldLabel:"root Lookup field field property editor",gazetteerFieldLabel:"root Gazetteer field property editor"}}},searchInput:"data-testid search transformations",noTransformationsMessage:"data-testid no transformations message",addTransformationButton:"data-testid add transformation button",removeAllTransformationsButton:"data-testid remove all transformations button"},NavBar:{Configuration:{button:"Configuration"},Toggle:{button:"data-testid Toggle menu"},Reporting:{button:"Reporting"}},NavMenu:{Menu:"data-testid navigation mega-menu",item:"data-testid Nav menu item"},NavToolbar:{container:"data-testid Nav toolbar",shareDashboard:"data-testid Share dashboard",markAsFavorite:"data-testid Mark as favorite",editDashboard:{editButton:"data-testid Edit dashboard button",saveButton:"data-testid Save dashboard button",exitButton:"data-testid Exit edit mode button",settingsButton:"data-testid Dashboard settings",addRowButton:"data-testid Add row button",addLibraryPanelButton:"data-testid Add a panel from the panel library button",addVisualizationButton:"data-testid Add new visualization menu item",pastePanelButton:"data-testid Paste panel button",discardChangesButton:"data-testid Discard changes button",discardLibraryPanelButton:"data-testid Discard library panel button",unlinkLibraryPanelButton:"data-testid Unlink library panel button",saveLibraryPanelButton:"data-testid Save library panel button",backToDashboardButton:"data-testid Back to dashboard button"}},PageToolbar:{container:()=>".page-toolbar",item:e=>`${e}`,itemButton:e=>`data-testid ${e}`},QueryEditorToolbarItem:{button:e=>`QueryEditor toolbar item button ${e}`},BackButton:{backArrow:"data-testid Go Back"},OptionsGroup:{group:e=>e?`Options group ${e}`:"Options group",toggle:e=>e?`Options group ${e} toggle`:"Options group toggle"},PluginVisualization:{item:e=>`Plugin visualization item ${e}`,current:()=>'[class*="-currentVisualizationItem"]'},Select:{option:"Select option",input:()=>'input[id*="time-options-input"]',singleValue:()=>'div[class*="-singleValue"]'},FieldConfigEditor:{content:"Field config editor content"},OverridesConfigEditor:{content:"Field overrides editor content"},FolderPicker:{container:"Folder picker select container",containerV2:"data-testid Folder picker select container",input:"data-testid folder-picker-input"},ReadonlyFolderPicker:{container:"data-testid Readonly folder picker select container"},DataSourcePicker:{container:"data-testid Data source picker select container",input:()=>'input[id="data-source-picker"]',inputV2:"data-testid Select a data source",dataSourceList:"data-testid Data source list dropdown",advancedModal:{dataSourceList:"data-testid Data source list",builtInDataSourceList:"data-testid Built in data source list"}},TimeZonePicker:{container:"Time zone picker select container",containerV2:"data-testid Time zone picker select container",changeTimeSettingsButton:"data-testid Time zone picker Change time settings button"},WeekStartPicker:{container:"Choose starting day of the week",containerV2:"data-testid Choose starting day of the week",placeholder:"Choose starting day of the week"},TraceViewer:{spanBar:"data-testid SpanBar--wrapper"},QueryField:{container:"data-testid Query field"},QueryBuilder:{queryPatterns:"data-testid Query patterns",labelSelect:"data-testid Select label",valueSelect:"data-testid Select value",matchOperatorSelect:"data-testid Select match operator"},ValuePicker:{button:e=>`data-testid Value picker button ${e}`,select:e=>`data-testid Value picker select ${e}`},Search:{section:"Search section",sectionV2:"data-testid Search section",items:"Search items",itemsV2:"data-testid Search items",cards:"data-testid Search cards",collapseFolder:e=>`data-testid Collapse folder ${e}`,expandFolder:e=>`data-testid Expand folder ${e}`,dashboardItem:e=>`${_n.Search.dashboardItems} ${e}`,dashboardCard:e=>`data-testid Search card ${e}`,folderHeader:e=>`data-testid Folder header ${e}`,folderContent:e=>`data-testid Folder content ${e}`,dashboardItems:"data-testid Dashboard search item"},DashboardLinks:{container:"data-testid Dashboard link container",dropDown:"data-testid Dashboard link dropdown",link:"data-testid Dashboard link"},LoadingIndicator:{icon:"data-testid Loading indicator"},CallToActionCard:{button:e=>`Call to action button ${e}`,buttonV2:e=>`data-testid Call to action button ${e}`},DataLinksContextMenu:{singleLink:"data-testid Data link"},CodeEditor:{container:"data-testid Code editor container"},DashboardImportPage:{textarea:"data-testid-import-dashboard-textarea",submit:"data-testid-load-dashboard"},ImportDashboardForm:{name:"data-testid-import-dashboard-title",submit:"data-testid-import-dashboard-submit"},PanelAlertTabContent:{content:"data-testid Unified alert editor tab content"},VisualizationPreview:{card:e=>`data-testid suggestion-${e}`},ColorSwatch:{name:"data-testid-colorswatch"},DashboardRow:{title:e=>`data-testid dashboard-row-title-${e}`},UserProfile:{profileSaveButton:"data-testid-user-profile-save",preferencesSaveButton:"data-testid-shared-prefs-save",orgsTable:"data-testid-user-orgs-table",sessionsTable:"data-testid-user-sessions-table",extensionPointTabs:"data-testid-extension-point-tabs",extensionPointTab:e=>`data-testid-extension-point-tab-${e}`},FileUpload:{inputField:"data-testid-file-upload-input-field",fileNameSpan:"data-testid-file-upload-file-name"},DebugOverlay:{wrapper:"debug-overlay"},OrgRolePicker:{input:"Role"},AnalyticsToolbarButton:{button:"Dashboard insights"},Variables:{variableOption:"data-testid variable-option"},Annotations:{annotationsTypeInput:"annotations-type-input",annotationsChoosePanelInput:"choose-panels-input",editor:{testButton:"data-testid annotations-test-button",resultContainer:"data-testid annotations-query-result-container"}},Tooltip:{container:"data-testid tooltip"},ReturnToPrevious:{buttonGroup:"data-testid dismissable button group",backButton:"data-testid back",dismissButton:"data-testid dismiss"},SQLQueryEditor:{selectColumn:"data-testid select-column",selectAggregation:"data-testid select-aggregation",selectAlias:"data-testid select-alias",filterConjunction:"data-testid filter-conjunction",filterField:"data-testid filter-field",filterOperator:"data-testid filter-operator",headerTableSelector:"data-testid header-table-selector",headerFilterSwitch:"data-testid header-filter-switch",headerGroupSwitch:"data-testid header-group-switch",headerOrderSwitch:"data-testid header-order-switch",headerPreviewSwitch:"data-testid header-preview-switch"}},xn={pages:{Login:{url:"/login",username:"data-testid Username input field",password:"data-testid Password input field",submit:"data-testid Login button",skip:"data-testid Skip change password button"},Home:{url:"/"},DataSource:{name:"data-testid Data source settings page name input field",delete:"Data source settings page Delete button",readOnly:"data-testid Data source settings page read only message",saveAndTest:"data-testid Data source settings page Save and Test button",alert:"data-testid Data source settings page Alert"},DataSources:{url:"/datasources",dataSources:e=>`Data source list item ${e}`},EditDataSource:{url:e=>`/datasources/edit/${e}`,settings:"Datasource settings page basic settings"},AddDataSource:{url:"/datasources/new",dataSourcePlugins:e=>`Data source plugin item ${e}`,dataSourcePluginsV2:e=>`Add new data source ${e}`},ConfirmModal:{delete:"data-testid Confirm Modal Danger Button"},AddDashboard:{url:"/dashboard/new",itemButton:e=>`data-testid ${e}`,addNewPanel:"Add new panel",addNewRow:"Add new row",addNewPanelLibrary:"Add new panel from panel library"},Dashboard:{url:e=>`/d/${e}`,DashNav:{nav:"Dashboard navigation",navV2:"data-testid Dashboard navigation",publicDashboardTag:"data-testid public dashboard tag",shareButton:"data-testid share-button",scrollContainer:"data-testid Dashboard canvas scroll container",playlistControls:{prev:"data-testid playlist previous dashboard button",stop:"data-testid playlist stop dashboard button",next:"data-testid playlist next dashboard button"}},SubMenu:{submenu:"Dashboard submenu",submenuItem:"data-testid template variable",submenuItemLabels:e=>`data-testid Dashboard template variables submenu Label ${e}`,submenuItemValueDropDownValueLinkTexts:e=>`data-testid Dashboard template variables Variable Value DropDown value link text ${e}`,submenuItemValueDropDownDropDown:"Variable options",submenuItemValueDropDownOptionTexts:e=>`data-testid Dashboard template variables Variable Value DropDown option text ${e}`,Annotations:{annotationsWrapper:"data-testid annotation-wrapper",annotationLabel:e=>`data-testid Dashboard annotations submenu Label ${e}`,annotationToggle:e=>`data-testid Dashboard annotations submenu Toggle ${e}`}},Settings:{Actions:{close:"data-testid dashboard-settings-close"},General:{deleteDashBoard:"Dashboard settings page delete dashboard button",sectionItems:e=>`Dashboard settings section item ${e}`,saveDashBoard:"Dashboard settings aside actions Save button",saveAsDashBoard:"Dashboard settings aside actions Save As button",timezone:"Time zone picker select container",title:"Tab General"},Annotations:{List:{addAnnotationCTA:_n.CallToActionCard.button("Add annotation query"),addAnnotationCTAV2:_n.CallToActionCard.buttonV2("Add annotation query"),annotations:"data-testid list-annotations"},Settings:{name:"Annotations settings name input"},NewAnnotation:{panelFilterSelect:"data-testid annotations-panel-filter",showInLabel:"show-in-label",previewInDashboard:"data-testid annotations-preview",delete:"data-testid annotations-delete",apply:"data-testid annotations-apply",enable:"data-testid annotation-enable",hide:"data-testid annotation-hide"}},Variables:{List:{addVariableCTA:_n.CallToActionCard.button("Add variable"),addVariableCTAV2:_n.CallToActionCard.buttonV2("Add variable"),newButton:"Variable editor New variable button",table:"Variable editor Table",tableRowNameFields:e=>`Variable editor Table Name field ${e}`,tableRowDefinitionFields:e=>`Variable editor Table Definition field ${e}`,tableRowArrowUpButtons:e=>`Variable editor Table ArrowUp button ${e}`,tableRowArrowDownButtons:e=>`Variable editor Table ArrowDown button ${e}`,tableRowDuplicateButtons:e=>`Variable editor Table Duplicate button ${e}`,tableRowRemoveButtons:e=>`Variable editor Table Remove button ${e}`},Edit:{General:{headerLink:"Variable editor Header link",modeLabelNew:"Variable editor Header mode New",modeLabelEdit:"Variable editor Header mode Edit",generalNameInput:"Variable editor Form Name field",generalNameInputV2:"data-testid Variable editor Form Name field",generalTypeSelect:"Variable editor Form Type select",generalTypeSelectV2:"data-testid Variable editor Form Type select",generalLabelInput:"Variable editor Form Label field",generalLabelInputV2:"data-testid Variable editor Form Label field",generalHideSelect:"Variable editor Form Hide select",generalHideSelectV2:"data-testid Variable editor Form Hide select",selectionOptionsMultiSwitch:"data-testid Variable editor Form Multi switch",selectionOptionsIncludeAllSwitch:"data-testid Variable editor Form IncludeAll switch",selectionOptionsCustomAllInput:"data-testid Variable editor Form IncludeAll field",previewOfValuesOption:"data-testid Variable editor Preview of Values option",submitButton:"data-testid Variable editor Run Query button",applyButton:"data-testid Variable editor Apply button"},QueryVariable:{queryOptionsDataSourceSelect:_n.DataSourcePicker.inputV2,queryOptionsRefreshSelect:"Variable editor Form Query Refresh select",queryOptionsRefreshSelectV2:"data-testid Variable editor Form Query Refresh select",queryOptionsRegExInput:"Variable editor Form Query RegEx field",queryOptionsRegExInputV2:"data-testid Variable editor Form Query RegEx field",queryOptionsSortSelect:"Variable editor Form Query Sort select",queryOptionsSortSelectV2:"data-testid Variable editor Form Query Sort select",queryOptionsQueryInput:"data-testid Variable editor Form Default Variable Query Editor textarea",valueGroupsTagsEnabledSwitch:"Variable editor Form Query UseTags switch",valueGroupsTagsTagsQueryInput:"Variable editor Form Query TagsQuery field",valueGroupsTagsTagsValuesQueryInput:"Variable editor Form Query TagsValuesQuery field"},ConstantVariable:{constantOptionsQueryInput:"Variable editor Form Constant Query field",constantOptionsQueryInputV2:"data-testid Variable editor Form Constant Query field"},DatasourceVariable:{datasourceSelect:"data-testid datasource variable datasource type"},TextBoxVariable:{textBoxOptionsQueryInput:"Variable editor Form TextBox Query field",textBoxOptionsQueryInputV2:"data-testid Variable editor Form TextBox Query field"},CustomVariable:{customValueInput:"data-testid custom-variable-input"},IntervalVariable:{intervalsValueInput:"data-testid interval variable intervals input",autoEnabledCheckbox:"data-testid interval variable auto value checkbox",stepCountIntervalSelect:"data-testid interval variable step count input",minIntervalInput:"data-testid interval variable mininum interval input"},GroupByVariable:{dataSourceSelect:_n.DataSourcePicker.inputV2,infoText:"data-testid group by variable info text",modeToggle:"data-testid group by variable mode toggle"},AdHocFiltersVariable:{datasourceSelect:_n.DataSourcePicker.inputV2,infoText:"data-testid ad-hoc filters variable info text",modeToggle:"data-testid ad-hoc filters variable mode toggle"}}}},Annotations:{marker:"data-testid annotation-marker"},Rows:{Repeated:{ConfigSection:{warningMessage:"data-testid Repeated rows warning message"}}}},Dashboards:{url:"/dashboards",dashboards:e=>`Dashboard search item ${e}`},SaveDashboardAsModal:{newName:"Save dashboard title field",save:"Save dashboard button"},SaveDashboardModal:{save:"Dashboard settings Save Dashboard Modal Save button",saveVariables:"Dashboard settings Save Dashboard Modal Save variables checkbox",saveTimerange:"Dashboard settings Save Dashboard Modal Save timerange checkbox",saveRefresh:"Dashboard settings Save Dashboard Modal Save refresh checkbox"},SharePanelModal:{linkToRenderedImage:"Link to rendered image"},ShareDashboardModal:{PublicDashboard:{Tab:"Tab Public dashboard",WillBePublicCheckbox:"data-testid public dashboard will be public checkbox",LimitedDSCheckbox:"data-testid public dashboard limited datasources checkbox",CostIncreaseCheckbox:"data-testid public dashboard cost may increase checkbox",PauseSwitch:"data-testid public dashboard pause switch",EnableAnnotationsSwitch:"data-testid public dashboard on off switch for annotations",CreateButton:"data-testid public dashboard create button",DeleteButton:"data-testid public dashboard delete button",CopyUrlInput:"data-testid public dashboard copy url input",CopyUrlButton:"data-testid public dashboard copy url button",SettingsDropdown:"data-testid public dashboard settings dropdown",TemplateVariablesWarningAlert:"data-testid public dashboard disabled template variables alert",UnsupportedDataSourcesWarningAlert:"data-testid public dashboard unsupported data sources alert",NoUpsertPermissionsWarningAlert:"data-testid public dashboard no upsert permissions alert",EnableTimeRangeSwitch:"data-testid public dashboard on off switch for time range",EmailSharingConfiguration:{Container:"data-testid email sharing config container",ShareType:"data-testid public dashboard share type",EmailSharingInput:"data-testid public dashboard email sharing input",EmailSharingInviteButton:"data-testid public dashboard email sharing invite button",EmailSharingList:"data-testid public dashboard email sharing list",DeleteEmail:"data-testid public dashboard delete email button",ReshareLink:"data-testid public dashboard reshare link button"}},PublicDashboardScene:{Tab:"Tab Public Dashboard"}},PublicDashboard:{page:"public-dashboard-page",NotAvailable:{container:"public-dashboard-not-available",title:"public-dashboard-title",pausedDescription:"public-dashboard-paused-description"},footer:"public-dashboard-footer"},PublicDashboardScene:{loadingPage:"public-dashboard-scene-loading-page",page:"public-dashboard-scene-page",controls:"public-dashboard-controls"},RequestViewAccess:{form:"request-view-access-form",recipientInput:"request-view-access-recipient-input",submitButton:"request-view-access-submit-button"},PublicDashboardConfirmAccess:{submitButton:"data-testid confirm-access-submit-button"},Explore:{url:"/explore",General:{container:"data-testid Explore",graph:"Explore Graph",table:"Explore Table",scrollView:"data-testid explorer scroll view"}},SoloPanel:{url:e=>`/d-solo/${e}`},PluginsList:{page:"Plugins list page",list:"Plugins list",listItem:"Plugins list item",signatureErrorNotice:"data-testid Unsigned plugins notice"},PluginPage:{page:"Plugin page",signatureInfo:"data-testid Plugin signature info",disabledInfo:"data-testid Plugin disabled info"},PlaylistForm:{name:"Playlist name",interval:"Playlist interval",itemDelete:"data-testid playlist-form-delete-item"},BrowseDashboards:{table:{body:"data-testid browse-dashboards-table",row:e=>`data-testid browse dashboards row ${e}`,checkbox:e=>`data-testid ${e} checkbox`},NewFolderForm:{form:"data-testid new folder form",nameInput:"data-testid new-folder-name-input",createButton:"data-testid new-folder-create-button"}},Search:{url:"/?search=openn",FolderView:{url:"/?search=open&layout=folders"}},PublicDashboards:{ListItem:{linkButton:"public-dashboard-link-button",configButton:"public-dashboard-configuration-button",trashcanButton:"public-dashboard-remove-button",pauseSwitch:"data-testid public dashboard pause switch"}},UserListPage:{tabs:{allUsers:"data-testid all-users-tab",orgUsers:"data-testid org-users-tab",anonUserDevices:"data-testid anon-user-devices-tab",publicDashboardsUsers:"data-testid public-dashboards-users-tab",users:"data-testid users-tab"},org:{url:"/org/users"},admin:{url:"/admin/users"},publicDashboards:{container:"data-testid public-dashboards-users-list"},UserListAdminPage:{container:"data-testid user-list-admin-page"},UsersListPage:{container:"data-testid users-list-page"},UserAnonListPage:{container:"data-testid user-anon-list-page"},UsersListPublicDashboardsPage:{container:"data-testid users-list-public-dashboards-page",DashboardsListModal:{listItem:e=>`data-testid dashboards-list-item-${e}`}}},ProfilePage:{url:"/profile"}},components:_n};var Pn=f(644);const jn=new Intl.Collator("en",{numeric:!0,sensitivity:"base"}).compare,Cn=1/0,En=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Dn="eexxaacctt",kn=(e,t,n)=>e.replace("A-Z",t).replace("a-z",n),Tn={unicode:!1,alpha:null,interSplit:"[^A-Za-z\\d']+",intraSplit:"[a-z][A-Z]",intraBound:"[A-Za-z]\\d|\\d[A-Za-z]|[a-z][A-Z]",interLft:0,interRgt:0,interChars:".",interIns:Cn,intraChars:"[a-z\\d']",intraIns:null,intraContr:"'[a-z]{1,2}\\b",intraMode:0,intraSlice:[1,Cn],intraSub:null,intraTrn:null,intraDel:null,intraFilt:(e,t,n)=>!0,sort:(e,t,n)=>{let{idx:r,chars:a,terms:o,interLft2:i,interLft1:s,start:l,intraIns:u,interIns:c}=e;return r.map(((e,t)=>t)).sort(((e,n)=>a[n]-a[e]||u[e]-u[n]||o[n]+i[n]+.5*s[n]-(o[e]+i[e]+.5*s[e])||c[e]-c[n]||l[e]-l[n]||jn(t[r[e]],t[r[n]])))}},Rn=(e,t)=>0==t?"":1==t?e+"??":t==Cn?e+"*?":e+`{0,${t}}?`,An="(?:\\b|_)";function In(e){e=Object.assign({},Tn,e);let{unicode:t,interLft:n,interRgt:r,intraMode:a,intraSlice:o,intraIns:i,intraSub:s,intraTrn:l,intraDel:u,intraContr:c,intraSplit:d,interSplit:p,intraBound:f,intraChars:h}=e;i??=a,s??=a,l??=a,u??=a;let m=e.letters??e.alpha;if(null!=m){let e=m.toLocaleUpperCase(),t=m.toLocaleLowerCase();p=kn(p,e,t),d=kn(d,e,t),f=kn(f,e,t),h=kn(h,e,t),c=kn(c,e,t)}let g=t?"u":"";const b='".+?"',y=new RegExp(b,"gi"+g),v=new RegExp(`(?:\\s+|^)-(?:${h}+|${b})`,"gi"+g);let{intraRules:w}=e;null==w&&(w=e=>{let t=Tn.intraSlice,n=0,r=0,a=0,c=0;if(/[^\d]/.test(e)){let d=e.length;d<=4?d>=3&&(a=Math.min(l,1),4==d&&(n=Math.min(i,1))):(t=o,n=i,r=s,a=l,c=u)}return{intraSlice:t,intraIns:n,intraSub:r,intraTrn:a,intraDel:c}});let O=!!d,S=new RegExp(d,"g"+g),_=new RegExp(p,"g"+g),x=new RegExp("^"+p+"|"+p+"$","g"+g),P=new RegExp(c,"gi"+g);const j=e=>{let t=[];e=(e=e.replace(y,(e=>(t.push(e),Dn)))).replace(x,"").toLocaleLowerCase(),O&&(e=e.replace(S,(e=>e[0]+" "+e[1])));let n=0;return e.split(_).filter((e=>""!=e)).map((e=>e===Dn?t[n++]:e))},C=/[^\d]+|\d+/g,E=(t,o=0,s=!1)=>{let l=j(t);if(0==l.length)return[];let u,c=Array(l.length).fill("");if(l=l.map(((e,t)=>e.replace(P,(e=>(c[t]=e,""))))),1==a)u=l.map(((e,t)=>{if('"'===e[0])return En(e.slice(1,-1));let n="";for(let r of e.matchAll(C)){let e=r[0],{intraSlice:a,intraIns:o,intraSub:i,intraTrn:s,intraDel:l}=w(e);if(o+i+s+l==0)n+=e+c[t];else{let[r,u]=a,d=e.slice(0,r),p=e.slice(u),f=e.slice(r,u);1==o&&1==d.length&&d!=f[0]&&(d+="(?!"+d+")");let m=f.length,g=[e];if(i)for(let e=0;e<m;e++)g.push(d+f.slice(0,e)+h+f.slice(e+1)+p);if(s)for(let e=0;e<m-1;e++)f[e]!=f[e+1]&&g.push(d+f.slice(0,e)+f[e+1]+f[e]+f.slice(e+2)+p);if(l)for(let e=0;e<m;e++)g.push(d+f.slice(0,e+1)+"?"+f.slice(e+1)+p);if(o){let e=Rn(h,1);for(let t=0;t<m;t++)g.push(d+f.slice(0,t)+e+f.slice(t)+p)}n+="(?:"+g.join("|")+")"+c[t]}}return n}));else{let e=Rn(h,i);2==o&&i>0&&(e=")("+e+")("),u=l.map(((t,n)=>'"'===t[0]?En(t.slice(1,-1)):t.split("").map(((e,t,n)=>(1==i&&0==t&&n.length>1&&e!=n[t+1]&&(e+="(?!"+e+")"),e))).join(e)+c[n]))}let d=2==n?An:"",p=2==r?An:"",f=p+Rn(e.interChars,e.interIns)+d;return o>0?s?u=d+"("+u.join(")"+p+"|"+d+"(")+")"+p:(u="("+u.join(")("+f+")(")+")",u="(.??"+d+")"+u+"("+p+".*)"):(u=u.join(f),u=d+u+p),[new RegExp(u,"i"+g),l,c]},D=(e,t,n)=>{let[r]=E(t);if(null==r)return null;let a=[];if(null!=n)for(let t=0;t<n.length;t++){let o=n[t];r.test(e[o])&&a.push(o)}else for(let t=0;t<e.length;t++)r.test(e[t])&&a.push(t);return a};let k=!!f,T=new RegExp(p,g),R=new RegExp(f,g);const A=(t,a,o)=>{let[i,s,l]=E(o,1),[u]=E(o,2),c=s.length,d=t.length,p=Array(d).fill(0),f={idx:Array(d),start:p.slice(),chars:p.slice(),terms:p.slice(),interIns:p.slice(),intraIns:p.slice(),interLft2:p.slice(),interRgt2:p.slice(),interLft1:p.slice(),interRgt1:p.slice(),ranges:Array(d)},h=1==n||1==r,m=0;for(let o=0;o<t.length;o++){let d=a[t[o]],p=d.match(i),b=p.index+p[1].length,y=b,v=!1,w=0,O=0,S=0,_=0,x=0,P=0,j=0,C=0,E=[];for(let t=0,a=2;t<c;t++,a+=2){let o=p[a].toLocaleLowerCase(),i=s[t],u='"'==i[0]?i.slice(1,-1):i+l[t],f=u.length,m=o.length,D=o==u;if(!D&&p[a+1].length>=f){let e=p[a+1].toLocaleLowerCase().indexOf(u);e>-1&&(E.push(y,m,e,f),y+=I(p,a,e,f),o=u,m=f,D=!0,0==t&&(b=y))}if(h||D){let e=y-1,i=y+m,s=!1,l=!1;if(-1==e||T.test(d[e]))D&&w++,s=!0;else{if(2==n){v=!0;break}if(k&&R.test(d[e]+d[e+1]))D&&O++,s=!0;else if(1==n){let e=p[a+1],n=y+m;if(e.length>=f){let r,i=0,l=!1,c=new RegExp(u,"ig"+g);for(;r=c.exec(e);){i=r.index;let e=n+i,t=e-1;if(-1==t||T.test(d[t])){w++,l=!0;break}if(R.test(d[t]+d[e])){O++,l=!0;break}}l&&(s=!0,E.push(y,m,i,f),y+=I(p,a,i,f),o=u,m=f,D=!0,0==t&&(b=y))}if(!s){v=!0;break}}}if(i==d.length||T.test(d[i]))D&&S++,l=!0;else{if(2==r){v=!0;break}if(k&&R.test(d[i-1]+d[i]))D&&_++,l=!0;else if(1==r){v=!0;break}}D&&(x+=f,s&&l&&P++)}if(m>f&&(C+=m-f),t>0&&(j+=p[a-1].length),!e.intraFilt(u,o,y)){v=!0;break}t<c-1&&(y+=m+p[a+1].length)}if(!v){f.idx[m]=t[o],f.interLft2[m]=w,f.interLft1[m]=O,f.interRgt2[m]=S,f.interRgt1[m]=_,f.chars[m]=x,f.terms[m]=P,f.interIns[m]=j,f.intraIns[m]=C,f.start[m]=b;let e=d.match(u),n=e.index+e[1].length,r=E.length,a=r>0?0:1/0,i=r-4;for(let t=2;t<e.length;){let r=e[t].length;if(a<=i&&E[a]==n){let r=E[a+1],o=E[a+2],i=E[a+3],s=t,l="";for(let t=0;t<r;s++)l+=e[s],t+=e[s].length;e.splice(t,s-t,l),n+=I(e,t,o,i),a+=4}else n+=r,t++}n=e.index+e[1].length;let s=f.ranges[m]=[],l=n,c=n;for(let t=2;t<e.length;t++){let r=e[t].length;n+=r,t%2==0?c=n:r>0&&(s.push(l,c),l=c=n)}c>l&&s.push(l,c),m++}}if(m<t.length)for(let e in f)f[e]=f[e].slice(0,m);return f},I=(e,t,n,r)=>{let a=e[t]+e[t+1].slice(0,n);return e[t-1]+=a,e[t]=e[t+1].slice(n,n+r),e[t+1]=e[t+1].slice(n+r),a.length};return{search:(...t)=>{let n=((t,n,r,a=1e3,o)=>{r=r?!0===r?5:r:0;let i=null,s=null,l=[];n=n.replace(v,(e=>{let t=e.trim().slice(1);return'"'===t[0]&&(t=En(t.slice(1,-1))),l.push(t),""}));let u,c=j(n);if(l.length>0){if(u=new RegExp(l.join("|"),"i"+g),0==c.length){let e=[];for(let n=0;n<t.length;n++)u.test(t[n])||e.push(n);return[e,null,null]}}else if(0==c.length)return[null,null,null];if(r>0){let e=j(n);if(e.length>1){let n=e.slice().sort(((e,t)=>t.length-e.length));for(let e=0;e<n.length;e++){if(0==o?.length)return[[],null,null];o=D(t,n[e],o)}if(e.length>r)return[o,null,null];i=Mn(e).map((e=>e.join(" "))),s=[];let a=new Set;for(let e=0;e<i.length;e++)if(a.size<o.length){let n=o.filter((e=>!a.has(e))),r=D(t,i[e],n);for(let e=0;e<r.length;e++)a.add(r[e]);s.push(r)}else s.push([])}}null==i&&(i=[n],s=[o?.length>0?o:D(t,n)]);let d=null,p=null;if(l.length>0&&(s=s.map((e=>e.filter((e=>!u.test(t[e])))))),s.reduce(((e,t)=>e+t.length),0)<=a){d={},p=[];for(let n=0;n<s.length;n++){let r=s[n];if(null==r||0==r.length)continue;let a=i[n],o=A(r,t,a),l=e.sort(o,t,a);if(n>0)for(let e=0;e<l.length;e++)l[e]+=p.length;for(let e in o)d[e]=(d[e]??[]).concat(o[e]);p=p.concat(l)}}return[[].concat(...s),d,p]})(...t);return n},split:j,filter:D,info:A,sort:e.sort}}const Vn=(()=>{let e={A:"ÁÀÃÂÄĄ",a:"áàãâäą",E:"ÉÈÊËĖ",e:"éèêëę",I:"ÍÌÎÏĮ",i:"íìîïį",O:"ÓÒÔÕÖ",o:"óòôõö",U:"ÚÙÛÜŪŲ",u:"úùûüūų",C:"ÇČĆ",c:"çčć",L:"Ł",l:"ł",N:"ÑŃ",n:"ñń",S:"ŠŚ",s:"šś",Z:"ŻŹ",z:"żź"},t=new Map,n="";for(let r in e)e[r].split("").forEach((e=>{n+=e,t.set(e,r)}));let r=new RegExp(`[${n}]`,"g"),a=e=>t.get(e);return e=>{if("string"==typeof e)return e.replace(r,a);let t=Array(e.length);for(let n=0;n<e.length;n++)t[n]=e[n].replace(r,a);return t}})();function Mn(e){let t,n,r=(e=e.slice()).length,a=[e.slice()],o=new Array(r).fill(0),i=1;for(;i<r;)o[i]<i?(t=i%2&&o[i],n=e[i],e[i]=e[t],e[t]=n,++o[i],i=1,a.push(e.slice())):(o[i]=0,++i);return a}const Fn=(e,t)=>t?`<mark>${e}</mark>`:e,Ln=(e,t)=>e+t;function $n(e,t){const n=new In;let r=e;const a=[],o=1e4;return t&&(r=[{value:yt,label:bt},...r]),e=>{if(""===e)return r.length>o?r.slice(0,o):r;if(0===a.length)for(let e=0;e<r.length;e++)a.push(r[e].label);const[t,i,s]=n.search(a,e),l=[];if(t){for(let e=0;e<t.length;e++){if(i&&s){const n=s[e];l.push(r[t[n]])}else l.push(r[t[e]]);if(l.length>o)return l}return l}return r.length>o?r.slice(0,o):r}}In.latinize=Vn,In.permute=e=>Mn([...Array(e.length).keys()]).sort(((e,t)=>{for(let n=0;n<e.length;n++)if(e[n]!=t[n])return e[n]-t[n];return 0})).map((t=>t.map((t=>e[t])))),In.highlight=function(e,t,n=Fn,r="",a=Ln){r=a(r,n(e.substring(0,t[0]),!1))??r;for(let o=0;o<t.length;o+=2){let i=t[o],s=t[o+1];r=a(r,n(e.substring(i,s),!0))??r,o<t.length-3&&(r=a(r,n(e.substring(t[o+1],t[o+2]),!1))??r)}return a(r,n(e.substring(t[t.length-1]),!1))??r};var Nn=Object.defineProperty,Bn=Object.defineProperties,zn=Object.getOwnPropertyDescriptors,qn=Object.getOwnPropertySymbols,Hn=Object.prototype.hasOwnProperty,Wn=Object.prototype.propertyIsEnumerable,Un=(e,t,n)=>t in e?Nn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const Gn=()=>!0,Qn=e=>"$__all"!==e.value,Kn=(e,t)=>e.length===t.filter(Qn).length?Sn.ToggleAllState.allSelected:0===e.length||1===e.length&&e[0]&&"$__all"===e[0].value?Sn.ToggleAllState.noneSelected:Sn.ToggleAllState.indeterminate;function Yn({model:e}){const{value:n,text:a,key:o,options:i,includeAll:s,isReadOnly:l}=e.useState(),[u,c]=(0,t.useState)(""),[d,p]=(0,t.useState)(!1),f=function(e,t){return{value:e,label:null!=t?t:String(e)}}(n,String(a)),h=(0,t.useMemo)((()=>$n(i,s)),[i,s])(u);return r().createElement(Sn.Select,{id:o,isValidNewOption:e=>e.trim().length>0,placeholder:"Select value",width:"auto",disabled:l,value:f,inputValue:u,allowCustomValue:!0,virtualized:!0,filterOption:Gn,tabSelectsValue:!1,onInputChange:(t,{action:n})=>"input-change"===n?(c(t),e.onSearchChange&&e.onSearchChange(t),t):t,onOpenMenu:()=>{d&&c(String(a))},onCloseMenu:()=>{c("")},options:h,"data-testid":xn.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${n}`),onChange:t=>{e.changeValueTo(t.value,t.label),d!==t.__isNew__&&p(t.__isNew__)}})}function Zn({model:e}){const{value:n,options:a,key:o,maxVisibleValues:i,noValueOnClear:s,includeAll:l,isReadOnly:u}=e.useState(),c=(0,t.useMemo)((()=>(0,be.isArray)(n)?n:[n]),[n]),[d,p]=(0,t.useState)(c),[f,h]=(0,t.useState)(""),m=(0,t.useMemo)((()=>$n(a,l)),[a,l]);(0,t.useEffect)((()=>{p(c)}),[c]);const g=a.length>0?"Select value":"",b=m(f);return r().createElement(Sn.MultiSelect,{id:o,placeholder:g,width:"auto",inputValue:f,disabled:u,value:d,noMultiValueWrap:!0,maxVisibleValues:null!=i?i:5,tabSelectsValue:!1,virtualized:!0,allowCustomValue:!0,toggleAllOptions:{enabled:!0,optionsFilter:Qn,determineToggleAllState:Kn},options:b,closeMenuOnSelect:!1,components:{Option:Xn},isClearable:!0,hideSelectedOptions:!1,onInputChange:(t,{action:n})=>"input-change"===n?(h(t),e.onSearchChange&&e.onSearchChange(t),t):"input-blur"===n?(h(""),""):f,onBlur:()=>{e.changeValueTo(d)},filterOption:Gn,"data-testid":xn.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${d}`),onChange:(t,n)=>{"clear"===n.action&&s&&e.changeValueTo([]),p(t.map((e=>e.value)))}})}const Xn=({children:e,data:t,innerProps:n,innerRef:a,isFocused:o,isSelected:i,indeterminate:s,renderOptionLabel:l})=>{var u;const c=((e,t)=>{var n={};for(var r in e)Hn.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&qn)for(var r of qn(e))t.indexOf(r)<0&&Wn.call(e,r)&&(n[r]=e[r]);return n})(n,["onMouseMove","onMouseOver"]),d=(0,Sn.useTheme2)(),p=(0,Sn.getSelectStyles)(d),f=(0,Sn.useStyles2)(Jn);return r().createElement("div",(h=((e,t)=>{for(var n in t||(t={}))Hn.call(t,n)&&Un(e,n,t[n]);if(qn)for(var n of qn(t))Wn.call(t,n)&&Un(e,n,t[n]);return e})({ref:a,className:(0,Pn.cx)(p.option,o&&p.optionFocused)},c),m={"data-testid":"data-testid Select option",title:t.title},Bn(h,zn(m))),r().createElement("div",{className:f.checkbox},r().createElement(Sn.Checkbox,{indeterminate:s,value:i})),r().createElement("div",{className:p.optionBody,"data-testid":xn.pages.Dashboard.SubMenu.submenuItemValueDropDownOptionTexts(null!=(u=t.label)?u:String(t.value))},r().createElement("span",null,e)));var h,m};Xn.displayName="SelectMenuOptions";const Jn=e=>({checkbox:(0,Pn.css)({marginRight:e.spacing(2)})});function er(e){return e.state.isMulti?r().createElement(Zn,{model:e}):r().createElement(Yn,{model:e})}class tr{getKey(){return`var-${this._sceneObject.state.name}`}getKeys(){return this._sceneObject.state.skipUrlSync?[]:[this.getKey()]}getUrlState(){return this._sceneObject.state.skipUrlSync?{}:{[this.getKey()]:(e=this._sceneObject.state.value,t=this._sceneObject.state.text,e=Array.isArray(e)?e:[e],t=Array.isArray(t)?t:[t],e.map(((e,n)=>{if(null==e)return"";e=String(e);let r=t[n];return r=null==r?e:String(r),Ll(e,r)})))};var e,t}updateFromUrl(e){let t=e[this.getKey()];if(null!=t){this._sceneObject.isActive||(this._sceneObject.skipNextValidation=!0);const{values:e,texts:r}=(n=t,(n=Array.isArray(n)?n:[n]).reduce(((e,t)=>{const[n,r]=(null!=t?t:"").split(",");return e.values.push(Fl(n)),e.texts.push(Fl(null!=r?r:n)),e}),{values:[],texts:[]}));this._sceneObject.changeValueTo(e,r)}var n}constructor(e){this._sceneObject=e}}function nr(e){const t=e.getRoot();return"enrichFiltersRequest"in t?t.enrichFiltersRequest(e):null}var rr,ar=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};class or{toString(){}get value(){return this}constructor(e){((e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,void 0)})(this,rr),this.text="__sceneObject",this.valueOf=()=>{return ar(this,e=rr,"read from private field"),e.get(this);var e},((e,t,n,r)=>{ar(e,t,"write to private field"),t.set(e,n)})(this,rr,e)}}function ir(e){return function(e){const t=e.match(/^(\d+)\.(\d+)\.(\d+)/);if(!t)return!1;const n=parseInt(t[1],10),r=parseInt(t[2],10),a=parseInt(t[3],10);return 11===n?0===r&&a>=4||1===r&&a>=2||r>1:10===n?4===r&&a>=8||r>=5:n>11}(d.config.buildInfo.version)?new or(e):{value:e,text:"__sceneObject"}}function sr(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function lr(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){sr(o,r,a,i,s,"next",e)}function s(e){sr(o,r,a,i,s,"throw",e)}i(void 0)}))}}rr=new WeakMap;var ur=Object.defineProperty,cr=Object.defineProperties,dr=Object.getOwnPropertyDescriptors,pr=Object.getOwnPropertySymbols,fr=Object.prototype.hasOwnProperty,hr=Object.prototype.propertyIsEnumerable,mr=(e,t,n)=>t in e?ur(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,gr=(e,t)=>{for(var n in t||(t={}))fr.call(t,n)&&mr(e,n,t[n]);if(pr)for(var n of pr(t))hr.call(t,n)&&mr(e,n,t[n]);return e};class br extends jt{validateAndUpdate(){return this.getValueOptions({}).pipe((0,k.map)((e=>(this._updateValueGivenNewOptions(e),{}))))}_updateValueGivenNewOptions(e){const{value:t,text:n}=this.state,r={options:e,loading:!1,value:null!=t?t:[],text:null!=n?n:[]};this.setState(r)}getValueOptions(e){return this.state.defaultOptions?(0,k.of)(this.state.defaultOptions.map((e=>({label:e.text,value:String(e.value),group:e.group})))):(this.setState({loading:!0,error:null}),(0,k.from)(Kt(this.state.datasource,{__sceneObject:ir(this)})).pipe((0,k.mergeMap)((e=>(0,k.from)(this._getKeys(e)).pipe((0,k.tap)((e=>{Nl(e)&&this.setState({error:e.error.message})})),(0,k.map)((e=>$l(e))),(0,k.take)(1),(0,k.mergeMap)((e=>{const t=e.map((e=>({label:e.text,value:e.value?String(e.value):e.text,group:e.group})));return(0,k.of)(t)})))))))}getDefaultMultiState(e){return{value:[],text:[]}}constructor(e){var t;super((t=gr({isMulti:!0,name:"",value:[],text:[],options:[],datasource:null,baseFilters:[],applyMode:"auto",layout:"horizontal",type:"groupby"},e),cr(t,dr({noValueOnClear:!0})))),this.isLazy=!0,this._urlSync=new tr(this);var n=this;this._getKeys=function(){var e=lr((function*(e){var t,r,a;const o=yield null==(r=(t=n.state).getTagKeysProvider)?void 0:r.call(t,n,null);if(o&&o.replace)return o.values;if(n.state.defaultOptions)return n.state.defaultOptions.concat($l(null!=(a=null==o?void 0:o.values)?a:[]));if(!e.getTagKeys)return[];const i=Il(n),s=n.state.baseFilters||[],l=yu.getTimeRange(n).state.value,u=yield e.getTagKeys(gr({filters:s,queries:i,timeRange:l},nr(n)));Nl(u)&&n.setState({error:u.error.message});let c=$l(u);o&&(c=c.concat($l(o.values)));const d=n.state.tagKeyRegexFilter;return d&&(c=c.filter((e=>e.text.match(d)))),c}));return function(t){return e.apply(this,arguments)}}(),this.addActivationHandler((()=>(On.add(this),()=>On.delete(this))))}}br.Component=function({model:e}){const{value:n,text:a,key:o,maxVisibleValues:i,noValueOnClear:s,options:l,includeAll:u}=e.useState(),c=(0,t.useMemo)((()=>{const e=(0,be.isArray)(n)?n:[n],t=(0,be.isArray)(a)?a:[a];return e.map(((e,n)=>{var r;return{value:e,label:String(null!=(r=t[n])?r:e)}}))}),[n,a]),[d,p]=(0,t.useState)(!1),[f,h]=(0,t.useState)(!1),[m,g]=(0,t.useState)(""),[b,y]=(0,t.useState)(c),v=(0,t.useMemo)((()=>$n(l,u)),[l,u]);(0,t.useEffect)((()=>{y(c)}),[c]);const w=(0,t.useMemo)((()=>Bl(v(m).map(vr))),[v,m]);return r().createElement(Sn.MultiSelect,{"data-testid":`GroupBySelect-${o}`,id:o,placeholder:"Select value",width:"auto",inputValue:m,value:b,noMultiValueWrap:!0,maxVisibleValues:null!=i?i:5,tabSelectsValue:!1,virtualized:!0,options:w,filterOption:yr,closeMenuOnSelect:!1,isOpen:f,isClearable:!0,hideSelectedOptions:!1,isLoading:d,components:{Option:Xn},onInputChange:(t,{action:n})=>"input-change"===n?(g(t),e.onSearchChange&&e.onSearchChange(t),t):"input-blur"===n?(g(""),""):m,onBlur:()=>{e.changeValueTo(b.map((e=>e.value)),b.map((e=>e.label)))},onChange:(t,n)=>{"clear"===n.action&&s&&e.changeValueTo([]),y(t)},onOpenMenu:lr((function*(){p(!0),yield(0,k.lastValueFrom)(e.validateAndUpdate()),p(!1),h(!0)})),onCloseMenu:()=>{h(!1)}})};const yr=()=>!0;function vr(e){const{label:t,value:n,group:r}=e,a={label:t,value:n};return r&&(a.group=r),a}function wr(e){return r().createElement(Sn.Tooltip,{content:"Cancel query"},r().createElement(Sn.Icon,{className:"spin-clockwise",name:"sync",size:"xs",role:"button",onMouseDown:t=>{e.onCancel(t)}}))}function Or(e){const t=(0,Sn.useStyles2)(Sr),n=(0,Sn.useTheme2)(),a="vertical"===e.layout,o=Boolean(e.isLoading)?r().createElement("div",{style:{marginLeft:n.spacing(1),marginTop:"-1px"},"aria-label":xn.components.LoadingIndicator.icon},r().createElement(wr,{onCancel:t=>{var n;t.preventDefault(),t.stopPropagation(),null==(n=e.onCancel)||n.call(e)}})):null;let i=null;e.error&&(i=r().createElement(Sn.Tooltip,{content:e.error,placement:"bottom"},r().createElement(Sn.Icon,{className:t.errorIcon,name:"exclamation-triangle"})));let s=null;e.description&&(s=r().createElement(Sn.Tooltip,{content:e.description,placement:a?"top":"bottom"},r().createElement(Sn.Icon,{className:t.normalIcon,name:"info-circle"})));const l="string"==typeof e.label?xn.pages.Dashboard.SubMenu.submenuItemLabels(e.label):"";let u;return u=a?r().createElement("label",{className:t.verticalLabel,"data-testid":l,htmlFor:e.htmlFor},e.label,s,i,e.icon&&r().createElement(Sn.Icon,{name:e.icon,className:t.normalIcon}),o,e.onRemove&&r().createElement(Sn.IconButton,{variant:"secondary",size:"xs",name:"times",onClick:e.onRemove,tooltip:"Remove"})):r().createElement("label",{className:t.horizontalLabel,"data-testid":l,htmlFor:e.htmlFor},i,e.icon&&r().createElement(Sn.Icon,{name:e.icon,className:t.normalIcon}),e.label,s,o),u}const Sr=e=>({horizontalLabel:(0,Pn.css)({background:e.isDark?e.colors.background.primary:e.colors.background.secondary,display:"flex",alignItems:"center",padding:e.spacing(0,1),fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.bodySmall.fontSize,height:e.spacing(e.components.height.md),lineHeight:e.spacing(e.components.height.md),borderRadius:e.shape.borderRadius(1),border:`1px solid ${e.components.input.borderColor}`,position:"relative",right:-1,whiteSpace:"nowrap",gap:e.spacing(.5)}),verticalLabel:(0,Pn.css)({display:"flex",alignItems:"center",fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.bodySmall.fontSize,lineHeight:e.typography.bodySmall.lineHeight,whiteSpace:"nowrap",marginBottom:e.spacing(.5),gap:e.spacing(1)}),errorIcon:(0,Pn.css)({color:e.colors.error.text}),normalIcon:(0,Pn.css)({color:e.colors.text.secondary})});function _r(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function xr(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){_r(o,r,a,i,s,"next",e)}function s(e){_r(o,r,a,i,s,"throw",e)}i(void 0)}))}}var Pr=Object.defineProperty,jr=Object.getOwnPropertySymbols,Cr=Object.prototype.hasOwnProperty,Er=Object.prototype.propertyIsEnumerable,Dr=(e,t,n)=>t in e?Pr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,kr=(e,t)=>{for(var n in t||(t={}))Cr.call(t,n)&&Dr(e,n,t[n]);if(jr)for(var n of jr(t))Er.call(t,n)&&Dr(e,n,t[n]);return e};function Tr(e,t){return""!==e?{value:e,label:t||e}:null}const Rr=()=>!0;function Ar({filter:e,model:n}){var a,o,i;const s=(0,Sn.useStyles2)(Ir),[l,u]=(0,t.useState)([]),[c,d]=(0,t.useState)([]),[p,f]=(0,t.useState)(!1),[h,m]=(0,t.useState)(!1),[g,b]=(0,t.useState)(!1),[y,v]=(0,t.useState)(!1),[w,O]=(0,t.useState)(!1),[S,_]=(0,t.useState)(""),[x,P]=(0,t.useState)(!1),[j,C]=(0,t.useState)(e.values?e.values.map(((t,n)=>{var r;return Tr(t,null==(r=e.valueLabels)?void 0:r[n])})):[]),E=dl(e.operator),D=Tr(e.key,e.keyLabel),k=Tr(e.value,null==(a=e.valueLabels)?void 0:a[0]),T=(0,t.useMemo)((()=>function(e){const t=new In,n=[],r=1e4;return a=>{var o;if(""===a)return e.length>r?e.slice(0,r):e;if(0===n.length)for(let t=0;t<e.length;t++)n.push(null!=(o=e[t].label)?o:String(e[t].value));const[i,s,l]=t.search(n,a),u=[];if(i){for(let t=0;t<i.length;t++){if(s&&l){const n=l[t];u.push(e[i[n]])}else u.push(e[i[t]]);if(u.length>r)return u}return u}return e.length>r?e.slice(0,r):e}}(c)),[c]),R=(0,t.useMemo)((()=>Bl(T(S))),[T,S]),A={isMulti:!0,value:j,components:{Option:Xn},hideSelectedOptions:!1,closeMenuOnSelect:!1,openMenuOnFocus:!1,onChange:e=>{C(e),e.some((e=>e.__isNew__))&&_("")},onBlur:()=>{var t,r;n._updateFilter(e,{value:null!=(r=null==(t=j[0])?void 0:t.value)?r:"",values:j.map((e=>e.value)),valueLabels:j.map((e=>e.label))})}},I=r().createElement(Sn.Select,kr({virtualized:!0,allowCustomValue:!0,isValidNewOption:e=>e.trim().length>0,allowCreateWhileLoading:!0,formatCreateLabel:e=>`Use custom value: ${e}`,disabled:n.state.readOnly,className:(0,Pn.cx)(s.value,y?s.widthWhenOpen:void 0),width:"auto",value:k,filterOption:Rr,placeholder:"Select value",options:R,inputValue:S,onInputChange:(e,{action:t})=>("input-change"===t&&_(e),e),onChange:t=>{n._updateFilter(e,{value:t.value,valueLabels:t.label?[t.label]:[t.value]}),x!==t.__isNew__&&P(t.__isNew__)},isOpen:y&&!h,isLoading:h,openMenuOnFocus:!0,onOpenMenu:xr((function*(){var t;m(!0),v(!0);const r=yield n._getValuesFor(e);m(!1),d(r),x&&_(null!=(t=null==k?void 0:k.label)?t:"")})),onCloseMenu:()=>{v(!1),_("")}},E&&A)),V=r().createElement(Sn.Select,{key:h?"loading":"loaded",disabled:n.state.readOnly,className:(0,Pn.cx)(s.key,g?s.widthWhenOpen:void 0),width:"auto",allowCustomValue:!0,value:D,placeholder:"Select label",options:Bl(l),onChange:t=>{n._updateFilter(e,{key:t.value,keyLabel:t.label,value:"",valueLabels:[""],values:void 0}),C([])},autoFocus:""===e.key,isOpen:g&&!p,isLoading:p,onOpenMenu:xr((function*(){b(!0),f(!0);const t=yield n._getKeys(e.key);f(!1),u(t)})),onCloseMenu:()=>{b(!1)},onBlur:()=>{""===e.key&&n._removeFilter(e)},openMenuOnFocus:!0}),M=r().createElement(Sn.Select,{className:(0,Pn.cx)(s.operator,{[s.widthWhenOpen]:w}),value:e.operator,disabled:n.state.readOnly,options:n._getOperators(),onChange:t=>{var r,a;const o=e.operator,i=t.value,s={operator:i};dl(o)&&!dl(i)?(s.value="",s.valueLabels=[""],s.values=void 0,C([])):!dl(o)&&dl(i)&&e.value&&(s.values=[e.value],C([{value:e.value,label:null!=(a=null==(r=e.valueLabels)?void 0:r[0])?a:e.value}])),n._updateFilter(e,s)},onOpenMenu:()=>{O(!0)},onCloseMenu:()=>{O(!1)}});if("vertical"===n.state.layout){if(e.key){const t=r().createElement(Or,{layout:"vertical",label:null!=(o=e.key)?o:"",onRemove:()=>n._removeFilter(e)});return r().createElement(Sn.Field,{label:t,"data-testid":`AdHocFilter-${e.key}`,className:s.field},r().createElement("div",{className:s.wrapper},M,I))}return r().createElement(Sn.Field,{label:"Select label","data-testid":`AdHocFilter-${e.key}`,className:s.field},V)}return r().createElement("div",{className:s.wrapper,"data-testid":`AdHocFilter-${e.key}`},V,M,I,r().createElement(Sn.Button,{variant:"secondary","aria-label":"Remove filter",title:"Remove filter",className:s.removeButton,icon:"times","data-testid":`AdHocFilter-remove-${null!=(i=e.key)?i:""}`,onClick:()=>n._removeFilter(e)}))}const Ir=e=>({field:(0,Pn.css)({marginBottom:0}),wrapper:(0,Pn.css)({display:"flex","> *":{"&:not(:first-child)":{marginLeft:-1},"&:first-child":{borderTopRightRadius:0,borderBottomRightRadius:0},"&:last-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:first-child):not(:last-child)":{borderRadius:0},position:"relative",zIndex:0,"&:hover":{zIndex:1},"&:focus-within":{zIndex:2}}}),widthWhenOpen:(0,Pn.css)({minWidth:e.spacing(16)}),value:(0,Pn.css)({flexBasis:"content",flexShrink:1,minWidth:"90px"}),key:(0,Pn.css)({flexBasis:"content",minWidth:"90px",flexShrink:1}),operator:(0,Pn.css)({flexShrink:0,flexBasis:"content"}),removeButton:(0,Pn.css)({paddingLeft:e.spacing(1.5),paddingRight:e.spacing(1.5),borderLeft:"none",width:e.spacing(3),marginRight:e.spacing(1),boxSizing:"border-box",position:"relative",left:"1px"})});function Vr({model:e,addFilterButtonText:t}){const{_wip:n}=e.useState();return n?r().createElement(Ar,{filter:n,model:e}):r().createElement(Sn.Button,{variant:"secondary",icon:"plus",title:"Add filter","aria-label":"Add filter","data-testid":"AdHocFilter-add",onClick:()=>e._addWip()},t)}class Mr{getKey(){return`var-${this._variable.state.name}`}getKeys(){return[this.getKey()]}getUrlState(){const e=this._variable.state.filters;if(0===e.length)return{[this.getKey()]:[""]};const t=e.filter(cl).map((e=>function(e){var t;const n=[Ll(e.key,e.keyLabel),e.operator];return dl(e.operator)?e.values.forEach(((t,r)=>{var a;n.push(Ll(t,null==(a=e.valueLabels)?void 0:a[r]))})):n.push(Ll(e.value,null==(t=e.valueLabels)?void 0:t[0])),n}(e).map(Vl).join("|")));return{[this.getKey()]:t}}updateFromUrl(e){const t=e[this.getKey()];if(null==t)return;const n=function(e){if(Array.isArray(e))return e.map(Fr).filter(Lr);const t=Fr(e);return null===t?[]:[t]}(t);this._variable.setState({filters:n})}constructor(e){this._variable=e}}function Fr(e){if("string"!=typeof e||0===e.length)return null;const[t,n,r,a,...o]=e.split("|").reduce(((e,t)=>{const[n,r]=t.split(",");return e.push(n,null!=r?r:n),e}),[]).map(Fl);return{key:t,keyLabel:n,operator:r,value:o[0],values:dl(r)?o.filter(((e,t)=>t%2==0)):void 0,valueLabels:o.filter(((e,t)=>t%2==1)),condition:""}}function Lr(e){return null!==e&&"string"==typeof e.key&&"string"==typeof e.value}function $r(e){return zr(e)?(e.nodeName||"").toLowerCase():"#document"}function Nr(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function Br(e){var t;return null==(t=(zr(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function zr(e){return e instanceof Node||e instanceof Nr(e).Node}function qr(e){return e instanceof Element||e instanceof Nr(e).Element}function Hr(e){return e instanceof HTMLElement||e instanceof Nr(e).HTMLElement}function Wr(e){return"undefined"!=typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof Nr(e).ShadowRoot)}function Ur(e){const{overflow:t,overflowX:n,overflowY:r,display:a}=Zr(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(a)}function Gr(e){return["table","td","th"].includes($r(e))}function Qr(e){const t=Kr(),n=Zr(e);return"none"!==n.transform||"none"!==n.perspective||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some((e=>(n.willChange||"").includes(e)))||["paint","layout","strict","content"].some((e=>(n.contain||"").includes(e)))}function Kr(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function Yr(e){return["html","body","#document"].includes($r(e))}function Zr(e){return Nr(e).getComputedStyle(e)}function Xr(e){return qr(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Jr(e){if("html"===$r(e))return e;const t=e.assignedSlot||e.parentNode||Wr(e)&&e.host||Br(e);return Wr(t)?t.host:t}function ea(e){const t=Jr(e);return Yr(t)?e.ownerDocument?e.ownerDocument.body:e.body:Hr(t)&&Ur(t)?t:ea(t)}function ta(e,t,n){var r;void 0===t&&(t=[]),void 0===n&&(n=!0);const a=ea(e),o=a===(null==(r=e.ownerDocument)?void 0:r.body),i=Nr(a);return o?t.concat(i,i.visualViewport||[],Ur(a)?a:[],i.frameElement&&n?ta(i.frameElement):[]):t.concat(a,ta(a,[],n))}function na(e){let t=e.activeElement;for(;null!=(null==(n=t)||null==(n=n.shadowRoot)?void 0:n.activeElement);){var n;t=t.shadowRoot.activeElement}return t}function ra(e,t){if(!e||!t)return!1;const n=null==t.getRootNode?void 0:t.getRootNode();if(e.contains(t))return!0;if(n&&Wr(n)){let n=t;for(;n;){if(e===n)return!0;n=n.parentNode||n.host}}return!1}function aa(){const e=navigator.userAgentData;return null!=e&&e.platform?e.platform:navigator.platform}function oa(){const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?e.brands.map((e=>{let{brand:t,version:n}=e;return t+"/"+n})).join(" "):navigator.userAgent}function ia(e){return!(0!==e.mozInputSource||!e.isTrusted)||(ua()&&e.pointerType?"click"===e.type&&1===e.buttons:0===e.detail&&!e.pointerType)}function sa(e){return!oa().includes("jsdom/")&&(!ua()&&0===e.width&&0===e.height||ua()&&1===e.width&&1===e.height&&0===e.pressure&&0===e.detail&&"mouse"===e.pointerType||e.width<1&&e.height<1&&0===e.pressure&&0===e.detail&&"touch"===e.pointerType)}function la(){return/apple/i.test(navigator.vendor)}function ua(){const e=/android/i;return e.test(aa())||e.test(oa())}function ca(e){return(null==e?void 0:e.ownerDocument)||document}function da(e,t){if(null==t)return!1;if("composedPath"in e)return e.composedPath().includes(t);const n=e;return null!=n.target&&t.contains(n.target)}function pa(e){return"composedPath"in e?e.composedPath()[0]:e.target}const fa="input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])";function ha(e){e.preventDefault(),e.stopPropagation()}function ma(e){return!!e&&"combobox"===e.getAttribute("role")&&function(e){return Hr(e)&&e.matches(fa)}(e)}const ga=Math.min,ba=Math.max,ya=Math.round,va=Math.floor,wa=e=>({x:e,y:e}),Oa={left:"right",right:"left",bottom:"top",top:"bottom"},Sa={start:"end",end:"start"};function _a(e,t){return"function"==typeof e?e(t):e}function xa(e){return e.split("-")[0]}function Pa(e){return e.split("-")[1]}function ja(e){return"y"===e?"height":"width"}function Ca(e){return["top","bottom"].includes(xa(e))?"y":"x"}function Ea(e){return"x"===Ca(e)?"y":"x"}function Da(e){return e.replace(/start|end/g,(e=>Sa[e]))}function ka(e){return e.replace(/left|right|bottom|top/g,(e=>Oa[e]))}function Ta(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function Ra(e,t,n){let{reference:r,floating:a}=e;const o=Ca(t),i=Ea(t),s=ja(i),l=xa(t),u="y"===o,c=r.x+r.width/2-a.width/2,d=r.y+r.height/2-a.height/2,p=r[s]/2-a[s]/2;let f;switch(l){case"top":f={x:c,y:r.y-a.height};break;case"bottom":f={x:c,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:d};break;case"left":f={x:r.x-a.width,y:d};break;default:f={x:r.x,y:r.y}}switch(Pa(t)){case"start":f[i]-=p*(n&&u?-1:1);break;case"end":f[i]+=p*(n&&u?-1:1)}return f}async function Aa(e,t){var n;void 0===t&&(t={});const{x:r,y:a,platform:o,rects:i,elements:s,strategy:l}=e,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:p=!1,padding:f=0}=_a(t,e),h=function(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}(f),m=s[p?"floating"===d?"reference":"floating":d],g=Ta(await o.getClippingRect({element:null==(n=await(null==o.isElement?void 0:o.isElement(m)))||n?m:m.contextElement||await(null==o.getDocumentElement?void 0:o.getDocumentElement(s.floating)),boundary:u,rootBoundary:c,strategy:l})),b="floating"===d?{...i.floating,x:r,y:a}:i.reference,y=await(null==o.getOffsetParent?void 0:o.getOffsetParent(s.floating)),v=await(null==o.isElement?void 0:o.isElement(y))&&await(null==o.getScale?void 0:o.getScale(y))||{x:1,y:1},w=Ta(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:b,offsetParent:y,strategy:l}):b);return{top:(g.top-w.top+h.top)/v.y,bottom:(w.bottom-g.bottom+h.bottom)/v.y,left:(g.left-w.left+h.left)/v.x,right:(w.right-g.right+h.right)/v.x}}function Ia(e){const t=Zr(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=Hr(e),o=a?e.offsetWidth:n,i=a?e.offsetHeight:r,s=ya(n)!==o||ya(r)!==i;return s&&(n=o,r=i),{width:n,height:r,$:s}}function Va(e){return qr(e)?e:e.contextElement}function Ma(e){const t=Va(e);if(!Hr(t))return wa(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:o}=Ia(t);let i=(o?ya(n.width):n.width)/r,s=(o?ya(n.height):n.height)/a;return i&&Number.isFinite(i)||(i=1),s&&Number.isFinite(s)||(s=1),{x:i,y:s}}const Fa=wa(0);function La(e){const t=Nr(e);return Kr()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:Fa}function $a(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1);const a=e.getBoundingClientRect(),o=Va(e);let i=wa(1);t&&(r?qr(r)&&(i=Ma(r)):i=Ma(e));const s=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==Nr(e))&&t}(o,n,r)?La(o):wa(0);let l=(a.left+s.x)/i.x,u=(a.top+s.y)/i.y,c=a.width/i.x,d=a.height/i.y;if(o){const e=Nr(o),t=r&&qr(r)?Nr(r):r;let n=e,a=n.frameElement;for(;a&&r&&t!==n;){const e=Ma(a),t=a.getBoundingClientRect(),r=Zr(a),o=t.left+(a.clientLeft+parseFloat(r.paddingLeft))*e.x,i=t.top+(a.clientTop+parseFloat(r.paddingTop))*e.y;l*=e.x,u*=e.y,c*=e.x,d*=e.y,l+=o,u+=i,n=Nr(a),a=n.frameElement}}return Ta({width:c,height:d,x:l,y:u})}const Na=[":popover-open",":modal"];function Ba(e){return Na.some((t=>{try{return e.matches(t)}catch(e){return!1}}))}function za(e){return $a(Br(e)).left+Xr(e).scrollLeft}function qa(e,t,n){let r;if("viewport"===t)r=function(e,t){const n=Nr(e),r=Br(e),a=n.visualViewport;let o=r.clientWidth,i=r.clientHeight,s=0,l=0;if(a){o=a.width,i=a.height;const e=Kr();(!e||e&&"fixed"===t)&&(s=a.offsetLeft,l=a.offsetTop)}return{width:o,height:i,x:s,y:l}}(e,n);else if("document"===t)r=function(e){const t=Br(e),n=Xr(e),r=e.ownerDocument.body,a=ba(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=ba(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let i=-n.scrollLeft+za(e);const s=-n.scrollTop;return"rtl"===Zr(r).direction&&(i+=ba(t.clientWidth,r.clientWidth)-a),{width:a,height:o,x:i,y:s}}(Br(e));else if(qr(t))r=function(e,t){const n=$a(e,!0,"fixed"===t),r=n.top+e.clientTop,a=n.left+e.clientLeft,o=Hr(e)?Ma(e):wa(1);return{width:e.clientWidth*o.x,height:e.clientHeight*o.y,x:a*o.x,y:r*o.y}}(t,n);else{const n=La(e);r={...t,x:t.x-n.x,y:t.y-n.y}}return Ta(r)}function Ha(e,t){const n=Jr(e);return!(n===t||!qr(n)||Yr(n))&&("fixed"===Zr(n).position||Ha(n,t))}function Wa(e,t,n){const r=Hr(t),a=Br(t),o="fixed"===n,i=$a(e,!0,o,t);let s={scrollLeft:0,scrollTop:0};const l=wa(0);if(r||!r&&!o)if(("body"!==$r(t)||Ur(a))&&(s=Xr(t)),r){const e=$a(t,!0,o,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else a&&(l.x=za(a));return{x:i.left+s.scrollLeft-l.x,y:i.top+s.scrollTop-l.y,width:i.width,height:i.height}}function Ua(e){return"static"===Zr(e).position}function Ga(e,t){return Hr(e)&&"fixed"!==Zr(e).position?t?t(e):e.offsetParent:null}function Qa(e,t){const n=Nr(e);if(Ba(e))return n;if(!Hr(e)){let t=Jr(e);for(;t&&!Yr(t);){if(qr(t)&&!Ua(t))return t;t=Jr(t)}return n}let r=Ga(e,t);for(;r&&Gr(r)&&Ua(r);)r=Ga(r,t);return r&&Yr(r)&&Ua(r)&&!Qr(r)?n:r||function(e){let t=Jr(e);for(;Hr(t)&&!Yr(t);){if(Qr(t))return t;t=Jr(t)}return null}(e)||n}const Ka={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:r,strategy:a}=e;const o="fixed"===a,i=Br(r),s=!!t&&Ba(t.floating);if(r===i||s&&o)return n;let l={scrollLeft:0,scrollTop:0},u=wa(1);const c=wa(0),d=Hr(r);if((d||!d&&!o)&&(("body"!==$r(r)||Ur(i))&&(l=Xr(r)),Hr(r))){const e=$a(r);u=Ma(r),c.x=e.x+r.clientLeft,c.y=e.y+r.clientTop}return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-l.scrollLeft*u.x+c.x,y:n.y*u.y-l.scrollTop*u.y+c.y}},getDocumentElement:Br,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:r,strategy:a}=e;const o=[..."clippingAncestors"===n?Ba(t)?[]:function(e,t){const n=t.get(e);if(n)return n;let r=ta(e,[],!1).filter((e=>qr(e)&&"body"!==$r(e))),a=null;const o="fixed"===Zr(e).position;let i=o?Jr(e):e;for(;qr(i)&&!Yr(i);){const t=Zr(i),n=Qr(i);n||"fixed"!==t.position||(a=null),(o?!n&&!a:!n&&"static"===t.position&&a&&["absolute","fixed"].includes(a.position)||Ur(i)&&!n&&Ha(e,i))?r=r.filter((e=>e!==i)):a=t,i=Jr(i)}return t.set(e,r),r}(t,this._c):[].concat(n),r],i=o[0],s=o.reduce(((e,n)=>{const r=qa(t,n,a);return e.top=ba(r.top,e.top),e.right=ga(r.right,e.right),e.bottom=ga(r.bottom,e.bottom),e.left=ba(r.left,e.left),e}),qa(t,i,a));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}},getOffsetParent:Qa,getElementRects:async function(e){const t=this.getOffsetParent||Qa,n=this.getDimensions,r=await n(e.floating);return{reference:Wa(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=Ia(e);return{width:t,height:n}},getScale:Ma,isElement:qr,isRTL:function(e){return"rtl"===Zr(e).direction}};function Ya(e,t,n,r){void 0===r&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:i="function"==typeof ResizeObserver,layoutShift:s="function"==typeof IntersectionObserver,animationFrame:l=!1}=r,u=Va(e),c=a||o?[...u?ta(u):[],...ta(t)]:[];c.forEach((e=>{a&&e.addEventListener("scroll",n,{passive:!0}),o&&e.addEventListener("resize",n)}));const d=u&&s?function(e,t){let n,r=null;const a=Br(e);function o(){var e;clearTimeout(n),null==(e=r)||e.disconnect(),r=null}return function i(s,l){void 0===s&&(s=!1),void 0===l&&(l=1),o();const{left:u,top:c,width:d,height:p}=e.getBoundingClientRect();if(s||t(),!d||!p)return;const f={rootMargin:-va(c)+"px "+-va(a.clientWidth-(u+d))+"px "+-va(a.clientHeight-(c+p))+"px "+-va(u)+"px",threshold:ba(0,ga(1,l))||1};let h=!0;function m(e){const t=e[0].intersectionRatio;if(t!==l){if(!h)return i();t?i(!1,t):n=setTimeout((()=>{i(!1,1e-7)}),1e3)}h=!1}try{r=new IntersectionObserver(m,{...f,root:a.ownerDocument})}catch(e){r=new IntersectionObserver(m,f)}r.observe(e)}(!0),o}(u,n):null;let p,f=-1,h=null;i&&(h=new ResizeObserver((e=>{let[r]=e;r&&r.target===u&&h&&(h.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame((()=>{var e;null==(e=h)||e.observe(t)}))),n()})),u&&!l&&h.observe(u),h.observe(t));let m=l?$a(e):null;return l&&function t(){const r=$a(e);!m||r.x===m.x&&r.y===m.y&&r.width===m.width&&r.height===m.height||n(),m=r,p=requestAnimationFrame(t)}(),n(),()=>{var e;c.forEach((e=>{a&&e.removeEventListener("scroll",n),o&&e.removeEventListener("resize",n)})),null==d||d(),null==(e=h)||e.disconnect(),h=null,l&&cancelAnimationFrame(p)}}const Za=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:a,y:o,placement:i,middlewareData:s}=t,l=await async function(e,t){const{placement:n,platform:r,elements:a}=e,o=await(null==r.isRTL?void 0:r.isRTL(a.floating)),i=xa(n),s=Pa(n),l="y"===Ca(n),u=["left","top"].includes(i)?-1:1,c=o&&l?-1:1,d=_a(t,e);let{mainAxis:p,crossAxis:f,alignmentAxis:h}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return s&&"number"==typeof h&&(f="end"===s?-1*h:h),l?{x:f*c,y:p*u}:{x:p*u,y:f*c}}(t,e);return i===(null==(n=s.offset)?void 0:n.placement)&&null!=(r=s.arrow)&&r.alignmentOffset?{}:{x:a+l.x,y:o+l.y,data:{...l,placement:i}}}}},Xa=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:a,middlewareData:o,rects:i,initialPlacement:s,platform:l,elements:u}=t,{mainAxis:c=!0,crossAxis:d=!0,fallbackPlacements:p,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:h="none",flipAlignment:m=!0,...g}=_a(e,t);if(null!=(n=o.arrow)&&n.alignmentOffset)return{};const b=xa(a),y=xa(s)===s,v=await(null==l.isRTL?void 0:l.isRTL(u.floating)),w=p||(y||!m?[ka(s)]:function(e){const t=ka(e);return[Da(e),t,Da(t)]}(s));p||"none"===h||w.push(...function(e,t,n,r){const a=Pa(e);let o=function(e,t,n){const r=["left","right"],a=["right","left"],o=["top","bottom"],i=["bottom","top"];switch(e){case"top":case"bottom":return n?t?a:r:t?r:a;case"left":case"right":return t?o:i;default:return[]}}(xa(e),"start"===n,r);return a&&(o=o.map((e=>e+"-"+a)),t&&(o=o.concat(o.map(Da)))),o}(s,m,h,v));const O=[s,...w],S=await Aa(t,g),_=[];let x=(null==(r=o.flip)?void 0:r.overflows)||[];if(c&&_.push(S[b]),d){const e=function(e,t,n){void 0===n&&(n=!1);const r=Pa(e),a=Ea(e),o=ja(a);let i="x"===a?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[o]>t.floating[o]&&(i=ka(i)),[i,ka(i)]}(a,i,v);_.push(S[e[0]],S[e[1]])}if(x=[...x,{placement:a,overflows:_}],!_.every((e=>e<=0))){var P,j;const e=((null==(P=o.flip)?void 0:P.index)||0)+1,t=O[e];if(t)return{data:{index:e,overflows:x},reset:{placement:t}};let n=null==(j=x.filter((e=>e.overflows[0]<=0)).sort(((e,t)=>e.overflows[1]-t.overflows[1]))[0])?void 0:j.placement;if(!n)switch(f){case"bestFit":{var C;const e=null==(C=x.map((e=>[e.placement,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:C[0];e&&(n=e);break}case"initialPlacement":n=s}if(a!==n)return{reset:{placement:n}}}return{}}}},Ja=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:a,elements:o}=t,{apply:i=(()=>{}),...s}=_a(e,t),l=await Aa(t,s),u=xa(n),c=Pa(n),d="y"===Ca(n),{width:p,height:f}=r.floating;let h,m;"top"===u||"bottom"===u?(h=u,m=c===(await(null==a.isRTL?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(m=u,h="end"===c?"top":"bottom");const g=f-l[h],b=p-l[m],y=!t.middlewareData.shift;let v=g,w=b;if(d){const e=p-l.left-l.right;w=c||y?ga(b,e):e}else{const e=f-l.top-l.bottom;v=c||y?ga(g,e):e}if(y&&!c){const e=ba(l.left,0),t=ba(l.right,0),n=ba(l.top,0),r=ba(l.bottom,0);d?w=p-2*(0!==e||0!==t?e+t:ba(l.left,l.right)):v=f-2*(0!==n||0!==r?n+r:ba(l.top,l.bottom))}await i({...t,availableWidth:w,availableHeight:v});const O=await a.getDimensions(o.floating);return p!==O.width||f!==O.height?{reset:{rects:!0}}:{}}}};var eo=f(729),to="undefined"!=typeof document?t.useLayoutEffect:t.useEffect;function no(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;let n,r,a;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;0!=r--;)if(!no(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;0!=r--;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;0!=r--;){const n=a[r];if(!("_owner"===n&&e.$$typeof||no(e[n],t[n])))return!1}return!0}return e!=e&&t!=t}function ro(e){return"undefined"==typeof window?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function ao(e,t){const n=ro(e);return Math.round(t*n)/n}function oo(e){const n=t.useRef(e);return to((()=>{n.current=e})),n}const io=(e,t)=>({...Za(e),options:[e,t]}),so=(e,t)=>({...Xa(e),options:[e,t]}),lo=(e,t)=>({...Ja(e),options:[e,t]});var uo=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"].join(","),co="undefined"==typeof Element,po=co?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,fo=!co&&Element.prototype.getRootNode?function(e){var t;return null==e||null===(t=e.getRootNode)||void 0===t?void 0:t.call(e)}:function(e){return null==e?void 0:e.ownerDocument},ho=function e(t,n){var r;void 0===n&&(n=!0);var a=null==t||null===(r=t.getAttribute)||void 0===r?void 0:r.call(t,"inert");return""===a||"true"===a||n&&t&&e(t.parentNode)},mo=function e(t,n,r){for(var a=[],o=Array.from(t);o.length;){var i=o.shift();if(!ho(i,!1))if("SLOT"===i.tagName){var s=i.assignedElements(),l=e(s.length?s:i.children,!0,r);r.flatten?a.push.apply(a,l):a.push({scopeParent:i,candidates:l})}else{po.call(i,uo)&&r.filter(i)&&(n||!t.includes(i))&&a.push(i);var u=i.shadowRoot||"function"==typeof r.getShadowRoot&&r.getShadowRoot(i),c=!ho(u,!1)&&(!r.shadowRootFilter||r.shadowRootFilter(i));if(u&&c){var d=e(!0===u?i.children:u.children,!0,r);r.flatten?a.push.apply(a,d):a.push({scopeParent:i,candidates:d})}else o.unshift.apply(o,i.children)}}return a},go=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},bo=function(e){if(!e)throw new Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||function(e){var t,n=null==e||null===(t=e.getAttribute)||void 0===t?void 0:t.call(e,"contenteditable");return""===n||"true"===n}(e))&&!go(e)?0:e.tabIndex},yo=function(e,t){return e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex},vo=function(e){return"INPUT"===e.tagName},wo=function(e){var t=e.getBoundingClientRect(),n=t.width,r=t.height;return 0===n&&0===r},Oo=function(e,t){return!(t.disabled||ho(t)||function(e){return vo(e)&&"hidden"===e.type}(t)||function(e,t){var n=t.displayCheck,r=t.getShadowRoot;if("hidden"===getComputedStyle(e).visibility)return!0;var a=po.call(e,"details>summary:first-of-type")?e.parentElement:e;if(po.call(a,"details:not([open]) *"))return!0;if(n&&"full"!==n&&"legacy-full"!==n){if("non-zero-area"===n)return wo(e)}else{if("function"==typeof r){for(var o=e;e;){var i=e.parentElement,s=fo(e);if(i&&!i.shadowRoot&&!0===r(i))return wo(e);e=e.assignedSlot?e.assignedSlot:i||s===e.ownerDocument?i:s.host}e=o}if(function(e){var t,n,r,a,o=e&&fo(e),i=null===(t=o)||void 0===t?void 0:t.host,s=!1;if(o&&o!==e)for(s=!!(null!==(n=i)&&void 0!==n&&null!==(r=n.ownerDocument)&&void 0!==r&&r.contains(i)||null!=e&&null!==(a=e.ownerDocument)&&void 0!==a&&a.contains(e));!s&&i;){var l,u,c;s=!(null===(u=i=null===(l=o=fo(i))||void 0===l?void 0:l.host)||void 0===u||null===(c=u.ownerDocument)||void 0===c||!c.contains(i))}return s}(e))return!e.getClientRects().length;if("legacy-full"!==n)return!0}return!1}(t,e)||function(e){return"DETAILS"===e.tagName&&Array.prototype.slice.apply(e.children).some((function(e){return"SUMMARY"===e.tagName}))}(t)||function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var t=e.parentElement;t;){if("FIELDSET"===t.tagName&&t.disabled){for(var n=0;n<t.children.length;n++){var r=t.children.item(n);if("LEGEND"===r.tagName)return!!po.call(t,"fieldset[disabled] *")||!r.contains(e)}return!0}t=t.parentElement}return!1}(t))},So=function(e,t){return!(function(e){return function(e){return vo(e)&&"radio"===e.type}(e)&&!function(e){if(!e.name)return!0;var t,n=e.form||fo(e),r=function(e){return n.querySelectorAll('input[type="radio"][name="'+e+'"]')};if("undefined"!=typeof window&&void 0!==window.CSS&&"function"==typeof window.CSS.escape)t=r(window.CSS.escape(e.name));else try{t=r(e.name)}catch(e){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",e.message),!1}var a=function(e,t){for(var n=0;n<e.length;n++)if(e[n].checked&&e[n].form===t)return e[n]}(t,e.form);return!a||a===e}(e)}(t)||bo(t)<0||!Oo(e,t))},_o=function(e){var t=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(t)||t>=0)},xo=function e(t){var n=[],r=[];return t.forEach((function(t,a){var o=!!t.scopeParent,i=o?t.scopeParent:t,s=function(e,t){var n=bo(e);return n<0&&t&&!go(e)?0:n}(i,o),l=o?e(t.candidates):i;0===s?o?n.push.apply(n,l):n.push(i):r.push({documentOrder:a,tabIndex:s,item:t,isScope:o,content:l})})),r.sort(yo).reduce((function(e,t){return t.isScope?e.push.apply(e,t.content):e.push(t.content),e}),[]).concat(n)},Po=function(e,t){var n;return n=(t=t||{}).getShadowRoot?mo([e],t.includeContainer,{filter:So.bind(null,t),flatten:!1,getShadowRoot:t.getShadowRoot,shadowRootFilter:_o}):function(e,t,n){if(ho(e))return[];var r=Array.prototype.slice.apply(e.querySelectorAll(uo));return t&&po.call(e,uo)&&r.unshift(e),r.filter(n)}(e,t.includeContainer,So.bind(null,t)),xo(n)},jo=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return!1!==po.call(e,uo)&&So(t,e)};const Co={...n},Eo=Co.useInsertionEffect||(e=>e());function Do(e){const n=t.useRef((()=>{}));return Eo((()=>{n.current=e})),t.useCallback((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return null==n.current?void 0:n.current(...t)}),[])}const ko="ArrowUp",To="ArrowDown",Ro="ArrowLeft",Ao="ArrowRight";function Io(e,t,n){return Math.floor(e/t)!==n}function Vo(e,t){return t<0||t>=e.current.length}function Mo(e,t){return Lo(e,{disabledIndices:t})}function Fo(e,t){return Lo(e,{decrement:!0,startingIndex:e.current.length,disabledIndices:t})}function Lo(e,t){let{startingIndex:n=-1,decrement:r=!1,disabledIndices:a,amount:o=1}=void 0===t?{}:t;const i=e.current;let s=n;do{s+=r?-o:o}while(s>=0&&s<=i.length-1&&Bo(i,s,a));return s}function $o(e,t,n,r,a){if(-1===e)return-1;const o=n.indexOf(e),i=t[e];switch(a){case"tl":return o;case"tr":return i?o+i.width-1:o;case"bl":return i?o+(i.height-1)*r:o;case"br":return n.lastIndexOf(e)}}function No(e,t){return t.flatMap(((t,n)=>e.includes(t)?[n]:[]))}function Bo(e,t,n){if(n)return n.includes(t);const r=e[t];return null==r||r.hasAttribute("disabled")||"true"===r.getAttribute("aria-disabled")}let zo=0;function qo(e,t){void 0===t&&(t={});const{preventScroll:n=!1,cancelPrevious:r=!0,sync:a=!1}=t;r&&cancelAnimationFrame(zo);const o=()=>null==e?void 0:e.focus({preventScroll:n});a?o():zo=requestAnimationFrame(o)}var Ho="undefined"!=typeof document?t.useLayoutEffect:t.useEffect;function Wo(){return Wo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Wo.apply(this,arguments)}let Uo=!1,Go=0;const Qo=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+Go++,Ko=Co.useId||function(){const[e,n]=t.useState((()=>Uo?Qo():void 0));return Ho((()=>{null==e&&n(Qo())}),[]),t.useEffect((()=>{Uo=!0}),[]),e};const Yo=t.createContext(null),Zo=t.createContext(null),Xo=()=>{var e;return(null==(e=t.useContext(Yo))?void 0:e.id)||null},Jo=()=>t.useContext(Zo);function ei(e){return"data-floating-ui-"+e}function ti(e){const n=(0,t.useRef)(e);return Ho((()=>{n.current=e})),n}function ni(e,t){let n=e.filter((e=>{var n;return e.parentId===t&&(null==(n=e.context)?void 0:n.open)})),r=n;for(;r.length;)r=e.filter((e=>{var t;return null==(t=r)?void 0:t.some((t=>{var n;return e.parentId===t.id&&(null==(n=e.context)?void 0:n.open)}))})),n=n.concat(r);return n}let ri=new WeakMap,ai=new WeakSet,oi={},ii=0;const si=e=>e&&(e.host||si(e.parentNode)),li=(e,t)=>t.map((t=>{if(e.contains(t))return t;const n=si(t);return e.contains(n)?n:null})).filter((e=>null!=e));function ui(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);const r=ca(e[0]).body;return function(e,t,n,r){const a="data-floating-ui-inert",o=r?"inert":n?"aria-hidden":null,i=li(t,e),s=new Set,l=new Set(i),u=[];oi[a]||(oi[a]=new WeakMap);const c=oi[a];return i.forEach((function e(t){t&&!s.has(t)&&(s.add(t),t.parentNode&&e(t.parentNode))})),function e(t){t&&!l.has(t)&&[].forEach.call(t.children,(t=>{if("script"!==$r(t))if(s.has(t))e(t);else{const e=o?t.getAttribute(o):null,n=null!==e&&"false"!==e,r=(ri.get(t)||0)+1,i=(c.get(t)||0)+1;ri.set(t,r),c.set(t,i),u.push(t),1===r&&n&&ai.add(t),1===i&&t.setAttribute(a,""),!n&&o&&t.setAttribute(o,"true")}}))}(t),s.clear(),ii++,()=>{u.forEach((e=>{const t=(ri.get(e)||0)-1,n=(c.get(e)||0)-1;ri.set(e,t),c.set(e,n),t||(!ai.has(e)&&o&&e.removeAttribute(o),ai.delete(e)),n||e.removeAttribute(a)})),ii--,ii||(ri=new WeakMap,ri=new WeakMap,ai=new WeakSet,oi={})}}(e.concat(Array.from(r.querySelectorAll("[aria-live]"))),r,t,n)}const ci=()=>({getShadowRoot:!0,displayCheck:"function"==typeof ResizeObserver&&ResizeObserver.toString().includes("[native code]")?"full":"none"});function di(e,t){const n=Po(e,ci());"prev"===t&&n.reverse();const r=n.indexOf(na(ca(e)));return n.slice(r+1)[0]}function pi(){return di(document.body,"next")}function fi(){return di(document.body,"prev")}function hi(e,t){const n=t||e.currentTarget,r=e.relatedTarget;return!r||!ra(n,r)}function mi(e){Po(e,ci()).forEach((e=>{e.dataset.tabindex=e.getAttribute("tabindex")||"",e.setAttribute("tabindex","-1")}))}function gi(e){e.querySelectorAll("[data-tabindex]").forEach((e=>{const t=e.dataset.tabindex;delete e.dataset.tabindex,t?e.setAttribute("tabindex",t):e.removeAttribute("tabindex")}))}const bi={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"fixed",whiteSpace:"nowrap",width:"1px",top:0,left:0};function yi(e){"Tab"===e.key&&(e.target,clearTimeout(void 0))}const vi=t.forwardRef((function(e,n){const[r,a]=t.useState();Ho((()=>(la()&&a("button"),document.addEventListener("keydown",yi),()=>{document.removeEventListener("keydown",yi)})),[]);const o={ref:n,tabIndex:0,role:r,"aria-hidden":!r||void 0,[ei("focus-guard")]:"",style:bi};return t.createElement("span",Wo({},e,o))})),wi=t.createContext(null),Oi=ei("portal");function Si(e){const{children:n,id:r,root:a=null,preserveTabOrder:o=!0}=e,i=function(e){void 0===e&&(e={});const{id:n,root:r}=e,a=Ko(),o=_i(),[i,s]=t.useState(null),l=t.useRef(null);return Ho((()=>()=>{null==i||i.remove(),queueMicrotask((()=>{l.current=null}))}),[i]),Ho((()=>{if(!a)return;if(l.current)return;const e=n?document.getElementById(n):null;if(!e)return;const t=document.createElement("div");t.id=a,t.setAttribute(Oi,""),e.appendChild(t),l.current=t,s(t)}),[n,a]),Ho((()=>{if(!a)return;if(l.current)return;let e=r||(null==o?void 0:o.portalNode);e&&!qr(e)&&(e=e.current),e=e||document.body;let t=null;n&&(t=document.createElement("div"),t.id=n,e.appendChild(t));const i=document.createElement("div");i.id=a,i.setAttribute(Oi,""),e=t||e,e.appendChild(i),l.current=i,s(i)}),[n,r,a,o]),i}({id:r,root:a}),[s,l]=t.useState(null),u=t.useRef(null),c=t.useRef(null),d=t.useRef(null),p=t.useRef(null),f=!!s&&!s.modal&&s.open&&o&&!(!a&&!i);return t.useEffect((()=>{if(i&&o&&(null==s||!s.modal))return i.addEventListener("focusin",e,!0),i.addEventListener("focusout",e,!0),()=>{i.removeEventListener("focusin",e,!0),i.removeEventListener("focusout",e,!0)};function e(e){i&&hi(e)&&("focusin"===e.type?gi:mi)(i)}}),[i,o,null==s?void 0:s.modal]),t.createElement(wi.Provider,{value:t.useMemo((()=>({preserveTabOrder:o,beforeOutsideRef:u,afterOutsideRef:c,beforeInsideRef:d,afterInsideRef:p,portalNode:i,setFocusManagerState:l})),[o,i])},f&&i&&t.createElement(vi,{"data-type":"outside",ref:u,onFocus:e=>{if(hi(e,i)){var t;null==(t=d.current)||t.focus()}else{const e=fi()||(null==s?void 0:s.refs.domReference.current);null==e||e.focus()}}}),f&&i&&t.createElement("span",{"aria-owns":i.id,style:bi}),i&&(0,eo.createPortal)(n,i),f&&i&&t.createElement(vi,{"data-type":"outside",ref:c,onFocus:e=>{if(hi(e,i)){var t;null==(t=p.current)||t.focus()}else{const t=pi()||(null==s?void 0:s.refs.domReference.current);null==t||t.focus(),(null==s?void 0:s.closeOnFocusOut)&&(null==s||s.onOpenChange(!1,e.nativeEvent))}}}))}const _i=()=>t.useContext(wi),xi=20;let Pi=[];function ji(e){Pi=Pi.filter((e=>e.isConnected));let t=e;if(t&&"body"!==$r(t)){if(!jo(t,ci())){const e=Po(t,ci())[0];e&&(t=e)}Pi.push(t),Pi.length>xi&&(Pi=Pi.slice(-xi))}}function Ci(){return Pi.slice().reverse().find((e=>e.isConnected))}const Ei=t.forwardRef((function(e,n){return t.createElement("button",Wo({},e,{type:"button",ref:n,tabIndex:-1,style:bi}))}));function Di(e){const{context:n,children:r,disabled:a=!1,order:o=["content"],guards:i=!0,initialFocus:s=0,returnFocus:l=!0,modal:u=!0,visuallyHiddenDismiss:c=!1,closeOnFocusOut:d=!0}=e,{open:p,refs:f,nodeId:h,onOpenChange:m,events:g,dataRef:b,elements:{domReference:y,floating:v}}=n,w="number"==typeof s&&s<0,O=ma(y)&&w,S="undefined"==typeof HTMLElement||!("inert"in HTMLElement.prototype)||i,_=ti(o),x=ti(s),P=ti(l),j=Jo(),C=_i(),E=t.useRef(null),D=t.useRef(null),k=t.useRef(!1),T=t.useRef(!1),R=null!=C,A=t.useCallback((function(e){return void 0===e&&(e=v),e?Po(e,ci()):[]}),[v]),I=t.useCallback((e=>{const t=A(e);return _.current.map((e=>y&&"reference"===e?y:v&&"floating"===e?v:t)).filter(Boolean).flat()}),[y,v,_,A]);function V(e){return!a&&c&&u?t.createElement(Ei,{ref:"start"===e?E:D,onClick:e=>m(!1,e.nativeEvent)},"string"==typeof c?c:"Dismiss"):null}t.useEffect((()=>{if(a||!u)return;function e(e){if("Tab"===e.key){ra(v,na(ca(v)))&&0===A().length&&!O&&ha(e);const t=I(),n=pa(e);"reference"===_.current[0]&&n===y&&(ha(e),e.shiftKey?qo(t[t.length-1]):qo(t[1])),"floating"===_.current[1]&&n===v&&e.shiftKey&&(ha(e),qo(t[0]))}}const t=ca(v);return t.addEventListener("keydown",e),()=>{t.removeEventListener("keydown",e)}}),[a,y,v,u,_,O,A,I]),t.useEffect((()=>{if(!a&&d)return v&&Hr(y)?(y.addEventListener("focusout",t),y.addEventListener("pointerdown",e),!u&&v.addEventListener("focusout",t),()=>{y.removeEventListener("focusout",t),y.removeEventListener("pointerdown",e),!u&&v.removeEventListener("focusout",t)}):void 0;function e(){T.current=!0,setTimeout((()=>{T.current=!1}))}function t(e){const t=e.relatedTarget;queueMicrotask((()=>{const n=!(ra(y,t)||ra(v,t)||ra(t,v)||ra(null==C?void 0:C.portalNode,t)||null!=t&&t.hasAttribute(ei("focus-guard"))||j&&(ni(j.nodesRef.current,h).find((e=>{var n,r;return ra(null==(n=e.context)?void 0:n.elements.floating,t)||ra(null==(r=e.context)?void 0:r.elements.domReference,t)}))||function(e,t){var n;let r=[],a=null==(n=e.find((e=>e.id===t)))?void 0:n.parentId;for(;a;){const t=e.find((e=>e.id===a));a=null==t?void 0:t.parentId,t&&(r=r.concat(t))}return r}(j.nodesRef.current,h).find((e=>{var n,r;return(null==(n=e.context)?void 0:n.elements.floating)===t||(null==(r=e.context)?void 0:r.elements.domReference)===t}))));t&&n&&!T.current&&t!==Ci()&&(k.current=!0,m(!1,e))}))}}),[a,y,v,u,h,j,C,m,d]),t.useEffect((()=>{var e;if(a)return;const t=Array.from((null==C||null==(e=C.portalNode)?void 0:e.querySelectorAll("["+ei("portal")+"]"))||[]);if(v){const e=[v,...t,E.current,D.current,_.current.includes("reference")||O?y:null].filter((e=>null!=e)),n=u||O?ui(e,S,!S):ui(e);return()=>{n()}}}),[a,y,v,u,_,C,O,S]),Ho((()=>{if(a||!v)return;const e=na(ca(v));queueMicrotask((()=>{const t=I(v),n=x.current,r=("number"==typeof n?t[n]:n.current)||v,a=ra(v,e);w||a||!p||qo(r,{preventScroll:r===v})}))}),[a,p,v,w,I,x]),Ho((()=>{if(a||!v)return;let e=!1;const t=ca(v),n=na(t);let r=b.current.openEvent;function o(t){let{open:n,reason:a,event:o,nested:i}=t;n&&(r=o),"escape-key"===a&&f.domReference.current&&ji(f.domReference.current),"hover"===a&&"mouseleave"===o.type&&(k.current=!0),"outside-press"===a&&(i?(k.current=!1,e=!0):k.current=!(ia(o)||sa(o)))}return ji(n),g.on("openchange",o),()=>{g.off("openchange",o);const n=na(t),a=ra(v,n)||j&&ni(j.nodesRef.current,h).some((e=>{var t;return ra(null==(t=e.context)?void 0:t.elements.floating,n)}));(a||r&&["click","mousedown"].includes(r.type))&&f.domReference.current&&ji(f.domReference.current);const i=Ci();P.current&&!k.current&&Hr(i)&&(i===n||n===t.body||a)&&qo(i,{cancelPrevious:!1,preventScroll:e})}}),[a,v,P,b,f,g,j,h]),Ho((()=>{if(!a&&C)return C.setFocusManagerState({modal:u,closeOnFocusOut:d,open:p,onOpenChange:m,refs:f}),()=>{C.setFocusManagerState(null)}}),[a,C,u,p,m,f,d]),Ho((()=>{if(a||!v||"function"!=typeof MutationObserver||w)return;const e=()=>{const e=v.getAttribute("tabindex");_.current.includes("floating")||na(ca(v))!==f.domReference.current&&0===A().length?"0"!==e&&v.setAttribute("tabindex","0"):"-1"!==e&&v.setAttribute("tabindex","-1")};e();const t=new MutationObserver(e);return t.observe(v,{childList:!0,subtree:!0,attributes:!0}),()=>{t.disconnect()}}),[a,v,f,_,A,w]);const M=!a&&S&&(R||u);return t.createElement(t.Fragment,null,M&&t.createElement(vi,{"data-type":"inside",ref:null==C?void 0:C.beforeInsideRef,onFocus:e=>{if(u){const e=I();qo("reference"===o[0]?e[0]:e[e.length-1])}else if(null!=C&&C.preserveTabOrder&&C.portalNode)if(k.current=!1,hi(e,C.portalNode)){const e=pi()||y;null==e||e.focus()}else{var t;null==(t=C.beforeOutsideRef.current)||t.focus()}}}),!O&&V("start"),r,V("end"),M&&t.createElement(vi,{"data-type":"inside",ref:null==C?void 0:C.afterInsideRef,onFocus:e=>{if(u)qo(I()[0]);else if(null!=C&&C.preserveTabOrder&&C.portalNode)if(d&&(k.current=!0),hi(e,C.portalNode)){const e=fi()||y;null==e||e.focus()}else{var t;null==(t=C.afterOutsideRef.current)||t.focus()}}}))}const ki={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},Ti={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},Ri=e=>{var t,n;return{escapeKey:"boolean"==typeof e?e:null!=(t=null==e?void 0:e.escapeKey)&&t,outsidePress:"boolean"==typeof e?e:null==(n=null==e?void 0:e.outsidePress)||n}};function Ai(e,n){void 0===n&&(n={});const{open:r,onOpenChange:a,elements:{reference:o,domReference:i,floating:s},dataRef:l}=e,{enabled:u=!0,escapeKey:c=!0,outsidePress:d=!0,outsidePressEvent:p="pointerdown",referencePress:f=!1,referencePressEvent:h="pointerdown",ancestorScroll:m=!1,bubbles:g,capture:b}=n,y=Jo(),v=Do("function"==typeof d?d:()=>!1),w="function"==typeof d?v:d,O=t.useRef(!1),S=t.useRef(!1),{escapeKey:_,outsidePress:x}=Ri(g),{escapeKey:P,outsidePress:j}=Ri(b),C=Do((e=>{var t;if(!r||!u||!c||"Escape"!==e.key)return;const n=null==(t=l.current.floatingContext)?void 0:t.nodeId,o=y?ni(y.nodesRef.current,n):[];if(!_&&(e.stopPropagation(),o.length>0)){let e=!0;if(o.forEach((t=>{var n;null==(n=t.context)||!n.open||t.context.dataRef.current.__escapeKeyBubbles||(e=!1)})),!e)return}a(!1,function(e){return"nativeEvent"in e}(e)?e.nativeEvent:e,"escape-key")})),E=Do((e=>{var t;const n=()=>{var t;C(e),null==(t=pa(e))||t.removeEventListener("keydown",n)};null==(t=pa(e))||t.addEventListener("keydown",n)})),D=Do((e=>{var t;const n=O.current;O.current=!1;const r=S.current;if(S.current=!1,"click"===p&&r)return;if(n)return;if("function"==typeof w&&!w(e))return;const o=pa(e),u="["+ei("inert")+"]",c=ca(s).querySelectorAll(u);let d=qr(o)?o:null;for(;d&&!Yr(d);){const e=Jr(d);if(Yr(e)||!qr(e))break;d=e}if(c.length&&qr(o)&&!o.matches("html,body")&&!ra(o,s)&&Array.from(c).every((e=>!ra(d,e))))return;if(Hr(o)&&s){const t=o.clientWidth>0&&o.scrollWidth>o.clientWidth,n=o.clientHeight>0&&o.scrollHeight>o.clientHeight;let r=n&&e.offsetX>o.clientWidth;if(n&&"rtl"===Zr(o).direction&&(r=e.offsetX<=o.offsetWidth-o.clientWidth),r||t&&e.offsetY>o.clientHeight)return}const f=null==(t=l.current.floatingContext)?void 0:t.nodeId,h=y&&ni(y.nodesRef.current,f).some((t=>{var n;return da(e,null==(n=t.context)?void 0:n.elements.floating)}));if(da(e,s)||da(e,i)||h)return;const m=y?ni(y.nodesRef.current,f):[];if(m.length>0){let e=!0;if(m.forEach((t=>{var n;null==(n=t.context)||!n.open||t.context.dataRef.current.__outsidePressBubbles||(e=!1)})),!e)return}a(!1,e,"outside-press")})),k=Do((e=>{var t;const n=()=>{var t;D(e),null==(t=pa(e))||t.removeEventListener(p,n)};null==(t=pa(e))||t.addEventListener(p,n)}));return t.useEffect((()=>{if(!r||!u)return;function e(e){a(!1,e,"ancestor-scroll")}l.current.__escapeKeyBubbles=_,l.current.__outsidePressBubbles=x;const t=ca(s);c&&t.addEventListener("keydown",P?E:C,P),w&&t.addEventListener(p,j?k:D,j);let n=[];return m&&(qr(i)&&(n=ta(i)),qr(s)&&(n=n.concat(ta(s))),!qr(o)&&o&&o.contextElement&&(n=n.concat(ta(o.contextElement)))),n=n.filter((e=>{var n;return e!==(null==(n=t.defaultView)?void 0:n.visualViewport)})),n.forEach((t=>{t.addEventListener("scroll",e,{passive:!0})})),()=>{c&&t.removeEventListener("keydown",P?E:C,P),w&&t.removeEventListener(p,j?k:D,j),n.forEach((t=>{t.removeEventListener("scroll",e)}))}}),[l,s,i,o,c,w,p,r,a,m,u,_,x,C,P,E,D,j,k]),t.useEffect((()=>{O.current=!1}),[w,p]),t.useMemo((()=>u?{reference:{onKeyDown:C,[ki[h]]:e=>{f&&a(!1,e.nativeEvent,"reference-press")}},floating:{onKeyDown:C,onMouseDown(){S.current=!0},onMouseUp(){S.current=!0},[Ti[p]]:()=>{O.current=!0}}}:{}),[u,f,p,h,a,C])}function Ii(e){void 0===e&&(e={});const{nodeId:n}=e,r=function(e){const{open:n=!1,onOpenChange:r,elements:a}=e,o=Ko(),i=t.useRef({}),[s]=t.useState((()=>function(){const e=new Map;return{emit(t,n){var r;null==(r=e.get(t))||r.forEach((e=>e(n)))},on(t,n){e.set(t,[...e.get(t)||[],n])},off(t,n){var r;e.set(t,(null==(r=e.get(t))?void 0:r.filter((e=>e!==n)))||[])}}}())),l=null!=Xo(),[u,c]=t.useState(a.reference),d=Do(((e,t,n)=>{i.current.openEvent=e?t:void 0,s.emit("openchange",{open:e,event:t,reason:n,nested:l}),null==r||r(e,t,n)})),p=t.useMemo((()=>({setPositionReference:c})),[]),f=t.useMemo((()=>({reference:u||a.reference||null,floating:a.floating||null,domReference:a.reference})),[u,a.reference,a.floating]);return t.useMemo((()=>({dataRef:i,open:n,onOpenChange:d,elements:f,events:s,floatingId:o,refs:p})),[n,d,f,s,o,p])}({...e,elements:{reference:null,floating:null,...e.elements}}),a=e.rootContext||r,o=a.elements,[i,s]=t.useState(null),[l,u]=t.useState(null),c=(null==o?void 0:o.reference)||i,d=t.useRef(null),p=Jo();Ho((()=>{c&&(d.current=c)}),[c]);const f=function(e){void 0===e&&(e={});const{placement:n="bottom",strategy:r="absolute",middleware:a=[],platform:o,elements:{reference:i,floating:s}={},transform:l=!0,whileElementsMounted:u,open:c}=e,[d,p]=t.useState({x:0,y:0,strategy:r,placement:n,middlewareData:{},isPositioned:!1}),[f,h]=t.useState(a);no(f,a)||h(a);const[m,g]=t.useState(null),[b,y]=t.useState(null),v=t.useCallback((e=>{e!==_.current&&(_.current=e,g(e))}),[]),w=t.useCallback((e=>{e!==x.current&&(x.current=e,y(e))}),[]),O=i||m,S=s||b,_=t.useRef(null),x=t.useRef(null),P=t.useRef(d),j=null!=u,C=oo(u),E=oo(o),D=t.useCallback((()=>{if(!_.current||!x.current)return;const e={placement:n,strategy:r,middleware:f};E.current&&(e.platform=E.current),((e,t,n)=>{const r=new Map,a={platform:Ka,...n},o={...a.platform,_c:r};return(async(e,t,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:i}=n,s=o.filter(Boolean),l=await(null==i.isRTL?void 0:i.isRTL(t));let u=await i.getElementRects({reference:e,floating:t,strategy:a}),{x:c,y:d}=Ra(u,r,l),p=r,f={},h=0;for(let n=0;n<s.length;n++){const{name:o,fn:m}=s[n],{x:g,y:b,data:y,reset:v}=await m({x:c,y:d,initialPlacement:r,placement:p,strategy:a,middlewareData:f,rects:u,platform:i,elements:{reference:e,floating:t}});c=null!=g?g:c,d=null!=b?b:d,f={...f,[o]:{...f[o],...y}},v&&h<=50&&(h++,"object"==typeof v&&(v.placement&&(p=v.placement),v.rects&&(u=!0===v.rects?await i.getElementRects({reference:e,floating:t,strategy:a}):v.rects),({x:c,y:d}=Ra(u,p,l))),n=-1)}return{x:c,y:d,placement:p,strategy:a,middlewareData:f}})(e,t,{...a,platform:o})})(_.current,x.current,e).then((e=>{const t={...e,isPositioned:!0};k.current&&!no(P.current,t)&&(P.current=t,eo.flushSync((()=>{p(t)})))}))}),[f,n,r,E]);to((()=>{!1===c&&P.current.isPositioned&&(P.current.isPositioned=!1,p((e=>({...e,isPositioned:!1}))))}),[c]);const k=t.useRef(!1);to((()=>(k.current=!0,()=>{k.current=!1})),[]),to((()=>{if(O&&(_.current=O),S&&(x.current=S),O&&S){if(C.current)return C.current(O,S,D);D()}}),[O,S,D,C,j]);const T=t.useMemo((()=>({reference:_,floating:x,setReference:v,setFloating:w})),[v,w]),R=t.useMemo((()=>({reference:O,floating:S})),[O,S]),A=t.useMemo((()=>{const e={position:r,left:0,top:0};if(!R.floating)return e;const t=ao(R.floating,d.x),n=ao(R.floating,d.y);return l?{...e,transform:"translate("+t+"px, "+n+"px)",...ro(R.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:t,top:n}}),[r,l,R.floating,d.x,d.y]);return t.useMemo((()=>({...d,update:D,refs:T,elements:R,floatingStyles:A})),[d,D,T,R,A])}({...e,elements:{...o,...l&&{reference:l}}}),h=t.useCallback((e=>{const t=qr(e)?{getBoundingClientRect:()=>e.getBoundingClientRect(),contextElement:e}:e;u(t),f.refs.setReference(t)}),[f.refs]),m=t.useCallback((e=>{(qr(e)||null===e)&&(d.current=e,s(e)),(qr(f.refs.reference.current)||null===f.refs.reference.current||null!==e&&!qr(e))&&f.refs.setReference(e)}),[f.refs]),g=t.useMemo((()=>({...f.refs,setReference:m,setPositionReference:h,domReference:d})),[f.refs,m,h]),b=t.useMemo((()=>({...f.elements,domReference:c})),[f.elements,c]),y=t.useMemo((()=>({...f,...a,refs:g,elements:b,nodeId:n})),[f,g,b,n,a]);return Ho((()=>{a.dataRef.current.floatingContext=y;const e=null==p?void 0:p.nodesRef.current.find((e=>e.id===n));e&&(e.context=y)})),t.useMemo((()=>({...f,context:y,refs:g,elements:b})),[f,g,b,y])}const Vi="active",Mi="selected";function Fi(e,t,n){const r=new Map,a="item"===n;let o=e;if(a&&e){const{[Vi]:t,[Mi]:n,...r}=e;o=r}return{..."floating"===n&&{tabIndex:-1},...o,...t.map((t=>{const r=t?t[n]:null;return"function"==typeof r?e?r(e):null:r})).concat(e).reduce(((e,t)=>t?(Object.entries(t).forEach((t=>{let[n,o]=t;var i;a&&[Vi,Mi].includes(n)||(0===n.indexOf("on")?(r.has(n)||r.set(n,[]),"function"==typeof o&&(null==(i=r.get(n))||i.push(o),e[n]=function(){for(var e,t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return null==(e=r.get(n))?void 0:e.map((e=>e(...a))).find((e=>void 0!==e))})):e[n]=o)})),e):e),{})}}function Li(e){void 0===e&&(e=[]);const n=e,r=t.useCallback((t=>Fi(t,e,"reference")),n),a=t.useCallback((t=>Fi(t,e,"floating")),n),o=t.useCallback((t=>Fi(t,e,"item")),e.map((e=>null==e?void 0:e.item)));return t.useMemo((()=>({getReferenceProps:r,getFloatingProps:a,getItemProps:o})),[r,a,o])}let $i=!1;function Ni(e,t,n){switch(e){case"vertical":return t;case"horizontal":return n;default:return t||n}}function Bi(e,t){return Ni(t,e===ko||e===To,e===Ro||e===Ao)}function zi(e,t,n){return Ni(t,e===To,n?e===Ro:e===Ao)||"Enter"===e||" "===e||""===e}function qi(e,t,n){return Ni(t,n?e===Ao:e===Ro,e===ko)}function Hi(e,n){const{open:r,onOpenChange:a,elements:{domReference:o,floating:i}}=e,{listRef:s,activeIndex:l,onNavigate:u=(()=>{}),enabled:c=!0,selectedIndex:d=null,allowEscape:p=!1,loop:f=!1,nested:h=!1,rtl:m=!1,virtual:g=!1,focusItemOnOpen:b="auto",focusItemOnHover:y=!0,openOnArrowKeyDown:v=!0,disabledIndices:w,orientation:O="vertical",cols:S=1,scrollItemIntoView:_=!0,virtualItemRef:x,itemSizes:P,dense:j=!1}=n,C=Xo(),E=Jo(),D=Do(u),k=t.useRef(b),T=t.useRef(null!=d?d:-1),R=t.useRef(null),A=t.useRef(!0),I=t.useRef(D),V=t.useRef(!!i),M=t.useRef(!1),F=t.useRef(!1),L=ti(w),$=ti(r),N=ti(_),B=ti(i),z=ti(d),[q,H]=t.useState(),[W,U]=t.useState(),G=Do((function(e,t,n){function r(e){g?(H(e.id),null==E||E.events.emit("virtualfocus",e),x&&(x.current=e)):qo(e,{preventScroll:!0,sync:!(!aa().toLowerCase().startsWith("mac")||navigator.maxTouchPoints||!la())&&($i||M.current)})}void 0===n&&(n=!1);const a=e.current[t.current];a&&r(a),requestAnimationFrame((()=>{const o=e.current[t.current]||a;if(!o)return;a||r(o);const i=N.current;i&&K&&(n||!A.current)&&(null==o.scrollIntoView||o.scrollIntoView("boolean"==typeof i?{block:"nearest",inline:"nearest"}:i))}))}));Ho((()=>{document.createElement("div").focus({get preventScroll(){return $i=!0,!1}})}),[]),Ho((()=>{c&&(r&&i?k.current&&null!=d&&(F.current=!0,T.current=d,D(d)):V.current&&(T.current=-1,I.current(null)))}),[c,r,i,d,D]),Ho((()=>{if(c&&r&&i)if(null==l){if(M.current=!1,null!=z.current)return;if(V.current&&(T.current=-1,G(s,T)),!V.current&&k.current&&(null!=R.current||!0===k.current&&null==R.current)){let e=0;const t=()=>{null==s.current[0]?(e<2&&(e?requestAnimationFrame:queueMicrotask)(t),e++):(T.current=null==R.current||zi(R.current,O,m)||h?Mo(s,L.current):Fo(s,L.current),R.current=null,D(T.current))};t()}}else Vo(s,l)||(T.current=l,G(s,T,F.current),F.current=!1)}),[c,r,i,l,z,h,s,O,m,D,G,L]),Ho((()=>{var e;if(!c||i||!E||g||!V.current)return;const t=E.nodesRef.current,n=null==(e=t.find((e=>e.id===C)))||null==(e=e.context)?void 0:e.elements.floating,r=na(ca(i)),a=t.some((e=>e.context&&ra(e.context.elements.floating,r)));n&&!a&&A.current&&n.focus({preventScroll:!0})}),[c,i,E,C,g]),Ho((()=>{if(c&&E&&g&&!C)return E.events.on("virtualfocus",e),()=>{E.events.off("virtualfocus",e)};function e(e){U(e.id),x&&(x.current=e)}}),[c,E,g,C,x]),Ho((()=>{I.current=D,V.current=!!i})),Ho((()=>{r||(R.current=null)}),[r]);const Q=null!=l,K=t.useMemo((()=>{function e(e){if(!r)return;const t=s.current.indexOf(e);-1!==t&&D(t)}const t={onFocus(t){let{currentTarget:n}=t;e(n)},onClick:e=>{let{currentTarget:t}=e;return t.focus({preventScroll:!0})},...y&&{onMouseMove(t){let{currentTarget:n}=t;e(n)},onPointerLeave(e){let{pointerType:t}=e;A.current&&"touch"!==t&&(T.current=-1,G(s,T),D(null),g||qo(B.current,{preventScroll:!0}))}}};return t}),[r,B,G,y,s,D,g]);return t.useMemo((()=>{if(!c)return{};const e=L.current;function t(t){if(A.current=!1,M.current=!0,!$.current&&t.currentTarget===B.current)return;if(h&&qi(t.key,O,m))return ha(t),a(!1,t.nativeEvent,"list-navigation"),void(Hr(o)&&!g&&o.focus());const n=T.current,i=Mo(s,e),l=Fo(s,e);if("Home"===t.key&&(ha(t),T.current=i,D(T.current)),"End"===t.key&&(ha(t),T.current=l,D(T.current)),S>1){const n=P||Array.from({length:s.current.length},(()=>({width:1,height:1}))),r=function(e,t,n){const r=[];let a=0;return e.forEach(((e,o)=>{let{width:i,height:s}=e,l=!1;for(n&&(a=0);!l;){const e=[];for(let n=0;n<i;n++)for(let r=0;r<s;r++)e.push(a+n+r*t);a%t+i<=t&&e.every((e=>null==r[e]))?(e.forEach((e=>{r[e]=o})),l=!0):a++}})),[...r]}(n,S,j),a=r.findIndex((t=>null!=t&&!Bo(s.current,t,e))),o=r.reduce(((t,n,r)=>null==n||Bo(s.current,n,e)?t:r),-1);if(T.current=r[function(e,t){let{event:n,orientation:r,loop:a,cols:o,disabledIndices:i,minIndex:s,maxIndex:l,prevIndex:u,stopEvent:c=!1}=t,d=u;if(n.key===ko){if(c&&ha(n),-1===u)d=l;else if(d=Lo(e,{startingIndex:d,amount:o,decrement:!0,disabledIndices:i}),a&&(u-o<s||d<0)){const e=u%o,t=l%o,n=l-(t-e);d=t===e?l:t>e?n:n-o}Vo(e,d)&&(d=u)}if(n.key===To&&(c&&ha(n),-1===u?d=s:(d=Lo(e,{startingIndex:u,amount:o,disabledIndices:i}),a&&u+o>l&&(d=Lo(e,{startingIndex:u%o-o,amount:o,disabledIndices:i}))),Vo(e,d)&&(d=u)),"both"===r){const t=va(u/o);n.key===Ao&&(c&&ha(n),u%o!=o-1?(d=Lo(e,{startingIndex:u,disabledIndices:i}),a&&Io(d,o,t)&&(d=Lo(e,{startingIndex:u-u%o-1,disabledIndices:i}))):a&&(d=Lo(e,{startingIndex:u-u%o-1,disabledIndices:i})),Io(d,o,t)&&(d=u)),n.key===Ro&&(c&&ha(n),u%o!=0?(d=Lo(e,{startingIndex:u,decrement:!0,disabledIndices:i}),a&&Io(d,o,t)&&(d=Lo(e,{startingIndex:u+(o-u%o),decrement:!0,disabledIndices:i}))):a&&(d=Lo(e,{startingIndex:u+(o-u%o),decrement:!0,disabledIndices:i})),Io(d,o,t)&&(d=u));const r=va(l/o)===t;Vo(e,d)&&(d=a&&r?n.key===Ro?l:Lo(e,{startingIndex:u-u%o-1,disabledIndices:i}):u)}return d}({current:r.map((e=>null!=e?s.current[e]:null))},{event:t,orientation:O,loop:f,cols:S,disabledIndices:No([...e||s.current.map(((e,t)=>Bo(s.current,t)?t:void 0)),void 0],r),minIndex:a,maxIndex:o,prevIndex:$o(T.current>l?i:T.current,n,r,S,t.key===To?"bl":t.key===Ao?"tr":"tl"),stopEvent:!0})],D(T.current),"both"===O)return}if(Bi(t.key,O)){if(ha(t),r&&!g&&na(t.currentTarget.ownerDocument)===t.currentTarget)return T.current=zi(t.key,O,m)?i:l,void D(T.current);zi(t.key,O,m)?T.current=f?n>=l?p&&n!==s.current.length?-1:i:Lo(s,{startingIndex:n,disabledIndices:e}):Math.min(l,Lo(s,{startingIndex:n,disabledIndices:e})):T.current=f?n<=i?p&&-1!==n?s.current.length:l:Lo(s,{startingIndex:n,decrement:!0,disabledIndices:e}):Math.max(i,Lo(s,{startingIndex:n,decrement:!0,disabledIndices:e})),Vo(s,T.current)?D(null):D(T.current)}}function n(e){"auto"===b&&ia(e.nativeEvent)&&(k.current=!0)}const i=g&&r&&Q&&{"aria-activedescendant":W||q},l=s.current.find((e=>(null==e?void 0:e.id)===q));return{reference:{...i,onKeyDown(n){A.current=!1;const o=0===n.key.indexOf("Arrow"),i=function(e,t,n){return Ni(t,n?e===Ro:e===Ao,e===To)}(n.key,O,m),u=qi(n.key,O,m),c=Bi(n.key,O),p=(h?i:c)||"Enter"===n.key||""===n.key.trim();if(g&&r){const e=null==E?void 0:E.nodesRef.current.find((e=>null==e.parentId)),r=E&&e?function(e,t){let n,r=-1;return function t(a,o){o>r&&(n=a,r=o),ni(e,a).forEach((e=>{t(e.id,o+1)}))}(t,0),e.find((e=>e.id===n))}(E.nodesRef.current,e.id):null;if(o&&r&&x){const e=new KeyboardEvent("keydown",{key:n.key,bubbles:!0});if(i||u){var f,b;const t=(null==(f=r.context)?void 0:f.elements.domReference)===n.currentTarget,a=u&&!t?null==(b=r.context)?void 0:b.elements.domReference:i?l:null;a&&(ha(n),a.dispatchEvent(e),U(void 0))}var y;if(c&&r.context&&r.context.open&&r.parentId&&n.currentTarget!==r.context.elements.domReference)return ha(n),void(null==(y=r.context.elements.domReference)||y.dispatchEvent(e))}return t(n)}(r||v||!o)&&(p&&(R.current=h&&c?null:n.key),h?i&&(ha(n),r?(T.current=Mo(s,e),D(T.current)):a(!0,n.nativeEvent,"list-navigation")):c&&(null!=d&&(T.current=d),ha(n),!r&&v?a(!0,n.nativeEvent,"list-navigation"):t(n),r&&D(T.current)))},onFocus(){r&&!g&&D(null)},onPointerDown:function(e){k.current=b,"auto"===b&&sa(e.nativeEvent)&&(k.current=!0)},onMouseDown:n,onClick:n},floating:{"aria-orientation":"both"===O?void 0:O,...!ma(o)&&i,onKeyDown:t,onPointerMove(){A.current=!0}},item:K}}),[o,B,q,W,L,$,s,c,O,m,g,r,Q,h,d,v,p,S,f,b,D,a,K,E,x,P,j])}const Wi=new Map([["select","listbox"],["combobox","listbox"],["label",!1]]);function Ui(e,n){var r;void 0===n&&(n={});const{open:a,floatingId:o}=e,{enabled:i=!0,role:s="dialog"}=n,l=null!=(r=Wi.get(s))?r:s,u=Ko(),c=null!=Xo();return t.useMemo((()=>{if(!i)return{};const e={id:o,...l&&{role:l}};return"tooltip"===l||"label"===s?{reference:{["aria-"+("label"===s?"labelledby":"describedby")]:a?o:void 0},floating:e}:{reference:{"aria-expanded":a?"true":"false","aria-haspopup":"alertdialog"===l?"dialog":l,"aria-controls":a?o:void 0,..."listbox"===l&&{role:"combobox"},..."menu"===l&&{id:u},..."menu"===l&&c&&{role:"menuitem"},..."select"===s&&{"aria-autocomplete":"none"},..."combobox"===s&&{"aria-autocomplete":"list"}},floating:{...e,..."menu"===l&&{"aria-labelledby":u}},item(e){let{active:t,selected:n}=e;const r={role:"option",...t&&{id:o+"-option"}};switch(s){case"select":return{...r,"aria-selected":t&&n};case"combobox":return{...r,...t&&{"aria-selected":!0}}}return{}}}}),[i,s,l,a,o,u,c])}function Gi(e,t,n){let r,a=n.initialDeps??[];return()=>{var o,i,s,l;let u;n.key&&(null==(o=n.debug)?void 0:o.call(n))&&(u=Date.now());const c=e(),d=c.length!==a.length||c.some(((e,t)=>a[t]!==e));if(!d)return r;let p;if(a=c,n.key&&(null==(i=n.debug)?void 0:i.call(n))&&(p=Date.now()),r=t(...c),n.key&&(null==(s=n.debug)?void 0:s.call(n))){const e=Math.round(100*(Date.now()-u))/100,t=Math.round(100*(Date.now()-p))/100,r=t/16,a=(e,t)=>{for(e=String(e);e.length<t;)e=" "+e;return e};console.info(`%c⏱ ${a(t,5)} /${a(e,5)} ms`,`\n            font-size: .6rem;\n            font-weight: bold;\n            color: hsl(${Math.max(0,Math.min(120-120*r,120))}deg 100% 31%);`,null==n?void 0:n.key)}return null==(l=null==n?void 0:n.onChange)||l.call(n,r),r}}function Qi(e,t){if(void 0===e)throw new Error("Unexpected undefined"+(t?`: ${t}`:""));return e}const Ki=(e,t,n)=>{let r;return function(...a){e.clearTimeout(r),r=e.setTimeout((()=>t.apply(this,a)),n)}},Yi=e=>e,Zi=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let e=t;e<=n;e++)r.push(e);return r},Xi=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const a=e=>{const{width:n,height:r}=e;t({width:Math.round(n),height:Math.round(r)})};if(a(n.getBoundingClientRect()),!r.ResizeObserver)return()=>{};const o=new r.ResizeObserver((e=>{const t=e[0];if(null==t?void 0:t.borderBoxSize){const e=t.borderBoxSize[0];if(e)return void a({width:e.inlineSize,height:e.blockSize})}a(n.getBoundingClientRect())}));return o.observe(n,{box:"border-box"}),()=>{o.unobserve(n)}},Ji={passive:!0},es="undefined"==typeof window||"onscrollend"in window,ts=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let a=0;const o=es?()=>{}:Ki(r,(()=>{t(a,!1)}),e.options.isScrollingResetDelay),i=r=>()=>{const{horizontal:i,isRtl:s}=e.options;a=i?n.scrollLeft*(s?-1:1):n.scrollTop,o(),t(a,r)},s=i(!0),l=i(!1);return l(),n.addEventListener("scroll",s,Ji),n.addEventListener("scrollend",l,Ji),()=>{n.removeEventListener("scroll",s),n.removeEventListener("scrollend",l)}},ns=(e,t,n)=>{if(null==t?void 0:t.borderBoxSize){const e=t.borderBoxSize[0];if(e)return Math.round(e[n.options.horizontal?"inlineSize":"blockSize"])}return Math.round(e.getBoundingClientRect()[n.options.horizontal?"width":"height"])},rs=(e,{adjustments:t=0,behavior:n},r)=>{var a,o;const i=e+t;null==(o=null==(a=r.scrollElement)?void 0:a.scrollTo)||o.call(a,{[r.options.horizontal?"left":"top"]:i,behavior:n})};class as{constructor(e){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let e=null;const t=()=>e||(this.targetWindow&&this.targetWindow.ResizeObserver?e=new this.targetWindow.ResizeObserver((e=>{e.forEach((e=>{this._measureElement(e.target,e)}))})):null);return{disconnect:()=>{var e;return null==(e=t())?void 0:e.disconnect()},observe:e=>{var n;return null==(n=t())?void 0:n.observe(e,{box:"border-box"})},unobserve:e=>{var n;return null==(n=t())?void 0:n.unobserve(e)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach((([t,n])=>{void 0===n&&delete e[t]})),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:Yi,rangeExtractor:Zi,onChange:()=>{},measureElement:ns,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,...e}},this.notify=(e,t)=>{var n,r;const{startIndex:a,endIndex:o}=this.range??{startIndex:void 0,endIndex:void 0},i=this.calculateRange();(e||a!==(null==i?void 0:i.startIndex)||o!==(null==i?void 0:i.endIndex))&&(null==(r=(n=this.options).onChange)||r.call(n,this,t))},this.cleanup=()=>{this.unsubs.filter(Boolean).forEach((e=>e())),this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.observer.disconnect(),this.elementsCache.clear()},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var e;const t=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==t){if(this.cleanup(),!t)return void this.notify(!1,!1);this.scrollElement=t,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=(null==(e=this.scrollElement)?void 0:e.window)??null,this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,(e=>{this.scrollRect=e,this.notify(!1,!1)}))),this.unsubs.push(this.options.observeElementOffset(this,((e,t)=>{this.scrollAdjustments=0,this.scrollDirection=t?this.getScrollOffset()<e?"forward":"backward":null,this.scrollOffset=e;const n=this.isScrolling;this.isScrolling=t,this.notify(n!==t,t)})))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??("function"==typeof this.options.initialOffset?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(e,t)=>{const n=new Map,r=new Map;for(let a=t-1;a>=0;a--){const t=e[a];if(n.has(t.lane))continue;const o=r.get(t.lane);if(null==o||t.end>o.end?r.set(t.lane,t):t.end<o.end&&n.set(t.lane,!0),n.size===this.options.lanes)break}return r.size===this.options.lanes?Array.from(r.values()).sort(((e,t)=>e.end===t.end?e.index-t.index:e.end-t.end))[0]:void 0},this.getMeasurementOptions=Gi((()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled]),((e,t,n,r,a)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:t,scrollMargin:n,getItemKey:r,enabled:a})),{key:!1}),this.getMeasurements=Gi((()=>[this.getMeasurementOptions(),this.itemSizeCache]),(({count:e,paddingStart:t,scrollMargin:n,getItemKey:r,enabled:a},o)=>{var i;if(!a)return this.measurementsCache=[],this.itemSizeCache.clear(),[];0===this.measurementsCache.length&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach((e=>{this.itemSizeCache.set(e.key,e.size)})));const s=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const l=this.measurementsCache.slice(0,s);for(let a=s;a<e;a++){let e=null==(i=this.measurementsCache[a])?void 0:i.measureElement;e||(e=e=>{const t=r(a),n=this.elementsCache.get(t);e?(n!==e&&(n&&this.observer.unobserve(n),this.observer.observe(e),this.elementsCache.set(t,e)),e.isConnected&&this.resizeItem(a,this.options.measureElement(e,void 0,this))):n&&(this.observer.unobserve(n),this.elementsCache.delete(t))});const s=r(a),u=1===this.options.lanes?l[a-1]:this.getFurthestMeasurement(l,a),c=u?u.end+this.options.gap:t+n,d=o.get(s),p="number"==typeof d?d:this.options.estimateSize(a),f=c+p,h=u?u.lane:a%this.options.lanes;l[a]={index:a,start:c,size:p,end:f,key:s,lane:h,measureElement:e}}return this.measurementsCache=l,l}),{key:!1,debug:()=>this.options.debug}),this.calculateRange=Gi((()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset()]),((e,t,n)=>this.range=e.length>0&&t>0?function({measurements:e,outerSize:t,scrollOffset:n}){const r=e.length-1,a=os(0,r,(t=>e[t].start),n);let o=a;for(;o<r&&e[o].end<n+t;)o++;return{startIndex:a,endIndex:o}}({measurements:e,outerSize:t,scrollOffset:n}):null),{key:!1,debug:()=>this.options.debug}),this.getIndexes=Gi((()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count]),((e,t,n,r)=>null===t?[]:e({startIndex:t.startIndex,endIndex:t.endIndex,overscan:n,count:r})),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const t=this.options.indexAttribute,n=e.getAttribute(t);return n?parseInt(n,10):(console.warn(`Missing attribute name '${t}={index}' on measured element.`),-1)},this._measureElement=(e,t)=>{const n=this.indexFromElement(e),r=this.getMeasurements()[n];if(!r||!e.isConnected)return void this.elementsCache.forEach(((t,n)=>{t===e&&(this.observer.unobserve(e),this.elementsCache.delete(n))}));const a=this.elementsCache.get(r.key);a!==e&&(a&&this.observer.unobserve(a),this.observer.observe(e),this.elementsCache.set(r.key,e)),this.resizeItem(n,this.options.measureElement(e,t,this))},this.resizeItem=(e,t)=>{const n=this.getMeasurements()[e];if(!n)return;const r=t-(this.itemSizeCache.get(n.key)??n.size);0!==r&&((void 0!==this.shouldAdjustScrollPositionOnItemSizeChange?this.shouldAdjustScrollPositionOnItemSizeChange(n,r,this):n.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=r,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(n.index),this.itemSizeCache=new Map(this.itemSizeCache.set(n.key,t)),this.notify(!0,!1))},this.measureElement=e=>{e&&this._measureElement(e,void 0)},this.getVirtualItems=Gi((()=>[this.getIndexes(),this.getMeasurements()]),((e,t)=>{const n=[];for(let r=0,a=e.length;r<a;r++){const a=t[e[r]];n.push(a)}return n}),{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const t=this.getMeasurements();if(0!==t.length)return Qi(t[os(0,t.length-1,(e=>Qi(t[e]).start),e)])},this.getOffsetForAlignment=(e,t)=>{const n=this.getSize(),r=this.getScrollOffset();"auto"===t&&(t=e<=r?"start":e>=r+n?"end":"start"),"start"===t||("end"===t?e-=n:"center"===t&&(e-=n/2));const a=this.options.horizontal?"scrollWidth":"scrollHeight",o=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[a]:this.scrollElement[a]:0)-n;return Math.max(Math.min(o,e),0)},this.getOffsetForIndex=(e,t="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const n=this.getMeasurements()[e];if(!n)return;const r=this.getSize(),a=this.getScrollOffset();if("auto"===t)if(n.end>=a+r-this.options.scrollPaddingEnd)t="end";else{if(!(n.start<=a+this.options.scrollPaddingStart))return[a,t];t="start"}const o="end"===t?n.end+this.options.scrollPaddingEnd:n.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(o,t),t]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{null!==this.scrollToIndexTimeoutId&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:t="start",behavior:n}={})=>{this.cancelScrollToIndex(),"smooth"===n&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,t),{adjustments:void 0,behavior:n})},this.scrollToIndex=(e,{align:t="auto",behavior:n}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),"smooth"===n&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const r=this.getOffsetForIndex(e,t);if(!r)return;const[a,o]=r;this._scrollToOffset(a,{adjustments:void 0,behavior:n}),"smooth"!==n&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout((()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(e))){const[a]=Qi(this.getOffsetForIndex(e,o));t=a,r=this.getScrollOffset(),Math.abs(t-r)<1||this.scrollToIndex(e,{align:o,behavior:n})}else this.scrollToIndex(e,{align:o,behavior:n});var t,r})))},this.scrollBy=(e,{behavior:t}={})=>{this.cancelScrollToIndex(),"smooth"===t&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+e,{adjustments:void 0,behavior:t})},this.getTotalSize=()=>{var e;const t=this.getMeasurements();let n;return n=0===t.length?this.options.paddingStart:1===this.options.lanes?(null==(e=t[t.length-1])?void 0:e.end)??0:Math.max(...t.slice(-this.options.lanes).map((e=>e.end))),n-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(e,{adjustments:t,behavior:n})=>{this.options.scrollToFn(e,{behavior:n,adjustments:t},this)},this.measure=()=>{var e,t;this.itemSizeCache=new Map,null==(t=(e=this.options).onChange)||t.call(e,this,!1)},this.setOptions(e)}}const os=(e,t,n,r)=>{for(;e<=t;){const a=(e+t)/2|0,o=n(a);if(o<r)e=a+1;else{if(!(o>r))return a;t=a-1}}return e>0?e-1:0},is="undefined"!=typeof document?t.useLayoutEffect:t.useEffect;function ss(e){return function(e){const n=t.useReducer((()=>({})),{})[1],r={...e,onChange:(t,r)=>{var a;r?(0,eo.flushSync)(n):n(),null==(a=e.onChange)||a.call(e,t,r)}},[a]=t.useState((()=>new as(r)));return a.setOptions(r),t.useEffect((()=>a._didMount()),[]),is((()=>a._willUpdate())),a}({observeElementRect:Xi,observeElementOffset:ts,scrollToFn:rs,...e})}var ls=Object.defineProperty,us=Object.getOwnPropertySymbols,cs=Object.prototype.hasOwnProperty,ds=Object.prototype.propertyIsEnumerable,ps=(e,t,n)=>t in e?ls(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const fs=(0,t.forwardRef)((function(e,n){var a=e,{children:o,active:i,addGroupBottomBorder:s,isMultiValueEdit:l,checked:u}=a,c=((e,t)=>{var n={};for(var r in e)cs.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&us)for(var r of us(e))t.indexOf(r)<0&&ds.call(e,r)&&(n[r]=e[r]);return n})(a,["children","active","addGroupBottomBorder","isMultiValueEdit","checked"]);const d=(0,Sn.useStyles2)(hs),p=(0,t.useId)();return r().createElement("div",((e,t)=>{for(var n in t||(t={}))cs.call(t,n)&&ps(e,n,t[n]);if(us)for(var n of us(t))ds.call(t,n)&&ps(e,n,t[n]);return e})({ref:n,role:"option",id:p,"aria-selected":i,className:(0,Pn.cx)(d.option,i&&d.optionFocused,s&&d.groupBottomBorder)},c),r().createElement("div",{className:d.optionBody,"data-testid":`data-testid ad hoc filter option value ${o}`},r().createElement("span",null,l?r().createElement(Sn.Checkbox,{tabIndex:-1,checked:u,className:d.checkbox}):null,o)))})),hs=e=>({option:(0,Pn.css)({label:"grafana-select-option",top:0,left:0,width:"100%",position:"absolute",padding:e.spacing(1),display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer","&:hover":{background:e.colors.action.hover,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${e.colors.primary.border}`}}}),optionFocused:(0,Pn.css)({label:"grafana-select-option-focused",background:e.colors.action.focus,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${e.colors.primary.border}`}}),optionBody:(0,Pn.css)({label:"grafana-select-option-body",display:"flex",fontWeight:e.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),groupBottomBorder:(0,Pn.css)({borderBottom:`1px solid ${e.colors.border.weak}`}),checkbox:(0,Pn.css)({paddingRight:e.spacing(.5)}),multiValueApplyWrapper:(0,Pn.css)({position:"fixed",top:0,left:0,display:"flex",backgroundColor:e.colors.background.primary,color:e.colors.text.primary,boxShadow:e.shadows.z2,overflowY:"auto",zIndex:e.zIndex.dropdown,gap:e.spacing(1.5),padding:`${e.spacing(1.5)} ${e.spacing(1)}`})}),ms=()=>r().createElement(fs,{onClick:e=>e.stopPropagation()},"Loading options..."),gs=()=>r().createElement(fs,{onClick:e=>e.stopPropagation()},"No options found"),bs=({handleFetchOptions:e})=>r().createElement(fs,{onClick:e},"An error has occurred fetching labels. Click to retry"),ys=({onApply:e,floatingElement:t,maxOptionWidth:n,menuHeight:a})=>{const o=(0,Sn.useStyles2)(hs),i=null==t?void 0:t.getBoundingClientRect();return r().createElement("div",{className:o.multiValueApplyWrapper,style:{width:`${n}px`,transform:`translate(${null==i?void 0:i.left}px,${i?i.top+a:0}px)`}},r().createElement(Sn.Button,{onClick:e,size:"sm",tabIndex:-1},"Apply"))},vs={key:"operator",operator:"value",value:"key"},ws=(e,t,n,r)=>Os(vs[e],t,"value"===e?n:void 0,r),Os=(e,t,n,r)=>{t(e),null==n||n(),setTimeout((()=>null==r?void 0:r.focus()))},Ss=({filterInputType:e,item:t,filter:n,setFilterMultiValues:r})=>{var a,o,i,s,l;if("key"===e)return{key:t.value,keyLabel:t.label?t.label:t.value};if("value"===e)return{value:t.value,valueLabels:[t.label?t.label:t.value]};if("operator"===e){if(dl(n.operator)&&!dl(t.value))return r([]),{operator:t.value,valueLabels:[(null==(a=n.valueLabels)?void 0:a[0])||(null==(o=n.values)?void 0:o[0])||n.value],values:void 0};if(dl(t.value)&&!dl(n.operator)){const e=[(null==(i=n.valueLabels)?void 0:i[0])||(null==(s=n.values)?void 0:s[0])||n.value],a=[n.value];return a[0]&&r([{value:a[0],label:null!=(l=null==e?void 0:e[0])?l:a[0]}]),{operator:t.value,valueLabels:e,values:a}}}return{[e]:t.value}},_s="Filter by label values",xs=(e,t,n,r)=>{var a;return"key"===t?_s:"value"===t?n?"Edit values":(null==(a=e.valueLabels)?void 0:a[0])||"":e[t]&&!r?`${e[t]}`:_s};function Ps(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}var js=Object.defineProperty,Cs=Object.defineProperties,Es=Object.getOwnPropertyDescriptors,Ds=Object.getOwnPropertySymbols,ks=Object.prototype.hasOwnProperty,Ts=Object.prototype.propertyIsEnumerable,Rs=(e,t,n)=>t in e?js(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,As=(e,t)=>{for(var n in t||(t={}))ks.call(t,n)&&Rs(e,n,t[n]);if(Ds)for(var n of Ds(t))Ts.call(t,n)&&Rs(e,n,t[n]);return e},Is=(e,t)=>Cs(e,Es(t));const Vs=(0,t.forwardRef)((function({filter:e,model:n,isAlwaysWip:a,handleChangeViewMode:o},i){var s,l,u;const[c,d]=(0,t.useState)(!1),[p,f]=(0,t.useState)([]),[h,m]=(0,t.useState)(!1),[g,b]=(0,t.useState)(!1),[y,v]=(0,t.useState)(""),[w,O]=(0,t.useState)(null),[S,_]=(0,t.useState)(a?"key":"value"),x=(0,Sn.useStyles2)(Fs),[P,j]=(0,t.useState)([]),[C,E]=(0,t.useState)({}),D=(0,t.useRef)(null),k=dl((null==e?void 0:e.operator)||""),T=k&&"value"===S,R=(0,t.useId)(),A=(0,t.useRef)([]),I=(0,t.useRef)([]),V=(0,t.useMemo)((()=>function(e){const t=new In,n=[],r=1e4;return(a,o)=>{var i;if(""===a)return e.length>r?e.slice(0,r):e;if("operator"===o){const t=[];for(let n=0;n<e.length;n++)if((null==(i=e[n].label||e[n].value)?void 0:i.includes(a))&&(t.push(e[n]),t.length>r))return t;return t}if(0===n.length)for(let t=0;t<e.length;t++)n.push(e[t].label||e[t].value);const[s,l,u]=t.search(n,a),c=[];if(s){for(let t=0;t<s.length;t++){if(l&&u){const n=u[t];c.push(e[s[n]])}else c.push(e[s[t]]);if(c.length>r)return c}return c}return e.length>r?e.slice(0,r):e}}(p)),[p]),M=(0,t.useCallback)((()=>{a&&(n._addWip(),_("key"),v(""))}),[n,a]),F=(0,t.useCallback)(((e,t,n,r)=>{if(n.length){const r=[],a=[];n.forEach((e=>{var t;r.push(null!=(t=e.label)?t:e.value),a.push(e.value)})),e._updateFilter(t,{valueLabels:r,values:a,value:a[0]}),j([])}r||setTimeout((()=>{var e;return null==(e=B.domReference.current)?void 0:e.focus()}))}),[]),L=(0,t.useCallback)((e=>{j((t=>t.some((t=>t.value===e.value))?t.filter((t=>t.value!==e.value)):[...t,e]))}),[]),$=(0,t.useCallback)(((t,r,a)=>{d(t),a&&["outside-press","escape-key"].includes(a)&&(T&&F(n,e,P),M(),null==o||o())}),[e,P,o,F,M,T,n]),N=(0,t.useMemo)((()=>[R,...P.map(((e,t)=>`${e.value}-${t}`))]),[R,P]),{refs:B,floatingStyles:z,context:q,getReferenceProps:H,getFloatingProps:W,getItemProps:U}=(({open:e,onOpenChange:t,activeIndex:n,setActiveIndex:r,outsidePressIdsToIgnore:a,listRef:o,disabledIndicesRef:i})=>{const{refs:s,floatingStyles:l,context:u}=Ii({whileElementsMounted:Ya,open:e,onOpenChange:t,placement:"bottom-start",middleware:[io(10),so({padding:10}),lo({apply({availableHeight:e,availableWidth:t,elements:n}){n.floating.style.maxHeight=`${Math.min(300,e)}px`,n.floating.style.maxWidth=`${t}px`},padding:10})],strategy:"fixed"}),c=Ui(u,{role:"listbox"}),d=Ai(u,{outsidePress:e=>{var t;if(e.currentTarget instanceof Element){const n=e.currentTarget;let r=n.id;if("path"===n.nodeName&&(r=(null==(t=n.parentElement)?void 0:t.id)||""),a.includes(r))return!1}return!0}}),p=Hi(u,{listRef:o,activeIndex:n,onNavigate:r,virtual:!0,loop:!0,disabledIndices:i.current}),{getReferenceProps:f,getFloatingProps:h,getItemProps:m}=Li([c,d,p]);return{refs:s,floatingStyles:l,context:u,getReferenceProps:f,getFloatingProps:h,getItemProps:m}})({open:c,onOpenChange:$,activeIndex:w,setActiveIndex:O,outsidePressIdsToIgnore:N,listRef:A,disabledIndicesRef:I});(0,t.useImperativeHandle)(i,(()=>()=>{var e;return null==(e=B.domReference.current)?void 0:e.focus()}),[B.domReference]);const G=(0,t.useCallback)((e=>{j((t=>t.filter((t=>t.value!==e.value)))),setTimeout((()=>{var e;return null==(e=B.domReference.current)?void 0:e.focus()}))}),[B.domReference]),Q=(e=>e.flatMap((e=>e.options?[e,...e.options]:[e])))(Bl(V(y,S)));"operator"!==S&&y&&Q.push({value:y.trim(),label:y.trim(),isCustom:!0});const K=((e,t,n)=>{var r,a,o,i;let s=182;const l=[],u=[];for(let t=0;t<e.length;t++){l.push(null),(null==(r=e[t])?void 0:r.options)&&u.push(t);let n=null!=(o=null!=(a=e[t].label)?a:e[t].value)?o:"",c=8;8*n.length<6*((null==(i=e[t].description)?void 0:i.length)||0)&&(n=e[t].description,c=6);const d=(e[t].isCustom?n.length+18:n.length)*c+16;d>s&&(s=d)}return t.current=[...l],n.current=[...u],s})(Q,A,I),Y=(0,t.useCallback)(function(){var t,r=(t=function*(t){var r;b(!1),m(!0),f([]);let a=[];try{"key"===t?a=yield n._getKeys(null):"operator"===t?a=n._getOperators():"value"===t&&(a=yield n._getValuesFor(e)),f(a),(null==(r=a[0])?void 0:r.group)&&O(1)}catch(e){b(!0)}m(!1)},function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){Ps(o,r,a,i,s,"next",e)}function s(e){Ps(o,r,a,i,s,"throw",e)}i(void 0)}))});return function(e){return r.apply(this,arguments)}}(),[e,n]),Z=ss({count:Q.length,getScrollElement:()=>B.floating.current,estimateSize:e=>Q[e].description?60:38,overscan:5}),X=(0,t.useCallback)(((e,t)=>{"Backspace"!==e.key||y||(t?j((e=>{const t=[...e];return t.splice(-1,1),t})):"key"===S&&(n._removeLastFilter(),Y(S)))}),[y,S,n,Y]),J=(0,t.useCallback)(((t,r)=>{var a;"Tab"!==t.key||t.shiftKey||(r&&(t.preventDefault(),F(n,e,P),null==(a=B.domReference.current)||a.focus()),null==o||o(),M())}),[e,P,o,F,M,n,B.domReference]),ee=(0,t.useCallback)(((t,r)=>{"Tab"===t.key&&t.shiftKey&&(r&&(t.preventDefault(),F(n,e,P,!0)),null==o||o(),M())}),[e,P,o,F,M,n]),te=(0,t.useCallback)(((t,r)=>{if("Enter"===t.key&&null!=w){if(!Q[w])return;const t=Q[w];r?L(t):(n._updateFilter(e,Ss({filterInputType:S,item:t,filter:e,setFilterMultiValues:j})),ws(S,_,o,B.domReference.current),O(0)),v("")}}),[w,e,S,Q,L,o,n,B.domReference]);(0,t.useEffect)((()=>{c&&Y(S)}),[c,S]),(0,t.useEffect)((()=>{var t,n;if(!a){if(_("value"),v(""),k&&(null==(t=null==e?void 0:e.values)?void 0:t.length)){const t=e.values.reduce(((t,n,r)=>{var a;return[...t,{label:(null==(a=e.valueLabels)?void 0:a[r])||n,value:n}]}),[]);j(t)}null==(n=B.domReference.current)||n.focus()}}),[]),(0,t.useEffect)((()=>{T&&P&&setTimeout((()=>E({})))}),[P,T]),(0,t.useLayoutEffect)((()=>{var e,t;null!==w&&Z.range&&(w>(null==(e=Z.range)?void 0:e.endIndex)||w<(null==(t=Z.range)?void 0:t.startIndex))&&Z.scrollToIndex(w)}),[w,Z]);const ne=null!=(s=null==e?void 0:e.keyLabel)?s:null==e?void 0:e.key;return r().createElement("div",{className:x.comboboxWrapper},e?r().createElement("div",{className:x.pillWrapper},(null==e?void 0:e.key)?r().createElement("div",{className:(0,Pn.cx)(x.basePill,x.keyPill)},ne):null,(null==e?void 0:e.key)&&(null==e?void 0:e.operator)&&"operator"!==S?r().createElement("div",{id:R,className:(0,Pn.cx)(x.basePill,x.operatorPill,R),role:"button","aria-label":"Edit filter operator",tabIndex:0,onClick:e=>{e.stopPropagation(),Os("operator",_,void 0,B.domReference.current)},onKeyDown:e=>{ee(e,k),"Enter"===e.key&&Os("operator",_,void 0,B.domReference.current)}},e.operator):null,r().createElement("div",{ref:D}),T?P.map(((e,t)=>r().createElement(Ms,{key:`${e.value}-${t}`,item:e,index:t,handleRemoveMultiValue:G}))):null):null,r().createElement("input",Is(As({},H({ref:B.setReference,onChange:function(e){const t=e.target.value;v(t),O(0)},value:y,placeholder:xs(e,S,T,a),"aria-autocomplete":"list",onKeyDown(e){c?("operator"===S&&ee(e),X(e,T),J(e,T),te(e,T)):d(!0)}})),{className:(0,Pn.cx)(x.inputStyle,{[x.loadingInputPadding]:!h}),onClick:e=>{e.stopPropagation(),d(!0)},onFocus:()=>{O(0),d(!0)}})),h?r().createElement(Sn.Spinner,{className:x.loadingIndicator,inline:!0}):null,r().createElement(Si,null,c&&r().createElement(Di,{context:q,initialFocus:-1,visuallyHiddenDismiss:!0,modal:!1},r().createElement(r().Fragment,null,r().createElement("div",{style:Is(As({},z),{width:`${g?366:K}px`,transform:T?`translate(${(null==(l=D.current)?void 0:l.getBoundingClientRect().left)||0}px, ${((null==(u=B.domReference.current)?void 0:u.getBoundingClientRect().bottom)||0)+10}px )`:z.transform}),ref:B.setFloating,className:x.dropdownWrapper,tabIndex:-1},r().createElement("div",Is(As({style:{height:`${Z.getTotalSize()||38}px`}},W()),{tabIndex:-1}),h?r().createElement(ms,null):g?r().createElement(bs,{handleFetchOptions:()=>Y(S)}):Q.length||"operator"!==S&&y?Z.getVirtualItems().map((t=>{var a;const i=Q[t.index],s=t.index;if(i.options)return r().createElement("div",{key:`${i.label}+${s}`,className:(0,Pn.cx)(x.optionGroupLabel,x.groupTopBorder),style:{height:`${t.size}px`,transform:`translateY(${t.start}px)`}},r().createElement(Sn.Text,{weight:"bold",variant:"bodySmall",color:"secondary"},i.label));const l=Q[t.index+1],u=l&&!l.group&&!l.options&&i.group;return r().createElement(fs,Is(As({},U({key:`${i.value}-${s}`,ref(e){A.current[s]=e},onClick(t){var r;"value"!==S&&t.stopPropagation(),T?(t.preventDefault(),t.stopPropagation(),L(i),null==(r=B.domReference.current)||r.focus()):(n._updateFilter(e,Ss({filterInputType:S,item:i,filter:e,setFilterMultiValues:j})),v(""),ws(S,_,o,B.domReference.current))}})),{active:w===s,addGroupBottomBorder:u,style:{height:`${t.size}px`,transform:`translateY(${t.start}px)`},"aria-setsize":Q.length,"aria-posinset":t.index+1,isMultiValueEdit:T,checked:P.some((e=>e.value===i.value))}),r().createElement("span",null,i.isCustom?"Use custom value: ":""," ",null!=(a=i.label)?a:i.value),i.description?r().createElement("div",{className:x.descriptionText},i.description):null)})):r().createElement(gs,null))),T&&!h&&!g&&Q.length?r().createElement(ys,{onApply:()=>{F(n,e,P)},floatingElement:B.floating.current,maxOptionWidth:K,menuHeight:Math.min(Z.getTotalSize(),300)}):null))))})),Ms=({item:e,handleRemoveMultiValue:t,index:n})=>{var a,o;const i=(0,Sn.useStyles2)(Fs);return r().createElement("div",{className:(0,Pn.cx)(i.basePill,i.valuePill)},r().createElement("span",null," ",null!=(a=e.label)?a:e.value),r().createElement(Sn.Button,{onClick:n=>{n.stopPropagation(),n.preventDefault(),t(e)},onKeyDownCapture:n=>{"Enter"===n.key&&(n.preventDefault(),n.stopPropagation(),t(e))},fill:"text",size:"sm",variant:"secondary",className:i.removeButton,tooltip:`Remove filter value - ${null!=(o=e.label)?o:e.value}`},r().createElement(Sn.Icon,{name:"times",size:"md",id:`${e.value}-${n}`})))},Fs=e=>({comboboxWrapper:(0,Pn.css)({display:"flex",flexWrap:"wrap"}),pillWrapper:(0,Pn.css)({display:"flex",alignItems:"center",flexWrap:"wrap"}),basePill:(0,Pn.css)(Is(As({display:"flex",alignItems:"center",background:e.colors.action.disabledBackground,border:`1px solid ${e.colors.border.weak}`,padding:e.spacing(.125,1,.125,1),color:e.colors.text.primary,overflow:"hidden",whiteSpace:"nowrap",minHeight:e.spacing(2.75)},e.typography.bodySmall),{cursor:"pointer"})),keyPill:(0,Pn.css)({fontWeight:e.typography.fontWeightBold,cursor:"default"}),operatorPill:(0,Pn.css)({"&:hover":{background:e.colors.action.hover}}),valuePill:(0,Pn.css)({background:e.colors.action.selected,padding:e.spacing(.125,0,.125,1)}),dropdownWrapper:(0,Pn.css)({backgroundColor:e.colors.background.primary,color:e.colors.text.primary,boxShadow:e.shadows.z2,overflowY:"auto",zIndex:e.zIndex.dropdown}),inputStyle:(0,Pn.css)({paddingBlock:0,"&:focus":{outline:"none"}}),loadingIndicator:(0,Pn.css)({color:e.colors.text.secondary,marginLeft:e.spacing(.5)}),loadingInputPadding:(0,Pn.css)({paddingRight:e.spacing(2.5)}),optionGroupLabel:(0,Pn.css)({padding:e.spacing(1),position:"absolute",top:0,left:0,width:"100%"}),groupTopBorder:(0,Pn.css)({"&:not(:first-child)":{borderTop:`1px solid ${e.colors.border.weak}`}}),removeButton:(0,Pn.css)({marginInline:e.spacing(.5),height:"100%",padding:0,cursor:"pointer","&:hover":{color:e.colors.text.primary}}),descriptionText:(0,Pn.css)(Is(As({},e.typography.bodySmall),{color:e.colors.text.secondary,paddingTop:e.spacing(.5)})),multiValueApply:(0,Pn.css)({position:"absolute",top:0,left:0,display:"flex"})});var Ls=Object.defineProperty,$s=Object.defineProperties,Ns=Object.getOwnPropertyDescriptors,Bs=Object.getOwnPropertySymbols,zs=Object.prototype.hasOwnProperty,qs=Object.prototype.propertyIsEnumerable,Hs=(e,t,n)=>t in e?Ls(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ws=(e,t)=>{for(var n in t||(t={}))zs.call(t,n)&&Hs(e,n,t[n]);if(Bs)for(var n of Bs(t))qs.call(t,n)&&Hs(e,n,t[n]);return e};function Us({filter:e,model:n,readOnly:a,focusOnInputRef:o}){var i,s,l;const u=(0,Sn.useStyles2)(Gs),[c,d]=(0,t.useState)(!0),[p,f]=(0,t.useState)(!1),h=(0,t.useRef)(null),m=null!=(i=e.keyLabel)?i:e.key,g=(null==(s=e.valueLabels)?void 0:s.join(", "))||(null==(l=e.values)?void 0:l.join(", "))||e.value,b=(0,t.useCallback)((e=>{null==e||e.stopPropagation(),a||(f(!c),d(!c))}),[a,c]);if((0,t.useEffect)((()=>{var e;p&&(null==(e=h.current)||e.focus(),f(!1))}),[p]),c){const t=r().createElement("span",{className:u.pillText},m," ",e.operator," ",g);return r().createElement("div",{className:(0,Pn.cx)(u.combinedFilterPill,{[u.readOnlyCombinedFilter]:a}),onClick:b,onKeyDown:e=>{"Enter"===e.key&&b()},role:"button","aria-label":`Edit filter with key ${m}`,tabIndex:0,ref:h},g.length<20?t:r().createElement(Sn.Tooltip,{content:r().createElement("div",{className:u.tooltipText},g),placement:"top"},t),a?null:r().createElement(Sn.IconButton,{onClick:t=>{t.stopPropagation(),n._removeFilter(e),setTimeout((()=>null==o?void 0:o()))},onKeyDownCapture:t=>{"Enter"===t.key&&(t.preventDefault(),t.stopPropagation(),n._removeFilter(e),setTimeout((()=>null==o?void 0:o())))},name:"times",size:"md",className:u.removeButton,tooltip:`Remove filter with key ${m}`}))}return r().createElement(Vs,{filter:e,model:n,handleChangeViewMode:b})}const Gs=e=>{return{combinedFilterPill:(0,Pn.css)((t=Ws({display:"flex",alignItems:"center",background:e.colors.action.selected,borderRadius:e.shape.radius.default,border:`1px solid ${e.colors.border.weak}`,padding:e.spacing(.125,0,.125,1),color:e.colors.text.primary,overflow:"hidden",whiteSpace:"nowrap",minHeight:e.spacing(2.75)},e.typography.bodySmall),n={fontWeight:e.typography.fontWeightBold,cursor:"pointer","&:hover":{background:e.colors.action.hover}},$s(t,Ns(n)))),readOnlyCombinedFilter:(0,Pn.css)({paddingRight:e.spacing(1),cursor:"text","&:hover":{background:e.colors.action.selected}}),removeButton:(0,Pn.css)({marginInline:e.spacing(.5),cursor:"pointer","&:hover":{color:e.colors.text.primary}}),pillText:(0,Pn.css)({maxWidth:"200px",width:"100%",textOverflow:"ellipsis",overflow:"hidden"}),tooltipText:(0,Pn.css)({textAlign:"center"})};var t,n},Qs=(0,t.forwardRef)((function({model:e},n){const{_wip:a}=e.useState();return(0,t.useLayoutEffect)((()=>{a||e._addWip()}),[a]),r().createElement(Vs,{model:e,filter:a,isAlwaysWip:!0,ref:n})})),Ks=(0,t.memo)((function({model:e}){const{filters:n,readOnly:a}=e.useState(),o=(0,Sn.useStyles2)(Ys),i=(0,t.useRef)();return r().createElement("div",{className:(0,Pn.cx)(o.comboboxWrapper,{[o.comboboxFocusOutline]:!a}),onClick:()=>{var e;null==(e=i.current)||e.call(i)}},r().createElement(Sn.Icon,{name:"filter",className:o.filterIcon,size:"lg"}),n.map(((t,n)=>r().createElement(Us,{key:n,filter:t,model:e,readOnly:a,focusOnInputRef:i.current}))),a?null:r().createElement(Qs,{model:e,ref:i}))})),Ys=e=>({comboboxWrapper:(0,Pn.css)({display:"flex",flexWrap:"wrap",alignItems:"center",columnGap:e.spacing(1),rowGap:e.spacing(.5),minHeight:e.spacing(4),backgroundColor:e.components.input.background,border:`1px solid ${e.colors.border.strong}`,borderRadius:e.shape.radius.default,paddingInline:e.spacing(1),paddingBlock:e.spacing(.5),flexGrow:1}),comboboxFocusOutline:(0,Pn.css)({"&:focus-within":{outline:"2px dotted transparent",outlineOffset:"2px",boxShadow:`0 0 0 2px ${e.colors.background.canvas}, 0 0 0px 4px ${e.colors.primary.main}`,transitionTimingFunction:"cubic-bezier(0.19, 1, 0.22, 1)",transitionDuration:"0.2s",transitionProperty:"outline, outline-offset, box-shadow",zIndex:2}}),filterIcon:(0,Pn.css)({color:e.colors.text.secondary,alignSelf:"center"})});function Zs(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function Xs(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){Zs(o,r,a,i,s,"next",e)}function s(e){Zs(o,r,a,i,s,"throw",e)}i(void 0)}))}}var Js=Object.defineProperty,el=Object.getOwnPropertySymbols,tl=Object.prototype.hasOwnProperty,nl=Object.prototype.propertyIsEnumerable,rl=(e,t,n)=>t in e?Js(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,al=(e,t)=>{for(var n in t||(t={}))tl.call(t,n)&&rl(e,n,t[n]);if(el)for(var n of el(t))nl.call(t,n)&&rl(e,n,t[n]);return e};const ol=[{value:"=",description:"Equals"},{value:"!=",description:"Not equal"},{value:"=|",description:"One of. Use to filter on multiple values.",isMulti:!0},{value:"!=|",description:"Not one of. Use to exclude multiple values.",isMulti:!0},{value:"=~",description:"Matches regex"},{value:"!~",description:"Does not match regex"},{value:"<",description:"Less than"},{value:">",description:"Greater than"}];class il extends ae{setState(e){let t=!1;e.filters&&e.filters!==this.state.filters&&!e.filterExpression&&(e.filterExpression=sl(this.state.expressionBuilder,e.filters),t=e.filterExpression!==this.state.filterExpression),super.setState(e),t&&this.publishEvent(new rt(this),!0)}getValue(){return this.state.filterExpression}_updateFilter(e,t){const{filters:n,_wip:r}=this.state;if(e===r)return void("value"in t&&""!==t.value?this.setState({filters:[...n,al(al({},r),t)],_wip:void 0}):this.setState({_wip:al(al({},e),t)}));const a=this.state.filters.map((n=>n===e?al(al({},n),t):n));this.setState({filters:a})}_removeFilter(e){e!==this.state._wip?this.setState({filters:this.state.filters.filter((t=>t!==e))}):this.setState({_wip:void 0})}_removeLastFilter(){const e=this.state.filters.at(-1);e&&this._removeFilter(e)}_getKeys(e){var t=this;return Xs((function*(){var n,r,a;const o=yield null==(r=(n=t.state).getTagKeysProvider)?void 0:r.call(n,t,e);if(o&&o.replace)return $l(o.values).map(ul);if(t.state.defaultKeys)return t.state.defaultKeys.map(ul);const i=yield t._dataSourceSrv.get(t.state.datasource,t._scopedVars);if(!i||!i.getTagKeys)return[];const s=t.state.filters.filter((t=>t.key!==e)).concat(null!=(a=t.state.baseFilters)?a:[]),l=yu.getTimeRange(t).state.value,u=t.state.useQueriesAsFilterForOptions?Il(t):void 0,c=yield i.getTagKeys(al({filters:s,queries:u,timeRange:l},nr(t)));Nl(c)&&t.setState({error:c.error.message});let d=$l(c);o&&(d=d.concat($l(o.values)));const p=t.state.tagKeyRegexFilter;return p&&(d=d.filter((e=>e.text.match(p)))),d.map(ul)}))()}_getValuesFor(e){var t=this;return Xs((function*(){var n,r,a;const o=yield null==(r=(n=t.state).getTagValuesProvider)?void 0:r.call(n,t,e);if(o&&o.replace)return $l(o.values).map(ul);const i=yield t._dataSourceSrv.get(t.state.datasource,t._scopedVars);if(!i||!i.getTagValues)return[];const s=t.state.filters.filter((t=>t.key!==e.key)).concat(null!=(a=t.state.baseFilters)?a:[]),l=yu.getTimeRange(t).state.value,u=t.state.useQueriesAsFilterForOptions?Il(t):void 0,c=yield i.getTagValues(al({key:e.key,filters:s,timeRange:l,queries:u},nr(t)));Nl(c)&&t.setState({error:c.error.message});let d=$l(c);return o&&(d=d.concat($l(o.values))),d.map(ul)}))()}_addWip(){this.setState({_wip:{key:"",value:"",operator:"=",condition:""}})}_getOperators(){return(this.state.supportsMultiValueOperators?ol:ol.filter((e=>!e.isMulti))).map((({value:e,description:t})=>({label:e,value:e,description:t})))}constructor(e){var t,n;super(al({type:"adhoc",name:null!=(t=e.name)?t:"Filters",filters:[],datasource:null,applyMode:"auto",filterExpression:null!=(n=e.filterExpression)?n:sl(e.expressionBuilder,e.filters)},e)),this._scopedVars={__sceneObject:ir(this)},this._dataSourceSrv=(0,d.getDataSourceSrv)(),this._urlSync=new Mr(this),"auto"===this.state.applyMode&&function(e){if(e.addActivationHandler((()=>(vn.add(e),()=>vn.delete(e)))),yn)return;const t=(0,d.getTemplateSrv)();(null==t?void 0:t.getAdhocFilters)?(yn=t.getAdhocFilters,t.getAdhocFilters=function(e){var n;if(0===vn.size)return yn.call(t);const r=(0,d.getDataSourceSrv)().getInstanceSettings(e);if(!r)return[];for(const e of vn.values())if((null==(n=e.state.datasource)?void 0:n.uid)===r.uid)return e.state.filters;return[]}.bind(t)):console.log("Failed to patch getAdhocFilters")}(this)}}function sl(e,t){return(null!=e?e:kl)(null!=t?t:[])}il.Component=function({model:e}){const{filters:t,readOnly:n,addFilterButtonText:a}=e.useState(),o=(0,Sn.useStyles2)(ll);return"combobox"===e.state.layout?r().createElement(Ks,{model:e}):r().createElement("div",{className:o.wrapper},t.map(((t,n)=>r().createElement(r().Fragment,{key:n},r().createElement(Ar,{filter:t,model:e})))),!n&&r().createElement(Vr,{model:e,key:"'builder",addFilterButtonText:a}))};const ll=e=>({wrapper:(0,Pn.css)({display:"flex",flexWrap:"wrap",alignItems:"flex-end",columnGap:e.spacing(2),rowGap:e.spacing(1)})});function ul(e){const{text:t,value:n}=e,r={label:t,value:String(null!=n?n:t)};return"group"in e&&(r.group=e.group),r}function cl(e){return""!==e.key&&""!==e.operator&&""!==e.value}function dl(e){const t=ol.find((t=>t.value===e));return!!t&&Boolean(t.isMulti)}class pl{getMergedStream(e){(function(e,t){if(e.length!==t.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!0;return!1})(e,this._prevLayers)&&(this._resultsMap=new Map,this._prevLayers=e);const t=e.map((e=>e.getResultsStream())),n=[];for(const t of e)n.push(t.activate());return(0,k.merge)(t).pipe((0,k.mergeAll)(),(0,k.filter)((e=>this._resultsMap.get(e.origin.state.key)!==e)),(0,k.map)((e=>(this._resultsMap.set(e.origin.state.key,e),this._resultsMap.values()))),(0,k.finalize)((()=>{n.forEach((e=>e()))})))}constructor(){this._resultsMap=new Map,this._prevLayers=[]}}function fl(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}var hl=Object.defineProperty,ml=Object.defineProperties,gl=Object.getOwnPropertyDescriptors,bl=Object.getOwnPropertySymbols,yl=Object.prototype.hasOwnProperty,vl=Object.prototype.propertyIsEnumerable,wl=(e,t,n)=>t in e?hl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ol=(e,t)=>{for(var n in t||(t={}))yl.call(t,n)&&wl(e,n,t[n]);if(bl)for(var n of bl(t))vl.call(t,n)&&wl(e,n,t[n]);return e},Sl=(e,t)=>ml(e,gl(t));let _l=100;function xl(){return"SQR"+_l++}class Pl extends ae{getResultsStream(){return this._results}_onActivate(){if(this.isQueryModeAuto()){const e=yu.getTimeRange(this),t=this.getClosestExtraQueryProviders();for(const e of t)this._subs.add(e.subscribeToState(((t,n)=>{e.shouldRerun(n,t,this.state.queries)&&this.runQueries()})));this.subscribeToTimeRangeChanges(e),this.shouldRunQueriesOnActivate()&&this.runQueries()}return this._dataLayersSub||this._handleDataLayers(),()=>this._onDeactivate()}_handleDataLayers(){const e=yu.getDataLayers(this);0!==e.length&&(this._dataLayersSub=this._dataLayersMerger.getMergedStream(e).subscribe(this._onLayersReceived.bind(this)))}_onLayersReceived(t){var n,r,a,o,i;const s=yu.getTimeRange(this),{dataLayerFilter:l}=this.state;let u,c=[],d=[];for(const a of t)for(let t of a.data.series)(null==(n=t.meta)?void 0:n.dataTopic)===e.DataTopic.Annotations&&(c=c.concat(t)),(null==(r=t.meta)?void 0:r.dataTopic)===e.DataTopic.AlertStates&&(d=d.concat(t));if((null==l?void 0:l.panelId)&&(c.length>0&&(c=function(e,t){var n;if(!Array.isArray(e)||0===e.length)return e;const r=Array.from({length:e.length},(()=>new Set));let a=0;for(const o of e){for(let e=0;e<o.length;e++){if(r[a].has(e))continue;let i=!0;const s=o.fields.find((e=>"panelId"===e.name)),l=o.fields.find((e=>"source"===e.name));if(l){s&&"dashboard"===l.values[e].type&&(i=s.values[e]===t.panelId);const r=l.values[e].filter;if(r){const e=(null!=(n=r.ids)?n:[]).includes(t.panelId);r.exclude?e&&(i=!1):e||(i=!1)}}i&&r[a].add(e)}a++}const o=[];a=0;for(const t of e){const e=r[a].size,n=[];for(const e of t.fields){const o=[];for(let n=0;n<t.length;n++)r[a].has(n)&&o.push(e.values[n]);n.push(gn(mn({},e),{values:o}))}o.push(gn(mn({},t),{fields:n,length:e})),a++}return o}(c,l)),d.length>0))for(const t of d){const n=new e.DataFrameView(t);for(const e of n)if(e.panelId===l.panelId){u=e;break}}if(Cl(c)&&Cl(this._layerAnnotations)&&(0,be.isEqual)(u,null==(a=this.state.data)?void 0:a.alertState))return;this._layerAnnotations=c;const p=this.state.data?this.state.data:Sl(Ol({},Be),{timeRange:s.state.value});this.setState({data:Sl(Ol({},p),{annotations:[...null!=(o=this._resultAnnotations)?o:[],...c],alertState:null!=u?u:null==(i=this.state.data)?void 0:i.alertState})})}onVariableUpdatesCompleted(){this.isQueryModeAuto()&&this.runQueries()}onAnyVariableChanged(e){this._adhocFiltersVar!==e&&this._groupByVar!==e&&this.isQueryModeAuto()&&(e instanceof il&&this._isRelevantAutoVariable(e)&&this.runQueries(),e instanceof br&&this._isRelevantAutoVariable(e)&&this.runQueries())}_isRelevantAutoVariable(e){var t,n;const r=null!=(t=this.state.datasource)?t:jl(this.state.queries);return"auto"===e.state.applyMode&&(null==r?void 0:r.uid)===(null==(n=e.state.datasource)?void 0:n.uid)}shouldRunQueriesOnActivate(){return this._variableValueRecorder.hasDependenciesChanged(this)?(Gt("SceneQueryRunner","Variable dependency changed while inactive, shouldRunQueriesOnActivate returns true"),!0):!this.state.data||!!this._isDataTimeRangeStale(this.state.data)}_isDataTimeRangeStale(e){const t=yu.getTimeRange(this).state.value,n=e.timeRange;return(t.from.unix()!==n.from.unix()||t.to.unix()!==n.to.unix())&&(Gt("SceneQueryRunner","Data time range is stale"),!0)}_onDeactivate(){var e;this._querySub&&(this._querySub.unsubscribe(),this._querySub=void 0),this._dataLayersSub&&(this._dataLayersSub.unsubscribe(),this._dataLayersSub=void 0),null==(e=this._timeSub)||e.unsubscribe(),this._timeSub=void 0,this._timeSubRange=void 0,this._adhocFiltersVar=void 0,this._groupByVar=void 0,this._variableValueRecorder.recordCurrentDependencyValuesForSceneObject(this)}setContainerWidth(e){!this._containerWidth&&e>0?(this._containerWidth=e,this.state.maxDataPointsFromWidth&&!this.state.maxDataPoints&&setTimeout((()=>{this.isActive&&!this.state._hasFetchedData&&this.runQueries()}),0)):e>0&&(this._containerWidth=e)}isDataReadyToDisplay(){return Boolean(this.state._hasFetchedData)}subscribeToTimeRangeChanges(e){this._timeSubRange!==e&&(this._timeSub&&this._timeSub.unsubscribe(),this._timeSubRange=e,this._timeSub=e.subscribeToState((()=>{this.runWithTimeRange(e)})))}runQueries(){const e=yu.getTimeRange(this);this.isQueryModeAuto()&&this.subscribeToTimeRangeChanges(e),this.runWithTimeRange(e)}getMaxDataPoints(){var e;return this.state.maxDataPoints?this.state.maxDataPoints:this.state.maxDataPointsFromWidth&&null!=(e=this._containerWidth)?e:500}cancelQuery(){var e;null==(e=this._querySub)||e.unsubscribe(),this._dataLayersSub&&(this._dataLayersSub.unsubscribe(),this._dataLayersSub=void 0),this.setState({data:Sl(Ol({},this.state.data),{state:Ie.Done})})}runWithTimeRange(e){var t,n=this;return(t=function*(){var t,r,a;if(!n.state.maxDataPoints&&n.state.maxDataPointsFromWidth&&!n._containerWidth)return;if(n._dataLayersSub||n._handleDataLayers(),null==(t=n._querySub)||t.unsubscribe(),n._variableDependency.hasDependencyInLoadingState())return Gt("SceneQueryRunner","Variable dependency is in loading state, skipping query execution"),void n.setState({data:Sl(Ol({},null!=(r=n.state.data)?r:Be),{state:Ie.Loading})});const{queries:o}=n.state;if(null==o?void 0:o.length)try{const t=null!=(a=n.state.datasource)?a:jl(o),r=yield Kt(t,n._scopedVars);n.findAndSubscribeToAdHocFilters(null==t?void 0:t.uid);const i=(0,d.getRunRequest)(),{primary:s,secondaries:l,processors:u}=n.prepareRequests(e,r);Gt("SceneQueryRunner","Starting runRequest",n.state.key);let c=i(r,s);if(l.length>0){const e=l.map((e=>i(r,e))),t=(e=>t=>t.pipe((0,k.mergeMap)((([t,...n])=>{const r=n.flatMap((n=>{var r,a;return null!=(a=null==(r=e.get(n.request.requestId))?void 0:r(t,n))?a:(0,k.of)(n)}));return(0,k.forkJoin)([(0,k.of)(t),...r])})),(0,k.map)((([e,...t])=>{var n,r,a;return r=((e,t)=>{for(var n in t||(t={}))rn.call(t,n)&&on(e,n,t[n]);if(nn)for(var n of nn(t))an.call(t,n)&&on(e,n,t[n]);return e})({},e),a={series:[...e.series,...t.flatMap((e=>e.series))],annotations:[...null!=(n=e.annotations)?n:[],...t.flatMap((e=>{var t;return null!=(t=e.annotations)?t:[]}))]},en(r,tn(a))}))))(u);c=(0,k.forkJoin)([c,...e]).pipe(t)}c=c.pipe(wn({type:"data",request:s,origin:n,cancel:()=>n.cancelQuery()})),n._querySub=c.subscribe(n.onDataReceived)}catch(e){console.error("PanelQueryRunner Error",e),n.onDataReceived(Sl(Ol(Ol({},Be),n.state.data),{state:Ie.Error,errors:[(0,d.toDataQueryError)(e)]}))}else n._setNoDataState()},function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){fl(o,r,a,i,s,"next",e)}function s(e){fl(o,r,a,i,s,"throw",e)}i(void 0)}))})()}clone(e){var t;const n=super.clone(e);return this._resultAnnotations&&(n._resultAnnotations=this._resultAnnotations.map((e=>Ol({},e)))),this._layerAnnotations&&(n._layerAnnotations=this._layerAnnotations.map((e=>Ol({},e)))),n._variableValueRecorder=this._variableValueRecorder.cloneAndRecordCurrentValuesForSceneObject(this),n._containerWidth=this._containerWidth,n._results.next({origin:this,data:null!=(t=this.state.data)?t:Be}),n}prepareRequests(t,n){var r;const{minInterval:a,queries:o}=this.state;let i=Ol({app:"scenes",requestId:xl(),timezone:t.getTimeZone(),range:t.state.value,interval:"1s",intervalMs:1e3,targets:(0,be.cloneDeep)(o),maxDataPoints:this.getMaxDataPoints(),scopedVars:this._scopedVars,startTime:Date.now(),liveStreaming:this.state.liveStreaming,rangeRaw:{from:t.state.from,to:t.state.to},cacheTimeout:this.state.cacheTimeout,queryCachingTTL:this.state.queryCachingTTL},bn(this));this._adhocFiltersVar&&(i.filters=this._adhocFiltersVar.state.filters.filter(cl)),this._groupByVar&&(i.groupByKeys=this._groupByVar.state.value),i.targets=i.targets.map((e=>{var t;return e.datasource&&(e.datasource.uid===n.uid||(null==(t=n.meta)?void 0:t.mixed)||!d.isExpressionReference||(0,d.isExpressionReference)(e.datasource))||(e.datasource=n.getRef()),e}));const s=a?hu(this,a):n.interval,l=e.rangeUtil.calculateInterval(t.state.value,i.maxDataPoints,s);i.scopedVars=Object.assign({},i.scopedVars,{__interval:{text:l.interval,value:l.interval},__interval_ms:{text:l.intervalMs.toString(),value:l.intervalMs}}),i.interval=l.interval,i.intervalMs=l.intervalMs;const u=t.state.value;let c=[],p=new Map;for(const e of null!=(r=this.getClosestExtraQueryProviders())?r:[])for(const{req:t,processor:n}of e.getExtraQueries(i)){const e=xl();c.push(Sl(Ol({},t),{requestId:e})),p.set(e,null!=n?n:sn)}return i.range=u,{primary:i,secondaries:c,processors:p}}_combineDataLayers(e){return this._layerAnnotations&&this._layerAnnotations.length>0&&(e.annotations=(e.annotations||[]).concat(this._layerAnnotations)),this.state.data&&this.state.data.alertState&&(e.alertState=this.state.data.alertState),e}_setNoDataState(){this.state.data!==Be&&this.setState({data:Be})}getClosestExtraQueryProviders(){const e=new Map;return this.parent?(he(this.parent,(t=>(Xt(t)&&!e.has(t.constructor)&&e.set(t.constructor,t),t.forEachChild((t=>{Xt(t)&&!e.has(t.constructor)&&e.set(t.constructor,t)})),null))),Array.from(e.values())):[]}findAndSubscribeToAdHocFilters(e){const t=function(e){var t;for(const n of vn.values())if((null==(t=n.state.datasource)?void 0:t.uid)===e)return n}(e);this._adhocFiltersVar!==t&&(this._adhocFiltersVar=t,this._updateExplicitVariableDependencies());const n=function(e){var t;for(const n of On.values())if((null==(t=n.state.datasource)?void 0:t.uid)===e)return n}(e);this._groupByVar!==n&&(this._groupByVar=n,this._updateExplicitVariableDependencies())}_updateExplicitVariableDependencies(){const e=[];this._adhocFiltersVar&&e.push(this._adhocFiltersVar.state.name),this._groupByVar&&e.push(this._groupByVar.state.name),this._variableDependency.setVariableNames(e)}isQueryModeAuto(){var e;return"auto"===(null!=(e=this.state.runQueriesMode)?e:"auto")}constructor(t){super(t),this._dataLayersMerger=new pl,this._variableValueRecorder=new Zt,this._results=new k.ReplaySubject(1),this._scopedVars={__sceneObject:ir(this)},this._variableDependency=new zl(this,{statePaths:["queries","datasource"],onVariableUpdateCompleted:this.onVariableUpdatesCompleted.bind(this),onAnyVariableChanged:this.onAnyVariableChanged.bind(this)}),this.onDataReceived=t=>{const n=(0,e.preProcessPanelData)(t,this.state.data);this._resultAnnotations=t.annotations;const r=this._combineDataLayers(n);let a=this.state._hasFetchedData;a||n.state===Ie.Loading||(a=!0),this.setState({data:r,_hasFetchedData:a}),this._results.next({origin:this,data:r})},this.addActivationHandler((()=>this._onActivate()))}}function jl(e){var t,n;return null!=(n=null==(t=e.find((e=>null!==e.datasource)))?void 0:t.datasource)?n:void 0}function Cl(e){if(!e)return!0;for(let t=0;t<e.length;t++)if(e[t].length>0)return!1;return!0}function El(e,t){return e===t||(0,be.isEqual)(e,t)}function Dl(e){try{return JSON.stringify(e,(()=>{const e=new WeakSet;return(t,n)=>{if("object"==typeof n&&null!==n){if(e.has(n))return;e.add(n)}return n}})())}catch(e){console.error(e)}return""}function kl(e){return e.map((e=>function(e){var t,n;let r="",a=e.operator;return"=|"===a?(a="=~",r=null==(t=e.values)?void 0:t.map(Rl).join("|")):"!=|"===a?(a="!~",r=null==(n=e.values)?void 0:n.map(Rl).join("|")):r="=~"===a||"!~"===a?Rl(e.value):Tl(e.value),`${e.key}${a}"${r}"`}(e))).join(",")}function Tl(e){return e.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function Rl(e){return Tl(e.replace(Al,"\\$&"))}const Al=/[*+?()|\\.\[\]{}^$]/g;function Il(e){const t=function(e){const t={};for(const n of e)n.state.key&&(n.state.key in t||(t[n.state.key]=[]),t[n.state.key].push(n));return Object.values(t).flatMap((e=>{const t=e.filter((e=>e.isActive));return 0===t.length&&1===e.length?e:t}))}(yu.findAllObjects(e.getRoot(),(e=>e instanceof Pl))).filter((t=>{var n,r;return(null==(n=t.state.datasource)?void 0:n.uid)===(null==(r=e.state.datasource)?void 0:r.uid)}));if(0===t.length)return[];const n=[];return t.forEach((e=>{n.push(...e.state.queries)})),n}function Vl(e){return null==e?"":/\|/g[Symbol.replace](e,"__gfp__")}function Ml(e){return null==e?"":/,/g[Symbol.replace](e,"__gfc__")}function Fl(e){return null==e?"":(e=/__gfp__/g[Symbol.replace](e,"|"),e=/__gfc__/g[Symbol.replace](e,","))}function Ll(e,t){return t&&e!==t?[e,t].map(Ml).join(","):Ml(e)}function $l(e){return Array.isArray(e)?e:e.data}function Nl(e){return!Array.isArray(e)&&Boolean(e.error)}function Bl(e){const t=[],n=new Map;for(const r of e){const e=r.group;if(e){let a=n.get(e);a||(a=[],n.set(e,a),t.push({label:e,options:a})),a.push(r)}else t.push(r)}return t}class zl{hasDependencyOn(e){return this.getNames().has(e)}variableUpdateCompleted(t,n){const r=this.getNames();let a=!1;(r.has(t.state.name)||r.has(e.DataLinkBuiltInVars.includeVars))&&n&&(a=!0),Gt("VariableDependencyConfig","variableUpdateCompleted",t.state.name,a,this._isWaitingForVariables),this._options.onAnyVariableChanged&&this._options.onAnyVariableChanged(t),this._options.onVariableUpdateCompleted&&(this._isWaitingForVariables||a)&&this._options.onVariableUpdateCompleted(),a&&(this._options.onReferencedVariableValueChanged&&this._options.onReferencedVariableValueChanged(t),this._options.onReferencedVariableValueChanged||this._options.onVariableUpdateCompleted||this._sceneObject.forceRender())}hasDependencyInLoadingState(){return yu.hasVariableDependencyInLoadingState(this._sceneObject)?(this._isWaitingForVariables=!0,!0):(this._isWaitingForVariables=!1,!1)}getNames(){const e=this._state,t=this._state=this._sceneObject.state;if(!e)return this.scanStateForDependencies(this._state),this._dependencies;if(t!==e)if(this._statePaths){for(const n of this._statePaths)if("*"===n||t[n]!==e[n]){this.scanStateForDependencies(t);break}}else this.scanStateForDependencies(t);return this._dependencies}setVariableNames(e){this._options.variableNames=e,this.scanStateForDependencies(this._state)}setPaths(e){this._statePaths=e}scanStateForDependencies(e){if(this._dependencies.clear(),this.scanCount+=1,this._options.variableNames)for(const e of this._options.variableNames)this._dependencies.add(e);if(this._statePaths)for(const t of this._statePaths){if("*"===t){this.extractVariablesFrom(e);break}{const n=e[t];n&&this.extractVariablesFrom(n)}}}extractVariablesFrom(e){wt.lastIndex=0;const t=("string"!=typeof e?Dl(e):e).matchAll(wt);if(t)for(const e of t){const[,t,n,,r]=e,a=t||n||r;this._dependencies.add(a)}}constructor(e,t){this._sceneObject=e,this._options=t,this._dependencies=new Set,this._isWaitingForVariables=!1,this.scanCount=0,this._statePaths=t.statePaths}}const ql=e=>Boolean(e.metricFindQuery)&&!Boolean(e.variables),Hl=t=>{if(!t.variables)return!1;if(t.variables.getType()!==e.VariableSupportType.Standard)return!1;const n=t.variables;return"toDataQuery"in n&&Boolean(n.toDataQuery)},Wl=t=>{if(!t.variables)return!1;if(t.variables.getType()!==e.VariableSupportType.Custom)return!1;const n=t.variables;return"query"in n&&"editor"in n&&Boolean(n.query)&&Boolean(n.editor)};var Ul=Object.defineProperty,Gl=Object.defineProperties,Ql=Object.getOwnPropertyDescriptors,Kl=Object.getOwnPropertySymbols,Yl=Object.prototype.hasOwnProperty,Zl=Object.prototype.propertyIsEnumerable,Xl=(e,t,n)=>t in e?Ul(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Jl=(e,t)=>{for(var n in t||(t={}))Yl.call(t,n)&&Xl(e,n,t[n]);if(Kl)for(var n of Kl(t))Zl.call(t,n)&&Xl(e,n,t[n]);return e},eu=(e,t)=>Gl(e,Ql(t));class tu{getTarget(e){if(Hl(this.datasource))return this.datasource.variables.toDataQuery(function(e){var t;const n=null!=(t=e.state.query)?t:"";return"string"==typeof n?{query:n,refId:`variable-${e.state.name}`}:null==n.refId?eu(Jl({},n),{refId:`variable-${e.state.name}`}):e.state.query}(e));throw new Error("Couldn't create a target with supplied arguments.")}runRequest(e,t){return Hl(this.datasource)?this.datasource.variables.query?this._runRequest(this.datasource,t,this.datasource.variables.query.bind(this.datasource.variables)):this._runRequest(this.datasource,t):au()}constructor(e,t=(0,d.getRunRequest)()){this.datasource=e,this._runRequest=t}}class nu{getTarget(e){if(ql(this.datasource))return e.state.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({variable:t,searchFilter:n},r){return ql(this.datasource)?(0,k.from)(this.datasource.metricFindQuery(t.state.query,eu(Jl({},r),{variable:{name:t.state.name,type:t.state.type},searchFilter:n}))).pipe((0,k.mergeMap)((t=>{if(!t||!t.length)return au();const n=t;return(0,k.of)({series:n,state:e.LoadingState.Done,timeRange:r.range})}))):au()}constructor(e){this.datasource=e}}class ru{getTarget(e){if(Wl(this.datasource))return e.state.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest(e,t){return Wl(this.datasource)?this.datasource.variables.query?this._runRequest(this.datasource,t,this.datasource.variables.query.bind(this.datasource.variables)):this._runRequest(this.datasource,t):au()}constructor(e,t=(0,d.getRunRequest)()){this.datasource=e,this._runRequest=t}}function au(){return(0,k.of)({state:e.LoadingState.Done,series:[],timeRange:(0,e.getDefaultTimeRange)()})}const ou=(e,t)=>{const n=[];let r=null;t.lastIndex=0;do{r=t.exec(e),r&&n.push(r)}while(t.global&&r&&""!==r[0]&&void 0!==r[0]);return n};function iu(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}var su=Object.defineProperty,lu=Object.getOwnPropertySymbols,uu=Object.prototype.hasOwnProperty,cu=Object.prototype.propertyIsEnumerable,du=(e,t,n)=>t in e?su(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class pu extends jt{getValueOptions(t){return this.state.query?(this.setState({loading:!0,error:null}),(0,k.from)(Kt(this.state.datasource,{__sceneObject:ir(this)})).pipe((0,k.mergeMap)((n=>{const r=function(e){if(Hl(e))return new tu(e,(0,d.getRunRequest)());if(ql(e))return new nu(e);if(Wl(e))return new ru(e);throw new Error(`Couldn't create a query runner for datasource ${e.type}`)}(n),a=r.getTarget(this),o=this.getRequest(a,t.searchFilter);return r.runRequest({variable:this,searchFilter:t.searchFilter},o).pipe(wn({type:"variable",request:o,origin:this}),(0,k.filter)((t=>t.state===e.LoadingState.Done||t.state===e.LoadingState.Error)),(0,k.take)(1),(0,k.mergeMap)((t=>t.state===e.LoadingState.Error?(0,k.throwError)((()=>t.error)):(0,k.of)(t))),(t=>t.pipe((0,k.map)((t=>{const n=t.series;if(!n||!n.length)return[];if(function(t){if(!t)return!1;if(!t.length)return!0;const n=t[0];if((0,e.isDataFrame)(n))return!1;for(const e in n){if(!n.hasOwnProperty(e))continue;if(null!==n[e]&&"string"!=typeof n[e]&&"number"!=typeof n[e])continue;const t=e.toLowerCase();if("text"===t||"value"===t)return!0}return!1}(n))return n;if(0===n[0].fields.length)return[];const r=(0,e.getProcessedDataFrames)(n),a=[];let o=-1,i=-1,s=-1,l=-1;for(const t of r)for(let r=0;r<t.fields.length;r++){const a=t.fields[r],u=(0,e.getFieldDisplayName)(a,t,n).toLowerCase();a.type===e.FieldType.string&&-1===s&&(s=r),"text"===u&&a.type===e.FieldType.string&&-1===i&&(i=r),"value"===u&&a.type===e.FieldType.string&&-1===o&&(o=r),"expandable"!==u||a.type!==e.FieldType.boolean&&a.type!==e.FieldType.number||-1!==l||(l=r)}if(-1===s)throw new Error("Couldn't find any field of type string in the results.");for(const e of n)for(let t=0;t<e.length;t++){const n=-1!==l?e.fields[l].values.get(t):void 0,r=e.fields[s].values.get(t),u=-1!==i?e.fields[i].values.get(t):null,c=-1!==o?e.fields[o].values.get(t):null;-1!==o||-1!==i?-1!==o||-1===i?-1===o||-1!==i?a.push({text:u,value:c,expandable:n}):a.push({text:c,value:c,expandable:n}):a.push({text:u,value:u,expandable:n}):a.push({text:r,value:r,expandable:n})}return a})))),(0,k.mergeMap)((t=>{let n="";return this.state.regex&&(n=yu.interpolate(this,this.state.regex,void 0,"regex")),(0,k.of)(((t,n,r)=>{var a,o,i,s,l,u;let c,d=[];t&&(c=(0,e.stringToJsRegex)(t));for(let e=0;e<r.length;e++){const t=r[e];let n=void 0===t.text||null===t.text?t.value:t.text,p=void 0===t.value||null===t.value?t.text:t.value;if((0,be.isNumber)(p)&&(p=p.toString()),(0,be.isNumber)(n)&&(n=n.toString()),c){const e=ou(p,c);if(!e.length)continue;const t=e.find((e=>e.groups&&e.groups.value)),r=e.find((e=>e.groups&&e.groups.text)),f=e.find((e=>e.length>1)),h=e.length>1&&f;if(t||r)p=null!=(i=null==(a=null==t?void 0:t.groups)?void 0:a.value)?i:null==(o=null==r?void 0:r.groups)?void 0:o.text,n=null!=(u=null==(s=null==r?void 0:r.groups)?void 0:s.text)?u:null==(l=null==t?void 0:t.groups)?void 0:l.value;else{if(h){for(let t=0;t<e.length;t++){const n=e[t];d.push({label:n[1],value:n[1]})}continue}f&&(n=f[1],p=f[1])}}d.push({label:n,value:p})}return d=(0,be.uniqBy)(d,"value"),((t,n)=>{if(n===e.VariableSort.disabled)return t;const r=e=>{if(!e.text)return-1;const t=e.text.match(/.*?(\d+).*/);return!t||t.length<2?-1:parseInt(t[1],10)},a=e=>e.sort(((e,t)=>e.text?t.text?e.text.localeCompare(t.text,void 0,{numeric:!0}):1:-1));switch(n){case e.VariableSort.alphabeticalAsc:t=(0,be.sortBy)(t,"label");break;case e.VariableSort.alphabeticalDesc:t=(0,be.sortBy)(t,"label").reverse();break;case e.VariableSort.numericalAsc:t=(0,be.sortBy)(t,r);break;case e.VariableSort.numericalDesc:t=(t=(0,be.sortBy)(t,r)).reverse();break;case e.VariableSort.alphabeticalCaseInsensitiveAsc:t=(0,be.sortBy)(t,(e=>(0,be.toLower)(e.label)));break;case e.VariableSort.alphabeticalCaseInsensitiveDesc:t=(t=(0,be.sortBy)(t,(e=>(0,be.toLower)(e.label)))).reverse();break;case e.VariableSort.naturalAsc||7:t=a(t);break;case e.VariableSort.naturalDesc||8:t=(t=a(t)).reverse()}return t})(d,n)})(n,this.state.sort,t))})),(0,k.catchError)((e=>e.cancelled?(0,k.of)([]):(0,k.throwError)((()=>e)))))})))):(0,k.of)([])}getRequest(t,n){const r={__sceneObject:ir(this)};n&&(r.__searchFilter={value:n,text:n});const a=yu.getTimeRange(this).state.value;return{app:e.CoreApp.Dashboard,requestId:M(),timezone:"",range:a,interval:"",intervalMs:0,targets:[t],scopedVars:r,startTime:Date.now()}}constructor(t){super(((e,t)=>{for(var n in t||(t={}))uu.call(t,n)&&du(e,n,t[n]);if(lu)for(var n of lu(t))cu.call(t,n)&&du(e,n,t[n]);return e})({type:"query",name:"",value:"",text:"",options:[],datasource:null,regex:"",query:"",refresh:e.VariableRefresh.onDashboardLoad,sort:e.VariableSort.disabled},t)),this._variableDependency=new zl(this,{statePaths:["regex","query","datasource"]}),this.onSearchChange=e=>{Dl(this.state.query).indexOf("__searchFilter")>-1&&this._updateOptionsBasedOnSearchFilter(e)};var n=this;this._updateOptionsBasedOnSearchFilter=(0,be.debounce)(function(){var e,t=(e=function*(e){const t=yield(0,k.lastValueFrom)(n.getValueOptions({searchFilter:e}));n.setState({options:t,loading:!1})},function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){iu(o,r,a,i,s,"next",e)}function s(e){iu(o,r,a,i,s,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),400)}}function fu(e){var t;return null!=(t=he(e,(e=>e.state.$data)))?t:Je}function hu(e,t,n,r,a){return""===t||null==t?"":Nt(e,t,n,r,a)}function mu(e,t,n,r){if(t(e))return e;let a=null;return e.forEachChild((e=>{if(e===n)return;let r=mu(e,t);r&&(a=r)})),a||(r&&e.parent?mu(e.parent,t,e,!0):null)}function gu(e,t){return mu(e,t,void 0,!0)}function bu(e,t){const n=[];return e.forEachChild((e=>{t(e)&&n.push(e),n.push(...bu(e,t))})),n}pu.Component=({model:e})=>er(e);const yu={getVariables:function(e){var t;return null!=(t=he(e,(e=>e.state.$variables)))?t:tt},getData:fu,getTimeRange:nt,getLayout:function(e){return he(e,(e=>function(e){return"isDraggable"in e}(e)?e:void 0))||null},getDataLayers:function(e,t=!1){let n=e,r=[];for(;n;){const e=n.state.$data;if(e){if(qt(e)?r=r.concat(e):e.state.$data&&qt(e.state.$data)&&(r=r.concat(e.state.$data)),t&&r.length>0)break;n=n.parent}else n=n.parent}return r},interpolate:hu,lookupVariable:ye,hasVariableDependencyInLoadingState:function(e){if(!e.variableDependency)return!1;for(const t of e.variableDependency.getNames()){if(e instanceof pu&&e.state.name===t){console.warn("Query variable is referencing itself");continue}const n=ye(t,e);if(n&&n.parent.isVariableLoadingOrWaitingToUpdate(n))return!0}return!1},findByKey:function(e,t){const n=gu(e,(e=>e.state.key===t));if(!n)throw new Error("Unable to find scene with key "+t);return n},findByKeyAndType:function(e,t,n){const r=gu(e,(e=>e.state.key===t));if(!r)throw new Error("Unable to find scene with key "+t);if(!(r instanceof n))throw new Error(`Found scene object with key ${t} does not match type ${n.name}`);return r},findObject:gu,findAllObjects:bu,getAncestor:function(e,t){let n=e;for(;n;){if(n instanceof t)return n;n=n.parent}if(!n)throw new Error("Unable to find parent of type "+t.name);return n},findDescendents:function(e,t){function n(e){return e instanceof t}return bu(e,n).filter(n)},getQueryController:function(e){let t=e;for(;t;){if(t.state.$behaviors)for(const e of t.state.$behaviors)if("isQueryController"in e)return e;t=t.parent}},getUrlSyncManager:function(e){let t=e;for(;t;){if("urlSyncManager"in t.state)return t.state.urlSyncManager;t=t.parent}}};class vu{getUniqueKey(e,t){const n=this.index.get(e);if(!n)return this.index.set(e,[t]),e;let r=n.findIndex((e=>e===t));return-1===r&&(function(e){for(const t of e)if(wu(t)){const n=e.indexOf(t);e.splice(n,1)}}(n),n.push(t),r=n.length-1),r>0?`${e}-${r+1}`:e}clear(){this.index.clear()}constructor(){this.index=new Map}}function wu(e){const t=e.getRoot();return!yu.findObject(t,(t=>t===e))}function Ou(e){const t=new vu,n={},r=e=>{if(e.urlSync){const r=e.urlSync.getUrlState();for(const[a,o]of Object.entries(r))if(null!=o){const r=t.getUniqueKey(a,e);n[r]=o}}e.forEachChild(r)};return r(e),n}function Su(e,t,n,r){r||_u(e,t,n),e.forEachChild((e=>{_u(e,t,n)})),e.forEachChild((e=>Su(e,t,n,!0)))}function _u(e,t,n){if(e.urlSync){const r={},a=e.urlSync.getUrlState();for(const o of e.urlSync.getKeys()){const i=n.getUniqueKey(o,e),s=t.getAll(i),l=a[o];xu(s,l)||(s.length>0?Array.isArray(l)?r[o]=s:r[o]=s[0]:r[o]=null)}Object.keys(r).length>0&&e.urlSync.updateFromUrl(r)}}function xu(e,t){return 0===e.length&&null==t||(Array.isArray(t)||1!==(null==e?void 0:e.length)?0===(null==t?void 0:t.length)&&null===e||(0,be.isEqual)(e,t):t===e[0])}class Pu extends ae{_onVariableChanged(e){const t=this.state.onChange;this._runningEffect&&(this._runningEffect(),this._runningEffect=null);const n=t(e,this);n&&(this._runningEffect=n)}constructor(){super(...arguments),this._runningEffect=null,this._variableDependency=new zl(this,{variableNames:[this.state.variableName],onReferencedVariableValueChanged:this._onVariableChanged.bind(this)})}}var ju=(e=>(e[e.never=0]="never",e[e.onDashboardLoad=1]="onDashboardLoad",e[e.onTimeRangeChanged=2]="onTimeRangeChanged",e))(ju||{}),Cu=(e=>(e[e.alphabeticalAsc=1]="alphabeticalAsc",e[e.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",e[e.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",e[e.alphabeticalDesc=2]="alphabeticalDesc",e[e.disabled=0]="disabled",e[e.naturalAsc=7]="naturalAsc",e[e.naturalDesc=8]="naturalDesc",e[e.numericalAsc=3]="numericalAsc",e[e.numericalDesc=4]="numericalDesc",e))(Cu||{}),Eu=(e=>(e.ContinuousBlPu="continuous-BlPu",e.ContinuousBlYlRd="continuous-BlYlRd",e.ContinuousBlues="continuous-blues",e.ContinuousGrYlRd="continuous-GrYlRd",e.ContinuousGreens="continuous-greens",e.ContinuousPurples="continuous-purples",e.ContinuousRdYlGr="continuous-RdYlGr",e.ContinuousReds="continuous-reds",e.ContinuousYlBl="continuous-YlBl",e.ContinuousYlRd="continuous-YlRd",e.Fixed="fixed",e.PaletteClassic="palette-classic",e.PaletteClassicByName="palette-classic-by-name",e.Shades="shades",e.Thresholds="thresholds",e))(Eu||{}),Du=(e=>(e[e.Crosshair=1]="Crosshair",e[e.Off=0]="Off",e[e.Tooltip=2]="Tooltip",e))(Du||{}),ku=Object.defineProperty,Tu=Object.defineProperties,Ru=Object.getOwnPropertyDescriptors,Au=Object.getOwnPropertySymbols,Iu=Object.prototype.hasOwnProperty,Vu=Object.prototype.propertyIsEnumerable,Mu=(e,t,n)=>t in e?ku(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Fu extends ae{getEventsScope(){if(!this.parent)throw new Error("EnableCursorSync cannot be used as a standalone scene object");return this.state.key}constructor(e){var t,n;super((t=((e,t)=>{for(var n in t||(t={}))Iu.call(t,n)&&Mu(e,n,t[n]);if(Au)for(var n of Au(t))Vu.call(t,n)&&Mu(e,n,t[n]);return e})({},e),n={sync:e.sync||Du.Off},Tu(t,Ru(n)))),this.getEventsBus=e=>{if(!this.parent)throw new Error("EnableCursorSync cannot be used as a standalone scene object");return new Lu(this.parent,e)}}}class Lu{publish(e){e.origin=this,this._eventsOrigin.publishEvent(e,!0)}getStream(e){return new k.Observable((t=>{const n=this._source.subscribeToEvent(e,(e=>{t.next(e)}));return()=>n.unsubscribe()}))}subscribe(e,t){return this.getStream(e).pipe().subscribe(t)}removeAllListeners(){}newScopedBus(e,t){throw new Error("For internal use only")}constructor(e,t){this._source=e,this._eventsOrigin=t}}var $u=function(){},Nu="undefined"!=typeof window;const Bu=Nu?t.useLayoutEffect:t.useEffect;var zu={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};const qu=Nu&&void 0!==window.ResizeObserver?function(){var e=(0,t.useState)(null),n=e[0],r=e[1],a=(0,t.useState)(zu),o=a[0],i=a[1],s=(0,t.useMemo)((function(){return new window.ResizeObserver((function(e){if(e[0]){var t=e[0].contentRect,n=t.x,r=t.y,a=t.width,o=t.height,s=t.top,l=t.left,u=t.bottom,c=t.right;i({x:n,y:r,width:a,height:o,top:s,left:l,bottom:u,right:c})}}))}),[]);return Bu((function(){if(n)return s.observe(n),function(){s.disconnect()}}),[n]),[r,o]}:function(){return[$u,zu]};var Hu=Object.defineProperty,Wu=Object.getOwnPropertySymbols,Uu=Object.prototype.hasOwnProperty,Gu=Object.prototype.propertyIsEnumerable,Qu=(e,t,n)=>t in e?Hu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const Ku=(e,t,n,r,a,o,i,s)=>{const l={dashboardUId:e,dashboardTitle:t,panelTitle:n,panelId:r,expressionData:a,dashboardTime:o,rangeDurationMs:i,unit:s};var u;u={type:"message",payload:{source:"oodle-grafana",eventType:"sendQuery",value:JSON.parse(JSON.stringify(l))}},window.parent.postMessage(u,"*")};function Yu(e,t){if(t)return t;let n=e.error?e.error.message:void 0;return e.errors&&(n=e.errors.map((e=>e.message)).join(", ")),n}const Zu=(0,Pn.css)({position:"relative",width:"100%",height:"100%"}),Xu=(0,Pn.css)({position:"absolute",width:"100%",height:"100%"}),Ju=e=>({ok:(0,Pn.css)({color:e.colors.success.text}),pending:(0,Pn.css)({color:e.colors.warning.text}),alerting:(0,Pn.css)({color:e.colors.error.text})});var ec=Object.defineProperty,tc=Object.defineProperties,nc=Object.getOwnPropertyDescriptors,rc=Object.getOwnPropertySymbols,ac=Object.prototype.hasOwnProperty,oc=Object.prototype.propertyIsEnumerable,ic=(e,t,n)=>t in e?ec(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,sc=(e,t)=>{for(var n in t||(t={}))ac.call(t,n)&&ic(e,n,t[n]);if(rc)for(var n of rc(t))oc.call(t,n)&&ic(e,n,t[n]);return e},lc=(e,t)=>tc(e,nc(t));const uc="hideSeriesFrom",cc=(0,e.isSystemOverrideWithRef)(uc);function dc(t,n=e.ByNamesMatcherMode.exclude,r){return r=null!=r?r:{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:uc,matcher:{id:e.FieldMatcherID.byNames,options:{mode:n,names:t,prefix:n===e.ByNamesMatcherMode.exclude?"All except:":void 0,readOnly:!0}},properties:[lc(sc({},r),{value:{viz:!0,legend:!1,tooltip:!1}})]}}const pc=e=>{var t;const n=null==(t=e.matcher.options)?void 0:t.names;return Array.isArray(n)?[...n]:[]},fc=(t,n)=>{const r=new Set;for(const a of t)for(const o of a.fields){if(o.type!==e.FieldType.number)continue;const i=(0,e.getFieldDisplayName)(o,a,t);i!==n&&r.add(i)}return Array.from(r)},hc=(t,n)=>{var r;let a=[];for(const o of t){const t=o.properties.find((e=>"custom.hideFrom"===e.id));if(void 0!==t&&!0===(null==(r=t.value)?void 0:r.legend)){const t=e.fieldMatchers.get(o.matcher.id).get(o.matcher.options);for(const r of n)for(const o of r.fields){if(o.type!==e.FieldType.number)continue;const i=(0,e.getFieldDisplayName)(o,r,n);t(o,r,n)&&a.push(i)}}}return a};var mc=Object.defineProperty,gc=Object.defineProperties,bc=Object.getOwnPropertyDescriptors,yc=Object.getOwnPropertySymbols,vc=Object.prototype.hasOwnProperty,wc=Object.prototype.propertyIsEnumerable,Oc=(e,t,n)=>t in e?mc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Sc=(e,t)=>{for(var n in t||(t={}))vc.call(t,n)&&Oc(e,n,t[n]);if(yc)for(var n of yc(t))wc.call(t,n)&&Oc(e,n,t[n]);return e},_c=(e,t)=>gc(e,bc(t));const xc=(t,n)=>({matcher:{id:e.FieldMatcherID.byName,options:t},properties:[Pc(n)]}),Pc=t=>({id:"color",value:{mode:e.FieldColorModeId.Fixed,fixedColor:t}});function jc(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function Cc(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){jc(o,r,a,i,s,"next",e)}function s(e){jc(o,r,a,i,s,"throw",e)}i(void 0)}))}}var Ec=Object.defineProperty,Dc=Object.defineProperties,kc=Object.getOwnPropertyDescriptors,Tc=Object.getOwnPropertySymbols,Rc=Object.prototype.hasOwnProperty,Ac=Object.prototype.propertyIsEnumerable,Ic=(e,t,n)=>t in e?Ec(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Vc=(e,t)=>{for(var n in t||(t={}))Rc.call(t,n)&&Ic(e,n,t[n]);if(Tc)for(var n of Tc(t))Ac.call(t,n)&&Ic(e,n,t[n]);return e},Mc=(e,t)=>Dc(e,kc(t));class Fc extends ae{_onActivate(){this._plugin||this._loadPlugin(this.state.pluginId)}_loadPlugin(t,n,r,a){var o=this;return Cc((function*(){const i=function(e){var t;const{getPanelPluginFromCache:n}=(0,d.getPluginImportUtils)();return null!=(t=n(e))?t:D.get(e)}(t);if(i)o._pluginLoaded(i,n,r,a);else{const{importPanelPlugin:i}=(0,d.getPluginImportUtils)();try{const e=yield i(t);o._pluginLoaded(e,n,r,a)}catch(n){o._pluginLoaded(function(t){const n=new e.PanelPlugin((()=>null));return n.meta={id:t,name:t,sort:100,type:e.PluginType.panel,module:"",baseUrl:"",info:{author:{name:""},description:"",links:[],logos:{large:"",small:"public/img/grafana_icon.svg"},screenshots:[],updated:"",version:""}},n}(t)),n instanceof Error&&o.setState({_pluginLoadError:n.message})}}}))()}getLegacyPanelId(){const e=parseInt(this.state.key.replace("panel-",""),10);return isNaN(e)?0:e}_pluginLoaded(t,n,r,a){var o=this;return Cc((function*(){const{options:i,fieldConfig:s,title:l,pluginVersion:u,_UNSAFE_customMigrationHandler:c}=o.state,d={title:l,options:i,fieldConfig:s,id:o.getLegacyPanelId(),type:t.meta.id,pluginVersion:u};n&&(d.options=n),r&&(d.fieldConfig=r);const p=o._getPluginVersion(t);null==c||c(d,t),t.onPanelMigration&&p!==o.state.pluginVersion&&(d.options=yield t.onPanelMigration(d));const f=(0,e.getPanelOptionsWithDefaults)({plugin:t,currentOptions:d.options,currentFieldConfig:d.fieldConfig,isAfterPluginChange:null!=a&&a});if(o._plugin=t,o.setState({options:f.options,fieldConfig:f.fieldConfig,pluginVersion:p,pluginId:t.meta.id}),t.meta.skipDataQuery){const e=yu.getTimeRange(o);o._subs.add(e.subscribeToState((()=>o.forceRender())))}}))()}_getPluginVersion(e){return e&&e.meta.info.version?e.meta.info.version:d.config.buildInfo.version}getPlugin(){return this._plugin}getPanelContext(){return null!=this._panelContext||(this._panelContext=this.buildPanelContext()),this._panelContext}changePluginType(e,t,n){var r=this;return Cc((function*(){var a,o;const{options:i,fieldConfig:s,pluginId:l}=r.state;r._dataWithFieldConfig=void 0,yield r._loadPlugin(e,null!=t?t:{},n,!0);const u={title:r.state.title,options:r.state.options,fieldConfig:r.state.fieldConfig,id:1,type:e},c=null==(o=null==(a=r._plugin)?void 0:a.onPanelTypeChanged)?void 0:o.call(a,u,l,i,s);c&&!(0,be.isEmpty)(c)&&r.onOptionsChange(c,!0,!0)}))()}clearFieldConfigCache(){this._dataWithFieldConfig=void 0}applyFieldConfig(t){var n,r,a,o;const i=this._plugin;if(!i||i.meta.skipDataQuery||!t)return Be;if(this._prevData===t&&this._dataWithFieldConfig)return this._dataWithFieldConfig;const s=i.dataSupport||{alertStates:!1,annotations:!1},l=i.fieldConfigRegistry,u=null!=(r=null==(n=this._dataWithFieldConfig)?void 0:n.series)?r:[],c=(0,e.applyFieldOverrides)({data:t.series,fieldConfig:this.state.fieldConfig,fieldConfigRegistry:l,replaceVariables:this.interpolate,theme:d.config.theme2,timeZone:null==(a=t.request)?void 0:a.timezone});return(0,e.compareArrayValues)(c,u,e.compareDataFrameStructures)||this._structureRev++,this._dataWithFieldConfig=Mc(Vc({},t),{structureRev:this._structureRev,series:c}),this._dataWithFieldConfig.annotations&&(this._dataWithFieldConfig.annotations=(0,e.applyFieldOverrides)({data:this._dataWithFieldConfig.annotations,fieldConfig:{defaults:{},overrides:[]},fieldConfigRegistry:l,replaceVariables:this.interpolate,theme:d.config.theme2,timeZone:null==(o=t.request)?void 0:o.timezone})),s.alertStates||(this._dataWithFieldConfig.alertState=void 0),s.annotations||(this._dataWithFieldConfig.annotations=void 0),this._prevData=t,this._dataWithFieldConfig}buildPanelContext(){const t=(this,yu.findObject(this,(e=>e instanceof Fu)));const n={eventsScope:t?t.getEventsScope():"__global_",eventBus:t?t.getEventsBus(this):(0,d.getAppEvents)(),app:e.CoreApp.Unknown,sync:()=>t?t.state.sync:e.DashboardCursorSync.Off,onSeriesColorChange:this._onSeriesColorChange,onToggleSeriesVisibility:this._onSeriesVisibilityChange,onToggleLegendSort:this._onToggleLegendSort,onInstanceStateChange:this._onInstanceStateChange};return this.state.extendPanelContext&&this.state.extendPanelContext(this,n),n}constructor(t){var n;super(Vc({options:{},fieldConfig:{defaults:{},overrides:[]},title:"Title",pluginId:"timeseries",_renderCounter:0},t)),this._variableDependency=new zl(this,{statePaths:["title","options","fieldConfig"]}),this._structureRev=0,this.onTimeRangeChange=t=>{yu.getTimeRange(this).onTimeRangeChange({raw:{from:(0,e.toUtc)(t.from),to:(0,e.toUtc)(t.to)},from:(0,e.toUtc)(t.from),to:(0,e.toUtc)(t.to)})},this.getTimeRange=e=>{const t=yu.findObject(this,(e=>e instanceof $c)),n=yu.getTimeRange(this);if(t instanceof $c&&t.isEnabled)return We(n.state.from,n.state.to,n.getTimeZone(),n.state.fiscalYearStartMonth,n.state.UNSAFE_nowDelay);const r=this.getPlugin();return r&&!r.meta.skipDataQuery&&e&&e.timeRange?e.timeRange:n.state.value},this.onTitleChange=e=>{this.setState({title:e})},this.onDescriptionChange=e=>{this.setState({description:e})},this.onDisplayModeChange=e=>{this.setState({displayMode:e})},this.onOptionsChange=(t,n=!1,r=!1)=>{var a;const{fieldConfig:o,options:i}=this.state,s=n?t:(0,be.mergeWith)((0,be.cloneDeep)(i),t,((e,t,n,r)=>{if((0,be.isArray)(t))return t;e===t||void 0!==t||(r[n]=t)})),l=(0,e.getPanelOptionsWithDefaults)({plugin:this._plugin,currentOptions:s,currentFieldConfig:o,isAfterPluginChange:r});this.setState({options:l.options,_renderCounter:(null!=(a=this.state._renderCounter)?a:0)+1})},this.onFieldConfigChange=(t,n)=>{const{fieldConfig:r,options:a}=this.state,o=n?t:(0,be.merge)((0,be.cloneDeep)(r),t),i=(0,e.getPanelOptionsWithDefaults)({plugin:this._plugin,currentOptions:a,currentFieldConfig:o,isAfterPluginChange:!1});this._dataWithFieldConfig=void 0,this.setState({fieldConfig:i.fieldConfig})},this.interpolate=(e,t,n)=>yu.interpolate(this,e,t,n),this.getDescription=()=>{this.publishEvent(new Q({origin:this,interaction:"panel-description-shown"}),!0);const{description:t}=this.state;if(t){const n=this.interpolate(t);return(0,e.renderMarkdown)(n)}return""},this.onCancelQuery=()=>{var e;this.publishEvent(new Q({origin:this,interaction:"panel-cancel-query-clicked"}),!0);const t=yu.getData(this);null==(e=t.cancelQuery)||e.call(t)},this.onStatusMessageClick=()=>{this.publishEvent(new Q({origin:this,interaction:"panel-status-message-clicked"}),!0)},this._onSeriesColorChange=(t,n)=>{this.onFieldConfigChange(((t,n,r)=>{const{overrides:a}=r,o=r.overrides.findIndex((n=>n.matcher.id===e.FieldMatcherID.byName&&n.matcher.options===t));if(o<0)return _c(Sc({},r),{overrides:[...r.overrides,xc(t,n)]});const i=Array.from(a),s=i[o],l=s.properties.findIndex((e=>"color"===e.id));if(l<0)return i[o]=_c(Sc({},s),{properties:[...s.properties,Pc(n)]}),_c(Sc({},r),{overrides:i});const u=Array.from(s.properties);return u[l]=Pc(n),i[o]=_c(Sc({},s),{properties:u}),_c(Sc({},r),{overrides:i})})(t,n,this.state.fieldConfig))},this._onSeriesVisibilityChange=(t,n)=>{this._dataWithFieldConfig&&this.onFieldConfigChange(function(t,n,r,a){const{overrides:o}=r,i=t,s=o.findIndex(cc);if(s<0){if(n===Sn.SeriesVisibilityChangeMode.ToggleSelection){const e=dc([i,...hc(o,a)]);return lc(sc({},r),{overrides:[...r.overrides,e]})}const e=dc(fc(a,i));return lc(sc({},r),{overrides:[...r.overrides,e]})}const l=Array.from(o),[u]=l.splice(s,1);if(n===Sn.SeriesVisibilityChangeMode.ToggleSelection){let e=pc(u);const t=hc(l,a);if(t.length>0&&(e=e.filter((e=>t.indexOf(e)<0))),e[0]===i&&1===e.length)return lc(sc({},r),{overrides:l});const n=dc([i,...t]);return lc(sc({},r),{overrides:[...l,n]})}const c=((t,n,r=e.ByNamesMatcherMode.exclude)=>{const a=t.properties.find((e=>"custom.hideFrom"===e.id)),o=pc(t),i=o.findIndex((e=>e===n));return i<0?o.push(n):o.splice(i,1),dc(o,r,a)})(u,i);return((e,t)=>pc(e).length===fc(t).length)(c,a)?lc(sc({},r),{overrides:l}):lc(sc({},r),{overrides:[...l,c]})}(t,n,this.state.fieldConfig,this._dataWithFieldConfig.series),!0)},this._onInstanceStateChange=e=>{this._panelContext&&(this._panelContext=Mc(Vc({},this._panelContext),{instanceState:e})),this.setState({_pluginInstanceState:e})},this._onToggleLegendSort=e=>{const t=this.state.options.legend;if(!t)return;let n=t.sortDesc,r=t.sortBy;e!==r&&(n=void 0),!1===n?(r=void 0,n=void 0):(n=!n,r=e),this.onOptionsChange(Mc(Vc({},this.state.options),{legend:Mc(Vc({},t),{sortBy:r,sortDesc:n})}),!0)},this.addActivationHandler((()=>{this._onActivate()})),null==(n=t.menu)||n.addActivationHandler((()=>{this.publishEvent(new Q({origin:this,interaction:"panel-menu-shown"}),!0)}))}}Fc.Component=function({model:n}){var a,o,i,s,l;const{title:u,options:c,fieldConfig:p,_pluginLoadError:f,displayMode:h,hoverHeader:m,hoverHeaderOffset:g,menu:b,headerActions:y,titleItems:v,description:w,_renderCounter:O=0}=n.useState(),[S,{width:_,height:x}]=qu(),P=(0,t.useMemo)((()=>(0,d.getAppEvents)()),[]),j=(0,t.useCallback)((()=>{P.publish(new e.SetPanelAttentionEvent({panelId:n.state.key}))}),[n.state.key,P]),C=(0,t.useMemo)((()=>(0,be.debounce)(j,100,{leading:!0,trailing:!1})),[j]),E=n.getPlugin(),{dragClass:D,dragClassCancel:k}=function(e){var t,n;const r=yu.getLayout(e),a=null==r?void 0:r.isDraggable();return r&&a&&!function(e,t){let n=e.parent;for(;n&&n!==t;){if("isDraggable"in n.state&&!1===n.state.isDraggable)return!0;n=n.parent}return!1}(e,r)?{dragClass:null==(t=r.getDragClass)?void 0:t.call(r),dragClassCancel:null==(n=null==r?void 0:r.getDragClassCancel)?void 0:n.call(r)}:{dragClass:"",dragClassCancel:""}}(n),T=yu.getData(n),R=T.useState(),A=n.applyFieldConfig(R.data),I=yu.getTimeRange(n).getTimeZone(),V=n.getTimeRange(A),M=n.interpolate(u,void 0,"text"),F=(0,Sn.useStyles2)(Ju);if(!E)return r().createElement("div",null,"Loading plugin panel...");if(!E.panel)return r().createElement("div",null,"Panel plugin has no panel component");const L=E.panel;T&&T.setContainerWidth&&T.setContainerWidth(Math.round(_));let $,N,B=[];v&&(Array.isArray(v)?B=B.concat(v.map((e=>r().createElement(e.Component,{model:e,key:`${e.state.key}`})))):Bt(v)?B.push(r().createElement(v.Component,{model:v})):B.push(v)),n.state.$timeRange&&B.push(r().createElement(n.state.$timeRange.Component,{model:n.state.$timeRange,key:n.state.key})),A.alertState&&B.push(r().createElement(Sn.Tooltip,{content:null!=(a=A.alertState.state)?a:"unknown",key:`alert-states-icon-${n.state.key}`},r().createElement(Sn.PanelChrome.TitleItem,{className:(0,Pn.cx)({[F.ok]:A.alertState.state===e.AlertState.OK,[F.pending]:A.alertState.state===e.AlertState.Pending,[F.alerting]:A.alertState.state===e.AlertState.Alerting})},r().createElement(Sn.Icon,{name:"alerting"===A.alertState.state?"heart-break":"heart",className:"panel-alert-icon",size:"md"})))),b&&($=r().createElement(b.Component,{model:b})),y&&(N=Array.isArray(y)?r().createElement(r().Fragment,null,y.map((e=>r().createElement(e.Component,{model:e,key:`${e.state.key}`})))):Bt(y)?r().createElement(y.Component,{model:y}):y);const z=A,q=!T.isDataReadyToDisplay||T.isDataReadyToDisplay(),H=n.getPanelContext(),W=n.getLegacyPanelId();let U=null;return null!=(s=null==(i=null==(o=z.request)?void 0:o.targets)?void 0:i.length)&&s&&(U=null==(l=z.request)?void 0:l.targets[0].datasource),r().createElement("div",{className:Zu},r().createElement("div",{ref:S,className:Xu,"data-viz-panel-key":n.state.key},_>0&&x>0&&r().createElement(Sn.PanelChrome,{title:M,description:(null==w?void 0:w.trim())?n.getDescription:void 0,loadingState:z.state,statusMessage:Yu(z,f),statusMessageOnClick:n.onStatusMessageClick,width:_,height:x,displayMode:h,hoverHeader:m,hoverHeaderOffset:g,titleItems:B,dragClass:D,actions:N,dragClassCancel:k,padding:E.noPadding?"none":"md",menu:$,onCancelQuery:n.onCancelQuery,onFocus:j,onMouseEnter:j,onMouseMove:C},((t,a)=>r().createElement(r().Fragment,null,"timeseries"===E.meta.id&&r().createElement(Sn.Button,{style:{top:"-32px",right:"28px",position:"absolute",border:0,padding:0},variant:"secondary",fill:"outline",type:"button","data-testid":"send-query-button",tooltip:"Oodle insight",tooltipPlacement:"top",hidden:"prometheus"!==(null==U?void 0:U.type),onClick:()=>{var t,r;const a=((e,t)=>{for(var n in t||(t={}))Uu.call(t,n)&&Qu(e,n,t[n]);if(Wu)for(var n of Wu(t))Gu.call(t,n)&&Qu(e,n,t[n]);return e})({},null==(t=null==z?void 0:z.request)?void 0:t.scopedVars);a.__interval={value:"$__interval"},a.__interval_ms={value:"$__interval_ms"};let o=e.rangeUtil.convertRawToRange(null==(r=z.request)?void 0:r.rangeRaw),i=o.to.valueOf()-o.from.valueOf();(0,d.getDataSourceSrv)().get(U,a).then((e=>{var t,r,s,l,u,c;if(!e.interpolateVariablesInQueries)throw new Error("datasource does not support variable interpolation");{let d=e.interpolateVariablesInQueries(null==(t=z.request)?void 0:t.targets,a);Ku(null==(r=z.request)?void 0:r.dashboardUID,"Insights",n.state.title,null==(s=z.request)?void 0:s.panelId,d,o,i,null==(c=null==(u=null==(l=n.state)?void 0:l.fieldConfig)?void 0:u.defaults)?void 0:c.unit)}})).catch((e=>{var t,r,a,s,l,u;Ku(null==(t=z.request)?void 0:t.dashboardUID,"Insights",n.state.title,null==(r=z.request)?void 0:r.panelId,null==(a=z.request)?void 0:a.targets,o,i,null==(u=null==(l=null==(s=n.state)?void 0:s.fieldConfig)?void 0:l.defaults)?void 0:u.unit)}))}},r().createElement("img",{src:"https://imagedelivery.net/oP5rEbdkySYwiZY4N9HGRw/d0e74e50-902c-4b3c-90af-cabc367bcb00/public",alt:"Insight icon","data-testid":"insight-icon",style:{height:"25px"}})),r().createElement(Sn.ErrorBoundaryAlert,{dependencies:[E,z]},r().createElement(e.PluginContextProvider,{meta:E.meta},r().createElement(Sn.PanelContextProvider,{value:H},q&&r().createElement(L,{id:W,data:z,title:"TEST TITLE",timeRange:V,timeZone:I,options:c,fieldConfig:p,transparent:!1,width:t,height:a,renderCounter:O,replaceVariables:n.interpolate,onOptionsChange:n.onOptionsChange,onFieldConfigChange:n.onFieldConfigChange,onChangeTimeRange:n.onTimeRangeChange,eventBus:H.eventBus})))))))))};const Lc=class extends ae{enable(){window.clearInterval(this.timerId),this.timerId=void 0,this.timerId=window.setInterval((()=>{const e=yu.findAllObjects(this.getRoot(),(e=>e instanceof Fc));for(const t of e)t.forceRender()}),Lc.REFRESH_RATE),this.setState({enabled:!0})}disable(){window.clearInterval(this.timerId),this.timerId=void 0,this.setState({enabled:!1})}get isEnabled(){return this.state.enabled}constructor({enabled:e=!1}){super({enabled:e}),this.timerId=void 0,this._activationHandler=()=>(this.state.enabled&&this.enable(),()=>{window.clearInterval(this.timerId),this.timerId=void 0}),this.addActivationHandler(this._activationHandler)}};let $c=Lc;function Nc(e){if("string"==typeof e)return e;if(e){if(e instanceof Error)return e.message;if((0,d.isFetchError)(e)){if(e.data&&e.data.message)return e.data.message;if(e.statusText)return e.statusText}else if(e.hasOwnProperty("message"))return e.message}return JSON.stringify(e)}$c.REFRESH_RATE=100;var Bc=Object.defineProperty,zc=Object.getOwnPropertySymbols,qc=Object.prototype.hasOwnProperty,Hc=Object.prototype.propertyIsEnumerable,Wc=(e,t,n)=>t in e?Bc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Uc extends ae{onActivate(){return this.state.isEnabled&&this.onEnable(),this.shouldRunLayerOnActivate()&&this.runLayer(),this.subscribeToState(((e,t)=>{!e.isEnabled&&this.querySub&&(this.querySub.unsubscribe(),this.querySub=void 0,this.onDisable(),this._results.next({origin:this,data:Be}),this.setStateHelper({data:Be})),e.isEnabled&&!t.isEnabled&&(this.onEnable(),this.runLayer())})),()=>{this.onDeactivate()}}onDeactivate(){this.querySub&&(this.querySub.unsubscribe(),this.querySub=void 0),this.onDisable(),this._variableValueRecorder.recordCurrentDependencyValuesForSceneObject(this)}onVariableUpdateCompleted(){this.runLayer()}cancelQuery(){this.querySub&&(this.querySub.unsubscribe(),this.querySub=void 0,this.publishResults(Be))}publishResults(e){this.state.isEnabled&&(this._results.next({origin:this,data:e}),this.setStateHelper({data:e}))}getResultsStream(){return this._results}shouldRunLayerOnActivate(){return!!this.state.isEnabled&&(this._variableValueRecorder.hasDependenciesChanged(this)?(Gt("SceneDataLayerBase","Variable dependency changed while inactive, shouldRunLayerOnActivate returns true"),!0):!this.state.data)}setStateHelper(e){xt(this,e)}constructor(e,t=[]){super(((e,t)=>{for(var n in t||(t={}))qc.call(t,n)&&Wc(e,n,t[n]);if(zc)for(var n of zc(t))Hc.call(t,n)&&Wc(e,n,t[n]);return e})({isEnabled:!0},e)),this._results=new k.ReplaySubject(1),this.isDataLayer=!0,this._variableValueRecorder=new Zt,this._variableDependency=new zl(this,{onVariableUpdateCompleted:this.onVariableUpdateCompleted.bind(this)}),this._variableDependency.setPaths(t),this.addActivationHandler((()=>this.onActivate()))}}class Gc extends ae{constructor(){super({})}}function Qc({layer:e}){var t,n;const a=`data-layer-${e.state.key}`,{data:o,isEnabled:i}=e.useState(),s=Boolean(o&&o.state===Ie.Loading);return r().createElement("div",{className:Kc},r().createElement(Or,{htmlFor:a,isLoading:s,onCancel:()=>{var t;return null==(t=e.cancelQuery)?void 0:t.call(e)},label:e.state.name,description:e.state.description,error:null==(n=null==(t=e.state.data)?void 0:t.errors)?void 0:n[0].message}),r().createElement(Sn.InlineSwitch,{id:a,value:i,onChange:()=>e.setState({isEnabled:!i})}))}Gc.Component=function({model:e}){const t=yu.getDataLayers(e,!0);return 0===t.length?null:r().createElement(r().Fragment,null,t.map((e=>r().createElement(e.Component,{model:e,key:e.state.key}))))};const Kc=(0,Pn.css)({display:"flex"});function Yc(e){return"function"==typeof e}function Zc(e){return function(t){if(function(e){return Yc(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}var Xc=function(e,t){return Xc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Xc(e,t)};function Jc(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Xc(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function ed(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function td(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function nd(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return i}function rd(e,t,n){if(n||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}function ad(e){return this instanceof ad?(this.v=e,this):new ad(e)}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var od,id=((od=function(e){var t;t=this,Error.call(t),t.stack=(new Error).stack,this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}).prototype=Object.create(Error.prototype),od.prototype.constructor=od,od);function sd(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var ld=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,r,a;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var i=td(o),s=i.next();!s.done;s=i.next())s.value.remove(this)}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}else o.remove(this);var l=this.initialTeardown;if(Yc(l))try{l()}catch(e){a=e instanceof id?e.errors:[e]}var u=this._finalizers;if(u){this._finalizers=null;try{for(var c=td(u),d=c.next();!d.done;d=c.next()){var p=d.value;try{cd(p)}catch(e){a=null!=a?a:[],e instanceof id?a=rd(rd([],nd(a)),nd(e.errors)):a.push(e)}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}if(a)throw new id(a)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)cd(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&sd(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&sd(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function ud(e){return e instanceof ld||e&&"closed"in e&&Yc(e.remove)&&Yc(e.add)&&Yc(e.unsubscribe)}function cd(e){Yc(e)?e():e.unsubscribe()}ld.EMPTY;var dd={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},pd={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var a=pd.delegate;return(null==a?void 0:a.setTimeout)?a.setTimeout.apply(a,rd([e,t],nd(n))):setTimeout.apply(void 0,rd([e,t],nd(n)))},clearTimeout:function(e){var t=pd.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function fd(e){pd.setTimeout((function(){var t=dd.onUnhandledError;if(!t)throw e;t(e)}))}function hd(){}var md=gd("C",void 0,void 0);function gd(e,t,n){return{kind:e,value:t,error:n}}var bd=null,yd=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,ud(t)&&t.add(n)):n.destination=Pd,n}return Jc(t,e),t.create=function(e,t,n){return new Sd(e,t,n)},t.prototype.next=function(e){this.isStopped?xd(function(e){return gd("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?xd(gd("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?xd(md,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(ld),vd=Function.prototype.bind;function wd(e,t){return vd.call(e,t)}var Od=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){_d(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){_d(e)}else _d(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){_d(e)}},e}(),Sd=function(e){function t(t,n,r){var a,o,i=e.call(this)||this;return Yc(t)||!t?a={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:i&&dd.useDeprecatedNextContext?((o=Object.create(t)).unsubscribe=function(){return i.unsubscribe()},a={next:t.next&&wd(t.next,o),error:t.error&&wd(t.error,o),complete:t.complete&&wd(t.complete,o)}):a=t,i.destination=new Od(a),i}return Jc(t,e),t}(yd);function _d(e){var t;dd.useDeprecatedSynchronousErrorHandling?(t=e,dd.useDeprecatedSynchronousErrorHandling&&bd&&(bd.errorThrown=!0,bd.error=t)):fd(e)}function xd(e,t){var n=dd.onStoppedNotification;n&&pd.setTimeout((function(){return n(e,t)}))}var Pd={closed:!0,next:hd,error:function(e){throw e},complete:hd};function jd(e,t,n,r,a){return new Cd(e,t,n,r,a)}var Cd=function(e){function t(t,n,r,a,o,i){var s=e.call(this,t)||this;return s.onFinalize=o,s.shouldUnsubscribe=i,s._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,s._error=a?function(e){try{a(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return Jc(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(yd);function Ed(e,t){return Zc((function(n,r){var a=0;n.subscribe(jd(r,(function(n){r.next(e.call(t,n,a++))})))}))}var Dd=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e},kd="function"==typeof Symbol&&Symbol.observable||"@@observable";function Td(e){return e}var Rd=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,a=this,o=(r=e)&&r instanceof yd||function(e){return e&&Yc(e.next)&&Yc(e.error)&&Yc(e.complete)}(r)&&ud(r)?e:new Sd(e,t,n);return function(e){if(dd.useDeprecatedSynchronousErrorHandling){var t=!bd;if(t&&(bd={errorThrown:!1,error:null}),e(),t){var n=bd,r=n.errorThrown,a=n.error;if(bd=null,r)throw a}}else e()}((function(){var e=a,t=e.operator,n=e.source;o.add(t?t.call(o,n):n?a._subscribe(o):a._trySubscribe(o))})),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=Ad(t))((function(t,r){var a=new Sd({next:function(t){try{e(t)}catch(e){r(e),a.unsubscribe()}},error:r,complete:t});n.subscribe(a)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[kd]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===(n=e).length?Td:1===n.length?n[0]:function(e){return n.reduce((function(e,t){return t(e)}),e)})(this);var n},e.prototype.toPromise=function(e){var t=this;return new(e=Ad(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function Ad(e){var t;return null!==(t=null!=e?e:dd.Promise)&&void 0!==t?t:Promise}var Id="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Vd(e){if(e instanceof Rd)return e;if(null!=e){if(function(e){return Yc(e[kd])}(e))return o=e,new Rd((function(e){var t=o[kd]();if(Yc(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(Dd(e))return a=e,new Rd((function(e){for(var t=0;t<a.length&&!e.closed;t++)e.next(a[t]);e.complete()}));if(Yc(null==(r=e)?void 0:r.then))return n=e,new Rd((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,fd)}));if(function(e){return Symbol.asyncIterator&&Yc(null==e?void 0:e[Symbol.asyncIterator])}(e))return Md(e);if(function(e){return Yc(null==e?void 0:e[Id])}(e))return t=e,new Rd((function(e){var n,r;try{for(var a=td(t),o=a.next();!o.done;o=a.next()){var i=o.value;if(e.next(i),e.closed)return}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}e.complete()}));if(function(e){return Yc(null==e?void 0:e.getReader)}(e))return Md(function(e){return function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,a=n.apply(e,t||[]),o=[];return r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r;function i(e){a[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=a[e](t)).value instanceof ad?Promise.resolve(n.value.v).then(l,u):c(o[0][2],n)}catch(e){c(o[0][3],e)}var n}function l(e){s("next",e)}function u(e){s("throw",e)}function c(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}(this,arguments,(function(){var t,n,r;return ed(this,(function(a){switch(a.label){case 0:t=e.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,ad(t.read())];case 3:return n=a.sent(),r=n.value,n.done?[4,ad(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,ad(r)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}(e))}var t,n,r,a,o;throw function(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}(e)}function Md(e){return new Rd((function(t){(function(e,t){var n,r,a,o,i,s,l,u;return i=this,s=void 0,u=function(){var i,s;return ed(this,(function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=td(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,a){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,a,(t=e[n](t)).done,t.value)}))}}}(e),l.label=1;case 1:return[4,n.next()];case 2:if((r=l.sent()).done)return[3,4];if(i=r.value,t.next(i),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=l.sent(),a={error:s},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(a)throw a.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))},new((l=void 0)||(l=Promise))((function(e,t){function n(e){try{a(u.next(e))}catch(e){t(e)}}function r(e){try{a(u.throw(e))}catch(e){t(e)}}function a(t){var a;t.done?e(t.value):(a=t.value,a instanceof l?a:new l((function(e){e(a)}))).then(n,r)}a((u=u.apply(i,s||[])).next())}))})(e,t).catch((function(e){return t.error(e)}))}))}function Fd(e,t,n){return void 0===n&&(n=1/0),Yc(t)?Fd((function(n,r){return Ed((function(e,a){return t(n,e,r,a)}))(Vd(e(n,r)))}),n):("number"==typeof t&&(n=t),Zc((function(t,r){return function(e,t,n,r,a,o,i,s){var l=[],u=0,c=0,d=!1,p=function(){!d||l.length||u||t.complete()},f=function(e){return u<r?h(e):l.push(e)},h=function(e){u++;var a=!1;Vd(n(e,c++)).subscribe(jd(t,(function(e){t.next(e)}),(function(){a=!0}),void 0,(function(){if(a)try{u--;for(var e=function(){var e=l.shift();h(e)};l.length&&u<r;)e();p()}catch(e){t.error(e)}})))};return e.subscribe(jd(t,f,(function(){d=!0,p()}))),function(){}}(t,r,e,n)})))}var Ld=Object.defineProperty,$d=Object.defineProperties,Nd=Object.getOwnPropertyDescriptors,Bd=Object.getOwnPropertySymbols,zd=Object.prototype.hasOwnProperty,qd=Object.prototype.propertyIsEnumerable,Hd=(e,t,n)=>t in e?Ld(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const Wd={prepareAnnotation:e=>{if((0,be.isString)(null==e?void 0:e.query)){const n=e,{query:r}=n;return t=((e,t)=>{for(var n in t||(t={}))zd.call(t,n)&&Hd(e,n,t[n]);if(Bd)for(var n of Bd(t))qd.call(t,n)&&Hd(e,n,t[n]);return e})({},((e,t)=>{var n={};for(var r in e)zd.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&Bd)for(var r of Bd(e))t.indexOf(r)<0&&qd.call(e,r)&&(n[r]=e[r]);return n})(n,["query"])),$d(t,Nd({target:{refId:"annotation_query",query:r},mappings:{}}))}var t;return e},prepareQuery:e=>e.target,processEvents:(t,n)=>function(t,n){return(0,k.of)(t).pipe((t=>t.pipe(Fd((t=>{if(!(null==t?void 0:t.length))return(0,k.of)(void 0);if(1===t.length)return(0,k.of)(t[0]);return(0,k.of)(t).pipe(e.standardTransformers.mergeTransformer.operator({},{interpolate:e=>e}),Ed((e=>e[0])))})))),Ed((t=>{if(!(null==t?void 0:t.length))return[];let r=!1,a=!1;const o={};for(const n of t.fields)o[(0,e.getFieldDisplayName)(n,t).toLowerCase()]=n;n||(n={});const i=[];for(const s of Gd){const l=n[s.key]||{};if(l.source===e.AnnotationEventFieldSource.Skip)continue;const u={key:s.key,split:s.split};if(l.source===e.AnnotationEventFieldSource.Text)u.text=l.value;else{const e=(l.value||s.key).toLowerCase();u.field=o[e],!u.field&&s.field&&(u.field=s.field(t))}(u.field||u.text)&&(i.push(u),"time"===u.key?r=!0:"text"===u.key&&(a=!0))}if(!r||!a)return console.error("Cannot process annotation fields. No time or text present."),[];const s=[];for(let e=0;e<t.length;e++){const t={type:"default",color:"red"};for(const n of i){let r;if(n.text)r=n.text;else if(n.field&&(r=n.field.values.get(e),void 0!==r&&n.regex)){const e=n.regex.exec(r);e&&(r=e[1]?e[1]:e[0])}null!=r&&(n.split&&"string"==typeof r&&(r=r.split(",")),t[n.key]=r)}s.push(t)}return s})))}(n,t.mappings)},Ud=[{key:"time",field:t=>t.fields.find((t=>t.type===e.FieldType.time)),placeholder:"time, or the first time field"},{key:"timeEnd",help:"When this field is defined, the annotation will be treated as a range"},{key:"title"},{key:"text",field:t=>t.fields.find((t=>t.type===e.FieldType.string)),placeholder:"text, or the first text field"},{key:"tags",split:",",help:"The results will be split on comma (,)"},{key:"id"}],Gd=[...d.config.publicDashboardAccessToken?[{key:"color"},{key:"isRegion"},{key:"source"}]:[],...Ud,{key:"userId"},{key:"login"},{key:"email"},{key:"prevState"},{key:"newState"},{key:"data"},{key:"panelId"},{key:"alertId"},{key:"dashboardId"},{key:"dashboardUID"}],Qd=["prometheus","loki","elasticsearch","grafana-opensearch-datasource"];var Kd=Object.defineProperty,Yd=Object.defineProperties,Zd=Object.getOwnPropertyDescriptors,Xd=Object.getOwnPropertySymbols,Jd=Object.prototype.hasOwnProperty,ep=Object.prototype.propertyIsEnumerable,tp=(e,t,n)=>t in e?Kd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,np=(e,t)=>{for(var n in t||(t={}))Jd.call(t,n)&&tp(e,n,t[n]);if(Xd)for(var n of Xd(t))ep.call(t,n)&&tp(e,n,t[n]);return e},rp=(e,t)=>Yd(e,Zd(t));let ap=100;var op=Object.defineProperty,ip=Object.getOwnPropertySymbols,sp=Object.prototype.hasOwnProperty,lp=Object.prototype.propertyIsEnumerable,up=(e,t,n)=>t in e?op(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function cp(e){return"panel-alert"===e.eventType}function dp(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function pp(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){dp(o,r,a,i,s,"next",e)}function s(e){dp(o,r,a,i,s,"throw",e)}i(void 0)}))}}var fp=Object.defineProperty,hp=Object.defineProperties,mp=Object.getOwnPropertyDescriptors,gp=Object.getOwnPropertySymbols,bp=Object.prototype.hasOwnProperty,yp=Object.prototype.propertyIsEnumerable,vp=(e,t,n)=>t in e?fp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,wp=(e,t)=>{for(var n in t||(t={}))bp.call(t,n)&&vp(e,n,t[n]);if(gp)for(var n of gp(t))yp.call(t,n)&&vp(e,n,t[n]);return e},Op=(e,t)=>hp(e,mp(t));class Sp extends Uc{onEnable(){this.publishEvent(new d.RefreshEvent,!0);const e=yu.getTimeRange(this);this._timeRangeSub=e.subscribeToState((()=>{this.runWithTimeRange(e)}))}onDisable(){var e;this.publishEvent(new d.RefreshEvent,!0),null==(e=this._timeRangeSub)||e.unsubscribe()}runLayer(){Gt("AnnotationsDataLayer","run layer");const e=yu.getTimeRange(this);this.runWithTimeRange(e)}runWithTimeRange(t){var n=this;return pp((function*(){const{query:r}=n.state;if(n.querySub&&n.querySub.unsubscribe(),n._variableDependency.hasDependencyInLoadingState())Gt("AnnotationsDataLayer","Variable dependency is in loading state, skipping query execution");else try{let a=function(t,n,r,a){var o;if(t.annotationQuery&&function(e){const{type:t}=e;return!e.annotations||Qd.includes(t)}(t))return console.warn("Using deprecated annotationQuery method, please upgrade your datasource"),(0,k.from)(t.annotationQuery({range:n.state.value,rangeRaw:n.state.value.raw,annotation:r,dashboard:{getVariables:(0,d.getTemplateSrv)().getVariables}})).pipe(Ed((e=>({state:Ie.Done,events:e}))));const i=np(np({},Wd),t.annotations),s=np(np({},null==(o=i.getDefaultQuery)?void 0:o.call(i)),r),l=i.prepareAnnotation(s);if(!l)return(0,k.of)({state:Ie.Done,events:[]});const u=i.prepareQuery(l);if(!u)return(0,k.of)({state:Ie.Done,events:[]});const c=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,p=e.rangeUtil.calculateInterval(n.state.value,c,t.interval),f={__interval:{text:p.interval,value:p.interval},__interval_ms:{text:p.intervalMs.toString(),value:p.intervalMs},__annotation:{text:l.name,value:l},__sceneObject:ir(a)},h=np(rp(np({startTime:Date.now(),requestId:"AQ"+ap++,range:n.state.value,maxDataPoints:c,scopedVars:f},p),{app:e.CoreApp.Dashboard,timezone:n.getTimeZone(),targets:[rp(np({},u),{refId:"Anno"})]}),bn(a));return(0,d.getRunRequest)()(t,h).pipe(Fd((t=>{const n=(null==t?void 0:t.series.length)?t.series:t.annotations;return(null==n?void 0:n.length)?(n.forEach((t=>{var n;(null==(n=t.meta)?void 0:n.dataTopic)||(t.meta=rp(np({},t.meta||{}),{dataTopic:e.DataTopic.Annotations}))})),i.processEvents(l,n).pipe(Ed((e=>({state:t.state,events:e||[]}))))):(0,k.of)({state:t.state,events:[]})})))}(yield n.resolveDataSource(r),t,r,n).pipe(wn({type:"annotations",origin:n,cancel:()=>n.cancelQuery()}),(0,k.map)((e=>n.processEvents(r,e))));n.querySub=a.subscribe((e=>{n.publishResults(e)}))}catch(e){n.publishResults(Op(wp({},Be),{state:Ie.Error,errors:[{message:Nc(e)}]})),console.error("AnnotationsDataLayer error",e)}}))()}resolveDataSource(e){var t=this;return pp((function*(){return yield Kt(e.datasource||void 0,t._scopedVars)}))()}processEvents(t,n){let r=(a=t,o=n.events||[],a.snapshotData&&delete(a=(0,be.cloneDeep)(a)).snapshotData,o.map((e=>{var t;const n=((e,t)=>{for(var n in t||(t={}))sp.call(t,n)&&up(e,n,t[n]);if(ip)for(var n of ip(t))lp.call(t,n)&&up(e,n,t[n]);return e})({},e);switch(n.source=a,n.color=d.config.theme2.visualization.getColorByName(a.iconColor),n.type=a.name,n.isRegion=Boolean(n.timeEnd&&n.time!==n.timeEnd),null==(t=n.newState)?void 0:t.toLowerCase()){case"pending":n.color="yellow";break;case"alerting":n.color="red";break;case"ok":case"normal":n.color="green";break;case"no_data":case"nodata":n.color="gray"}return n})));var a,o;r=function(e){let t=[];const n=(0,be.partition)(e,"id"),r=(0,be.groupBy)(n[0],"id");return t=(0,be.map)(r,(e=>e.length>1&&!(0,be.every)(e,cp)?(0,be.find)(e,(e=>"panel-alert"!==e.eventType)):(0,be.head)(e))),t=(0,be.concat)(t,n[1]),t}(r);const i=Op(wp({},Be),{state:n.state}),s=(0,e.arrayToDataFrame)(r);return s.meta=Op(wp({},s.meta),{dataTopic:e.DataTopic.Annotations}),i.series=[s],i}constructor(e){super(wp({isEnabled:!0},e),["query"]),this._scopedVars={__sceneObject:ir(this)}}}Sp.Component=function({model:e}){const{isHidden:t}=e.useState();return t?null:r().createElement(Qc,{layer:e})};class _p extends ae{getAncestorTimeRange(){if(!this.parent||!this.parent.parent)throw new Error(typeof this+" must be used within $timeRange scope");return yu.getTimeRange(this.parent.parent)}getTimeZone(){return this.getAncestorTimeRange().getTimeZone()}onTimeRangeChange(e){this.getAncestorTimeRange().onTimeRangeChange(e)}onTimeZoneChange(e){this.getAncestorTimeRange().onTimeZoneChange(e)}onRefresh(){this.getAncestorTimeRange().onRefresh()}constructor(e){super(e),this._activationHandler=()=>{const e=this.getAncestorTimeRange();this.ancestorTimeRangeChanged(e.state),this._subs.add(e.subscribeToState((e=>this.ancestorTimeRangeChanged(e))))},this.addActivationHandler(this._activationHandler)}}var xp=Object.defineProperty,Pp=Object.defineProperties,jp=Object.getOwnPropertyDescriptors,Cp=Object.getOwnPropertySymbols,Ep=Object.prototype.hasOwnProperty,Dp=Object.prototype.propertyIsEnumerable,kp=(e,t,n)=>t in e?xp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Tp=(e,t)=>{for(var n in t||(t={}))Ep.call(t,n)&&kp(e,n,t[n]);if(Cp)for(var n of Cp(t))Dp.call(t,n)&&kp(e,n,t[n]);return e},Rp=(e,t)=>Pp(e,jp(t));class Ap extends _p{ancestorTimeRangeChanged(e){this.setState(Rp(Tp({},e),{timeZone:this.state.timeZone,value:We(e.from,e.to,this.state.timeZone,e.fiscalYearStartMonth,e.UNSAFE_nowDelay)}))}getTimeZone(){return this.state.timeZone}onTimeZoneChange(e){this.setState({timeZone:e,value:We(this.state.from,this.state.to,this.state.timeZone,this.getAncestorTimeRange().state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay)})}constructor(t){super(Rp(Tp({},t),{timeZone:t.timeZone,from:"now-6h",to:"now",value:(0,e.getDefaultTimeRange)()}))}}class Ip extends ae{setContainerWidth(e){var t,n;null==(n=(t=this.state.source.resolve()).setContainerWidth)||n.call(t,e)}isDataReadyToDisplay(){var e,t,n;return null==(n=null==(t=(e=this.state.source.resolve()).isDataReadyToDisplay)?void 0:t.call(e))||n}cancelQuery(){var e,t;null==(t=(e=this.state.source.resolve()).cancelQuery)||t.call(e)}getResultsStream(){return this.state.source.resolve().getResultsStream()}constructor(e){super({source:e.source,data:e.source.resolve().state.data}),this.addActivationHandler((()=>{this._subs.add(this.state.source.resolve().subscribeToState(((e,t)=>{e.data!==t.data&&this.setState({data:e.data})})))}))}}var Vp=Object.defineProperty,Mp=Object.defineProperties,Fp=Object.getOwnPropertyDescriptors,Lp=Object.getOwnPropertySymbols,$p=Object.prototype.hasOwnProperty,Np=Object.prototype.propertyIsEnumerable,Bp=(e,t,n)=>t in e?Vp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class zp extends ae{subscribeToAllLayers(e){e.length>0?this.querySub=this._dataLayersMerger.getMergedStream(e).subscribe(this._onLayerUpdateReceived.bind(this)):(this._results.next({origin:this,data:Be}),this.setStateHelper({data:Be}))}_onLayerUpdateReceived(e){var t;let n=[];for(const r of e)(null==(t=r.data)?void 0:t.series)&&(n=n.concat(r.data.series));const r=(a=((e,t)=>{for(var n in t||(t={}))$p.call(t,n)&&Bp(e,n,t[n]);if(Lp)for(var n of Lp(t))Np.call(t,n)&&Bp(e,n,t[n]);return e})({},Be),Mp(a,Fp({series:n})));var a;this._results.next({origin:this,data:r}),this.setStateHelper({data:r})}getResultsStream(){return this._results}cancelQuery(){var e;null==(e=this.querySub)||e.unsubscribe()}setStateHelper(e){xt(this,e)}constructor(){super(...arguments),this.isDataLayer=!0,this._results=new k.ReplaySubject(1),this._dataLayersMerger=new pl}}class qp extends zp{_onActivate(){return this._subs.add(this.subscribeToState(((e,t)=>{var n;e.layers!==t.layers&&(null==(n=this.querySub)||n.unsubscribe(),this.subscribeToAllLayers(e.layers))}))),this.subscribeToAllLayers(this.state.layers),()=>{var e;null==(e=this.querySub)||e.unsubscribe()}}constructor(e){var t,n;super({name:null!=(t=e.name)?t:"Data layers",layers:null!=(n=e.layers)?n:[]}),this.addActivationHandler((()=>this._onActivate()))}}qp.Component=({model:e})=>{const{layers:t}=e.useState();return r().createElement(r().Fragment,null,t.map((e=>r().createElement(e.Component,{model:e,key:e.state.key}))))};var Hp=Object.defineProperty,Wp=Object.defineProperties,Up=Object.getOwnPropertyDescriptors,Gp=Object.getOwnPropertySymbols,Qp=Object.prototype.hasOwnProperty,Kp=Object.prototype.propertyIsEnumerable,Yp=(e,t,n)=>t in e?Hp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Zp=(e,t)=>{for(var n in t||(t={}))Qp.call(t,n)&&Yp(e,n,t[n]);if(Gp)for(var n of Gp(t))Kp.call(t,n)&&Yp(e,n,t[n]);return e},Xp=(e,t)=>Wp(e,Up(t));class Jp extends ae{activationHandler(){const e=this.getSourceData();return this._subs.add(e.subscribeToState((e=>this.transform(e.data)))),e.state.data&&this.transform(e.state.data),()=>{this._transformSub&&this._transformSub.unsubscribe()}}getSourceData(){if(this.state.$data){if(this.state.$data instanceof qp)throw new Error("SceneDataLayerSet can not be used as data provider for SceneDataTransformer.");return this.state.$data}if(!this.parent||!this.parent.parent)throw new Error("SceneDataTransformer must either have $data set on it or have a parent.parent with $data");return yu.getData(this.parent.parent)}setContainerWidth(e){this.state.$data&&this.state.$data.setContainerWidth&&this.state.$data.setContainerWidth(e)}isDataReadyToDisplay(){const e=this.getSourceData();return!e.isDataReadyToDisplay||e.isDataReadyToDisplay()}reprocessTransformations(){this.transform(this.getSourceData().state.data,!0)}cancelQuery(){var e,t;null==(t=(e=this.getSourceData()).cancelQuery)||t.call(e)}getResultsStream(){return this._results}clone(e){const t=super.clone(e);return this._prevDataFromSource&&(t._prevDataFromSource=this._prevDataFromSource),t}haveAlreadyTransformedData(e){if(!this._prevDataFromSource)return!1;if(e===this._prevDataFromSource)return!0;const{series:t,annotations:n}=this._prevDataFromSource;return e.series===t&&e.annotations===n&&(this.state.data&&e.state!==this.state.data.state&&this.setState({data:Xp(Zp({},this.state.data),{state:e.state})}),!0)}transform(t,n=!1){var r;if(0===this.state.transformations.length||!t)return this._prevDataFromSource=t,this.setState({data:t}),void(t&&this._results.next({origin:this,data:t}));if(!n&&this.haveAlreadyTransformedData(t))return;const a=this.state.transformations.filter((t=>!("options"in t)&&!("topic"in t)||null==t.topic||t.topic===e.DataTopic.Series)).map((e=>"operator"in e?e.operator:e)),o=this.state.transformations.filter((t=>("options"in t||"topic"in t)&&t.topic===e.DataTopic.Annotations)).map((e=>"operator"in e?e.operator:e));this._transformSub&&this._transformSub.unsubscribe();const i={interpolate:e=>{var n;return yu.interpolate(this,e,null==(n=t.request)?void 0:n.scopedVars)}};let s=[(0,e.transformDataFrame)(a,t.series,i)];t.annotations&&t.annotations.length>0&&o.length>0&&s.push((0,e.transformDataFrame)(o,null!=(r=t.annotations)?r:[])),this._transformSub=(0,k.forkJoin)(s).pipe((0,k.map)((e=>{const n=e[0],r=e[1];return Xp(Zp({},t),{series:n,annotations:null!=r?r:t.annotations})})),(0,k.catchError)((n=>{var r;console.error("Error transforming data: ",n);const a=(null==(r=this.getSourceData().state.data)?void 0:r.errors)||[],o=(0,d.toDataQueryError)(n);o.message=`Error transforming data: ${o.message}`;const i=Xp(Zp({},t),{state:e.LoadingState.Error,errors:[...a,o]});return(0,k.of)(i)}))).subscribe((e=>{this.setState({data:e}),this._results.next({origin:this,data:e}),this._prevDataFromSource=t}))}constructor(e){super(e),this._results=new k.ReplaySubject(1),this._variableDependency=new zl(this,{statePaths:["transformations"],onReferencedVariableValueChanged:()=>this.reprocessTransformations()}),this.addActivationHandler((()=>this.activationHandler()))}}class ef extends ae{}function tf({variable:t,layout:n,showAlways:a,hideLabel:o}){return oe(t,{shouldActivateOrKeepAlive:!0}).hide!==e.VariableHide.hideVariable||a?"vertical"===n?r().createElement("div",{className:af,"data-testid":xn.pages.Dashboard.SubMenu.submenuItem},r().createElement(nf,{variable:t,layout:n,hideLabel:o}),r().createElement(t.Component,{model:t})):r().createElement("div",{className:rf,"data-testid":xn.pages.Dashboard.SubMenu.submenuItem},r().createElement(nf,{variable:t,hideLabel:o}),r().createElement(t.Component,{model:t})):null}function nf({variable:t,layout:n,hideLabel:a}){var o,i;const{state:s}=t;if(t.state.hide===e.VariableHide.hideLabel||a)return null;const l=`var-${s.key}`,u=null!=(o=s.label)?o:s.name;return r().createElement(Or,{htmlFor:l,isLoading:s.loading,onCancel:()=>{var e;return null==(e=t.onCancel)?void 0:e.call(t)},label:u,error:s.error,layout:n,description:null!=(i=s.description)?i:void 0})}ef.Component=function({model:e}){const t=yu.getVariables(e).useState();return r().createElement(r().Fragment,null,t.variables.map((t=>r().createElement(tf,{key:t.state.key,variable:t,layout:e.state.layout}))))};const rf=(0,Pn.css)({display:"flex"}),af=(0,Pn.css)({display:"flex",flexDirection:"column"});(class extends ae{}).Component=function({model:e}){const t=yu.lookupVariable(e.state.variableName,e);return t?r().createElement(tf,{key:t.state.key,variable:t,layout:e.state.layout,showAlways:!0}):null};class of extends ae{getByName(e){return this.state.variables.find((t=>t.state.name===e))}_refreshTimeRangeBasedVariables(){for(const t of this.state.variables)"refresh"in t.state&&t.state.refresh===e.VariableRefresh.onTimeRangeChanged&&this._variablesToUpdate.add(t);this._updateNextBatch()}_checkForVariablesThatChangedWhileInactive(){if(this._variableValueRecorder.hasValues())for(const e of this.state.variables)this._variableValueRecorder.hasValueChanged(e)&&(sf(e,"Changed while in-active"),this._addDependentVariablesToUpdateQueue(e))}_variableNeedsUpdate(e){return!(e.isLazy||!e.validateAndUpdate||this._variableValueRecorder.hasRecordedValue(e)&&(sf(e,"Skipping updateAndValidate current value valid"),1))}_updateNextBatch(){for(const e of this._variablesToUpdate){if(!e.validateAndUpdate)throw new Error("Variable added to variablesToUpdate but does not have validateAndUpdate");if(this._updating.has(e))continue;if(yu.hasVariableDependencyInLoadingState(e))continue;const t={variable:e};this._updating.set(e,t),sf(e,"updateAndValidate started"),t.subscription=e.validateAndUpdate().subscribe({next:()=>this._validateAndUpdateCompleted(e),complete:()=>this._validateAndUpdateCompleted(e),error:t=>this._handleVariableError(e,t)})}}_validateAndUpdateCompleted(e){var t;if(!this._updating.has(e))return;const n=this._updating.get(e);null==(t=null==n?void 0:n.subscription)||t.unsubscribe(),this._updating.delete(e),this._variablesToUpdate.delete(e),sf(e,"updateAndValidate completed"),this._notifyDependentSceneObjects(e),this._updateNextBatch()}cancel(e){var t;const n=this._updating.get(e);null==(t=null==n?void 0:n.subscription)||t.unsubscribe(),this._updating.delete(e),this._variablesToUpdate.delete(e)}_handleVariableError(e,t){var n;const r=this._updating.get(e);null==(n=null==r?void 0:r.subscription)||n.unsubscribe(),this._updating.delete(e),this._variablesToUpdate.delete(e),e.setState({loading:!1,error:t.message}),console.error("SceneVariableSet updateAndValidate error",t),sf(e,"updateAndValidate error",t),this._notifyDependentSceneObjects(e),this._updateNextBatch()}_handleVariableValueChanged(e){this._variablesThatHaveChanged.add(e),this._addDependentVariablesToUpdateQueue(e),this._updating.has(e)||(this._updateNextBatch(),this._notifyDependentSceneObjects(e))}_handleParentVariableUpdatesCompleted(e,t){t&&this._addDependentVariablesToUpdateQueue(e),this._variablesToUpdate.size>0&&0===this._updating.size&&this._updateNextBatch()}_addDependentVariablesToUpdateQueue(e){for(const t of this.state.variables)t.variableDependency&&t.variableDependency.hasDependencyOn(e.state.name)&&(sf(t,"Added to update queue, dependant variable value changed"),this._updating.has(t)&&t.onCancel&&t.onCancel(),this._variablesToUpdate.add(t))}_notifyDependentSceneObjects(e){this.parent&&(this._traverseSceneAndNotify(this.parent,e,this._variablesThatHaveChanged.has(e)),this._variablesThatHaveChanged.delete(e))}_traverseSceneAndNotify(e,t,n){if(this!==e&&e.isActive){if(e.state.$variables&&e.state.$variables!==this&&e.state.$variables.getByName(t.state.name))return;e.variableDependency&&e.variableDependency.variableUpdateCompleted(t,n),e.forEachChild((e=>this._traverseSceneAndNotify(e,t,n)))}}isVariableLoadingOrWaitingToUpdate(e){return!(!e.isAncestorLoading||!e.isAncestorLoading())||!(!this._variablesToUpdate.has(e)&&!this._updating.has(e))||yu.hasVariableDependencyInLoadingState(e)}constructor(e){super(e),this._variablesThatHaveChanged=new Set,this._variablesToUpdate=new Set,this._updating=new Map,this._variableValueRecorder=new Zt,this._variableDependency=new lf(this._handleParentVariableUpdatesCompleted.bind(this)),this._onActivate=()=>{const e=yu.getTimeRange(this);this._subs.add(this.subscribeToEvent(rt,(e=>this._handleVariableValueChanged(e.payload)))),this._subs.add(e.subscribeToState((()=>{this._refreshTimeRangeBasedVariables()}))),this._subs.add(this.subscribeToState(this._onStateChanged)),this._checkForVariablesThatChangedWhileInactive();for(const e of this.state.variables)this._variableNeedsUpdate(e)&&this._variablesToUpdate.add(e);return this._updateNextBatch(),this._onDeactivate},this._onDeactivate=()=>{var e;for(const t of this._updating.values())null==(e=t.subscription)||e.unsubscribe();for(const e of this.state.variables)this._variablesToUpdate.has(e)||this._updating.has(e)||this._variableValueRecorder.recordCurrentValue(e);this._variablesToUpdate.clear(),this._updating.clear()},this._onStateChanged=(e,t)=>{const n=this._variablesToUpdate.size;for(const n of t.variables)if(!e.variables.includes(n)){const e=this._updating.get(n);(null==e?void 0:e.subscription)&&e.subscription.unsubscribe(),this._updating.delete(n),this._variablesToUpdate.delete(n)}for(const n of e.variables)t.variables.includes(n)||this._variableNeedsUpdate(n)&&this._variablesToUpdate.add(n);0===n&&this._variablesToUpdate.size>0&&this._updateNextBatch()},this.addActivationHandler(this._onActivate)}}function sf(e,t,n){n?Gt("SceneVariableSet",`Variable[${e.state.name}]: ${t}`,n):Gt("SceneVariableSet",`Variable[${e.state.name}]: ${t}`)}class lf{getNames(){return this._emptySet}hasDependencyOn(e){return!1}variableUpdateCompleted(e,t){this._variableUpdatesCompleted(e,t)}constructor(e){this._variableUpdatesCompleted=e,this._emptySet=new Set}}Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var uf=Object.defineProperty,cf=Object.getOwnPropertySymbols,df=Object.prototype.hasOwnProperty,pf=Object.prototype.propertyIsEnumerable,ff=(e,t,n)=>t in e?uf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class hf extends jt{getValueOptions(e){var t;const n=(null!=(t=yu.interpolate(this,this.state.query).match(/(?:\\,|[^,])+/g))?t:[]).map((e=>{var t;e=e.replace(/\\,/g,",");const n=null!=(t=/^(.+)\s:\s(.+)$/g.exec(e))?t:[];if(3===n.length){const[,e,t]=n;return{label:e.trim(),value:t.trim()}}return{label:e.trim(),value:e.trim()}}));return(0,k.of)(n)}constructor(e){super(((e,t)=>{for(var n in t||(t={}))df.call(t,n)&&ff(e,n,t[n]);if(cf)for(var n of cf(t))pf.call(t,n)&&ff(e,n,t[n]);return e})({type:"custom",query:"",value:"",text:"",options:[],name:""},e)),this._variableDependency=new zl(this,{statePaths:["query"]})}}hf.Component=({model:e})=>er(e);var mf=Object.defineProperty,gf=Object.getOwnPropertySymbols,bf=Object.prototype.hasOwnProperty,yf=Object.prototype.propertyIsEnumerable,vf=(e,t,n)=>t in e?mf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class wf extends jt{getValueOptions(t){if(!this.state.pluginId)return(0,k.of)([]);const n=(0,d.getDataSourceSrv)().getList({metrics:!0,variables:!1,pluginId:this.state.pluginId});let r;if(this.state.regex){const t=yu.interpolate(this,this.state.regex,void 0,"regex");r=(0,e.stringToJsRegex)(t)}const a=[];for(let e=0;e<n.length;e++){const t=n[e];Of(t,r)&&a.push({label:t.name,value:t.uid}),this.state.defaultOptionEnabled&&Sf(t,r)&&a.push({label:"default",value:"default"})}return 0===a.length?this.setState({error:"No data sources found"}):this.state.error&&this.setState({error:null}),(0,k.of)(a)}constructor(e){super(((e,t)=>{for(var n in t||(t={}))bf.call(t,n)&&vf(e,n,t[n]);if(gf)for(var n of gf(t))yf.call(t,n)&&vf(e,n,t[n]);return e})({type:"datasource",value:"",text:"",options:[],name:"",regex:"",pluginId:""},e)),this._variableDependency=new zl(this,{statePaths:["regex"]})}}function Of(e,t){return!t||t.exec(e.name)}function Sf(e,t){return!!e.isDefault&&(!t||t.exec("default"))}function _f(e,t){const n=["A","B","C","D","E","F","G","H"],r=[];if(t>5)return[];for(const a of n){const n=`${e}${a}`;r.push({name:n,children:_f(n,t+1)})}return r}function xf(e,t,n){if(n>=t.length)return e;if("*"===t[n])return e;const r=t[n];let a=[],o=[r];r.startsWith("{")&&(o=r.replace(/\{|\}/g,"").split(","));for(const r of e)for(const e of o)if(-1!==e.indexOf("*")){const o=e.replace("*","");new RegExp(`^${o}.*`,"gi").test(r.name)&&(a=a.concat(xf([r],t,n+1)))}else r.name===e&&(a=a.concat(xf(r.children,t,n+1)));return a}function Pf(e){return 0===e.indexOf("value")?[{name:e,children:[]}]:xf(_f("",0),e.split("."),0)}wf.Component=({model:e})=>er(e);var jf=Object.defineProperty,Cf=Object.getOwnPropertySymbols,Ef=Object.prototype.hasOwnProperty,Df=Object.prototype.propertyIsEnumerable,kf=(e,t,n)=>t in e?jf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Tf extends jt{getValueOptions(e){const{delayMs:t}=this.state;this.getValueOptionsCount+=1;const n=yu.getQueryController(this);return new k.Observable((e=>{const r={type:"variable",origin:this,cancel:()=>e.complete()};if(n&&n.queryStarted(r),this.setState({loading:!0}),this.state.throwError)throw new Error(this.state.throwError);const a=yu.interpolate(this,this.state.query),o=this.getOptions(a),i=this.completeUpdate.subscribe({next:()=>{const t={issuedQuery:a,loading:!1};this.state.updateOptions&&(t.options=o),this.setState(t),e.next(o),e.complete()}});let s;return t?s=window.setTimeout((()=>this.signalUpdateCompleted()),t):0===t&&this.signalUpdateCompleted(),this.isGettingValues=!0,()=>{i.unsubscribe(),window.clearTimeout(s),this.isGettingValues=!1,this.state.loading&&this.setState({loading:!1}),n&&n.queryCompleted(r)}}))}cancel(){const e=he(this,(e=>e instanceof of?e:void 0));null==e||e.cancel(this)}getOptions(e){return this.state.optionsToReturn?this.state.optionsToReturn:Pf(e).map((e=>({label:e.name,value:e.name})))}signalUpdateCompleted(){this.completeUpdate.next(1)}constructor(t,n=!1){super(((e,t)=>{for(var n in t||(t={}))Ef.call(t,n)&&kf(e,n,t[n]);if(Cf)for(var n of Cf(t))Df.call(t,n)&&kf(e,n,t[n]);return e})({type:"custom",name:"Test",value:"Value",text:"Text",query:"Query",options:[],refresh:e.VariableRefresh.onDashboardLoad,updateOptions:!0},t)),this.completeUpdate=new k.Subject,this.isGettingValues=!0,this.getValueOptionsCount=0,this.isLazy=!1,this._variableDependency=new zl(this,{statePaths:["query"]}),this.isLazy=n}}function Rf({model:e}){const{value:n,key:a,loading:o}=e.useState(),i=(0,t.useCallback)((t=>{e.setValue(t.currentTarget.value)}),[e]),s=(0,t.useCallback)((t=>{"Enter"===t.key&&e.setValue(t.currentTarget.value)}),[e]);return r().createElement(Sn.AutoSizeInput,{id:a,placeholder:"Enter value",minWidth:15,value:n,loading:o,onBlur:i,onKeyDown:s})}Tf.Component=({model:e})=>er(e);var Af=Object.defineProperty,If=Object.getOwnPropertySymbols,Vf=Object.prototype.hasOwnProperty,Mf=Object.prototype.propertyIsEnumerable,Ff=(e,t,n)=>t in e?Af(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Lf extends ae{getValue(){return this.state.value}setValue(e){e!==this.state.value&&(this.setState({value:e}),this.publishEvent(new rt(this),!0))}getKey(){return`var-${this.state.name}`}getUrlState(){return{[this.getKey()]:this.state.value}}updateFromUrl(e){const t=e[this.getKey()];"string"==typeof t&&this.setValue(t)}constructor(e){super(((e,t)=>{for(var n in t||(t={}))Vf.call(t,n)&&Ff(e,n,t[n]);if(If)for(var n of If(t))Mf.call(t,n)&&Ff(e,n,t[n]);return e})({type:"textbox",value:"",name:""},e)),this._urlSync=new ze(this,{keys:()=>[this.getKey()]})}}Lf.Component=({model:e})=>r().createElement(Rf,{model:e}),Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var $f=Object.defineProperty,Nf=Object.getOwnPropertySymbols,Bf=Object.prototype.hasOwnProperty,zf=Object.prototype.propertyIsEnumerable,qf=(e,t,n)=>t in e?$f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Hf extends ae{getKey(){return`var-${this.state.name}`}getUrlState(){return{[this.getKey()]:this.state.value}}updateFromUrl(e){const t={},n=e[this.getKey()];"string"==typeof n&&(n.startsWith("$__auto_interval_")?t.value=vt:t.value=n),this.setState(t)}getOptionsForSelect(){const{value:e,intervals:t,autoEnabled:n}=this.state;let r=t.map((e=>({value:e,label:e})));return n&&(r=[{value:vt,label:"Auto"},...r]),e&&!r.some((t=>t.value===e))&&r.push({value:e,label:e}),r}getValue(){const{value:e,autoStepCount:t,autoMinInterval:n}=this.state;return e===vt?this.getAutoRefreshInteval(t,n):e}getAutoRefreshInteval(t,n){const r=yu.getTimeRange(this).state.value;return e.rangeUtil.calculateInterval(r,t,n).interval}validateAndUpdate(){const{value:e,intervals:t}=this.state;let n=!1;if(e===vt)n=!0;else if(!e&&t.length>0){const e=t[0];this.setState({value:e}),n=!0}return n&&this.publishEvent(new rt(this),!0),(0,k.of)({})}constructor(e){super(((e,t)=>{for(var n in t||(t={}))Bf.call(t,n)&&qf(e,n,t[n]);if(Nf)for(var n of Nf(t))zf.call(t,n)&&qf(e,n,t[n]);return e})({type:"interval",value:"",intervals:["1m","10m","30m","1h","6h","12h","1d","7d","14d","30d"],name:"",autoStepCount:30,autoMinInterval:"10s",autoEnabled:!1,refresh:ju.onTimeRangeChanged},e)),this._onChange=e=>{this.setState({value:e.value}),this.publishEvent(new rt(this),!0)},this._urlSync=new ze(this,{keys:()=>[this.getKey()]})}}Hf.Component=({model:e})=>{const{key:t,value:n}=e.useState();return r().createElement(Sn.Select,{id:t,placeholder:"Select value",width:"auto",value:n,tabSelectsValue:!1,options:e.getOptionsForSelect(),onChange:e._onChange})};var Wf,Uf,Gf=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},Qf=(e,t,n)=>(Gf(e,t,"read from private field"),n?n.call(e):t.get(e)),Kf=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},Yf=(e,t,n,r)=>(Gf(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);class Zf extends e.BusEventWithPayload{}Zf.type="new-scene-object-added";class Xf{initSync(e){var t;if(this._subs&&(Gt("UrlSyncManager","Unregister previous scene state subscription",null==(t=this._sceneRoot)?void 0:t.state.key),this._subs.unsubscribe()),Gt("UrlSyncManager","init",e.state.key),this._sceneRoot=e,this._subs=new k.Subscription,this._subs.add(e.subscribeToEvent(G,(e=>{this.handleSceneObjectStateChanged(e.payload.changedObject)}))),this._subs.add(e.subscribeToEvent(Zf,(e=>{this.handleNewObject(e.payload)}))),this._urlKeyMapper.clear(),this._lastLocation=this._locationService.getLocation(),this.handleNewObject(this._sceneRoot),this._options.updateUrlOnInit){const t=Ou(e);(function(e,t){for(let n in e)if(!xu(t.getAll(n),e[n]))return!0;return!1})(t,this._paramsCache.getParams())&&this._locationService.partial(t,!0)}}cleanUp(e){this._sceneRoot===e&&(Gt("UrlSyncManager","Clean up"),this._subs&&(this._subs.unsubscribe(),this._subs=void 0,Gt("UrlSyncManager","Root deactived, unsub to state","same key",this._sceneRoot.state.key===e.state.key)),this._sceneRoot=void 0,this._lastLocation=void 0)}handleNewLocation(e){this._sceneRoot&&this._lastLocation!==e&&(Gt("UrlSyncManager","handleNewLocation"),this._lastLocation=e,Su(this._sceneRoot,this._paramsCache.getParams(),this._urlKeyMapper))}handleNewObject(e){this._sceneRoot&&Su(e,this._paramsCache.getParams(),this._urlKeyMapper)}handleSceneObjectStateChanged(e){var t,n;if(!e.urlSync)return;const r=e.urlSync.getUrlState(),a=this._locationService.getSearch(),o={};for(const[t,n]of Object.entries(r)){const r=this._urlKeyMapper.getUniqueKey(t,e);xu(a.getAll(r),n)||(o[r]=n)}if(Object.keys(o).length>0){const a=!0!==(null==(n=(t=e.urlSync).shouldCreateHistoryStep)?void 0:n.call(t,r));Gt("UrlSyncManager","onStateChange updating URL"),this._locationService.partial(o,a),this._lastLocation=this._locationService.getLocation()}}getUrlState(e){return Ou(e)}constructor(e={},t=d.locationService){this._urlKeyMapper=new vu,this._options=e,this._locationService=t,this._paramsCache=new Jf(t)}}class Jf{getParams(){const e=this.locationService.getLocation();return Qf(this,Uf)===e||(Yf(this,Uf,e),Yf(this,Wf,new URLSearchParams(e.search))),Qf(this,Wf)}constructor(e){this.locationService=e,Kf(this,Wf,void 0),Kf(this,Uf,void 0)}}function eh(e,n={}){const r=(0,o.useLocation)(),a=Pt(),[i,s]=(0,t.useState)(!1),l=function(e,n){return(0,t.useMemo)((()=>new Xf({updateUrlOnInit:e.updateUrlOnInit,createBrowserHistorySteps:e.createBrowserHistorySteps},n)),[e.updateUrlOnInit,e.createBrowserHistorySteps,n])}(n,a);return(0,t.useEffect)((()=>(l.initSync(e),s(!0),()=>l.cleanUp(e))),[e,l]),(0,t.useEffect)((()=>{const e=a.getLocation(),t=e!==r?e:r;e!==r&&Gt("useUrlSync","latestLocation different from location"),l.handleNewLocation(t)}),[e,l,r,a]),i}function th({children:e,scene:t,updateUrlOnInit:n,createBrowserHistorySteps:r}){return eh(t,{updateUrlOnInit:n,createBrowserHistorySteps:r})?e:null}Wf=new WeakMap,Uf=new WeakMap;class nh extends ae{constructor(e){super(e),this.addActivationHandler((()=>{const e=function(e){const t=window.__grafanaSceneContext;return Gt("setWindowGrafanaScene","set window.__grafanaSceneContext",e),window.__grafanaSceneContext=e,()=>{window.__grafanaSceneContext===e&&(Gt("setWindowGrafanaScene","restore window.__grafanaSceneContext",t),window.__grafanaSceneContext=t)}}(this);return()=>{e()}}))}}nh.Component=function({model:e}){const{body:t,controls:n}=e.useState(),a=(0,Sn.useStyles2)(rh);return r().createElement("div",{className:a.container},n&&r().createElement("div",{className:a.controls},n.map((e=>r().createElement(e.Component,{key:e.state.key,model:e})))),r().createElement("div",{className:a.body},r().createElement(t.Component,{model:t})))};const rh=e=>({container:(0,Pn.css)({flexGrow:1,display:"flex",gap:e.spacing(2),minHeight:"100%",flexDirection:"column"}),body:(0,Pn.css)({flexGrow:1,display:"flex",gap:e.spacing(1)}),controls:(0,Pn.css)({display:"flex",gap:e.spacing(2),alignItems:"flex-end",flexWrap:"wrap"})});class ah extends ae{addItem(e){this.setState({items:this.state.items?[...this.state.items,e]:[e]})}setItems(e){this.setState({items:e})}}ah.Component=function({model:e}){const{items:n=[]}=e.useState(),a=r().useRef(null);(0,t.useEffect)((()=>{a.current&&a.current.focus()}),[]);const o=e=>e.map((e=>{switch(e.type){case"divider":return r().createElement(Sn.Menu.Divider,{key:e.text});case"group":return r().createElement(Sn.Menu.Group,{key:e.text,label:e.text},e.subMenu?o(e.subMenu):void 0);default:return r().createElement(Sn.Menu.Item,{key:e.text,label:e.text,icon:e.iconClassName,childItems:e.subMenu?o(e.subMenu):void 0,url:e.href,onClick:e.onClick,shortcut:e.shortcut,testId:xn.components.Panels.Panel.menuItems(e.text)})}}));return r().createElement(Sn.Menu,{ref:a},o(n))};class oh extends ae{}function ih(e){return e instanceof am}oh.Component=function({model:e}){const{body:t}=e.useState(),n=e.parent;if(n&&!(n instanceof Qh)&&!ih(n))throw new Error("SceneGridItem must be a child of SceneGridLayout or SceneGridRow");return t?r().createElement(t.Component,{model:t}):null};var sh=f(121),lh=f.n(sh);var uh=Object.defineProperty,ch=Object.getOwnPropertySymbols,dh=Object.prototype.hasOwnProperty,ph=Object.prototype.propertyIsEnumerable,fh=(e,t,n)=>t in e?uh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function hh(){const e=(0,t.useRef)(void 0);return null!=e.current||(e.current=(0,be.uniqueId)()),e.current}const mh=r().forwardRef(((e,n)=>{var a=e,{children:o,onLoad:i,onChange:s,className:l}=a,u=((e,t)=>{var n={};for(var r in e)dh.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&ch)for(var r of ch(e))t.indexOf(r)<0&&ph.call(e,r)&&(n[r]=e[r]);return n})(a,["children","onLoad","onChange","className"]);const c=hh(),{hideEmpty:d}=(0,Sn.useStyles2)(gh),[p,f]=(0,t.useState)(!1),[h,m]=(0,t.useState)(!1),g=(0,t.useRef)(null);var b;(0,t.useImperativeHandle)(n,(()=>g.current)),b=()=>{mh.addCallback(c,(e=>{!p&&e.isIntersecting&&(f(!0),null==i||i()),m(e.isIntersecting),null==s||s(e.isIntersecting)}));const e=g.current;return e&&mh.observer.observe(e),()=>{e&&mh.observer.unobserve(e),delete mh.callbacks[c],0===Object.keys(mh.callbacks).length&&mh.observer.disconnect()}},(0,t.useEffect)(b,[]);const y=`${p?d:""} ${l}`;return r().createElement("div",((e,t)=>{for(var n in t||(t={}))dh.call(t,n)&&fh(e,n,t[n]);if(ch)for(var n of ch(t))ph.call(t,n)&&fh(e,n,t[n]);return e})({id:c,ref:g,className:y},u),p&&("function"==typeof o?o({isInView:h}):o))}));function gh(){return{hideEmpty:(0,Pn.css)({"&:empty":{display:"none"}})}}mh.displayName="LazyLoader",mh.callbacks={},mh.addCallback=(e,t)=>mh.callbacks[e]=t,mh.observer=new IntersectionObserver((e=>{for(const t of e)"function"==typeof mh.callbacks[t.target.id]&&mh.callbacks[t.target.id](t)}),{rootMargin:"100px"});var bh=Object.defineProperty,yh=Object.defineProperties,vh=Object.getOwnPropertyDescriptors,wh=Object.getOwnPropertySymbols,Oh=Object.prototype.hasOwnProperty,Sh=Object.prototype.propertyIsEnumerable,_h=(e,t,n)=>t in e?bh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,xh=(e,t)=>{for(var n in t||(t={}))Oh.call(t,n)&&_h(e,n,t[n]);if(wh)for(var n of wh(t))Sh.call(t,n)&&_h(e,n,t[n]);return e},Ph=(e,t)=>yh(e,vh(t)),jh=(e,t)=>{var n={};for(var r in e)Oh.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&wh)for(var r of wh(e))t.indexOf(r)<0&&Sh.call(e,r)&&(n[r]=e[r]);return n};const Ch=r().forwardRef(((e,t)=>{var n;const a=e,{grid:o,layoutItem:i,index:s,totalCount:l,isLazy:u,style:c,onLoad:d,onChange:p,children:f}=a,h=jh(a,["grid","layoutItem","index","totalCount","isLazy","style","onLoad","onChange","children"]),m=o.getSceneLayoutChild(i.i),g=null==(n=m.getClassName)?void 0:n.call(m),b=r().createElement(m.Component,{model:m,key:m.state.key});return u?r().createElement(mh,Ph(xh({},h),{key:m.state.key,"data-griditem-key":m.state.key,className:(0,Pn.cx)(g,e.className),style:c,ref:t}),b,f):r().createElement("div",Ph(xh({},h),{ref:t,key:m.state.key,"data-griditem-key":m.state.key,className:(0,Pn.cx)(g,e.className),style:c}),b,f)}));function Eh(e,t,n){e.current?t?e.current.classList.add("react-grid-layout--enable-move-animations"):e.current.classList.remove("react-grid-layout--enable-move-animations"):n||setTimeout((()=>Eh(e,t,!0)),50)}Ch.displayName="GridItemWrapper";const Dh=r().forwardRef(((e,t)=>{var n=jh(e,["handleAxis"]);const a=(0,Sn.useStyles2)(kh);return r().createElement("div",Ph(xh({ref:t},n),{className:`${a} scene-resize-handle`}),r().createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r().createElement("path",{d:"M21 15L15 21M21 8L8 21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})))}));function kh(e){return(0,Pn.css)({position:"absolute",bottom:0,right:0,zIndex:999,padding:e.spacing(1.5,0,0,1.5),color:e.colors.border.strong,cursor:"se-resize","&:hover":{color:e.colors.text.link},svg:{display:"block"},".react-resizable-hide &":{display:"none"}})}Dh.displayName="ResizeHandle";var Th=Object.defineProperty,Rh=Object.defineProperties,Ah=Object.getOwnPropertyDescriptors,Ih=Object.getOwnPropertySymbols,Vh=Object.prototype.hasOwnProperty,Mh=Object.prototype.propertyIsEnumerable,Fh=(e,t,n)=>t in e?Th(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Lh=Object.defineProperty,$h=Object.defineProperties,Nh=Object.getOwnPropertyDescriptors,Bh=Object.getOwnPropertySymbols,zh=Object.prototype.hasOwnProperty,qh=Object.prototype.propertyIsEnumerable,Hh=(e,t,n)=>t in e?Lh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Wh=(e,t)=>{for(var n in t||(t={}))zh.call(t,n)&&Hh(e,n,t[n]);if(Bh)for(var n of Bh(t))qh.call(t,n)&&Hh(e,n,t[n]);return e},Uh=(e,t)=>$h(e,Nh(t));const Gh=class extends ae{isDraggable(){var e;return null!=(e=this.state.isDraggable)&&e}getDragClass(){return`grid-drag-handle-${this.state.key}`}getDragClassCancel(){return"grid-drag-cancel"}toggleRow(e){var t,n;if(!e.state.isCollapsed)return e.setState({isCollapsed:!0}),void this.setState({});const r=e.state.children;if(0===r.length)return e.setState({isCollapsed:!1}),void this.setState({});const a=e.state.y,o=(null!=(t=r[0].state.y)?t:a)-(a+1);let i=a;for(const e of r){const t=Wh({},e.state);t.y=null!=(n=t.y)?n:a,t.y-=o,t.y!==e.state.y&&e.setState(t),i=Math.max(i,Number(t.y)+Number(t.height))}const s=i-a-1;for(const t of this.state.children)if(t.state.y>a&&this.pushChildDown(t,s),ih(t)&&t!==e)for(const e of t.state.children)e.state.y>a&&this.pushChildDown(e,s);e.setState({isCollapsed:!1}),this.setState({})}ignoreLayoutChange(e){this._skipOnLayoutChange=e}getSceneLayoutChild(e){for(const t of this.state.children){if(t.state.key===e)return t;if(t instanceof am)for(const n of t.state.children)if(n.state.key===e)return n}throw new Error("Scene layout child not found for GridItem")}pushChildDown(e,t){e.setState({y:e.state.y+t})}findGridItemSceneParent(e,t){for(let n=t;n>=0;n--){const t=e[n],r=this.getSceneLayoutChild(t.i);if(r instanceof am)return r.state.isCollapsed?this:r}return this}isRowDropValid(e,t,n){if(e[e.length-1].i===t.i)return!0;const r=this.getSceneLayoutChild(e[n+1].i);return r instanceof am||r.parent instanceof Gh}moveChildTo(e,t){const n=e.parent;let r=this.state.children;const a=e.clone({key:e.state.key});if(n instanceof am){const o=n.clone();if(o.setState({children:o.state.children.filter((t=>t.state.key!==e.state.key))}),r=r.map((e=>e===n?o:e)),t instanceof am){const e=t.clone();e.setState({children:[...e.state.children,a]}),r=r.map((n=>n===t?e:n))}else r=[...r,a]}else if(!(t instanceof Gh)){r=r.filter((t=>t.state.key!==e.state.key));const n=t.clone();n.setState({children:[...n.state.children,a]}),r=r.map((e=>e===t?n:e))}return r}toGridCell(e){var t,n;const r=e.state;let a=null!=(t=r.x)?t:0,o=null!=(n=r.y)?n:0;const i=Number.isInteger(Number(r.width))?Number(r.width):4,s=Number.isInteger(Number(r.height))?Number(r.height):4;let l=e.state.isDraggable,u=e.state.isResizable;return e instanceof am&&(l=!!e.state.isCollapsed,u=!1),{i:e.state.key,x:a,y:o,h:s,w:i,isResizable:u,isDraggable:l}}buildGridLayout(e,t){let n=[];for(const e of this.state.children)if(n.push(this.toGridCell(e)),e instanceof am&&!e.state.isCollapsed)for(const t of e.state.children)n.push(this.toGridCell(t));return n=Yh(n),this.state.UNSAFE_fitPanels&&(n=function(e,t){const n=t-32,r=Math.max(...e.map((e=>e.h+e.y)))/Math.floor(n/38);return e.map((e=>{return t=((e,t)=>{for(var n in t||(t={}))Vh.call(t,n)&&Fh(e,n,t[n]);if(Ih)for(var n of Ih(t))Mh.call(t,n)&&Fh(e,n,t[n]);return e})({},e),n={y:Math.round(e.y/r)||0,h:Math.round(e.h/r)||1},Rh(t,Ah(n));var t,n}))}(n,t)),e<768?(this._skipOnLayoutChange=!0,n.map((e=>Uh(Wh({},e),{w:24})))):(this._skipOnLayoutChange=!1,n)}constructor(e){super(Uh(Wh({},e),{children:Kh(e.children)})),this._skipOnLayoutChange=!1,this._oldLayout=[],this._loadOldLayout=!1,this.onLayoutChange=e=>{if(this._skipOnLayoutChange)this._skipOnLayoutChange=!1;else{this._loadOldLayout&&(e=[...this._oldLayout],this._loadOldLayout=!1);for(const r of e){const e=this.getSceneLayoutChild(r.i),a={x:r.x,y:r.y,width:r.w,height:r.h};n=a,((t=e.state).x!==n.x||t.y!==n.y||t.width!==n.width||t.height!==n.height)&&e.setState(Wh({},a))}var t,n;this.setState({children:Kh(this.state.children)})}},this.onResizeStop=(e,t,n)=>{this.getSceneLayoutChild(n.i).setState({width:n.w,height:n.h})},this.onDragStart=e=>{this._oldLayout=[...e]},this.onDragStop=(e,t,n)=>{const r=this.getSceneLayoutChild(n.i);e=Yh(e);for(let t=0;t<e.length;t++){const n=e[t],r=this.getSceneLayoutChild(n.i),a=r.state;(null==a?void 0:a.x)===n.x&&(null==a?void 0:a.y)===n.y||r.setState({x:n.x,y:n.y})}const a=e.findIndex((e=>e.i===n.i));let o=this.findGridItemSceneParent(e,a-1),i=this.state.children;r instanceof am&&o instanceof am&&(this.isRowDropValid(e,n,a)||(this._loadOldLayout=!0),o=this),o!==r.parent&&(i=this.moveChildTo(r,o)),this.setState({children:Kh(i)}),this._skipOnLayoutChange=!0}}};let Qh=Gh;function Kh(e){return e.forEach((e=>{e instanceof am&&e.setState({children:Kh(e.state.children)})})),[...e].sort(((e,t)=>e.state.y-t.state.y||e.state.x-t.state.x))}function Yh(e){return[...e].sort(((e,t)=>e.y-t.y||e.x-t.x))}Qh.Component=function({model:e}){const{children:n,isLazy:a,isDraggable:o,isResizable:i}=e.useState(),[s,{width:l,height:u}]=qu(),c=(0,t.useRef)(null);return(0,t.useEffect)((()=>{Eh(c,!!o)}),[o]),function(e){if(e.some((e=>void 0===e.state.height||void 0===e.state.width||void 0===e.state.x||void 0===e.state.y)))throw new Error("All children must have a size specified")}(n),r().createElement("div",{ref:s,style:{flex:"1 1 auto",position:"relative",zIndex:1,width:"100%"}},((t,n)=>{if(!t||!n)return null;const s=e.buildGridLayout(t,n);return r().createElement("div",{ref:c,style:{width:`${t}px`,height:"100%"},className:"react-grid-layout"},r().createElement(lh(),{width:t,isDraggable:o&&t>768,isResizable:null!=i&&i,containerPadding:[0,0],useCSSTransforms:!0,margin:[8,8],cols:24,rowHeight:30,draggableHandle:`.grid-drag-handle-${e.state.key}`,draggableCancel:".grid-drag-cancel",layout:s,onDragStart:e.onDragStart,onDragStop:e.onDragStop,onResizeStop:e.onResizeStop,onLayoutChange:e.onLayoutChange,isBounded:!1,resizeHandle:r().createElement(Dh,null)},s.map(((t,n)=>r().createElement(Ch,{key:t.i,grid:e,layoutItem:t,index:n,isLazy:a,totalCount:s.length})))))})(l,u))};var Zh=Object.defineProperty,Xh=Object.defineProperties,Jh=Object.getOwnPropertyDescriptors,em=Object.getOwnPropertySymbols,tm=Object.prototype.hasOwnProperty,nm=Object.prototype.propertyIsEnumerable,rm=(e,t,n)=>t in e?Zh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class am extends ae{getGridLayout(){const e=this.parent;if(!(e&&e instanceof Qh))throw new Error("SceneGridRow must be a child of SceneGridLayout");return e}getUrlState(){return{rowc:this.state.isCollapsed?"1":"0"}}updateFromUrl(e){null!=e.rowc&&e.rowc!==this.getUrlState().rowc&&this.onCollapseToggle()}constructor(e){var t;super((t=((e,t)=>{for(var n in t||(t={}))tm.call(t,n)&&rm(e,n,t[n]);if(em)for(var n of em(t))nm.call(t,n)&&rm(e,n,t[n]);return e})({children:e.children||[],isCollapsible:e.isCollapsible||!0,title:e.title||""},e),Xh(t,Jh({x:0,height:1,width:24})))),this._variableDependency=new zl(this,{statePaths:["title"]}),this.onCollapseToggle=()=>{this.state.isCollapsible&&this.getGridLayout().toggleRow(this)}}}am.Component=function({model:e}){const t=(0,Sn.useStyles2)(om),{isCollapsible:n,isCollapsed:a,title:o,actions:i,children:s}=e.useState(),l=e.getGridLayout(),u=l.getDragClass(),c=l.isDraggable(),d=s?s.length:0,p=1===d?"panel":"panels";return r().createElement("div",{className:(0,Pn.cx)(t.row,a&&t.rowCollapsed)},r().createElement("div",{className:t.rowTitleAndActionsGroup},r().createElement("button",{onClick:e.onCollapseToggle,className:t.rowTitleButton,"aria-label":a?"Expand row":"Collapse row","data-testid":xn.components.DashboardRow.title(yu.interpolate(e,o,void 0,"text"))},n&&r().createElement(Sn.Icon,{name:a?"angle-right":"angle-down"}),r().createElement("span",{className:t.rowTitle,role:"heading"},yu.interpolate(e,o,void 0,"text"))),r().createElement("span",{className:(0,Pn.cx)(t.panelCount,a&&t.panelCountCollapsed)},"(",d," ",p,")"),i&&r().createElement("div",{className:t.rowActions},r().createElement(i.Component,{model:i}))),c&&a&&r().createElement("div",{className:(0,Pn.cx)(t.dragHandle,u)},r().createElement(Sn.Icon,{name:"draggabledots"})))};const om=e=>({row:(0,Pn.css)({width:"100%",height:"30px",display:"flex",justifyContent:"space-between",gap:e.spacing(1)}),rowTitleButton:(0,Pn.css)({display:"flex",alignItems:"center",cursor:"pointer",background:"transparent",border:"none",minWidth:0,gap:e.spacing(1)}),rowCollapsed:(0,Pn.css)({borderBottom:`1px solid ${e.colors.border.weak}`}),rowTitle:(0,Pn.css)({fontSize:e.typography.h5.fontSize,fontWeight:e.typography.fontWeightMedium,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",flexGrow:1,minWidth:0}),collapsedInfo:(0,Pn.css)({fontSize:e.typography.bodySmall.fontSize,color:e.colors.text.secondary,display:"flex",alignItems:"center",flexGrow:1}),rowTitleAndActionsGroup:(0,Pn.css)({display:"flex",minWidth:0,"&:hover, &:focus-within":{"& > div":{opacity:1}}}),rowActions:(0,Pn.css)({display:"flex",whiteSpace:"nowrap",opacity:0,transition:"200ms opacity ease-in 200ms","&:hover, &:focus-within":{opacity:1}}),dragHandle:(0,Pn.css)({display:"flex",padding:e.spacing(0,1),alignItems:"center",justifyContent:"flex-end",cursor:"move",color:e.colors.text.secondary,"&:hover":{color:e.colors.text.primary}}),panelCount:(0,Pn.css)({whiteSpace:"nowrap",paddingLeft:e.spacing(2),color:e.colors.text.secondary,fontStyle:"italic",fontSize:e.typography.size.sm,fontWeight:"normal",display:"none",lineHeight:"30px"}),panelCountCollapsed:(0,Pn.css)({display:"inline-block"})});class im extends ae{constructor(){super(...arguments),this.onToggle=()=>{this.setState({isCollapsed:!this.state.isCollapsed})},this.onRemove=()=>{const e=this.parent;"body"in e.state&&e.setState({body:void 0})}}}im.Component=function({model:e}){const{title:t,isCollapsed:n,canCollapse:a,canRemove:o,body:i,controls:s}=e.useState(),l=(0,Sn.useStyles2)(om),u=(0,Sn.useStyles2)(sm),c=(null!=s?s:[]).map((e=>r().createElement(e.Component,{key:e.state.key,model:e})));return o&&c.push(r().createElement(Sn.ToolbarButton,{icon:"times",variant:"default",onClick:e.onRemove,key:"remove-button","aria-label":"Remove scene"})),r().createElement("div",{className:u.wrapper},r().createElement("div",{className:(0,Pn.cx)(u.row,n&&u.rowCollapsed)},r().createElement("button",{onClick:e.onToggle,className:l.rowTitleButton,"aria-label":n?"Expand scene":"Collapse scene"},a&&r().createElement(Sn.Icon,{name:n?"angle-right":"angle-down"}),r().createElement("span",{className:l.rowTitle,role:"heading"},yu.interpolate(e,t,void 0,"text"))),r().createElement("div",{className:u.actions},c)),!n&&r().createElement(i.Component,{model:i}))};const sm=e=>({wrapper:(0,Pn.css)({display:"flex",flexDirection:"column",flexGrow:1,gap:e.spacing(1)}),row:(0,Pn.css)({width:"100%",display:"flex",justifyContent:"space-between",gap:e.spacing(1)}),rowCollapsed:(0,Pn.css)({borderBottom:`1px solid ${e.colors.border.weak}`,paddingBottom:e.spacing(1)}),actions:(0,Pn.css)({display:"flex",alignItems:"center",gap:e.spacing(1),justifyContent:"flex-end",flexGrow:1})});class lm extends ae{constructor(){super(...arguments),this._variableDependency=new zl(this,{statePaths:["text"]})}}lm.Component=({model:e})=>{const{text:t,fontSize:n=20,align:a="left",key:o,spacing:i}=e.useState(),s=(0,Sn.useTheme2)(),l=(0,Pn.css)({fontSize:n,display:"flex",flexGrow:1,alignItems:"center",padding:i?s.spacing(i,0):void 0,justifyContent:a});return r().createElement("div",{className:l,"data-testid":o},yu.interpolate(e,t))},class extends ae{}.Component=({model:e})=>{const t=e.useState();return r().createElement(Sn.ToolbarButton,{onClick:t.onClick,icon:t.icon})};class um extends ae{}um.Component=({model:e})=>{const t=e.useState();return r().createElement("div",{style:{display:"flex"}},t.label&&r().createElement(Or,{label:t.label}),r().createElement(Sn.Input,{defaultValue:t.value,width:8,onBlur:t=>{e.state.onChange(parseInt(t.currentTarget.value,10))}}))};class cm extends ae{constructor(){super(...arguments),this.onZoom=()=>{const t=yu.getTimeRange(this),n=function(t,n){const r=t.to.valueOf()-t.from.valueOf(),a=t.to.valueOf()-r/2,o=0===r?3e4:2*r,i=a+o/2,s=a-o/2;return{from:(0,e.toUtc)(s),to:(0,e.toUtc)(i),raw:{from:(0,e.toUtc)(s),to:(0,e.toUtc)(i)}}}(t.state.value);t.onTimeRangeChange(n)},this.onChangeFiscalYearStartMonth=e=>{yu.getTimeRange(this).setState({fiscalYearStartMonth:e})},this.toAbsolute=()=>{const t=yu.getTimeRange(this),n=t.state.value,r=(0,e.toUtc)(n.from),a=(0,e.toUtc)(n.to);t.onTimeRangeChange({from:r,to:a,raw:{from:r,to:a}})},this.onMoveBackward=()=>{const e=yu.getTimeRange(this),{state:{value:t}}=e;e.onTimeRangeChange(pm(dm.Backward,t,Date.now()))},this.onMoveForward=()=>{const e=yu.getTimeRange(this),{state:{value:t}}=e;e.onTimeRangeChange(pm(dm.Forward,t,Date.now()))}}}cm.Component=function({model:n}){const{hidePicker:a,isOnCanvas:o}=n.useState(),i=yu.getTimeRange(n),s=i.getTimeZone(),l=i.useState(),[u,c]=function(e,n,r){if(!Nu)return[n,$u,$u];if(!e)throw new Error("useLocalStorage key may not be falsy");var a=r?r.raw?function(e){return e}:r.deserializer:JSON.parse,o=(0,t.useRef)((function(e){try{var t=r?r.raw?String:r.serializer:JSON.stringify,o=localStorage.getItem(e);return null!==o?a(o):(n&&localStorage.setItem(e,t(n)),n)}catch(e){return n}})),i=(0,t.useState)((function(){return o.current(e)})),s=i[0],l=i[1];(0,t.useLayoutEffect)((function(){return l(o.current(e))}),[e]);var u=(0,t.useCallback)((function(t){try{var n,o="function"==typeof t?t(s):t;if(void 0===o)return;n=r?r.raw?"string"==typeof o?o:JSON.stringify(o):r.serializer?r.serializer(o):JSON.stringify(o):JSON.stringify(o),localStorage.setItem(e,n),l(a(n))}catch(e){}}),[e,l]),c=(0,t.useCallback)((function(){try{localStorage.removeItem(e),l(void 0)}catch(e){}}),[e,l]);return[s,u,c]}(fm,[],{raw:!1,serializer:mm,deserializer:hm});return a?null:r().createElement(Sn.TimeRangePicker,{isOnCanvas:null==o||o,value:l.value,onChange:t=>{var n;n=t,((0,e.isDateTime)(n.raw.from)||(0,e.isDateTime)(n.raw.to))&&c([t,...null!=u?u:[]]),i.onTimeRangeChange(t)},timeZone:s,fiscalYearStartMonth:l.fiscalYearStartMonth,onMoveBackward:n.onMoveBackward,onMoveForward:n.onMoveForward,onZoom:n.onZoom,onChangeTimeZone:i.onTimeZoneChange,onChangeFiscalYearStartMonth:n.onChangeFiscalYearStartMonth,weekStart:l.weekStart,history:u})};var dm=(e=>(e[e.Backward=0]="Backward",e[e.Forward=1]="Forward",e))(dm||{});function pm(t,n,r){const a=n.to.valueOf(),o=n.from.valueOf(),i=(a-o)/2;let s,l;0===t?(s=o-i,l=a-i):(s=o+i,l=a+i,l>r&&a<r&&(l=r,s=o));const u=(0,e.toUtc)(s),c=(0,e.toUtc)(l);return{from:u,to:c,raw:{from:u,to:c}}}const fm="grafana.dashboard.timepicker.history";function hm(t){return JSON.parse(t).map((t=>e.rangeUtil.convertRawToRange(t,"utc",void 0,"YYYY-MM-DD HH:mm:ss")))}function mm(e){return JSON.stringify((t=e.map((e=>({from:"string"==typeof e.raw.from?e.raw.from:e.raw.from.toISOString(),to:"string"==typeof e.raw.to?e.raw.to:e.raw.to.toISOString()}))),(0,be.uniqBy)(t,(e=>e.from+e.to)).slice(0,4)));var t}var gm=Object.defineProperty,bm=Object.defineProperties,ym=Object.getOwnPropertyDescriptors,vm=Object.getOwnPropertySymbols,wm=Object.prototype.hasOwnProperty,Om=Object.prototype.propertyIsEnumerable,Sm=(e,t,n)=>t in e?gm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const _m=["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"];class xm extends ae{getUrlState(){let e=this.state.refresh;return"string"==typeof e&&0!==e.length||(e=void 0),{refresh:e}}updateFromUrl(t){const{intervals:n}=this.state;let r=t.refresh;"string"==typeof r&&function(t){try{return e.rangeUtil.describeInterval(t).count>0}catch(e){return!1}}(r)&&((null==n?void 0:n.includes(r))?this.setState({refresh:r}):this.setState({refresh:n?n[0]:void 0}))}isTabVisible(){return void 0===document.visibilityState||"visible"===document.visibilityState}constructor(t){var n,r,a,o,i;super((o=((e,t)=>{for(var n in t||(t={}))wm.call(t,n)&&Sm(e,n,t[n]);if(vm)for(var n of vm(t))Om.call(t,n)&&Sm(e,n,t[n]);return e})({refresh:""},t),i={autoValue:void 0,autoEnabled:null==(n=t.autoEnabled)||n,autoMinInterval:null!=(r=t.autoMinInterval)?r:d.config.minRefreshInterval,intervals:(null!=(a=t.intervals)?a:_m).filter((n=>{var r;const a=null!=(r=t.minRefreshInterval)?r:d.config.minRefreshInterval;try{return!a||e.rangeUtil.intervalToMs(n)>=e.rangeUtil.intervalToMs(a)}catch(e){return!1}}))},bm(o,ym(i)))),this._urlSync=new ze(this,{keys:["refresh"]}),this._autoRefreshBlocked=!1,this.onRefresh=()=>{const e=yu.getQueryController(this);if(null==e?void 0:e.state.isRunning)return void e.cancelAll();const t=yu.getTimeRange(this);this._intervalTimer&&clearInterval(this._intervalTimer),t.onRefresh(),this.setupIntervalTimer()},this.onIntervalChanged=e=>{this.setState({refresh:e}),this.setupIntervalTimer()},this.setupAutoTimeRangeListener=()=>yu.getTimeRange(this).subscribeToState(((e,t)=>{e.from===t.from&&e.to===t.to||this.setupIntervalTimer()})),this.calculateAutoRefreshInterval=()=>{var t;const n=yu.getTimeRange(this),r=null!=(t=null==window?void 0:window.innerWidth)?t:2e3;return e.rangeUtil.calculateInterval(n.state.value,r,this.state.autoMinInterval)},this.setupIntervalTimer=()=>{var t;const n=yu.getTimeRange(this),{refresh:r,intervals:a}=this.state;if((this._intervalTimer||""===r)&&clearInterval(this._intervalTimer),""===r)return;if(r!==Sn.RefreshPicker.autoOption.value&&a&&!a.includes(r))return;let o;if(null==(t=this._autoTimeRangeListener)||t.unsubscribe(),r===Sn.RefreshPicker.autoOption.value){const e=this.calculateAutoRefreshInterval();o=e.intervalMs,this._autoTimeRangeListener=this.setupAutoTimeRangeListener(),e.interval!==this.state.autoValue&&this.setState({autoValue:e.interval})}else o=e.rangeUtil.intervalToMs(r);this._intervalTimer=setInterval((()=>{this.isTabVisible()?n.onRefresh():this._autoRefreshBlocked=!0}),o)},this.addActivationHandler((()=>{this.setupIntervalTimer();const e=()=>{this._autoRefreshBlocked&&"visible"===document.visibilityState&&(this._autoRefreshBlocked=!1,this.onRefresh())};return document.addEventListener("visibilitychange",e),()=>{var t;this._intervalTimer&&clearInterval(this._intervalTimer),document.removeEventListener("visibilitychange",e),null==(t=this._autoTimeRangeListener)||t.unsubscribe()}}))}}xm.Component=function({model:e}){var t;const{refresh:n,intervals:a,autoEnabled:o,autoValue:i,isOnCanvas:s,primary:l,withText:u}=e.useState(),c=function(e){const t=yu.getQueryController(e);return!!t&&t.useState().isRunning}(e);let d,p,f=n===(null==(t=Sn.RefreshPicker.autoOption)?void 0:t.value)?i:u?"Refresh":void 0;return c&&(d="Cancel all queries",u&&(f="Cancel")),u&&(p="96px"),r().createElement(Sn.RefreshPicker,{showAutoInterval:o,value:n,intervals:a,tooltip:d,width:p,text:f,onRefresh:e.onRefresh,primary:l,onIntervalChanged:e.onIntervalChanged,isLoading:c,isOnCanvas:null==s||s})};const Pm=e=>`${e}-compare`;var jm=Object.defineProperty,Cm=Object.defineProperties,Em=Object.getOwnPropertyDescriptors,Dm=Object.getOwnPropertySymbols,km=Object.prototype.hasOwnProperty,Tm=Object.prototype.propertyIsEnumerable,Rm=(e,t,n)=>t in e?jm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Am=(e,t)=>{for(var n in t||(t={}))km.call(t,n)&&Rm(e,n,t[n]);if(Dm)for(var n of Dm(t))Tm.call(t,n)&&Rm(e,n,t[n]);return e},Im=(e,t)=>Cm(e,Em(t));const Vm="__previousPeriod",Mm="__noPeriod",Fm={label:"Previous period",value:Vm},Lm={label:"No comparison",value:Mm},$m=[{label:"Day before",value:"24h"},{label:"Week before",value:"1w"},{label:"Month before",value:"1M"}];class Nm extends ae{getExtraQueries(e){const t=[],n=this.getCompareTimeRange(e.range);if(!n)return t;const r=e.targets.filter((e=>!1!==e.timeRangeCompare));return r.length&&t.push({req:Im(Am({},e),{targets:r,range:n}),processor:Bm}),t}shouldRerun(e,t,n){return e.compareWith!==t.compareWith&&void 0!==n.find((e=>!1!==e.timeRangeCompare))}getCompareTimeRange(t){let n,r;if(this.state.compareWith){if(this.state.compareWith===Vm){const a=t.to.diff(t.from);n=(0,e.dateTime)(t.from).subtract(a),r=(0,e.dateTime)(t.to).subtract(a)}else n=(0,e.dateTime)(t.from).subtract(e.rangeUtil.intervalToMs(this.state.compareWith)),r=(0,e.dateTime)(t.to).subtract(e.rangeUtil.intervalToMs(this.state.compareWith));return{from:n,to:r,raw:{from:n,to:r}}}}getUrlState(){return{compareWith:this.state.compareWith}}updateFromUrl(e){if(!e.compareWith)return;const t=He(e.compareWith);t&&(this.getCompareOptions(yu.getTimeRange(this).state.value).find((({value:e})=>e===t))?this.setState({compareWith:t}):this.setState({compareWith:"__previousPeriod"}))}constructor(t){super(Am({compareOptions:$m},t)),this._urlSync=new ze(this,{keys:["compareWith"]}),this._onActivate=()=>{const e=yu.getTimeRange(this);this.setState({compareOptions:this.getCompareOptions(e.state.value)}),this._subs.add(e.subscribeToState((e=>{const t=this.getCompareOptions(e.value),n={compareOptions:t};Boolean(this.state.compareWith)&&!t.find((({value:e})=>e===this.state.compareWith))&&(n.compareWith=Vm),this.setState(n)})))},this.getCompareOptions=t=>{const n=Math.ceil(t.to.diff(t.from)),r=$m.findIndex((({value:t})=>e.rangeUtil.intervalToMs(t)>=n));return[Lm,Fm,...$m.slice(r).map((({label:e,value:t})=>({label:e,value:t})))]},this.onCompareWithChanged=e=>{e===Mm?this.onClearCompare():this.setState({compareWith:e})},this.onClearCompare=()=>{this.setState({compareWith:void 0})},this.addActivationHandler(this._onActivate)}}Nm.Component=function({model:e}){var t;const n=(0,Sn.useStyles2)(zm),{compareWith:a,compareOptions:o}=e.useState(),[i,s]=r().useState(a),l=null!=(t=o.find((({value:e})=>e===i)))?t:Fm,u=o.find((({value:e})=>e===a)),c=Boolean(u),d=()=>{c?(s(a),e.onClearCompare()):c||e.onCompareWithChanged(l.value)};return r().createElement(Sn.ButtonGroup,null,r().createElement(Sn.ToolbarButton,{variant:"canvas",tooltip:"Enable time frame comparison",onClick:e=>{e.stopPropagation(),e.preventDefault(),d()}},r().createElement(Sn.Checkbox,{label:" ",value:c,onClick:d}),"Comparison"),c?r().createElement(Sn.ButtonSelect,{variant:"canvas",value:u,options:o,onChange:t=>{e.onCompareWithChanged(t.value)}}):r().createElement(Sn.ToolbarButton,{className:n.previewButton,disabled:!0,variant:"canvas",isOpen:!1},l.label))};const Bm=(t,n)=>{const r=n.timeRange.from.diff(t.timeRange.from);return n.series.forEach((t=>{t.refId=Pm(t.refId||""),t.meta=Im(Am({},t.meta),{timeCompare:{diffMs:r,isTimeShiftQuery:!0}}),t.fields.forEach((t=>(t.type===e.FieldType.time&&(t.values=t.values.map((e=>r<0?e-r:e+r))),t.config=Im(Am({},t.config),{color:{mode:"fixed",fixedColor:d.config.theme.palette.gray60}}),t)))})),(0,k.of)(n)};function zm(e){return{previewButton:(0,Pn.css)({"&:disabled":{border:`1px solid ${e.colors.secondary.border}`,color:e.colors.text.disabled,opacity:1}})}}class qm extends ae{performRepeat(e){const t=[];for(let n=0;n<e.series.length;n++){const r=this.state.getLayoutChild(e,e.series[n],n);t.push(r)}this.state.body.setState({children:t})}constructor(t){super(t),this.addActivationHandler((()=>{const t=yu.getData(this);this._subs.add(t.subscribeToState((t=>{var n;(null==(n=t.data)?void 0:n.state)===e.LoadingState.Done&&this.performRepeat(t.data)}))),t.state.data&&this.performRepeat(t.state.data)}))}}qm.Component=({model:e})=>{const{body:t}=e.useState();return r().createElement(t.Component,{model:t})};class Hm extends ae{performRepeat(){if(this._variableDependency.hasDependencyInLoadingState())return;const e=yu.lookupVariable(this.state.variableName,this);if(!(e instanceof jt))return void console.error("SceneByVariableRepeater: variable is not a MultiValueVariable");const t=function(e){const{value:t,text:n,options:r}=e.state;return e.hasAllValue()?r:Array.isArray(t)&&Array.isArray(n)?t.map(((e,t)=>({value:e,label:n[t]}))):[{value:t,label:n}]}(e),n=[];for(const e of t){const t=this.state.getLayoutChild(e);n.push(t)}this.state.body.setState({children:n})}constructor(e){super(e),this._variableDependency=new zl(this,{variableNames:[this.state.variableName],onVariableUpdateCompleted:()=>this.performRepeat()}),this.addActivationHandler((()=>this.performRepeat()))}}Hm.Component=({model:e})=>{const{body:t}=e.useState();return r().createElement(t.Component,{model:t})};const Wm=class extends ae{get Component(){return Wm.Component}constructor(){super({})}};let Um=Wm;Um.Component=e=>r().createElement("div",{style:{flexGrow:1}});class Gm extends ae{toggleDirection(){this.setState({direction:"row"===this.state.direction?"column":"row"})}isDraggable(){return!1}}Gm.Component=function({model:e,parentState:n}){const{children:a,isHidden:o}=e.useState(),i=function(e,n){return(0,t.useMemo)((()=>{var t,r,a,o,i,s,l,u,c,p;const{direction:f="row",wrap:h}=e,m=d.config.theme2,g={};return n?Km(g,e,n):(g.display="flex",g.flexGrow=1,g.minWidth=e.minWidth,g.minHeight=e.minHeight),g.flexDirection=f,g.gap="8px",g.flexWrap=h||"nowrap",g.alignContent="baseline",g.minWidth=g.minWidth||0,g.minHeight=g.minHeight||0,g[m.breakpoints.down("md")]={flexDirection:null!=(r=null==(t=e.md)?void 0:t.direction)?r:"column",maxWidth:null!=(o=null==(a=e.md)?void 0:a.maxWidth)?o:"unset",maxHeight:null!=(s=null==(i=e.md)?void 0:i.maxHeight)?s:"unset",height:null!=(u=null==(l=e.md)?void 0:l.height)?u:"unset",width:null!=(p=null==(c=e.md)?void 0:c.width)?p:"unset"},(0,Pn.css)(g)}),[n,e])}(e.state,n);return o?null:r().createElement("div",{className:i},a.map((t=>{const n=t.Component;return r().createElement(n,{key:t.state.key,model:t,parentState:e.state})})))};class Qm extends ae{}function Km(e,t,n){var r,a,o;const i=null!=(r=n.direction)?r:"row",{xSizing:s="fill",ySizing:l="fill"}=t;return e.display="flex",e.position="relative",e.flexDirection=i,"column"===i?(t.height?e.height=t.height:e.flexGrow="fill"===l?1:0,t.width?e.width=t.width:e.alignSelf="fill"===s?"stretch":"flex-start"):(t.height?e.height=t.height:e.alignSelf="fill"===l?"stretch":"flex-start",t.width?e.width=t.width:e.flexGrow="fill"===s?1:0),e.minWidth=t.minWidth,e.maxWidth=t.maxWidth,e.maxHeight=t.maxHeight,e.minHeight=null!=(a=t.minHeight)?a:n.minHeight,e.height=null!=(o=t.height)?o:n.height,e}Qm.Component=function({model:e,parentState:n}){if(!n)throw new Error("SceneFlexItem must be a child of SceneFlexLayout");const{body:a,isHidden:o}=e.useState(),i=function(e,n){return(0,t.useMemo)((()=>{var t,r,a,o,i,s,l,u,c,p;const f=d.config.theme2,h=Km({},e,n);return h[f.breakpoints.down("md")]={maxWidth:null!=(r=null==(t=e.md)?void 0:t.maxWidth)?r:"unset",maxHeight:null!=(o=null==(a=e.md)?void 0:a.maxHeight)?o:"unset",height:null!=(l=null==(i=e.md)?void 0:i.height)?l:null==(s=n.md)?void 0:s.height,width:null!=(p=null==(u=e.md)?void 0:u.width)?p:null==(c=n.md)?void 0:c.width},(0,Pn.css)(h)}),[e,n])}(e.state,n);return!a||o?null:r().createElement("div",{className:i},r().createElement(a.Component,{model:a}))};var Ym=Object.defineProperty,Zm=Object.getOwnPropertySymbols,Xm=Object.prototype.hasOwnProperty,Jm=Object.prototype.propertyIsEnumerable,eg=(e,t,n)=>t in e?Ym(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class tg extends ae{isDraggable(){return!1}constructor(e){var t,n;super(((e,t)=>{for(var n in t||(t={}))Xm.call(t,n)&&eg(e,n,t[n]);if(Zm)for(var n of Zm(t))Jm.call(t,n)&&eg(e,n,t[n]);return e})({rowGap:1,columnGap:1,templateColumns:"repeat(auto-fit, minmax(400px, 1fr))",autoRows:null!=(t=e.autoRows)?t:"320px",children:null!=(n=e.children)?n:[]},e))}}tg.Component=function({model:e}){const{children:n,isHidden:a,isLazy:o}=e.useState(),i=(s=e.state,(0,t.useMemo)((()=>{var e,t,n,r,a,o,i,l,u,c,p;const f={},h=d.config.theme2;return f.display="grid",f.gridTemplateColumns=s.templateColumns,f.gridTemplateRows=s.templateRows||"unset",f.gridAutoRows=s.autoRows||"unset",f.rowGap=h.spacing(null!=(e=s.rowGap)?e:1),f.columnGap=h.spacing(null!=(t=s.columnGap)?t:1),f.justifyItems=s.justifyItems||"unset",f.alignItems=s.alignItems||"unset",f.justifyContent=s.justifyContent||"unset",f.flexGrow=1,s.md&&(f[h.breakpoints.down("md")]={gridTemplateRows:null==(n=s.md)?void 0:n.templateRows,gridTemplateColumns:null==(r=s.md)?void 0:r.templateColumns,rowGap:s.md.rowGap?h.spacing(null!=(o=null==(a=s.md)?void 0:a.rowGap)?o:1):void 0,columnGap:s.md.columnGap?h.spacing(null!=(l=null==(i=s.md)?void 0:i.rowGap)?l:1):void 0,justifyItems:null==(u=s.md)?void 0:u.justifyItems,alignItems:null==(c=s.md)?void 0:c.alignItems,justifyContent:null==(p=s.md)?void 0:p.justifyContent}),(0,Pn.css)(f)}),[s]));var s;return a?null:r().createElement("div",{className:i},n.map((t=>{const n=t.Component;return o?r().createElement(mh,{key:t.state.key,className:i},r().createElement(n,{key:t.state.key,model:t,parentState:e.state})):r().createElement(n,{key:t.state.key,model:t,parentState:e.state})})))};class ng extends ae{}ng.Component=function({model:e,parentState:n}){if(!n)throw new Error("SceneCSSGridItem must be a child of SceneCSSGridLayout");const{body:a,isHidden:o}=e.useState(),i=(s=e.state,(0,t.useMemo)((()=>{const e={};return e.gridColumn=s.gridColumn||"unset",e.gridRow=s.gridRow||"unset",e.position="relative",(0,Pn.css)(e)}),[s]));var s;return!a||o?null:r().createElement("div",{className:i},r().createElement(a.Component,{model:a}))};var rg=Object.defineProperty,ag=Object.getOwnPropertySymbols,og=Object.prototype.hasOwnProperty,ig=Object.prototype.propertyIsEnumerable,sg=(e,t,n)=>t in e?rg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,lg=(e,t)=>{for(var n in t||(t={}))og.call(t,n)&&sg(e,n,t[n]);if(ag)for(var n of ag(t))ig.call(t,n)&&sg(e,n,t[n]);return e};const ug=new Set(["ArrowUp","ArrowDown"]),cg=new Set(["ArrowLeft","ArrowRight"]),dg={row:{dim:"width",axis:"clientX",min:"minWidth",max:"maxWidth"},column:{dim:"height",axis:"clientY",min:"minHeight",max:"maxHeight"}};function pg({direction:e="row",handleSize:n=32,initialSize:a="auto",primaryPaneStyles:o,secondaryPaneStyles:i,onDragFinished:s,children:l}){const u=r().Children.toArray(l),c=(0,t.useRef)(null),d=(0,t.useRef)(null),p=(0,t.useRef)(null),f=(0,t.useRef)(null),h=(0,t.useRef)(null),m=(0,t.useRef)("1fr"),g=(0,t.useRef)(void 0),b=(0,t.useRef)(void 0),y=dg[e].dim,v=dg[e].axis,w=dg[e].min,O=dg[e].max;!function(e,n,r=0,a){const o=(0,be.throttle)(n,r);(0,t.useLayoutEffect)((()=>{if(!e)return;const t=new ResizeObserver(o);return t.observe(e,{box:"device-pixel-content-box"}),()=>t.disconnect()}),a)}(f.current,(e=>{for(const t of e){if(!t.target.isSameNode(f.current))return;const e=d.current.getBoundingClientRect()[y],n=hg(d.current);c.current.ariaValueNow=`${(0,be.clamp)((e-n[w])/(n[O]-n[w])*100,0,100)}`}}),500,[O,w,e,y]);const S=(0,t.useRef)(null),_=(0,t.useCallback)((e=>{m.current=d.current.getBoundingClientRect()[y],h.current=f.current.getBoundingClientRect()[y],S.current=e[v],c.current.setPointerCapture(e.pointerId),g.current=hg(d.current),b.current=void 0}),[y,v]),x=(0,t.useCallback)((e=>{if(null!==S.current&&"1fr"!==m.current){const t=e[v]-S.current,r=g.current,a=(0,be.clamp)(m.current+t,r[w],r[O]),o=a/(h.current-n);d.current.style.flexGrow=`${o}`,p.current.style.flexGrow=""+(1-o);const i=(0,be.clamp)((a-r[w])/(r[O]-r[w])*100,0,100);c.current.ariaValueNow=`${i}`}}),[n,v,w,O]),P=(0,t.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),c.current.releasePointerCapture(e.pointerId),S.current=null,null==s||s(parseFloat(d.current.style.flexGrow))}),[s]),j=(0,t.useRef)(new Set),C=(0,t.useRef)(null),E=(0,t.useCallback)((t=>{var r;if(0===j.current.size)return void(C.current=null);if("1fr"===m.current)return;const a=.3*(t-(null!=(r=C.current)?r:t));let o=0;"row"===e?(j.current.has("ArrowLeft")&&(o-=a),j.current.has("ArrowRight")&&(o+=a)):(j.current.has("ArrowUp")&&(o-=a),j.current.has("ArrowDown")&&(o+=a));const i=g.current,s=d.current.getBoundingClientRect()[y],l=(0,be.clamp)(s+o,i[w],i[O]),u=l/(h.current-n);d.current.style.flexGrow=`${u}`,p.current.style.flexGrow=""+(1-u);const f=(l-i[w])/(i[O]-i[w])*100;c.current.ariaValueNow=`${(0,be.clamp)(f,0,100)}`,C.current=t,window.requestAnimationFrame(E)}),[e,n,w,O,y]),D=(0,t.useCallback)((t=>{if("Enter"!==t.key){if("Home"===t.key){g.current=hg(d.current),h.current=f.current.getBoundingClientRect()[y];const e=g.current[w]/(h.current-n);return d.current.style.flexGrow=`${e}`,p.current.style.flexGrow=""+(1-e),void(c.current.ariaValueNow="0")}if("End"===t.key){g.current=hg(d.current),h.current=f.current.getBoundingClientRect()[y];const e=g.current[O]/(h.current-n);return d.current.style.flexGrow=`${e}`,p.current.style.flexGrow=""+(1-e),void(c.current.ariaValueNow="100")}if(("column"===e&&ug.has(t.key)||"row"===e&&cg.has(t.key))&&!j.current.has(t.key)&&(b.current=void 0,t.preventDefault(),t.stopPropagation(),m.current=d.current.getBoundingClientRect()[y],h.current=f.current.getBoundingClientRect()[y],g.current=hg(d.current),!j.current.has(t.key))){const e=0===j.current.size;j.current.add(t.key),e&&window.requestAnimationFrame(E)}}else void 0===b.current?(b.current=d.current.style.flexGrow,d.current.style.flexGrow="0",p.current.style.flexGrow="1"):(d.current.style.flexGrow=b.current,p.current.style.flexGrow=""+(1-parseFloat(b.current)),b.current=void 0)}),[e,E,n,O,y,w]),k=(0,t.useCallback)((t=>{"row"===e&&!cg.has(t.key)||"column"===e&&!ug.has(t.key)||(j.current.delete(t.key),null==s||s(parseFloat(d.current.style.flexGrow)))}),[e,s]),T=(0,t.useCallback)((()=>{d.current.style.flexGrow="0.5",p.current.style.flexGrow="0.5";const e=hg(d.current);g.current=e,m.current=d.current.getBoundingClientRect()[y],c.current.ariaValueNow=""+(m.current-e[w])/(e[O]-e[w])*100}),[O,y,w]),R=(0,t.useCallback)((()=>{j.current.size>0&&(j.current.clear(),S.current=null,null==s||s(parseFloat(d.current.style.flexGrow)))}),[s]),A=(0,Sn.useStyles2)(fg),I=hh(),V=2===u.length?"visible":"hidden";return r().createElement("div",{ref:f,className:A.container,style:{flexDirection:e}},r().createElement("div",{ref:d,className:A.panel,style:lg({flexGrow:"auto"===a?.5:(0,be.clamp)(a,0,1),[w]:"min-content"},o),id:`start-panel-${I}`},u[0]),u[1]&&r().createElement(r().Fragment,null,r().createElement("div",{ref:c,style:{[y]:`${n}px`},className:(0,Pn.cx)(A.handle,{[A.handleHorizontal]:"column"===e}),onPointerUp:P,onPointerDown:_,onPointerMove:x,onKeyDown:D,onKeyUp:k,onDoubleClick:T,onBlur:R,role:"separator","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":50,"aria-controls":`start-panel-${I}`,"aria-label":"Pane resize widget",tabIndex:0}),r().createElement("div",{ref:p,className:A.panel,style:lg({flexGrow:"auto"===a?.5:(0,be.clamp)(1-a,0,1),[w]:"min-content",visibility:`${V}`},i),id:`end-panel-${I}`},u[1])))}function fg(e){return{handle:(0,Pn.css)({cursor:"col-resize",position:"relative",flexShrink:0,userSelect:"none","&::before":{content:'""',position:"absolute",backgroundColor:e.colors.primary.main,left:"50%",transform:"translate(-50%)",top:0,height:"100%",width:"1px",opacity:0,transition:"opacity ease-in-out 0.2s"},"&::after":{content:'""',width:"4px",borderRadius:"4px",backgroundColor:e.colors.border.weak,transition:"background-color ease-in-out 0.2s",height:"50%",top:"calc(50% - (50%) / 2)",transform:"translateX(-50%)",position:"absolute",left:"50%"},"&:hover, &:focus-visible":{outline:"none","&::before":{opacity:1},"&::after":{backgroundColor:e.colors.primary.main}}}),handleHorizontal:(0,Pn.css)({cursor:"row-resize","&::before":{left:"inherit",transform:"translateY(-50%)",top:"50%",height:"1px",width:"100%"},"&::after":{width:"50%",height:"4px",top:"50%",transform:"translateY(-50%)",left:"calc(50% - (50%) / 2)"}}),container:(0,Pn.css)({display:"flex",width:"100%",flexGrow:1,overflow:"hidden"}),panel:(0,Pn.css)({display:"flex",position:"relative",flexBasis:0})}}function hg(e){if(null===e)return;const t=document.body.style.overflow,n=e.style.width,r=e.style.height,a=e.style.flexGrow;document.body.style.overflow="hidden",e.style.flexGrow="0";const{width:o,height:i}=e.getBoundingClientRect();e.style.flexGrow="100";const{width:s,height:l}=e.getBoundingClientRect();return document.body.style.overflow=t,e.style.width=n,e.style.height=r,e.style.flexGrow=a,{minWidth:o,maxWidth:s,minHeight:i,maxHeight:l}}class mg extends ae{toggleDirection(){this.setState({direction:"row"===this.state.direction?"column":"row"})}isDraggable(){return!1}}mg.Component=function({model:e}){const{primary:t,secondary:n,direction:a,isHidden:o,initialSize:i,primaryPaneStyles:s,secondaryPaneStyles:l}=e.useState();if(o)return null;const u=t.Component,c=null==n?void 0:n.Component;let d=n?i:1;return r().createElement(pg,{direction:a,initialSize:null!=d?d:.5,primaryPaneStyles:s,secondaryPaneStyles:l},r().createElement(u,{key:t.state.key,model:t,parentState:e.state}),c&&n&&r().createElement(c,{key:n.state.key,model:n,parentState:e.state}))};class gg extends ae{enrichDataRequest(){return{app:this.state.name||"app"}}}gg.Component=({model:e})=>{const{pages:t}=e.useState();return r().createElement(bg.Provider,{value:e},r().createElement(o.Switch,null,t.map((e=>r().createElement(o.Route,{key:e.state.url,exact:!1,path:e.state.url,render:t=>O(e,t)})))))};const bg=(0,t.createContext)(null),yg=new Map;var vg=Object.defineProperty,wg=Object.getOwnPropertySymbols,Og=Object.prototype.hasOwnProperty,Sg=Object.prototype.propertyIsEnumerable,_g=(e,t,n)=>t in e?vg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class xg extends ae{}function Pg({node:e}){const t=e.useState(),n=(0,Sn.useStyles2)(jg);return r().createElement("div",{className:n.container},Object.keys(t).map((a=>r().createElement("div",{className:n.row,key:a},r().createElement("div",{className:n.keyName},a),r().createElement("div",{className:n.value},function(e,t,n){if(null===t)return"null";switch(typeof t){case"number":return r().createElement(Sn.Input,{type:"number",defaultValue:t,onBlur:t=>n.setState({[e]:t.currentTarget.valueAsNumber})});case"string":return r().createElement(Sn.Input,{type:"text",defaultValue:t,onBlur:t=>n.setState({[e]:t.currentTarget.value})});case"object":return Bt(t)?t.constructor.name:(0,be.isPlainObject)(t)||(0,be.isArray)(t)?r().createElement(Sn.JSONFormatter,{json:t,open:0}):String(t);default:return typeof t}}(a,t[a],e))))))}function jg(e){return{container:(0,Pn.css)({flexGrow:1,display:"flex",gap:e.spacing(.5),flexDirection:"column"}),row:(0,Pn.css)({display:"flex",gap:e.spacing(2)}),keyName:(0,Pn.css)({display:"flex",flexGrow:"0",width:120,alignItems:"center",height:e.spacing(e.components.height.md)}),value:(0,Pn.css)({flexGrow:1,minHeight:e.spacing(e.components.height.md),display:"flex",alignItems:"center"})}}function Cg({node:e,selectedObject:t,onSelect:n}){const a=(0,Sn.useStyles2)(Eg),o=[],i=e===t;return e.forEachChild((e=>{o.push(r().createElement(Cg,{node:e,key:e.state.key,selectedObject:t,onSelect:n}))})),r().createElement("div",{className:a.container},r().createElement("div",{className:(0,Pn.cx)(a.name,i&&a.selected),onClick:()=>n(e)},e.constructor.name),r().createElement("div",{className:a.children},o))}function Eg(e){return{container:(0,Pn.css)({flexGrow:1,display:"flex",gap:e.spacing(.5),flexDirection:"column"}),name:(0,Pn.css)({flexGrow:1,display:"flex",gap:e.spacing(1),fontSize:e.typography.bodySmall.fontSize,cursor:"pointer",padding:e.spacing(0,1),borderRadius:e.shape.borderRadius(2),position:"relative","&:hover":{background:e.colors.background.secondary}}),selected:(0,Pn.css)({"&::before":{display:"block",content:"' '",position:"absolute",left:0,width:4,bottom:2,top:2,borderRadius:e.shape.radius.default,backgroundImage:e.colors.gradients.brandVertical}}),children:(0,Pn.css)({flexGrow:1,display:"flex",flexDirection:"column",paddingLeft:e.spacing(1)})}}function Dg({scene:e}){const n=(0,Sn.useStyles2)(kg),[a,o]=(0,t.useState)(!1),[i,s]=(0,t.useState)();return r().createElement(r().Fragment,null,r().createElement(Sn.ToolbarButton,{variant:"canvas",icon:"bug",onClick:()=>o(!0)}),a&&r().createElement(Sn.Drawer,{title:"Scene debugger",onClose:()=>o(!1),size:"lg"},r().createElement("div",{className:n.panes},r().createElement("div",{className:n.pane1},r().createElement("div",{className:n.paneHeading},"Scene graph"),r().createElement(Sn.CustomScrollbar,{autoHeightMin:"100%"},r().createElement("div",{className:n.treeWrapper},r().createElement(Cg,{node:e,selectedObject:i,onSelect:s})))),r().createElement("div",{className:n.pane2},r().createElement("div",{className:n.paneHeading},"Object details"),i&&r().createElement(Pg,{node:i})))))}function kg(e){return{panes:(0,Pn.css)({flexGrow:1,display:"flex",height:"100%",flexDirection:"row",marginTop:e.spacing(-2)}),pane1:(0,Pn.css)({flexGrow:0,display:"flex",height:"100%",flexDirection:"column",borderRight:`1px solid ${e.colors.border.weak}`}),pane2:(0,Pn.css)({flexGrow:1,display:"flex",minHeight:"100%",flexDirection:"column",paddingLeft:e.spacing(2)}),treeWrapper:(0,Pn.css)({paddingRight:e.spacing(2),height:"100%",marginLeft:e.spacing(-1)}),paneHeading:(0,Pn.css)({padding:e.spacing(1,0),fontWeight:e.typography.fontWeightMedium})}}function Tg({page:e,routeProps:n}){const a=function(e){return e.parent instanceof Ig?e.parent:e}(e),i=a.useState(),s=function(){const e=(0,o.useLocation)();return(0,d.locationSearchToObject)(e.search||"")}(),l=e.getScene(n.match),u=(0,t.useContext)(bg),c=i.initializedScene===l,{layout:p}=e.state,f=Pt();(0,t.useLayoutEffect)((()=>{c||a.initializeScene(l)}),[l,a,c]),(0,t.useEffect)((()=>()=>a.setState({initializedScene:void 0})),[a]);const h=eh(a,null==u?void 0:u.state.urlSyncOptions);if(!c&&!h)return null;const m={text:i.title,img:i.titleImg,icon:i.titleIcon,url:w(i.url,f.getSearchObject(),i.preserveUrlKeys),hideFromBreadcrumbs:i.hideFromBreadcrumbs,parentItem:Rg(i.getParentPage?i.getParentPage():a.parent,s,f.getSearchObject())};i.tabs&&(m.children=i.tabs.map((t=>({text:t.state.title,icon:t.state.titleIcon,tabSuffix:t.state.tabSuffix,active:e===t,url:w(t.state.url,f.getSearchObject(),t.state.preserveUrlKeys),parentItem:m}))));let g=[];return i.controls&&(g=i.controls.map((e=>r().createElement(e.Component,{model:e,key:e.state.key})))),s["scene-debugger"]&&g.push(r().createElement(Dg,{scene:a,key:"scene-debugger"})),r().createElement(d.PluginPage,{layout:p,pageNav:m,actions:g,renderTitle:i.renderTitle,subTitle:i.subTitle},r().createElement(l.Component,{model:l}))}function Rg(e,t,n){if(e instanceof Ig)return{text:e.state.title,url:w(e.state.url,n,e.state.preserveUrlKeys),hideFromBreadcrumbs:e.state.hideFromBreadcrumbs,parentItem:Rg(e.state.getParentPage?e.state.getParentPage():e.parent,t,n)}}function Ag({drilldown:e,parent:t,routeProps:n}){return O(t.getDrilldownPage(e,n.match),n)}xg.Component=({model:e})=>{const{component:t,props:n,reactNode:a}=e.useState();return t?r().createElement(t,((e,t)=>{for(var n in t||(t={}))Og.call(t,n)&&_g(e,n,t[n]);if(wg)for(var n of wg(t))Sg.call(t,n)&&_g(e,n,t[n]);return e})({},n)):a||null};class Ig extends ae{initializeScene(e){this.setState({initializedScene:e})}getScene(e){let t=this._sceneCache.get(e.url);if(t)return t;if(!this.state.getScene)throw new Error("Missing getScene on SceneAppPage "+this.state.title);return t=this.state.getScene(e),this._sceneCache.set(e.url,t),t}getDrilldownPage(e,t){let n=this._drilldownCache.get(t.url);return n||(n=e.getPage(t,this),this._drilldownCache.set(t.url,n),n)}enrichDataRequest(e){if(this.state.getParentPage)return this.state.getParentPage().enrichDataRequest(e);if(!this.parent)return null;const t=this.getRoot();return zt(t)?t.enrichDataRequest(e):null}constructor(e){super(e),this._sceneCache=new Map,this._drilldownCache=new Map}}Ig.Component=function({model:e,routeProps:t}){var n,a;const{tabs:i,drilldowns:s}=e.useState(),l=[];if(i&&i.length>0)for(let t=0;t<i.length;t++){const s=i[t];if(0===t&&l.push(r().createElement(o.Route,{exact:!0,key:e.state.url,path:null!=(n=e.state.routePath)?n:e.state.url,render:e=>O(s,e)})),l.push(r().createElement(o.Route,{exact:!0,key:s.state.url,path:null!=(a=s.state.routePath)?a:s.state.url,render:e=>O(s,e)})),s.state.drilldowns)for(const e of s.state.drilldowns)l.push(r().createElement(o.Route,{exact:!1,key:e.routePath,path:e.routePath,render:t=>r().createElement(Ag,{drilldown:e,parent:s,routeProps:t})}))}if(s)for(const t of s)l.push(r().createElement(o.Route,{key:t.routePath,exact:!1,path:t.routePath,render:n=>r().createElement(Ag,{drilldown:t,parent:e,routeProps:n})}));return!i&&(u=e,(c=t.match).isExact&&(c.url===u.state.url||u.parent instanceof Ig&&u.parent.state.tabs[0]===u&&u.parent.state.url===c.url))?r().createElement(Tg,{page:e,routeProps:t}):(l.push(function(e,t){return r().createElement(o.Route,{key:"fallback route",render:n=>{var a,o,i;const s=null!=(i=null==(o=(a=e.state).getFallbackPage)?void 0:o.call(a))?i:new Ig({url:"",title:"Not found",subTitle:"The url did not match any page",getScene:()=>new nh({body:new Gm({direction:"column",children:[new Qm({body:new xg({component:()=>r().createElement("div",{"data-testid":"default-fallback-content"},"If you found your way here using a link then there might be a bug in this application.")})})]})})});return r().createElement(Tg,{page:s,routeProps:t})}})}(e,t)),r().createElement(o.Switch,null,l));var u,c};var Vg=(e=>(e.Always="always",e.Auto="auto",e.Never="never",e))(Vg||{}),Mg=(e=>(e.Hue="hue",e.None="none",e.Opacity="opacity",e.Scheme="scheme",e))(Mg||{}),Fg=(e=>(e.None="none",e.Normal="normal",e.Percent="percent",e))(Fg||{}),Lg=(e=>(e.Auto="auto",e.Horizontal="horizontal",e.Vertical="vertical",e))(Lg||{}),$g=(e=>(e.Background="background",e.BackgroundSolid="background_solid",e.None="none",e.Value="value",e))($g||{}),Ng=(e=>(e.Area="area",e.Line="line",e.None="none",e))(Ng||{}),Bg=(e=>(e.Auto="auto",e.Center="center",e))(Bg||{}),zg=(e=>(e.Auto="auto",e.Name="name",e.None="none",e.Value="value",e.ValueAndName="value_and_name",e))(zg||{}),qg=(e=>(e.Multi="multi",e.None="none",e.Single="single",e))(qg||{}),Hg=(e=>(e.Basic="basic",e.Gradient="gradient",e.Lcd="lcd",e))(Hg||{}),Wg=(e=>(e.Color="color",e.Hidden="hidden",e.Text="text",e))(Wg||{}),Ug=(e=>(e.Auto="auto",e.Left="left",e.Top="top",e))(Ug||{}),Gg=(e=>(e.Auto="auto",e.Manual="manual",e))(Gg||{}),Qg=(e=>(e.Lg="lg",e.Md="md",e.Sm="sm",e))(Qg||{});const Kg={barRadius:0,barWidth:.97,fullHighlight:!1,groupWidth:.7,orientation:Lg.Auto,showValue:Vg.Auto,stacking:Fg.None,xTickLabelRotation:0,xTickLabelSpacing:0},Yg={fillOpacity:80,gradientMode:Mg.None,lineWidth:1},Zg={displayMode:Hg.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:Ug.Auto,showUnfilled:!0,sizing:Gg.Auto,valueMode:Wg.Color},Xg={selectedSeries:0},Jg={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:Gg.Auto},eb={layers:[]},tb={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},showValue:Vg.Auto,tooltip:{mode:qg.Single,yHistogram:!1,showColorScale:!1}},nb={bucketCount:30,bucketOffset:0},rb={fillOpacity:80,gradientMode:Mg.None,lineWidth:1},ab={showImage:!0},ob={displayLabels:[]},ib={colorMode:$g.Value,graphMode:Ng.Area,justifyMode:Bg.Auto,showPercentChange:!1,textMode:zg.Auto,wideLayout:!0},sb={alignValue:"left",mergeValues:!0,rowHeight:.9,showValue:Vg.Auto},lb={fillOpacity:70,lineWidth:0},ub={colWidth:.9,rowHeight:.9,showValue:Vg.Auto},cb={fillOpacity:70,lineWidth:1},db={cellHeight:Qg.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]};var pb=(e=>(e.Code="code",e.HTML="html",e.Markdown="markdown",e))(pb||{});const fb={content:"# Title\n\nFor markdown syntax help: [commonmark.org/help](https://commonmark.org/help/)",mode:"markdown"},hb={label:Vg.Auto,show:"points"},mb={series:[]};class gb{overrideColor(e){return this._overrides[this._overrides.length-1].properties.push({id:"color",value:e}),this}overrideDecimals(e){return this._overrides[this._overrides.length-1].properties.push({id:"decimals",value:e}),this}overrideDisplayName(e){return this._overrides[this._overrides.length-1].properties.push({id:"displayName",value:e}),this}overrideFilterable(e){return this._overrides[this._overrides.length-1].properties.push({id:"filterable",value:e}),this}overrideLinks(e){return this._overrides[this._overrides.length-1].properties.push({id:"links",value:e}),this}overrideMappings(e){return this._overrides[this._overrides.length-1].properties.push({id:"mappings",value:e}),this}overrideMax(e){return this._overrides[this._overrides.length-1].properties.push({id:"max",value:e}),this}overrideMin(e){return this._overrides[this._overrides.length-1].properties.push({id:"min",value:e}),this}overrideNoValue(e){return this._overrides[this._overrides.length-1].properties.push({id:"noValue",value:e}),this}overrideThresholds(e){return this._overrides[this._overrides.length-1].properties.push({id:"thresholds",value:e}),this}overrideUnit(e){return this._overrides[this._overrides.length-1].properties.push({id:"unit",value:e}),this}constructor(){this._overrides=[]}}class bb extends gb{match(e){return this._overrides.push({matcher:e,properties:[]}),this}matchFieldsWithName(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byName,options:t},properties:[]}),this}matchFieldsWithNameByRegex(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byRegexp,options:t},properties:[]}),this}matchFieldsByType(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byType,options:t},properties:[]}),this}matchFieldsByQuery(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byFrameRefID,options:t},properties:[]}),this}matchFieldsByValue(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byValue,options:t},properties:[]}),this}matchComparisonQuery(e){return this.matchFieldsByQuery(Pm(e))}overrideCustomFieldConfig(e,t){const n=`custom.${String(e)}`;return this._overrides[this._overrides.length-1].properties.push({id:n,value:t}),this}build(){return this._overrides}}var yb=Object.defineProperty,vb=Object.defineProperties,wb=Object.getOwnPropertyDescriptors,Ob=Object.getOwnPropertySymbols,Sb=Object.prototype.hasOwnProperty,_b=Object.prototype.propertyIsEnumerable,xb=(e,t,n)=>t in e?yb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Pb=(e,t)=>{for(var n in t||(t={}))Sb.call(t,n)&&xb(e,n,t[n]);if(Ob)for(var n of Ob(t))_b.call(t,n)&&xb(e,n,t[n]);return e},jb=(e,t)=>vb(e,wb(t));class Cb{setDefaults(){const e={defaults:{custom:this.defaultFieldConfig?(0,be.cloneDeep)(this.defaultFieldConfig()):{}},overrides:[]};this._fieldConfig=e}setColor(e){return this.setFieldConfigDefaults("color",e)}setDecimals(e){return this.setFieldConfigDefaults("decimals",e)}setDisplayName(e){return this.setFieldConfigDefaults("displayName",e)}setFilterable(e){return this.setFieldConfigDefaults("filterable",e)}setLinks(e){return this.setFieldConfigDefaults("links",e)}setMappings(e){return this.setFieldConfigDefaults("mappings",e)}setMax(e){return this.setFieldConfigDefaults("max",e)}setMin(e){return this.setFieldConfigDefaults("min",e)}setNoValue(e){return this.setFieldConfigDefaults("noValue",e)}setThresholds(e){return this.setFieldConfigDefaults("thresholds",e)}setUnit(e){return this.setFieldConfigDefaults("unit",e)}setCustomFieldConfig(e,t){return this._fieldConfig.defaults=jb(Pb({},this._fieldConfig.defaults),{custom:(0,be.merge)(this._fieldConfig.defaults.custom,{[e]:t})}),this}setOverrides(e){return e(this._overridesBuilder),this}setFieldConfigDefaults(e,t){return this._fieldConfig.defaults=jb(Pb({},this._fieldConfig.defaults),{[e]:t}),this}build(){return{defaults:this._fieldConfig.defaults,overrides:this._overridesBuilder.build()}}constructor(e){this.defaultFieldConfig=e,this._fieldConfig={defaults:{},overrides:[]},this._overridesBuilder=new bb,this.setDefaults()}}class Eb{setDefaults(){this._options=this.defaultOptions?(0,be.cloneDeep)(this.defaultOptions()):{}}setOption(e,t){return this._options=(0,be.merge)(this._options,{[e]:t}),this}build(){return this._options}constructor(e){this.defaultOptions=e,this._options={},this.setDefaults()}}var Db=Object.defineProperty,kb=Object.defineProperties,Tb=Object.getOwnPropertyDescriptors,Rb=Object.getOwnPropertySymbols,Ab=Object.prototype.hasOwnProperty,Ib=Object.prototype.propertyIsEnumerable,Vb=(e,t,n)=>t in e?Db(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Mb{setTitle(e){return this._state.title=e,this}setDescription(e){return this._state.description=e,this}setDisplayMode(e){return this._state.displayMode=e,this}setHoverHeader(e){return this._state.hoverHeader=e,this}setMenu(e){return this._state.menu=e,this}setHeaderActions(e){return this._state.headerActions=e,this}setColor(e){return this._fieldConfigBuilder.setColor(e),this}setDecimals(e){return this._fieldConfigBuilder.setDecimals(e),this}setDisplayName(e){return this._fieldConfigBuilder.setDisplayName(e),this}setFilterable(e){return this._fieldConfigBuilder.setFilterable(e),this}setLinks(e){return this._fieldConfigBuilder.setLinks(e),this}setMappings(e){return this._fieldConfigBuilder.setMappings(e),this}setMax(e){return this._fieldConfigBuilder.setMax(e),this}setMin(e){return this._fieldConfigBuilder.setMin(e),this}setNoValue(e){return this._fieldConfigBuilder.setNoValue(e),this}setThresholds(e){return this._fieldConfigBuilder.setThresholds(e),this}setUnit(e){return this._fieldConfigBuilder.setUnit(e),this}setCustomFieldConfig(e,t){return this._fieldConfigBuilder.setCustomFieldConfig(e,t),this}setOverrides(e){return this._fieldConfigBuilder.setOverrides(e),this}setOption(e,t){return this._panelOptionsBuilder.setOption(e,t),this}setData(e){return this._state.$data=e,this}setTimeRange(e){return this._state.$timeRange=e,this}setVariables(e){return this._state.$variables=e,this}setBehaviors(e){return this._state.$behaviors=e,this}applyMixin(e){return e(this),this}build(){const e=new Fc((t=((e,t)=>{for(var n in t||(t={}))Ab.call(t,n)&&Vb(e,n,t[n]);if(Rb)for(var n of Rb(t))Ib.call(t,n)&&Vb(e,n,t[n]);return e})({},this._state),n={options:this._panelOptionsBuilder.build(),fieldConfig:this._fieldConfigBuilder.build()},kb(t,Tb(n))));var t,n;return e}constructor(e,t,n,r){this._state={},this._state.title="",this._state.description="",this._state.displayMode="default",this._state.hoverHeader=!1,this._state.pluginId=e,this._state.pluginVersion=t,this._fieldConfigBuilder=new Cb(r),this._panelOptionsBuilder=new Eb(n)}}const Fb={barchart:()=>new Mb("barchart","10.0.0",(()=>Kg),(()=>Yg)),bargauge:()=>new Mb("bargauge","10.0.0",(()=>Zg)),datagrid:()=>new Mb("datagrid","10.0.0",(()=>Xg)),flamegraph:()=>new Mb("flamegraph","10.0.0"),gauge:()=>new Mb("gauge","10.0.0",(()=>Jg)),geomap:()=>new Mb("geomap","10.0.0",(()=>eb)),heatmap:()=>new Mb("heatmap","10.0.0",(()=>tb)),histogram:()=>new Mb("histogram","10.0.0",(()=>nb),(()=>rb)),logs:()=>new Mb("logs","10.0.0"),news:()=>new Mb("news","10.0.0",(()=>ab)),nodegraph:()=>new Mb("nodeGraph","10.0.0"),piechart:()=>new Mb("piechart","10.0.0",(()=>ob)),stat:()=>new Mb("stat","10.0.0",(()=>ib)),statetimeline:()=>new Mb("state-timeline","10.0.0",(()=>sb),(()=>lb)),statushistory:()=>new Mb("status-history","10.0.0",(()=>ub),(()=>cb)),table:()=>new Mb("table","10.0.0",(()=>db)),text:()=>new Mb("text","10.0.0",(()=>fb)),timeseries:()=>new Mb("timeseries","10.0.0"),trend:()=>new Mb("trend","10.0.0"),traces:()=>new Mb("traces","10.0.0"),xychart:()=>new Mb("xychart","10.0.0",(()=>mb),(()=>hb))};class Lb{setColor(e){return this._fieldConfigBuilder.setColor(e),this}setDecimals(e){return this._fieldConfigBuilder.setDecimals(e),this}setDisplayName(e){return this._fieldConfigBuilder.setDisplayName(e),this}setFilterable(e){return this._fieldConfigBuilder.setFilterable(e),this}setLinks(e){return this._fieldConfigBuilder.setLinks(e),this}setMappings(e){return this._fieldConfigBuilder.setMappings(e),this}setMax(e){return this._fieldConfigBuilder.setMax(e),this}setMin(e){return this._fieldConfigBuilder.setMin(e),this}setNoValue(e){return this._fieldConfigBuilder.setNoValue(e),this}setThresholds(e){return this._fieldConfigBuilder.setThresholds(e),this}setUnit(e){return this._fieldConfigBuilder.setUnit(e),this}setCustomFieldConfig(e,t){return this._fieldConfigBuilder.setCustomFieldConfig(e,t),this}setOverrides(e){return this._fieldConfigBuilder.setOverrides(e),this}setOption(e,t){return this._panelOptionsBuilder.setOption(e,t),this}build(){return{pluginId:this._pluginId,pluginVersion:this._pluginVersion,options:this._panelOptionsBuilder.build(),fieldConfig:this._fieldConfigBuilder.build()}}constructor(e,t,n,r){this._pluginId=e,this._pluginVersion=t,this._fieldConfigBuilder=new Cb(r),this._panelOptionsBuilder=new Eb(n)}}const $b=()=>new Lb("table","10.0.0",(()=>db)),Nb=()=>new Lb("timeseries","10.0.0"),Bb=()=>new Eb((()=>Jg)),zb=()=>new Eb((()=>db)),qb=()=>new Eb,Hb=()=>new Cb,Wb=()=>new Cb,Ub={getUrlWithAppState:w,registerRuntimePanelPlugin:function({pluginId:e,plugin:t}){if(D.has(e))throw new Error(`A runtime panel plugin with id ${e} has already been registered`);var n;t.meta=(n=((e,t)=>{for(var n in t||(t={}))j.call(t,n)&&E(e,n,t[n]);if(P)for(var n of P(t))C.call(t,n)&&E(e,n,t[n]);return e})({},t.meta),_(n,x({id:e,name:e,module:"runtime plugin",baseUrl:"runtime plugin",info:{author:{name:"Runtime plugin "+e},description:"",links:[],logos:{large:"",small:""},screenshots:[],updated:"",version:""}}))),D.set(e,t)},registerRuntimeDataSource:function({dataSource:e}){if(ge.has(e.uid))throw new Error(`A runtime data source with uid ${e.uid} has already been registered`);ge.set(e.uid,e)},registerVariableMacro:function(e,t){if($t.get(e))throw new Error(`Macro already registered ${e}`);return $t.set(e,t),()=>{$t.delete(e)}},cloneSceneObjectState:fe,syncStateFromSearchParams:function(e,t){Su(e,t,new vu)},getUrlState:Ou,renderPrometheusLabelFilters:kl,isAdHocVariable:function(e){return"adhoc"===e.state.type},isConstantVariable:function(e){return"constant"===e.state.type},isCustomVariable:function(e){return"custom"===e.state.type},isDataSourceVariable:function(e){return"datasource"===e.state.type},isIntervalVariable:function(e){return"interval"===e.state.type},isQueryVariable:function(e){return"query"===e.state.type},isTextBoxVariable:function(e){return"textbox"===e.state.type},isGroupByVariable:function(e){return"groupby"===e.state.type}};function Gb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Gb(e,t,n[t])}))}return e}function Kb(e,t){return new Pl(Qb({queries:[Qb({refId:"A",datasource:l,scenarioId:"random_walk"},e)]},t))}function Yb(){return{$timeRange:new Xe,controls:[new ef({}),new Um,new cm({}),new xm({})]}}function Zb(e){return new Qm({ySizing:"content",body:new lm({text:e,fontSize:12})})}function Xb(e){return new Pl({datasource:{uid:"gdev-prometheus"},queries:[Qb({refId:"A",instant:!0,format:"table",maxDataPoints:500},e)]})}function Jb(e){return new Pl({datasource:{uid:"gdev-prometheus"},queries:[Qb({refId:"A",range:!0,format:"time_series",maxDataPoints:500},e)]})}function ey(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ty(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ey(e,t,n[t])}))}return e}function ny(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function ry(t){return Ub.registerRuntimePanelPlugin({pluginId:"custom-viz-panel",plugin:new e.PanelPlugin(ay).setPanelOptions((e=>{e.addTextInput({path:"mode",name:"Mode",defaultValue:"modeA"})})).useFieldConfig({useCustomConfig:e=>{e.addNumberInput({path:"numericOption",name:"Option editor",description:"Option editor description",defaultValue:10})}})}),new Ig(ny(ty({},t),{subTitle:"Demo of a runtime registered panel plugin",getScene:()=>new nh({body:new Gm(ny(ty({},Yb()),{direction:"column",children:[new Qm({body:new Fc({title:"Custom visualization panel plugin",pluginId:"custom-viz-panel",$data:Kb(),fieldConfig:{defaults:{},overrides:[]}})})]}))})}))}function ay(e){var t,n,a;const{options:o,data:i}=e;return r().createElement("div",null,r().createElement("h4",null,"CustomVizPanel ",o.mode),r().createElement("div",null,"FieldConfig: ",JSON.stringify(null===(a=i.series[0])||void 0===a||null===(n=a.fields[0])||void 0===n||null===(t=n.config)||void 0===t?void 0:t.custom)))}function oy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class iy extends ae{constructor(...e){super(...e),oy(this,"onChange",(e=>{this.setState({value:e})}))}}oy(iy,"Component",(({model:e})=>{const{options:t,value:n}=e.useState();return r().createElement(Sn.RadioButtonGroup,{options:t,value:n,onChange:e.onChange})}));class sy extends ae{setHidden(){const e=ly(this);e.state.isHidden||e.setState({isHidden:!0})}setVisible(){const e=ly(this);e.state.isHidden&&e.setState({isHidden:!1})}constructor(e){super(e)}}function ly(e){if(e instanceof Qm||e instanceof Gm)return e;if(!e.parent)throw new Error("Could not find parent flex item");return ly(e.parent)}class uy extends sy{constructor(t){var n,r;super(t),r=t=>{const n=e.rangeUtil.convertRawToRange({from:this.state.greaterThan,to:"now"});t.value.from.valueOf()<n.from.valueOf()?this.setHidden():this.setVisible()},(n="_onTimeRangeChange")in this?Object.defineProperty(this,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[n]=r,this.addActivationHandler((()=>{this._subs.add(yu.getTimeRange(this).subscribeToState(this._onTimeRangeChange)),this._onTimeRangeChange(yu.getTimeRange(this).state)}))}}class cy extends sy{constructor(){var e,t;super({}),t=e=>{e.data&&(e.data&&0===e.data.series.length?this.setHidden():this.setVisible())},(e="_onData")in this?Object.defineProperty(this,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):this[e]=t,this.addActivationHandler((()=>{this._subs.add(yu.getData(this).subscribeToState(this._onData))}))}}class dy extends sy{_onActivate(){for(const e of this.state.references){const t=yu.findObject(this,(t=>t.state.key===e));if(!t)throw new Error(`SceneObject with key ${e} not found in scene graph`);this._resolvedRefs.push(t),this._subs.add(t.subscribeToState((()=>this._onReferenceChanged())))}this._onReferenceChanged()}_onReferenceChanged(){this.state.condition(...this._resolvedRefs)?this.setVisible():this.setHidden()}constructor(e){var t,n;super(e),n=[],(t="_resolvedRefs")in this?Object.defineProperty(this,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[t]=n,this.addActivationHandler((()=>this._onActivate()))}}function py(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){py(e,t,n[t])}))}return e}function hy(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function my(e){return new Ig(hy(fy({},e),{subTitle:"Behaviors can augment any scene object with new runtime behaviors and state logic",getScene:()=>{const e=Kb({seriesCount:2,alias:"__server_names",scenarioId:"random_walk"});return new nh({$timeRange:new Xe,controls:[new um({value:"2",onChange:t=>{e.setState({queries:[hy(fy({},e.state.queries[0]),{seriesCount:t})]}),e.runQueries()}}),new iy({key:"toggle",options:[{value:"visible",label:"Show text panel"},{value:"hidden",label:"Hide text panel"}],value:"hidden"}),new Um,new cm({})],body:new Gm({direction:"column",children:[new Qm({$behaviors:[new dy({references:["toggle"],condition:e=>"visible"===e.state.value})],body:Fb.text().setOption("content","This panel can be hidden with a toggle!").build()}),new Qm({$behaviors:[new uy({greaterThan:"now-2d"})],isHidden:!0,body:Fb.timeseries().setTitle("Hidden for time ranges > 2d").setBehaviors([gy]).setData(new Pl({key:"Hidden for time range query runner",$behaviors:[gy],queries:[{refId:"A",datasource:l,scenarioId:"random_walk"}]})).build()}),new Qm({$behaviors:[new cy],$data:e,body:Fb.timeseries().setTitle("Hidden when no time series").build()})]})})}}))}function gy(e){var t;return console.log(`[SceneObjectEvent]: ${null===(t=e.constructor)||void 0===t?void 0:t.name} ${e.state.key} activated!`),e.subscribeToState((t=>{var n;console.log(`[SceneObjectEvent]: ${null===(n=e.constructor)||void 0===n?void 0:n.name} ${e.state.key} state changed!`,t)})),()=>{var t;console.log(`[SceneObjectEvent]: ${null===(t=e.constructor)||void 0===t?void 0:t.name} ${e.state.key} deactivated!`)}}function by(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yy(e){const t=[vy("/tab1","Temperature")],n=new Ig((a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){by(e,t,n[t])}))}return e}({},e),o=null!=(o={subTitle:"Dynamic tabs, and drilldowns. Adds a tab with drilldown after 2 seconds.",$timeRange:new Xe,controls:[new cm({}),new xm({})],tabs:t,getFallbackPage:()=>new Ig({title:"Loading...",url:"",getScene:()=>new nh({body:new xg({component:()=>r().createElement("p",null,"Please wait...")})})})})?o:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(o)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(o,e))})),a));var a,o;return n.addActivationHandler((()=>{if(1===n.state.tabs.length){const e=setTimeout((()=>{n.setState({tabs:[...t,vy("/tab2","Humidity")],renderTitle:wy,getFallbackPage:void 0})}),2e3);return()=>clearTimeout(e)}})),n}function vy(e,t){return new Ig({title:t,url:`${c("dynamic-page")}${e}`,getScene:()=>new nh({body:new Gm({direction:"column",children:[new Qm({body:Fb.timeseries().setTitle(t).build()})]}),$data:Kb()}),drilldowns:[]})}function wy(e){return r().createElement("div",{style:{display:"flex",gap:"16px",alignItems:"center"}},r().createElement("h1",null,e),r().createElement("img",{src:"public/img/online.svg",style:{width:"24px",height:"24px"}}))}function Oy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Oy(e,t,n[t])}))}return e}function _y(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function xy(e){return new Ig(_y(Sy({},e),{subTitle:"A simple demo of different flex layout options",getScene:()=>new nh(_y(Sy({},Yb()),{key:"Flex layout embedded scene",body:new Gm({direction:"column",children:[new Gm({direction:"row",children:[new Qm({minWidth:"70%",body:new Fc({title:"Failing panel because of wrong panel id",pluginId:"this-plugin-does-not-exist",$data:Kb({})})}),new Gm({$data:Kb({},{maxDataPoints:50}),direction:"column",children:[new Qm({body:Fb.timeseries().setTitle("Fill height").build()}),new Qm({ySizing:"content",body:new lm({text:"Size to content",fontSize:20,align:"center"})}),new Qm({height:300,body:Fb.stat().setTitle("Fixed height").build()})]})]}),new Gm({direction:"row",children:[new Qm({width:150,height:150,body:Fb.text().setTitle("150x150").setOption("content","").build()}),new Qm({maxHeight:200,body:Fb.timeseries().setTitle("maxHeigh 200").setData(Kb()).build()}),new Qm({width:"10%",body:Fb.text().setTitle("").setOption("content","").build()})]})]})}))}))}const Py=30;function jy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Cy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){jy(e,t,n[t])}))}return e}function Ey(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Dy(e){return new Ig(Ey(Cy({},e),{subTitle:"Demo of the SceneGridLayout",getScene:()=>new nh(Ey(Cy({},Yb()),{$data:Kb(),body:new Qh({isLazy:!0,isDraggable:!0,isResizable:!0,children:[new oh({x:0,y:0,width:12,height:10,isResizable:!0,isDraggable:!0,body:Fb.timeseries().setTitle("Draggable and resizable").setOption("legend",{showLegend:!1}).build()}),new oh({x:12,y:0,width:12,height:10,isResizable:!1,isDraggable:!1,body:Fb.timeseries().setTitle("No drag and no resize").setOption("legend",{showLegend:!1}).build()}),new oh({x:0,y:11,width:24,height:10,isDraggable:!1,isResizable:!0,body:new Gm({direction:"column",height:10*Py,children:[new Qm({body:Fb.timeseries().setTitle("Child of flex layout").build()}),new Qm({body:Fb.timeseries().setTitle("Child of flex layout").build()})]})})]})}))}))}function ky(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ty(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ky(e,t,n[t])}))}return e}function Ry(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Ay(e){return new Ig(Ry(Ty({},e),{subTitle:"SceneGridLayout demo with collapsible rows",getScene:()=>new nh(Ry(Ty({},Yb()),{$data:Kb(),body:new Qh({isDraggable:!0,children:[new am({title:"Row A",key:"Row A",isCollapsed:!0,isDraggable:!0,isResizable:!1,y:0,x:0,children:[new oh({x:0,y:1,width:12,height:5,isResizable:!0,isDraggable:!0,body:Fb.timeseries().setTitle("Row A Child1").build()}),new oh({x:0,y:5,width:6,height:5,isResizable:!0,isDraggable:!0,body:Fb.timeseries().setTitle("Row A Child2").build()})]}),new am({title:"Row B",key:"Row B",isCollapsed:!0,y:1,children:[new oh({x:0,y:2,width:12,height:5,isResizable:!1,isDraggable:!0,body:Fb.timeseries().setTitle("Row B Child1").build()}),new oh({x:0,y:7,width:6,height:5,isResizable:!1,isDraggable:!0,body:Fb.timeseries().setTitle("Row B Child2").build()})]}),new oh({x:2,y:12,width:12,height:10,isResizable:!0,isDraggable:!0,body:Fb.timeseries().setTitle("Outsider").build()})]})}))}))}function Iy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Iy(e,t,n[t])}))}return e}function My(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Fy(e){return new Ig(My(Vy({},e),{subTitle:"Showcasing lazy rendering and query execution of panels that are outside viewport",getScene:()=>{const e=Array.from(Array(20).keys());return new nh(My(Vy({},Yb()),{body:new Qh({isLazy:!0,children:e.map((e=>new oh({x:0,y:6*e,width:24,height:6,isResizable:!0,isDraggable:!0,body:Fb.timeseries().setTitle(`Panel ${e}`).setData(Kb({scenarioId:"slow_query",stringInput:"5s"})).build()})))})}))}}))}function Ly(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ly(e,t,n[t])}))}return e}function Ny(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function By(e){return new Ig(Ny($y({},e),{subTitle:"Here you can test changing series color and toggle series visiblity. ",getScene:()=>new nh(Ny($y({},Yb()),{body:new Gm({direction:"column",children:[new Qm({height:400,body:Fb.timeseries().setData(new Pl({datasource:l,queries:[{labels:"cluster=eu",refId:"A",scenarioId:"random_walk",seriesCount:1},{hide:!1,labels:"cluster=us",refId:"B",scenarioId:"random_walk",seriesCount:1},{hide:!1,labels:"cluster=asia",refId:"C",scenarioId:"random_walk",seriesCount:1}]})).setTitle("Check legend visibility actions, and color change").setDisplayName("${__field.labels.cluster}").build()}),new Qm({height:400,body:Fb.text().setOption("content","from: ${__from:date:iso} to: ${__to:date:iso}").build()})]})}))}))}function zy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){zy(e,t,n[t])}))}return e}function Hy(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Wy(e){const t=Kb(),n=[{text:"Item 1",onClick:()=>{alert("Item 1 clicked")}},{text:"Item 2",onClick:()=>{alert("Item 2 clicked")}}],r=new ah({});r.addActivationHandler((()=>{setTimeout((()=>{r.setItems(n)}),1e3)}));const a=new ah({items:n}),o=new ah({});o.addActivationHandler((()=>{o.setItems(n)}));const i=new ah({});let s=1;i.addActivationHandler((()=>{setTimeout((()=>{const e=`Item ${s} clicked`;i.addItem({text:`Item ${s}`,onClick:()=>{alert(e)}}),s++}),500)}));const l=new ah({}),u=Fb.timeseries().setTitle("Menu reading from panel state").setMenu(l).build();return l.addActivationHandler((()=>{var e;const n=u.getPlugin();l.setItems([{text:"Alert plugin type",onClick:()=>{var e;alert(null===(e=n)||void 0===e?void 0:e.meta.id)}},{text:`Change ${null===(e=n)||void 0===e?void 0:e.meta.id} panel title`,onClick:()=>{u.setState({title:`Updated title ${Math.floor(100*Math.random())+1}`})}},{text:"Change number of  series",onClick:()=>{t.setState({queries:[Hy(qy({},t.state.queries[0]),{seriesCount:Math.floor(10*Math.random())+1})]}),t.runQueries()}}])})),new Ig(Hy(qy({},e),{subTitle:"Different ways to use panel menu",getScene:()=>new nh(Hy(qy({},Yb()),{body:new Gm({$data:t,direction:"row",wrap:"wrap",children:[new Qm({minHeight:200,minWidth:"40%",body:Fb.timeseries().setTitle("Basic static menu").setMenu(a).build()}),new Qm({minHeight:200,minWidth:"40%",body:Fb.timeseries().setTitle("Basic lazy menu").setMenu(o).build()}),new Qm({minHeight:200,minWidth:"40%",body:Fb.timeseries().setTitle("Async menu, will show after 1s").setMenu(r).build()}),new Qm({minHeight:200,minWidth:"40%",body:Fb.timeseries().setTitle("New item added to menu after it is shown").setMenu(i).build()}),new Qm({minHeight:200,minWidth:"40%",body:u})]})}))}))}function Uy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Uy(e,t,n[t])}))}return e}function Qy(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Ky(t){const n=Kb({seriesCount:2,alias:"__server_names",scenarioId:"random_walk"});return new Ig(Qy(Gy({},t),{subTitle:"Here we use the SceneByFrameRepeater to dynamically build a layout for each frame",getScene:()=>new nh(Qy(Gy({},Yb()),{body:new qm({body:new Gm({direction:"column",children:[]}),getLayoutChild:(t,n,r)=>new Qm({minHeight:200,body:new Gm({direction:"row",key:`panel-${r}`,$data:new Ne({data:Qy(Gy({},t),{series:[n]})}),children:[new Qm({body:Fb.timeseries().setTitle((0,e.getFrameDisplayName)(n,r)).setOption("legend",{showLegend:!1}).build()}),new Qm({width:300,body:Fb.stat().setDisplayName("Last").setOption("graphMode",Ce.None).build()})]})})}),$data:n,controls:[new um({value:"2",label:"Series count",onChange:e=>{n.setState({queries:[Qy(Gy({},n.state.queries[0]),{seriesCount:e})]}),n.runQueries()}}),...Yb().controls]}))}))}function Yy(e){return{editorList:(0,Pn.css)({overflow:"auto",listStyle:"none",gap:e.spacing(2)}),queryEditor:(0,Pn.css)({display:"flex",flexDirection:"column"}),refIdLabel:(0,Pn.css)({display:"flex",flexGrow:1,fontSize:e.typography.h5.fontSize})}}function Zy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xy(e){var n,{model:a}=e,o=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,["model"]);const i=null!==(n=a.constructor.Component)&&void 0!==n?n:ev,[s,l]=(0,t.useState)(0);return(0,t.useEffect)((()=>{const e=a.activate();return l((e=>e+1)),e}),[a]),a.isActive?r().createElement(i,(u=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Zy(e,t,n[t])}))}return e}({},o),c=null!=(c={model:a})?c:{},Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(c)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(c)).forEach((function(e){Object.defineProperty(u,e,Object.getOwnPropertyDescriptor(c,e))})),u)):null;var u,c}const Jy=r().memo(Xy);function ev(e){return null}function tv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class nv extends e.BusEventWithPayload{}tv(nv,"type","scene-object-state-change");class rv extends e.BusEventWithPayload{}function av(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}tv(rv,"type","scene-object-user-action");var ov=new WeakMap;class iv{resolve(){return function(e,t){return t.get?t.get.call(e):t.value}(this,av(this,ov,"get"))}constructor(e){(function(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)})(this,ov,{writable:!0,value:void 0}),function(e,t,n){(function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}})(e,av(e,t,"set"),n)}(this,ov,e)}}function sv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class lv{get state(){return this._state}get isActive(){return this._isActive}get parent(){return this._parent}get variableDependency(){return this._variableDependency}get urlSync(){return this._urlSync}get Component(){return Jy}_setParent(e){uv(e,(e=>{e._parent&&e._parent!==this&&console.warn("SceneObject already has a parent set that is different from the new parent. You cannot share the same SceneObject instance in multiple scenes or in multiple different places of the same scene graph. Use SceneObject.clone() to duplicate a SceneObject or store a state key reference and use sceneGraph.findObject to locate it.",e,this),e._parent=this}))}clearParent(){this._parent=void 0}subscribeToState(e){return this._events.subscribe(nv,(t=>{t.payload.changedObject===this&&e(t.payload.newState,t.payload.prevState)}))}subscribeToEvent(e,t){return this._events.subscribe(e,t)}setState(e){const t=this._state,n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){sv(e,t,n[t])}))}return e}({},this._state,e);this._state=Object.freeze(n),this._setParent(e),this._handleActivationOfChangedStateProps(t,n),this.publishEvent(new nv({prevState:t,newState:n,partialUpdate:e,changedObject:this}),!0)}_handleActivationOfChangedStateProps(e,t){this.isActive&&(e.$behaviors!==t.$behaviors&&this._handleChangedBehaviors(e.$behaviors,t.$behaviors),e.$data!==t.$data&&this._handleChangedStateActivation(e.$data,t.$data),e.$variables!==t.$variables&&this._handleChangedStateActivation(e.$variables,t.$variables),e.$timeRange!==t.$timeRange&&this._handleChangedStateActivation(e.$timeRange,t.$timeRange))}_handleChangedStateActivation(e,t){if(e){const t=this._deactivationHandlers.get(e);t&&(t(),this._deactivationHandlers.delete(e))}t&&this._deactivationHandlers.set(t,t.activate())}_handleChangedBehaviors(e,t){if(e)for(const n of e)if(!t||!t.includes(n)){const e=this._deactivationHandlers.get(n);e&&(e(),this._deactivationHandlers.delete(n))}if(t)for(const n of t)e&&e.includes(n)||this._activateBehavior(n)}publishEvent(e,t){this._events.publish(e),t&&this.parent&&this.parent.publishEvent(e,t)}getRoot(){return this._parent?this._parent.getRoot():this}_internalActivate(){this._isActive=!0;const{$data:e,$variables:t,$timeRange:n,$behaviors:r}=this.state;if(this._activationHandlers.forEach((e=>{const t=e();t&&this._deactivationHandlers.set(t,t)})),n&&!n.isActive&&this._deactivationHandlers.set(n,n.activate()),t&&!t.isActive&&this._deactivationHandlers.set(t,t.activate()),e&&!e.isActive&&this._deactivationHandlers.set(e,e.activate()),r)for(const e of r)this._activateBehavior(e)}_activateBehavior(e){if(e instanceof lv)this._deactivationHandlers.set(e,e.activate());else if("function"==typeof e){const t=e(this);t&&this._deactivationHandlers.set(e,t)}}activate(){this.isActive||this._internalActivate(),this._refCount++;let e=!1;return()=>{if(this._refCount--,e)throw new Error("SceneObject cancelation handler returned by activate() called a second time");e=!0,0===this._refCount&&this._internalDeactivate()}}_internalDeactivate(){this._isActive=!1;for(let e of this._deactivationHandlers.values())e();this._deactivationHandlers.clear(),this._events.removeAllListeners(),this._subs.unsubscribe(),this._subs=new k.Subscription}useState(){return function(e,n){const[r,a]=(0,t.useState)(e.state),o=e.state;var i;const s=null!==(void 0,i=void 0)&&void 0!==i&&i;return(0,t.useEffect)((()=>{let t;s&&(t=e.activate());const n=e.subscribeToState((e=>{a(e)}));return e.state!==o&&a(e.state),()=>{n.unsubscribe(),t&&t()}}),[e,s]),e.state}(this)}forceRender(){this.setState({})}clone(e){return function(e,t){const n=function(e,t){const n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){cv(e,t,n[t])}))}return e}({},e);for(const e in n){const t=n[e];if(t instanceof lv&&(n[e]=t.clone()),t instanceof iv)throw new Error("Cannot clone a SceneObject with a SceneObjectRef in state");if(Array.isArray(t)){const r=[];for(const e of t)e instanceof lv?r.push(e.clone()):r.push(e);n[e]=r}}return Object.assign(n,t),n}(e.state,t);return new e.constructor(n)}(this,e)}addActivationHandler(e){this._activationHandlers.push(e)}forEachChild(e){uv(this.state,e)}getRef(){return this._ref||(this._ref=new iv(this)),this._ref}constructor(t){sv(this,"_isActive",!1),sv(this,"_state",void 0),sv(this,"_activationHandlers",[]),sv(this,"_deactivationHandlers",new Map),sv(this,"_ref",void 0),sv(this,"_events",void 0),sv(this,"_parent",void 0),sv(this,"_subs",new k.Subscription),sv(this,"_refCount",0),sv(this,"_variableDependency",void 0),sv(this,"_urlSync",void 0),t.key||(t.key=M()),this._events=new e.EventBusSrv,this._state=Object.freeze(t),this._setParent(this._state)}}function uv(e,t){for(const n of Object.values(e))if(n instanceof lv&&t(n),Array.isArray(n))for(const e of n)e instanceof lv&&t(e)}function cv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dv(e,t){let n,r=e;for(;r&&!n;)n=t(r),r=r.parent;return n}function pv(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function fv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class hv extends ae{constructor(e){super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){fv(e,t,n[t])}))}return e}({},e)),fv(this,"_onActivate",(()=>{const e=mv(this);e&&this._subs.add(e.subscribeToState(((e,t)=>{var n,r,a;const o=null!==(a=e.datasource)&&void 0!==a?a:gv(e.queries);var i;const s=null!==(i=t.datasource)&&void 0!==i?i:gv(t.queries);((null===(n=o)||void 0===n?void 0:n.uid)!==(null===(r=s)||void 0===r?void 0:r.uid)||o&&!this.state.datasource)&&function(e,t){return bv.apply(this,arguments)}(e.datasource,{}).then((e=>this.setState({datasource:e}))).catch((e=>this.setState({datasourceLoadErrorMessage:e})))})))})),fv(this,"onChange",((e,t)=>{const n=e.state.queries;e.setState({queries:n.map((e=>e.refId===t.refId?t:e))}),e.runQueries()})),this.addActivationHandler(this._onActivate)}}function mv(e){return dv(e,(e=>{if(e.state.$data instanceof Pl)return e.state.$data}))}function gv(e){var t,n;return null!==(n=null===(t=e.find((e=>null!==e.datasource)))||void 0===t?void 0:t.datasource)&&void 0!==n?n:void 0}function bv(){var e;return e=function*(e,t){return e&&e.query?e:yield(0,d.getDataSourceSrv)().get(e,t)},bv=function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){pv(o,r,a,i,s,"next",e)}function s(e){pv(o,r,a,i,s,"throw",e)}i(void 0)}))},bv.apply(this,arguments)}function yv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){yv(e,t,n[t])}))}return e}function wv(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Ov(e){return new Ig(wv(vv({},e),{subTitle:"Example of how to to build a component that uses the QueryEditor",getScene:()=>new nh(wv(vv({},Yb()),{body:new Gm({direction:"column",children:[new Qm({ySizing:"content",body:new hv}),new Qm({body:Fb.timeseries().setTitle("Timeseries").build(),minHeight:400,minWidth:"40%"})]}),$data:Kb()}))}))}function Sv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Sv(e,t,n[t])}))}return e}function xv(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Pv(e){return new Ig(xv(_v({},e),{subTitle:"Show casing the default and custom responsive options of SceneFlexLayout",getScene:()=>new nh(xv(_v({},Yb()),{$data:Kb({},{maxDataPoints:40}),body:new Gm({direction:"column",children:[Zb("Row with height 150, Default responsive behavior of switching to column layout and removing height constraint on layout. Height constraints are automatically also applied to children so they work when the media query switches the flex direction to column"),new Gm({direction:"row",height:150,children:[jv({}),jv({}),jv({})]}),Zb("Row with height 20, Overriding default responsive rule to maintain row layout even on smaller screens but with only 100px height"),new Gm({direction:"row",height:200,md:{height:100,direction:"row"},children:[jv({}),jv({})]}),Zb("Row with minHeight 300, and item with width constraint. The responsive style will remove the maxWidth by default"),new Gm({direction:"row",minHeight:300,children:[Cv({},"No constraints"),new Gm({direction:"column",maxWidth:300,children:[Cv({},"maxWidth 300"),Cv({},"maxWidth 300")]})]})]})}))}))}function jv(e){return new Qm(xv(_v({},e),{body:Fb.stat().setTitle("Stat").build()}))}function Cv(e,t){return new Qm(xv(_v({},e),{body:Fb.timeseries().setTitle(null!=t?t:"Panel").build()}))}function Ev(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function Dv(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){Ev(o,r,a,i,s,"next",e)}function s(e){Ev(o,r,a,i,s,"throw",e)}i(void 0)}))}}function kv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Tv(t){return new Ig((n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){kv(e,t,n[t])}))}return e}({},t),r={subTitle:"Test of variable cascading updates and refresh on time range change",$timeRange:new Xe,controls:[new cm({}),new xm({})],tabs:[new Ig({title:"Async and chained",url:`${t.url}/query`,getScene:()=>new nh({controls:[new ef({})],$variables:new of({variables:[new Tf({name:"server",query:"A.*",value:"server",text:"",description:"Server name",delayMs:1e3,isMulti:!0,options:[],refresh:e.VariableRefresh.onTimeRangeChanged}),new Tf({name:"pod",query:"A.$server.*",value:"pod",delayMs:1e3,isMulti:!0,text:"",options:[]}),new Tf({name:"handler",query:"A.$server.$pod.*",value:"pod",delayMs:1e3,isMulti:!0,text:"",options:[],refresh:e.VariableRefresh.onTimeRangeChanged}),new hf({name:"keyValue",description:"CustomVariable with key value pairs",value:"",isMulti:!0,text:"",query:"A : 1, B : 2, C : 3"}),new Hf({name:"interval",intervals:["1d","1m"],autoEnabled:!0,autoStepCount:30,autoMinInterval:"10s",description:"Auto step count 30, auto min interval 10s",refresh:e.VariableRefresh.onTimeRangeChanged}),new pu({name:"queryVar",label:"QueryVariable with TestData datasource",query:{query:"*",refId:"A"},datasource:{uid:"gdev-testdata"},definition:"*"})]}),body:new Gm({direction:"column",$behaviors:[Av("keyValue"),Av("server")],children:[Rv(),new Qm({body:new im({title:"Collapsable inner scene",canCollapse:!0,body:Rv()})})]})})}),new Ig({title:"Data source and textbox",url:`${t.url}/ds`,getScene:()=>new nh({controls:[new ef({})],$variables:new of({variables:[new wf({name:"ds",pluginId:"grafana-testdata-datasource"}),new Lf({name:"search"})]}),body:new Gm({direction:"column",children:[new Qm({body:Fb.timeseries().setTitle("datasource: $ds, search = $search").setData(new Pl({datasource:{uid:"$ds"},queries:[{refId:"A",scenarioId:"random_walk",alias:"ds = $ds, search = $search"}]})).build()})]})})}),new Ig({title:"Search filter",url:`${t.url}/search`,getScene:()=>new nh({controls:[new ef({})],$variables:new of({variables:[new pu({name:"server",query:{query:"A.$__searchFilter",refId:"A"},datasource:{uid:"gdev-testdata"},definition:"A.$__searchFilter"})]}),body:new Gm({direction:"column",children:[new Qm({body:Fb.text().setTitle("Variable with search filter").setOption("content","This is a very old messy feature that allows data sources to filter down the options in a query variable dropdown based on what the user has typed in. Only implemented by very few data sources (Graphite, SQL, Datadog)").build()})]})})}),new Ig({title:"Many variable options",url:`${t.url}/many-values`,getScene:()=>new nh({controls:[new ef({})],$variables:new of({variables:[new Tf({name:"manyOptions",query:"",optionsToReturn:Iv(1e5),delayMs:0})]}),body:new Gm({direction:"column",children:[new Qm({body:Fb.text().setTitle("Description").setOption("content","This tab is mainly to test a variable with 100 000 options, to test search / typing performance. manyOptions=$manyOptions").build()})]})})}),new Ig({title:"Many adhoc variable values",url:`${t.url}/many-adhoc-values`,getScene:()=>new nh({controls:[new ef({})],$variables:new of({variables:[new il({name:"manyAdhocOptions",getTagKeysProvider:Dv((function*(){return{replace:!0,values:[{value:"a",text:"A"},{value:"b",text:"B"},{value:"c",text:"C"}]}})),getTagValuesProvider:Dv((function*(){return{replace:!0,values:Iv(1e5).map((({value:e,label:t})=>({value:e,text:t})))}}))})]}),body:new Gm({direction:"column",children:[new Qm({body:Fb.text().setTitle("Description").setOption("content","This tab is mainly to test an adhoc variable with 100 000 options, to test search / typing performance. manyAdhocOptions=$manyAdhocOptions").build()})]})})})]},r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(r)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))})),n));var n,r}function Rv(){return new Gm({children:[new Qm({body:Fb.timeseries().setTitle("handler: $handler").setData(Kb({alias:"handler: $handler"})).build()}),new Qm({body:Fb.text().setTitle("Interpolation").setOption("content","\n* server: $server\n* pod: $pod\n* handler: $handler\n* interval: $interval\n* keyValue: $keyValue\n* keyValue: ${keyValue:text} (text value)\n* queryVar: $queryVar\n* [Link that updates pod = AAG and AAH](${__url.path}${__url.params:exclude:var-pod}&var-pod=AAG&var-pod=AAH)\n\n          ").build()})]})}function Av(e){return new Pu({variableName:e,onChange:e=>{console.log(`${e.state.name} changed`);const t=setTimeout((()=>{console.log(`${e.state.name} post effect`)}),5e3);return()=>{console.log(`${e.state.name} cancel effect`),clearTimeout(t)}}})}function Iv(e){return new Array(e).fill(null).map(((e,t)=>({value:Vv(50),label:Vv(50)})))}function Vv(e){let t="";let n=0;for(;n<e;)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random())),n+=1;return t}function Mv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Mv(e,t,n[t])}))}return e}function Lv(){const e=new Jp({transformations:[{id:"reduce",options:{reducers:["mean"]}},{id:"organize",options:{excludeByName:{},indexByName:{},renameByName:{Field:"Room",Mean:"Average temperature"}}}]});return Fb.table().setData(e).setTitle("Room temperature overview").setOption("sortBy",[{displayName:"Average temperature"}]).setColor({mode:Eu.ContinuousGrYlRd}).setCustomFieldConfig("align","auto").setCustomFieldConfig("cellOptions",{type:Te.Auto}).setCustomFieldConfig("inspect",!1).setOverrides((e=>e.matchFieldsWithName("Average temperature").overrideUnit("celsius").overrideCustomFieldConfig("cellOptions",{type:Te.Gauge,mode:ke.Gradient}).overrideCustomFieldConfig("align","center").matchFieldsWithName("Room").overrideLinks([{title:"Go to room overview",url:"${__url.path}/room/${__value.text}/temperature"}]).overrideCustomFieldConfig("width",250))).build()}function $v(e){const t=new Jp({transformations:[{id:"reduce",options:{reducers:e}}]});return Fb.stat().setData(t).setUnit("celsius").build()}function Nv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Nv(e,t,n[t])}))}return e}function zv(e){return{refId:"Temp",datasource:l,scenarioId:"random_walk",seriesCount:1,alias:e,min:10,max:30}}function qv(e){return{refId:"Humidity",datasource:l,scenarioId:"random_walk",seriesCount:1,alias:e,min:30,max:60}}function Hv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Hv(e,t,n[t])}))}return e}function Uv(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}fv(hv,"Component",(function({model:t}){var n;const{datasource:a,datasourceLoadErrorMessage:o}=t.useState(),{data:i}=yu.getData(t).useState(),s=mv(t),l=null===(n=s)||void 0===n?void 0:n.state.queries,u=(0,Sn.useStyles2)(Yy);if(o)return r().createElement("div",null,"Failed to load datasource: ",o);if(!a||!a.components)return r().createElement("div",null,"Loading data source...");if(!a.components.QueryEditor)return r().createElement("div",null,"Datasource has no query editor.");if(!l||0===l.length)return r().createElement("div",null,"No queries found.");const c=a.components.QueryEditor;return r().createElement("ul",{className:u.editorList},l.map((n=>{var o;return r().createElement("li",{key:n.refId,className:u.queryEditor},r().createElement("span",{className:u.refIdLabel},n.refId),r().createElement(c,{key:a.name,query:n,datasource:a,onChange:e=>t.onChange(s,e),onRunQuery:()=>{},onAddQuery:()=>{},data:i,range:null===(o=i)||void 0===o?void 0:o.timeRange,queries:l,app:e.CoreApp.PanelEditor}))})))}));const Gv={refId:"Rooms temperature",datasource:l,scenarioId:"random_walk",seriesCount:8,alias:"__house_locations",min:10,max:27},Qv=()=>new nh(Uv(Wv({},Yb()),{$data:new Pl({datasource:l,queries:[Gv],maxDataPoints:100}),body:new Gm({direction:"column",children:[new Qm({height:300,body:Lv()}),new Qm({ySizing:"fill",body:new qm({body:new Gm({direction:"column",children:[]}),getLayoutChild:(t,n,a)=>{return new Qm({key:`panel-${a}`,minHeight:200,$data:new Ne({data:(o=Fv({},t),i={series:[n]},i=null!=i?i:{},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(i)).forEach((function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(i,e))})),o)}),body:new Gm({direction:"row",children:[new Qm({body:Fb.timeseries().setTitle((0,e.getFrameDisplayName)(n)).setOption("legend",{showLegend:!1}).setHeaderActions(r().createElement("a",{className:"external-link",href:`${c("with-drilldowns")}/room/${encodeURIComponent((0,e.getFrameDisplayName)(n))}/temperature`},r().createElement(Sn.Icon,{name:"arrow-right"}),"Go to room")).build()}),new Qm({width:200,body:Fb.stat().setTitle("Last").setOption("graphMode",Ce.None).setOption("textMode",Ee.Value).setDisplayName("Last").build()})]})});var o,i}})})]})}));function Kv(t){return new Ig(Uv(Wv({},t),{subTitle:"This scene showcases a basic drilldown functionality. Interact with room to see room details scene.",getScene:Qv,drilldowns:[{routePath:`${t.url}/room/:roomName`,getPage(n,a){const o=n.params.roomName;return new Ig({url:`${t.url}/room/${o}/temperature`,title:`${o}`,subTitle:"This scene is a particular room drilldown. It implements two tabs to organise the data.",getParentPage:()=>a,tabs:[new Ig({title:"Temperature",titleIcon:"dashboard",tabSuffix:()=>r().createElement(Sn.Counter,{value:1}),url:`${t.url}/room/${o}/temperature`,getScene:()=>function(t){return new nh(Bv({$data:new Pl({datasource:l,queries:[zv(t)],maxDataPoints:100}),body:new Gm({direction:"column",children:[new Qm({height:500,body:Fb.timeseries().setTitle("Temperature over time").setUnit("celsius").build()}),new Qm({body:new Gm({direction:"row",children:[new Qm({body:$v([e.ReducerID.min])}),new Qm({body:$v([e.ReducerID.max])}),new Qm({body:$v([e.ReducerID.mean])})]})})]})},Yb()))}(o)}),new Ig({title:"Humidity",titleIcon:"chart-line",url:`${t.url}/room/${o}/humidity`,getScene:()=>function(e){return new nh(Bv({$data:new Pl({datasource:l,queries:[qv(e)],maxDataPoints:100}),body:new Gm({direction:"column",children:[new Qm({height:500,body:Fb.timeseries().setTitle("Humidity over time").setUnit("humidity").build()})]})},Yb()))}(o)})]})}}]}))}function Yv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zv(e){const t=new Xe({timeZone:"browser"}),n=new Xe({from:"now-5m",to:"now"}),r=new Ap({timeZone:"America/New_York"}),a=Fb.timeseries(),o=a.setTitle("Using global time range and time zone (${__timezone})").setDescription("This panel should show data within time zone and time range selected in the time picker.").build(),i=a.setTitle("Using local range and global time zone (${__timezone})").setDescription("This panel should show data from the last 5 minutes, using time zone from the time picker").build(),s=a.setTitle("Using global range, local time zone (${__timezone})").setDescription("This panel should show data using America/New_York time zone and time range from the time picker").build();return t.subscribeToState((()=>{o.setState({title:`Using global time range and global time zone: ${t.getTimeZone()}`}),i.setState({title:`Using local time range and global time zone: ${n.getTimeZone()}`})})),r.subscribeToState(((e,t)=>{s.setState({title:`Using global time range and local time zone: ${r.getTimeZone()}`})})),new Ig((l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Yv(e,t,n[t])}))}return e}({},e),u=null!=(u={subTitle:"Time zones support test",getScene:()=>new nh({$timeRange:t,controls:[new Um,new cm({}),new xm({})],key:"Time zones embedded scene",body:new Gm({direction:"column",children:[new Gm({direction:"row",maxHeight:"500",children:[new Qm({$data:Kb({}),minHeight:"200",body:o}),new Qm({$data:Kb({}),$timeRange:n,minHeight:"200",body:new Gm({direction:"column",children:[new Qm({body:i})]})}),new Qm({$data:Kb({}),$timeRange:r,minHeight:"200",body:s})]})]})})})?u:{},Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(u)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(u)).forEach((function(e){Object.defineProperty(l,e,Object.getOwnPropertyDescriptor(u,e))})),l));var l,u}function Xv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Xv(e,t,n[t])}))}return e}function ew(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const tw=()=>new Ig({title:"Split layout test",url:c("split-layout"),getScene:()=>new nh(ew(Jv({},Yb()),{key:"Flex layout embedded scene",body:new mg({initialSize:.7,direction:"row",primary:new Qm({minWidth:300,body:Fb.timeseries().setTitle("Dynamic height and width").setData(Kb({},{maxDataPointsFromWidth:!0})).build()}),secondary:new Qm({minWidth:300,body:new mg({ySizing:"content",direction:"column",primary:new Qm({minHeight:200,body:Fb.timeseries().setTitle("Dynamic height and width").setData(Kb({},{maxDataPointsFromWidth:!0})).build()}),secondary:new Qm({minHeight:200,body:new lm({text:"Blah blah",fontSize:30,align:"center"})})})})})}))}),nw={refId:"Rooms temperature",datasource:l,scenarioId:"random_walk",seriesCount:8,alias:"__house_locations",min:10,max:27},rw=()=>{const e=new Qm({minWidth:500,body:new lm({text:"Select room to see details",fontSize:20,align:"center"})}),t=new Pl({datasource:l,queries:[nw],maxDataPoints:100}),n=Fb.table().setData(new Jp({transformations:[{id:"reduce",options:{reducers:["mean"]}},{id:"organize",options:{excludeByName:{},indexByName:{},renameByName:{Field:"Room",Mean:"Average temperature"}}}]})).setTitle("Room temperature overview").setOption("sortBy",[{displayName:"Average temperature"}]).setCustomFieldConfig("align","auto").setCustomFieldConfig("cellOptions",{type:Te.Auto}).setCustomFieldConfig("inspect",!1).setColor({mode:Eu.ContinuousGrYlRd}).setOverrides((t=>t.matchFieldsWithName("Average temperature").overrideUnit("celsius").overrideCustomFieldConfig("align","center").overrideCustomFieldConfig("cellOptions",{type:Te.Gauge,mode:ke.Gradient}).matchFieldsWithName("Room").overrideLinks([{title:"Go to room overview",url:"",onClick:t=>{const n=t.origin.field.values.get(t.origin.rowIndex);a.setState({secondary:new Qm({minWidth:500,body:Fb.timeseries().setTitle(`${n} temperature`).setData(new Pl({datasource:l,queries:[zv(n)]})).setHeaderActions(r().createElement("label",null,r().createElement(Sn.IconButton,{name:"trash-alt",type:"button",onClick:()=>a.setState({secondary:void 0}),"aria-label":"remove right part"}),r().createElement(Sn.IconButton,{name:"times",type:"button",onClick:()=>a.setState({secondary:e}),"aria-label":"clear right part"}))).build()})})}}]).overrideCustomFieldConfig("width",250))).build(),a=new mg({direction:"row",primary:new Qm({body:n,minWidth:300}),secondary:e});return new nh(ew(Jv({},Yb()),{key:"Flex layout embedded scene",$data:t,body:a}))},aw=()=>new Ig({title:"Dynamic split layout test",url:c("split-layout/dynamic"),getScene:rw});function ow(e){return new Ig(ew(Jv({},e),{subTitle:"A demo of split layout options",url:c("split-layout"),tabs:[tw(),aw()]}))}function iw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){iw(e,t,n[t])}))}return e}function lw(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function uw(e){return new Ig(lw(sw({},e),{subTitle:"Demo of query cancellation",getScene:()=>new nh(lw(sw({},Yb()),{key:"Flex layout embedded scene",$data:Kb({scenarioId:"slow_query",stringInput:"10s"},{maxDataPointsFromWidth:!1}),body:new Gm({direction:"column",children:[new Gm({direction:"row",children:[new Qm({minWidth:"20%",body:Fb.timeseries().setTitle("Global query").build()}),new Qm({minWidth:"20%",body:Fb.timeseries().setTitle("Local query").setData(Kb({scenarioId:"slow_query",stringInput:"10s"},{maxDataPointsFromWidth:!1})).build()}),new Qm({minWidth:"20%",body:Fb.stat().setTitle("Local query via transformation").setData(new Jp({$data:Kb({scenarioId:"slow_query",stringInput:"15s"},{maxDataPointsFromWidth:!0}),transformations:[{id:"reduce",options:{reducers:["mean"]}}]})).build()}),new Qm({minWidth:"20%",body:Fb.stat().setTitle("Global query via transformation").setData(new Jp({transformations:[{id:"reduce",options:{reducers:["mean"]}}]})).build()}),new Qm({minWidth:"20%",body:Fb.stat().setTitle("Transformed transformation").setData(new Jp({transformations:[{id:"calculateField",options:{mode:"binary",reduce:{reducer:"sum"},binary:{left:"A-series",reducer:"sum",operator:"*",right:"2"}}}]})).build()})]})]})}))}))}function cw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){cw(e,t,n[t])}))}return e}function pw(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function fw(e){return Ub.registerRuntimeDataSource({dataSource:new hw("my-custom-ds","my-custom-ds-uid")}),new Ig(pw(dw({},e),{subTitle:"Demo of a runtime registered panel plugin",getScene:()=>new nh(pw(dw({},Yb()),{$variables:new of({variables:[new pu({name:"test",query:{refId:"A",query:"A"},datasource:{uid:"my-custom-ds-uid",type:"my-custom-ds"}})]}),body:new Gm(pw(dw({},Yb()),{direction:"column",children:[new Qm({body:new Fc({title:"Data coming from custom runtime registered data source",pluginId:"table",$data:new Pl({datasource:{uid:"my-custom-ds-uid",type:"my-custom-ds"},queries:[{refId:"A",query:"A"}]})})})]}))}))}))}class hw extends me{query(t){return Promise.resolve({state:Ie.Done,data:[{fields:[{name:"Values",type:e.FieldType.number,values:[1,2,3],config:{}}],length:3}]})}metricFindQuery(e,t){return Promise.resolve([{text:"value1-from-runtime-ds",value:"value1-from-runtime-ds"},{text:"value2-from-runtime-ds",value:"value2-from-runtime-ds"}])}testDatasource(){return Promise.resolve({status:"success",message:"OK"})}}function mw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class gw extends ae{constructor(){super({count:0}),mw(this,"onIncrement",(()=>{this.setState({count:this.state.count+1})}))}}function bw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}mw(gw,"Component",(function({model:e}){const{count:t}=e.useState();return r().createElement("div",null,r().createElement("div",null,"Counter: ",t),r().createElement("button",{onClick:e.onIncrement},"Increase"))}));class yw extends ae{constructor(){super({count:0}),bw(this,"onIncrement",(()=>{this.setState({count:this.state.count+1})}))}}function vw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ww(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){vw(e,t,n[t])}))}return e}function Ow(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}bw(yw,"Component",(function({model:e}){const{count:t}=e.useState();return r().createElement("div",null,r().createElement("div",null,"Counter: ",t),r().createElement("button",{onClick:e.onIncrement},"Increase"))}));const Sw=()=>e=>e.pipe(Ed((e=>e.map((e=>Ow(ww({},e),{fields:e.fields.map((e=>"handler"===e.name?Ow(ww({},e),{values:e.values.map((e=>"http://www.my-api.com"+e))}):e))}))))));function _w(e){var t,n;const{options:a,data:o}=e;return r().createElement("div",null,r().createElement("h4",null,"CustomVizPanel options: ",r().createElement("pre",null,JSON.stringify(a))),r().createElement("div",null,"CustomVizPanel field config: ",r().createElement("pre",null,JSON.stringify(null===(n=o.series[0])||void 0===n||null===(t=n.fields[0])||void 0===t?void 0:t.config))))}function xw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Pw extends ae{constructor(e){super({text:e}),xw(this,"_variableDependency",new zl(this,{statePaths:["text"]})),xw(this,"onTextChange",(e=>{this.setState({text:e})}))}}xw(Pw,"Component",(function({model:e}){const{text:t}=e.useState(),n=yu.interpolate(e,t);return r().createElement("div",null,r().createElement("div",{style:{marginBottom:8}},r().createElement(Sn.TextArea,{defaultValue:t,onBlur:t=>e.onTextChange(t.currentTarget.value)})),r().createElement("pre",null,n))}));class jw extends ae{activationHandler(){const e=yu.getData(this);this._subs.add(e.subscribeToState((e=>console.log(e))))}constructor(){super({}),this.addActivationHandler((()=>this.activationHandler()))}}var Cw,Ew,Dw;function kw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Dw=function({model:e}){var t,n;const a=yu.getData(e).useState();return r().createElement("div",null,r().createElement("pre",null,"Time range: ",JSON.stringify(null===(t=a.data)||void 0===t?void 0:t.timeRange)),r().createElement("pre",null,"Data: ",JSON.stringify(null===(n=a.data)||void 0===n?void 0:n.series)))},(Ew="Component")in(Cw=jw)?Object.defineProperty(Cw,Ew,{value:Dw,enumerable:!0,configurable:!0,writable:!0}):Cw[Ew]=Dw;const Tw=e=>(console.log(`${e.state.key} activated`),e.subscribeToState((()=>{console.log(`${e.state.key} state changed`)})),()=>{console.log(`${e.state.key} deactivated`)});class Rw extends ae{constructor(e){super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){kw(e,t,n[t])}))}return e}({batchStateUpdates:5},e)),kw(this,"_batchedStateUpdates",[]),kw(this,"_onActivate",(()=>{const e=this.parent;if(!e)throw new Error("LoggerBehavior must be attached to a parent object");return console.log(`StatefulLoggerBehavior: ${e.state.key} activated`),e.subscribeToState((()=>{this._batchedStateUpdates.push(e.state),this._batchedStateUpdates.length===this.state.batchStateUpdates&&(console.log(`StatefulLoggerBehavior: ${e.state.key} state changed batch`,this._batchedStateUpdates),this._batchedStateUpdates=[])})),()=>{console.log(`StatefulLoggerBehavior: ${e.state.key} deactivated`)}})),this.addActivationHandler(this._onActivate)}}function Aw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Iw=[{title:"Hello world",url:"hello-world",getScene:function(){return new nh({body:new Gm({children:[new Qm({width:"50%",height:300,body:Fb.text().setTitle("Panel title").setOption("content","Hello world!").build()})]})})}},{title:"Custom object",url:"custom-object",getScene:function(){return new nh({body:new Gm({children:[new Qm({width:"50%",height:300,body:new yw})]})})}},{title:"Data and time range",url:"data-and-time-range",getScene:function(){const e=new Pl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"rate(prometheus_http_requests_total{}[5m])"}]}),t=new Pl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"avg by (job, instance, mode) (rate(node_cpu_seconds_total[5m]))"}]});return new nh({$data:e,$timeRange:new Xe({from:"now-5m",to:"now"}),body:new Gm({direction:"row",children:[new Qm({width:"50%",height:300,body:Fb.timeseries().setTitle("Panel using global time range").build()}),new Qm({width:"50%",height:300,body:Fb.timeseries().setTitle("Panel using local time range").setTimeRange(new Xe({from:"now-6h",to:"now"})).setData(t).build()})]})})}},{title:"Flexbox layout",url:"scene-layout-flexbox",getScene:function(){const e=new Pl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"rate(prometheus_http_requests_total{}[5m])"}]});return new nh({$data:e,body:new Gm({direction:"column",children:[new Qm({body:Fb.timeseries().setTitle("Time series").build()}),new Qm({body:Fb.table().setTitle("Table").build()})]})})}},{title:"CSS grid layout",url:"scene-layout-css-grid",getScene:function(){const e=new Pl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"rate(prometheus_http_requests_total{}[5m])"}]});return new nh({$data:e,body:new tg({templateColumns:"repeat(auto-fit, minmax(400px, 1fr))",autoRows:"150px",rowGap:2,columnGap:2,children:[new ng({body:Fb.timeseries().setTitle("Time series").build()}),new ng({body:Fb.table().setTitle("Time series").build()}),new ng({body:Fb.timeseries().setTitle("Time series").build()}),new ng({body:Fb.table().setTitle("Time series").build()}),new ng({body:Fb.timeseries().setTitle("Table").build()}),new ng({body:Fb.table().setTitle("Table").build()})]})})}},{title:"Grid layout",url:"scene-layout-grid",getScene:function(){const e=new Pl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"rate(prometheus_http_requests_total{}[5m])"}]});return new nh({body:new Qh({$data:e,children:[new oh({x:0,y:0,width:12,height:10,isResizable:!1,isDraggable:!1,body:Fb.timeseries().setTitle("Time series").build()}),new oh({x:12,y:0,width:12,height:10,isResizable:!1,isDraggable:!1,body:Fb.table().setTitle("Table").build()})]})})}},{title:"Split layout",url:"scene-layout-split",getScene:function(){const e=new Pl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"rate(prometheus_http_requests_total{}[5m])"}]});return new nh({$data:e,body:new mg({direction:"column",primary:Fb.timeseries().setTitle("Primary panel").build(),secondary:Fb.table().setTitle("Secondary panel").build()})})}},{title:"Standard visualizations",url:"visualizations-standard",getScene:function(){const e=Fb.timeseries().setTitle("My first panel"),t=new Pl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"rate(prometheus_http_requests_total{}[5m])"}],$timeRange:new Xe({from:"now-5m",to:"now"})});e.setData(t),e.setOption("legend",{asTable:!0}).setOption("tooltip",{mode:De.Single}),e.setDecimals(2).setUnit("ms"),e.setCustomFieldConfig("lineInterpolation",Se.Smooth),e.setOverrides((e=>e.matchFieldsWithNameByRegex("/metrics/").overrideDecimals(4).overrideCustomFieldConfig("lineWidth",5)));const n=e.build();return new nh({body:new Gm({children:[new Qm({body:n})]})})}},{title:"Custom visualization",url:"visualizations-custom",getScene:()=>{const t=new e.PanelPlugin(_w).useFieldConfig({useCustomConfig:e=>{e.addNumberInput({path:"numericOption",name:"Numeric option",description:"A numeric option",defaultValue:1})}});Ub.registerRuntimePanelPlugin({pluginId:"my-scene-app-my-custom-viz",plugin:t});const n=new Pl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"rate(prometheus_http_requests_total{}[5m])"}],$timeRange:new Xe({from:"now-5m",to:"now"})});return new nh({$data:n,body:new Gm({children:[new Qm({body:new Fc({pluginId:"my-scene-app-my-custom-viz",options:{mode:"my-custom-mode"},fieldConfig:{defaults:{unit:"ms",custom:{numericOption:100}},overrides:[]}})})]})})}},{title:"Variables",url:"variables",getScene:function(){const e=new pu({name:"handler",datasource:{type:"prometheus",uid:"gdev-prometheus"},query:{query:"label_values(prometheus_http_requests_total,handler)",refId:"A"}}),t=new Pl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",range:!0,format:"time_series",expr:'rate(prometheus_http_requests_total{handler="$handler"}[5m])'}]});return new nh({$variables:new of({variables:[e]}),$data:t,body:new Gm({children:[new Qm({body:Fb.timeseries().build()})]}),controls:[new ef({})]})}},{title:"Transformations",url:"transformations",getScene:function(){const e=new Pl({$timeRange:new Xe,datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"sort_desc(avg by(handler) (rate(prometheus_http_request_duration_seconds_sum {}[5m]) * 1e3))",format:"table",instant:!0}]}),t=new Jp({$data:e,transformations:[Sw,{id:"organize",options:{excludeByName:{Time:!0},indexByName:{},renameByName:{}}},{id:"renameByRegex",options:{regex:"handler",renamePattern:"Handler"}},{id:"renameByRegex",options:{regex:"Value",renamePattern:"Average duration"}}]});return new nh({$data:t,body:new Gm({direction:"column",children:[new Qm({body:Fb.table().setTitle("Average duration of HTTP request").build()})]})})}},{title:"Advanced - custom objects",url:"advanced-custom-scene-objects",getScene:function(){return new nh({body:new Gm({children:[new Qm({width:"50%",height:300,body:new gw})]})})}},{title:"Advanced - activation handlers",url:"advanced-activation-handlers",getScene:function(){const e=new Pl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",range:!0,format:"time_series",expr:"rate(prometheus_http_requests_total[5m])"}]}),t=Fb.text().setTitle("Debug view").setOption("mode",pb.HTML).setOption("content","").build();return e.addActivationHandler((()=>{let n="";const r=e.subscribeToState((e=>{n=`${new Date(Date.now()).toLocaleTimeString()} Executed query: <pre>${e.queries.map((e=>e.expr))}</pre>\n`+n,t.setState({options:{content:n}})}));return()=>{r.unsubscribe()}})),new nh({$timeRange:new Xe,controls:[new cm({isOnCanvas:!0}),new xm({isOnCanvas:!0})],body:new Gm({direction:"row",children:[new Qm({body:Fb.timeseries().setTitle("Panel title").setData(e).build()}),new Qm({width:"30%",body:t})]})})}},{title:"Advanced - data",url:"advanced-data",getScene:function(){const e=new Pl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:"rate(prometheus_http_requests_total{}[5m])"}]});return new nh({$data:e,controls:[new Um,new cm({}),new xm({})],body:new Gm({direction:"column",children:[new Qm({body:new jw})]})})}},{title:"Advanced - variables",url:"advanced-variables",getScene:function(){const e=new hf({name:"greetings",query:"Hello , Hola , Bonjour , Ahoj"});return new nh({$variables:new of({variables:[e]}),controls:[new ef({})],body:new Gm({direction:"column",children:[new Qm({minHeight:300,body:new Pw("Hello world")})]})})}},{title:"Advanced - time range comparison",url:"advanced-time-range-comparison",getScene:function(){const e=new Pl({datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",expr:'rate(prometheus_http_requests_total{handler=~"/metrics"}[5m])'}]});return new nh({$data:e,$timeRange:new Xe({from:"now-5m",to:"now"}),controls:[new cm({}),new Nm({})],body:new Gm({direction:"row",children:[new Qm({width:"100%",height:"100%",body:Fb.timeseries().setTitle("Panel using global time range").build()})]})})}},{title:"Advanced - Behaviors",url:"advanced-behaviors",getScene:function(){const e=new Pl({$behaviors:[Tw,new Rw({batchStateUpdates:5})],datasource:{type:"prometheus",uid:"gdev-prometheus"},queries:[{refId:"A",range:!0,format:"time_series",expr:"rate(prometheus_http_requests_total[5m])"}]});return new nh({$timeRange:new Xe,controls:[new cm({isOnCanvas:!0}),new xm({isOnCanvas:!0})],body:new Gm({direction:"row",children:[new Qm({body:Fb.timeseries().setTitle("Panel title").setData(e).build()})]})})}}];function Vw(e){return new Ig((t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Aw(e,t,n[t])}))}return e}({},e),n={subTitle:"Examples from documentation page",url:c("docs-examples"),tabs:Iw.map((e=>function(e,t,n){return new Ig({title:n,url:c(`docs-examples/${t}`),getScene:e})}(e.getScene,e.url,e.title)))},n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t));var t,n}function Mw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fw(e){return new Ig((t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Mw(e,t,n[t])}))}return e}({},e),n=null!=(n={subTitle:"Time range comparison test",getScene:()=>new nh({$data:Kb({},{maxDataPointsFromWidth:!1}),$timeRange:new Xe({}),controls:[new Um,new cm({}),new Nm({key:"top"}),new xm({})],key:"Flex layout embedded scene",body:new Gm({direction:"column",children:[new Gm({direction:"row",wrap:"wrap",children:[new Qm({minWidth:"40%",minHeight:500,body:Fb.timeseries().setTitle("Uses global time range, data and comparer").setData(Kb({},{maxDataPointsFromWidth:!0})).build()}),new Qm({minWidth:"40%",minHeight:500,body:Fb.timeseries().setOverrides((e=>e.matchComparisonQuery("MyQuery").overrideColor({mode:"fixed",fixedColor:"red"}))).setTitle("Uses global time range and comparer, local data").setData(Kb({refId:"MyQuery"},{maxDataPointsFromWidth:!0})).build()}),new Qm({minWidth:"40%",minHeight:500,body:Fb.timeseries().setTitle("Uses global time range, local comparer and data").setData(Kb({},{maxDataPointsFromWidth:!0})).setHeaderActions([new Nm({key:"mid"})]).build()}),new Qm({minWidth:"40%",minHeight:500,body:Fb.timeseries().setTitle("Uses local time range, data and comparer").setTimeRange(new Xe({})).setData(Kb({},{maxDataPointsFromWidth:!0})).setHeaderActions([new cm({}),new Nm({key:"bottom"}),new xm({})]).build()})]})]})})})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t));var t,n}function Lw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Lw(e,t,n[t])}))}return e}function Nw(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Bw(e){return new Ig(Nw($w({},e),{subTitle:"A simple demo of scoped cursor sync",url:c("cursor-sync"),tabs:[new Ig({title:"Global sync scope",url:c("cursor-sync"),getScene:()=>new nh(Nw($w({},Yb()),{key:"Flex layout embedded scene",$behaviors:[new Fu({key:"sync1",sync:Du.Tooltip})],body:new Gm({direction:"column",children:[new Gm({direction:"row",children:[new Qm({body:new Fc({title:"Panel 1",pluginId:"timeseries",$data:Kb({scenarioId:"csv_metric_values",stringInput:"1,20,90,30,5,0"})})}),new Qm({body:Fb.timeseries().setData(Kb({scenarioId:"csv_metric_values",stringInput:"1,20,90,30,5,0"},{maxDataPoints:50})).setTitle("Panel 2").build()})]}),new Gm({direction:"row",children:[new Qm({body:new Fc({title:"Panel 3",pluginId:"timeseries",$data:Kb({})})})]})]})}))}),new Ig({title:"Cursor sync test",url:c("cursor-sync/scoped"),getScene:()=>new nh(Nw($w({},Yb()),{key:"Flex layout embedded scene",body:new Gm({direction:"column",children:[new Gm({direction:"row",$behaviors:[new Fu({key:"sync1",sync:Du.Tooltip})],children:[new Qm({body:new Fc({title:"Panel 1 - syncs tooltip with Panel 2",pluginId:"piechart",$data:Kb({alias:"__house_locations",seriesCount:5,scenarioId:"random_walk"})})}),new Qm({body:Fb.piechart().setData(Kb({alias:"__house_locations",seriesCount:5,scenarioId:"random_walk"},{maxDataPoints:50})).setTitle("Panel 2").build()})]}),new Gm({direction:"row",$behaviors:[new Fu({key:"sync1",sync:Du.Tooltip})],children:[new Qm({body:new Fc({title:"Panel 1 - syncs tooltip with Panel 2",pluginId:"timeseries",$data:Kb({scenarioId:"csv_metric_values",stringInput:"1,20,90,30,5,0"})})}),new Qm({body:Fb.timeseries().setData(Kb({scenarioId:"csv_metric_values",stringInput:"1,20,90,30,5,0"},{maxDataPoints:50})).setTitle("Panel 2").build()})]}),new Gm({direction:"row",$behaviors:[new Fu({key:"sync2",sync:Du.Crosshair})],children:[new Qm({body:new Fc({title:"Panel 3 - syncs crosshair with Panel 4",pluginId:"timeseries",$data:Kb({})})}),new Qm({body:Fb.timeseries().setData(Kb({},{maxDataPoints:50})).setTitle("Panel 4").build()})]}),new Gm({direction:"row",$behaviors:[new Fu({key:"sync3",sync:Du.Off})],children:[new Qm({body:new Fc({title:"No sync",pluginId:"timeseries",$data:Kb({})})}),new Qm({body:Fb.timeseries().setData(Kb({},{maxDataPoints:50})).setTitle("No sync").build()})]})]})}))})]}))}function zw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){zw(e,t,n[t])}))}return e}function Hw(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Ww(e){const t=new Sp({name:"Global annotations",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"yellow",name:"New annotation",target:{lines:10,refId:"Anno",scenarioId:"annotations"}}}),n=new Sp({name:"Nested annotations",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"red",name:"New annotation",target:{lines:5,refId:"Anno",scenarioId:"annotations"}}}),r=new Sp({name:"Independent annotations",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"purple",name:"New annotation",target:{lines:3,refId:"Anno",scenarioId:"annotations"}}});return new Ig(Hw(qw({},e),{subTitle:"A simple demo of different flex layout options",getScene:()=>new nh(Hw(qw({},Yb()),{controls:[new Gc,new Um,new cm({}),new xm({})],key:"Multiple annotations layers",$data:new qp({layers:[t]}),body:new Gm({direction:"column",children:[new Gm({direction:"row",children:[new Qm({$data:Kb({scenarioId:"slow_query",stringInput:"5s"}),body:new Fc({title:"Global annotations only",pluginId:"timeseries"})}),new Qm({$data:n,body:new Fc({$data:Kb({}),title:"Nested annotations",description:"Uses a single data layer directly, not inside a SceneDataLayers",pluginId:"timeseries",headerActions:[new Gc]})}),new Qm({body:new Fc({$data:new Pl({$data:new qp({layers:[r]}),queries:[{refId:"A",datasource:l,scenarioId:"random_walk"}]}),title:"Combined annotations, from global and SceneQueryRunner",pluginId:"timeseries",headerActions:[new Gc]})})]}),new Gm({direction:"row",children:[new Qm({$data:new Jp({$data:Kb({scenarioId:"csv_metric_values",stringInput:"1,20,90,30,5,0"}),transformations:[{id:"calculateField",options:{mode:"binary",reduce:{reducer:"sum"},binary:{left:"A-series",reducer:"sum",operator:"*",right:"2"}}}]}),body:new Fc({title:"Transformed data & Global annotations",pluginId:"timeseries"})}),new Qm({$data:new qp({layers:[new Sp({name:"Local annotations",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"green",name:"New annotation",target:{lines:4,refId:"Anno",scenarioId:"annotations"}}})]}),body:new Fc({$data:new Jp({$data:Kb({scenarioId:"csv_metric_values",stringInput:"1,20,90,30,5,0"}),transformations:[{id:"calculateField",options:{mode:"binary",reduce:{reducer:"sum"},binary:{left:"A-series",reducer:"sum",operator:"*",right:"5"}}}]}),title:"Transformed local data, global+local annotations",pluginId:"timeseries",headerActions:[new Gc]})})]})]})}))}))}function Uw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Uw(e,t,n[t])}))}return e}function Qw(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Kw(t){return new Ig(Qw(Gw({},t),{subTitle:"Adhoc filters variable can be used in auto mode. By default datasources will apply the filters automatically to all queries of the same data source.\n     In manual mode you can use it as a normal variable in queries or use it programmtically.\n    ",tabs:[new Ig({title:"Apply mode auto",url:`${t.url}/auto`,getScene:()=>new nh(Qw(Gw({},Yb()),{$variables:new of({variables:[new il({name:"Filters",baseFilters:[{key:"__name__",operator:"=",value:"ALERTS",condition:""}],datasource:{uid:"gdev-prometheus"},supportsMultiValueOperators:!0})]}),body:new Gm({direction:"row",children:[new Qm({body:Fb.table().setTitle("ALERTS").setData(new Pl({datasource:{uid:"gdev-prometheus"},queries:[{refId:"A",expr:"ALERTS",format:"table",instant:!0}]})).build()})]})}))}),new Ig({title:"Apply mode manual",url:`${t.url}/manual`,getScene:()=>{const e=new il({applyMode:"manual",datasource:{uid:"gdev-prometheus"},filters:[{key:"job",operator:"=",value:"grafana",condition:""}],supportsMultiValueOperators:!0});return new nh(Qw(Gw({},Yb()),{$variables:new of({variables:[e]}),body:new Gm({direction:"column",children:[new Qm({ySizing:"content",body:new lm({text:"Using AdHocFilterSet in manual mode allows you to use it as a normal variable. The query below is interpolated to ALERTS{$Filters}",fontSize:14})}),new Qm({ySizing:"content",body:new Yw({filtersVar:e.getRef()})}),new Qm({body:Fb.table().setTitle("ALERTS").setData(new Pl({datasource:{uid:"gdev-prometheus"},queries:[{refId:"A",expr:"ALERTS{$Filters}",format:"table",instant:!0}]})).build()})]}),$timeRange:new Xe}))}}),new Ig({title:"Vertical Variants",url:`${t.url}/vertical`,getScene:()=>new nh(Qw(Gw({},Yb()),{$variables:new of({variables:[new il({name:"no-button-text",layout:"vertical",label:"Without add filter button text",hide:e.VariableHide.hideLabel,datasource:{uid:"gdev-prometheus"},filters:[{key:"job",operator:"=",value:"has no text",condition:""}],supportsMultiValueOperators:!0}),new il({name:"button-text",layout:"vertical",label:"With add filter button text",hide:e.VariableHide.hideLabel,addFilterButtonText:"Add a filter",datasource:{uid:"gdev-prometheus"},filters:[{key:"job",operator:"=",value:"has text on add button",condition:""}],supportsMultiValueOperators:!0}),new il({name:"button-text",layout:"vertical",label:"With add filter button text",hide:e.VariableHide.hideLabel,addFilterButtonText:"Filter",datasource:{uid:"gdev-prometheus"},filters:[{key:"job",operator:"=",value:"also has text on add button",condition:""}],supportsMultiValueOperators:!0})]}),body:new Gm({direction:"column",children:[new Qm({ySizing:"content",body:new lm({text:"Using AdHocFilterSet in manual mode allows you to use it as a normal variable. The query below is interpolated to ALERTS{$Filters}",fontSize:14})}),new Qm({body:Fb.table().setTitle("ALERTS").setData(new Pl({datasource:{uid:"gdev-prometheus"},queries:[{refId:"A",expr:"ALERTS{$Filters}",format:"table",instant:!0}]})).build()})]}),$timeRange:new Xe}))}),new Ig({title:"New Filters UI",url:`${t.url}/new-filters`,getScene:()=>new nh(Qw(Gw({},Yb()),{$variables:new of({variables:[new il({name:"ComboboxFilters",label:"Without add filter button text",hide:e.VariableHide.hideLabel,datasource:{uid:"gdev-prometheus"},filters:[{key:"job",operator:"=",value:"has no text",condition:""}],layout:"combobox",supportsMultiValueOperators:!0})]}),body:new Gm({direction:"column",children:[new Qm({ySizing:"content",body:new lm({text:"The query below is interpolated to ALERTS{$ComboboxFilters}",fontSize:14})}),new Qm({body:Fb.table().setTitle("ALERTS").setData(new Pl({datasource:{uid:"gdev-prometheus"},queries:[{refId:"A",expr:"ALERTS",format:"table",instant:!0}]})).build()})]}),$timeRange:new Xe}))})]}))}class Yw extends ae{}function Zw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Zw(e,t,n[t])}))}return e}function Jw(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function eO(e){return new Ig(Jw(Xw({},e),{subTitle:"TODO description",getScene:()=>new nh(Jw(Xw(Jw(Xw({},Yb()),{$variables:new of({variables:[new br({name:"groupBy",label:"Group By (static list)",datasource:{uid:"gdev-prometheus"},defaultOptions:[{text:"foo",value:"foo"},{text:"bar",value:"bar"},{text:"baz",value:"baz"}]})]}),controls:[new ef({})]}),Yb().controls),{body:new Gm({direction:"column",children:[new Qm({ySizing:"content",body:new lm({text:"Interpolated value (static): {$groupBy}",fontSize:14})}),new Qm({body:Fb.table().setTitle("ALERTS").setData(new Pl({datasource:{uid:"gdev-prometheus"},queries:[{refId:"A",expr:"ALERTS",format:"table",instant:!0}]})).build()})]})}))}))}function tO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){tO(e,t,n[t])}))}return e}function rO(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function aO(e){return new Ig(rO(nO({},e),{subTitle:"TODO description",getScene:()=>new nh(rO(nO(rO(nO({},Yb()),{$variables:new of({variables:[new br({name:"groupBy",label:"Group By (from datasource)",datasource:{uid:"gdev-prometheus"}})]}),controls:[new ef({})]}),Yb().controls),{body:new Gm({direction:"column",children:[new Qm({ySizing:"content",body:new lm({text:"Interpolated value (datasource): {$groupBy})",fontSize:14})}),new Qm({body:Fb.table().setTitle("ALERTS").setData(new Pl({datasource:{uid:"gdev-prometheus"},queries:[{refId:"A",expr:"ALERTS",format:"table",instant:!0}]})).build()})]})}))}))}function oO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){oO(e,t,n[t])}))}return e}function sO(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function lO(e){return new Ig(sO(iO({},e),{subTitle:"Transformations support ",getScene:()=>new nh(sO(iO({},Yb()),{$data:Kb({scenarioId:"csv_metric_values",stringInput:"1,20,90,30,5,0"}),body:new Gm({direction:"row",children:[new Qm({body:new Gm({direction:"column",children:[new Qm({body:new Gm({direction:"row",children:[new Qm({body:Fb.timeseries().setTitle("Source data (global query)").build()}),new Qm({body:Fb.stat().setTitle("Transformed data").setData(new Jp({transformations:[{id:"reduce",options:{reducers:["last","mean"]}}]})).build()}),new Qm({body:Fb.timeseries().setTitle("Custom transformer (log10 scale)").setData(new Jp({transformations:[uO()]})).build()}),new Qm({body:Fb.timeseries().setTitle("Custom transformer (log10 scale) that throws").setData(new Jp({transformations:[uO(!0)]})).build()})]})}),new Qm({body:Fb.stat().setTitle("Query with predefined transformations").setData(new Jp({$data:Kb(),transformations:[{id:"reduce",options:{reducers:["mean"]}}]})).build()}),new Qm({body:Fb.stat().setTitle("Datasoure and transformations error").setData(new Jp({$data:Kb({datasource:{uid:"nonexistent"}}),transformations:[uO(!0)]})).build()})]})})]})}))}))}Uw(Yw,"Component",(({model:t})=>{const n=t.state.filtersVar.resolve();return r().createElement(Sn.Stack,null,r().createElement(Sn.Button,{onClick:()=>{n.setState({filters:[],hide:e.VariableHide.hideVariable})}},"Clear"),r().createElement(Sn.Button,{onClick:()=>{n.setState({filters:[{key:"job",operator:"=",value:"has no text",condition:""}],hide:e.VariableHide.dontHide})}},"Add filter"))}));const uO=(t=!1)=>()=>n=>n.pipe((0,k.map)((n=>n.map((r=>(t&&(n[1999].fields=[]),sO(iO({},r),{fields:r.fields.map((t=>t.type===e.FieldType.number?sO(iO({},t),{values:t.values.map((e=>Math.log(e)/Math.log(10)))}):t))})))))));function cO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){cO(e,t,n[t])}))}return e}function pO(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function fO(e){return new Ig(pO(dO({},e),{subTitle:"A panel with actions that change visualization settings",getScene:()=>new nh(pO(dO({},Yb()),{key:"Dynamic options demo",$data:Kb({seriesCount:3,spread:15},{maxDataPoints:50}),body:new Gm({direction:"column",children:[new Qm({body:Fb.timeseries().setTitle("Graph").setHeaderActions([new mO({value:"lines"})]).build()}),new Qm({body:Fb.timeseries().setTitle("Graph").setHeaderActions([new hO({value:"timeseries"})]).build()})]})}))}))}class hO extends ae{constructor(...e){super(...e),cO(this,"onChange",(e=>{this.setState({value:e});const t=this.parent;if("timeseries"===e)t.changePluginType("timeseries");else if("stat"===e)t.changePluginType("stat");else if("gauge_extra"===e){const e=Bb().setOption("orientation",je.Vertical).build(),n=Hb().setUnit("accMS2").build();t.changePluginType("gauge",e,n)}}))}}cO(hO,"Component",(({model:e})=>{const{value:t}=e.useState();return r().createElement(r().Fragment,null,r().createElement(Sn.RadioButtonGroup,{value:t,options:[{label:"Timeseries panel",value:"timeseries"},{label:"Stat",value:"stat"},{label:"Gauge with extra config",value:"gauge_extra"}],onChange:e.onChange,size:"sm"}))}));class mO extends ae{constructor(...e){super(...e),cO(this,"intervalId",void 0),cO(this,"onChange",(e=>{window.clearInterval(this.intervalId),this.setState({value:e});const t=this.parent;switch(e){case"random_description":t.onDescriptionChange(gO());break;case"random_title":t.onTitleChange(gO()),this.intervalId=window.setInterval((()=>{t.onTitleChange(gO())}),2e3);break;case"lines":t.onFieldConfigChange(Wb().build(),!0),t.onOptionsChange(qb().build(),!0);break;case"bars_stacked":t.onFieldConfigChange(Wb().setCustomFieldConfig("fillOpacity",35).setCustomFieldConfig("drawStyle",Oe.Bars).setCustomFieldConfig("stacking",{mode:xe.Normal,group:"A"}).build()),t.onOptionsChange(qb().setOption("legend",{displayMode:Pe.Table}).build());break;case"lines_stacked":t.onFieldConfigChange(Wb().setCustomFieldConfig("fillOpacity",10).setCustomFieldConfig("drawStyle",Oe.Line).setCustomFieldConfig("stacking",{mode:xe.Normal,group:"A"}).build()),t.onOptionsChange(qb().setOption("tooltip",{mode:De.Multi}).build(),!0)}}))}}function gO(){const e=["I","You","We","They"],t=["run","eat","sleep","dance","sing"],n=["apples","bananas","books","cats","dogs"];return`${e[Math.floor(Math.random()*e.length)]} ${t[Math.floor(Math.random()*t.length)]} ${n[Math.floor(Math.random()*n.length)]}.`}function bO(e){return r().createElement(Sn.Tooltip,{content:"Cancel query"},r().createElement(Sn.Icon,{className:"spin-clockwise",name:"sync",size:"xs",role:"button",onMouseDown:t=>{e.onCancel(t)}}))}function yO(e){const t=(0,Sn.useStyles2)(vO),n=(0,Sn.useTheme2)(),a="vertical"===e.layout,o=Boolean(e.isLoading)?r().createElement("div",{style:{marginLeft:n.spacing(1),marginTop:"-1px"},"aria-label":xn.components.LoadingIndicator.icon},r().createElement(bO,{onCancel:t=>{var n,r;t.preventDefault(),t.stopPropagation(),null===(n=(r=e).onCancel)||void 0===n||n.call(r)}})):null;let i=null;e.error&&(i=r().createElement(Sn.Tooltip,{content:e.error,placement:"bottom"},r().createElement(Sn.Icon,{className:t.errorIcon,name:"exclamation-triangle"})));let s=null;e.description&&(s=r().createElement(Sn.Tooltip,{content:e.description,placement:a?"top":"bottom"},r().createElement(Sn.Icon,{className:t.normalIcon,name:"info-circle"})));const l="string"==typeof e.label?xn.pages.Dashboard.SubMenu.submenuItemLabels(e.label):"";let u;return u=a?r().createElement("label",{className:t.verticalLabel,"data-testid":l,htmlFor:e.htmlFor},e.label,s,i,e.icon&&r().createElement(Sn.Icon,{name:e.icon,className:t.normalIcon}),o,e.onRemove&&r().createElement(Sn.IconButton,{variant:"secondary",size:"xs",name:"times",onClick:e.onRemove,tooltip:"Remove"})):r().createElement("label",{className:t.horizontalLabel,"data-testid":l,htmlFor:e.htmlFor},i,e.icon&&r().createElement(Sn.Icon,{name:e.icon,className:t.normalIcon}),e.label,s,o),u}cO(mO,"Component",(({model:e})=>{const{value:t}=e.useState();return r().createElement(r().Fragment,null,r().createElement(Sn.RadioButtonGroup,{value:t,options:[{label:"Default config",value:"lines"},{label:"Bars stacked & table legend",value:"bars_stacked"},{label:"Lines stacked & tooltip multi",value:"lines_stacked"},{label:"Random title (every 2 sec)",value:"random_title"},{label:"Random description",value:"random_description"}],onChange:e.onChange,size:"sm"}))}));const vO=e=>({horizontalLabel:(0,Pn.css)({background:e.isDark?e.colors.background.primary:e.colors.background.secondary,display:"flex",alignItems:"center",padding:e.spacing(0,1),fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.bodySmall.fontSize,height:e.spacing(e.components.height.md),lineHeight:e.spacing(e.components.height.md),borderRadius:e.shape.borderRadius(1),border:`1px solid ${e.components.input.borderColor}`,position:"relative",right:-1,whiteSpace:"nowrap",gap:e.spacing(.5)}),verticalLabel:(0,Pn.css)({display:"flex",alignItems:"center",fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.bodySmall.fontSize,lineHeight:e.typography.bodySmall.lineHeight,whiteSpace:"nowrap",marginBottom:e.spacing(.5),gap:e.spacing(1)}),errorIcon:(0,Pn.css)({color:e.colors.error.text}),normalIcon:(0,Pn.css)({color:e.colors.text.secondary})});function wO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function OO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){wO(e,t,n[t])}))}return e}function SO(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function _O(e){const t=new PO({value:""}),n=new Pl({queries:[{refId:"A",datasource:l,scenarioId:"random_walk_table"}]}),r=new Jp({$data:n,transformations:[jO("")]});r.addActivationHandler((()=>{const e=t.subscribeToState((e=>{r.setState({transformations:[jO(e.value)]}),r.reprocessTransformations()}));return()=>e.unsubscribe()}));const a=Fb.table().setData(r).build(),o=new xO({vizPanelRef:new Z(a)});return new Ig(SO(OO({},e),{subTitle:"Demo showing a simple data filtering case",getScene:()=>new nh(SO(OO({},Yb()),{key:"Flex layout embedded scene",body:new Gm({direction:"column",children:[new Qm({minWidth:"70%",body:a})]}),controls:[t,o]}))}))}class xO extends ae{constructor(e){super(OO({isEnabled:!1},e)),wO(this,"onChange",(()=>{const e=!this.state.isEnabled;this.setState({isEnabled:e});const t=zb().setOption("footer",{enablePagination:e}).build();this.state.vizPanelRef.resolve().onOptionsChange(t)}))}}wO(xO,"Component",(function({model:e}){const{isEnabled:t}=e.useState();return r().createElement("div",{style:{display:"flex"}},r().createElement(yO,{label:"Enable pagination",htmlFor:"items-per-page-select"}),r().createElement(Sn.InlineSwitch,{id:"items-per-page-select",value:t,onChange:e.onChange}))}));class PO extends ae{constructor(...e){super(...e),wO(this,"onChange",(e=>{this.setState({value:e.currentTarget.value})}))}}function jO(t){const n={id:e.ValueMatcherID.regex,options:{value:t}};return{id:e.DataTransformerID.filterByValue,options:{type:"include",match:"all",filters:[{fieldName:"Info",config:n}]}}}function CO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function EO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){CO(e,t,n[t])}))}return e}function DO(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function kO(t){return new Ig(DO(EO({},t),{subTitle:"Shows variables that depend on other variables defined on a higher level",$variables:new of({variables:[new Tf({name:"server",query:"A.*",value:"server",text:"",delayMs:2e3,options:[]}),new Tf({name:"notUsed",query:"A.$A.*",value:"server",text:"",delayMs:5e3,options:[]})]}),controls:[new ef({})],tabs:[new Ig({title:"Overview",url:`${t.url}/overview`,getScene:()=>{return new nh(DO(EO({},Yb()),{$variables:new of({variables:[new Tf({name:"pod",query:"A.$server.*",value:"pod",delayMs:2e3,isMulti:!0,text:"",options:[]})]}),body:new Gm({direction:"row",children:[new Qm({body:new Gm({direction:"column",children:[new Qm({body:new Gm({children:[new Qm({body:Fb.timeseries().setTitle("handler: $handler").setData(Kb({alias:"handler: $pod"})).build()})]})}),new Qm({body:(t="Inner scene1",new im({title:t,canRemove:!0,canCollapse:!0,$variables:new of({variables:[new Tf({name:"handler",query:"A.$server.$pod.*",value:"pod",delayMs:2e3,isMulti:!0,text:"",options:[],refresh:e.VariableRefresh.onTimeRangeChanged})]}),body:new Gm({direction:"row",children:[new Qm({body:Fb.timeseries().setTitle("handler: $handler").setData(Kb({alias:"handler: $handler"})).build()})]}),$timeRange:new Xe,$data:Kb(),controls:[new ef({}),new cm({})]}))})]})})]}),$timeRange:new Xe}));var t}})]}))}function TO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function RO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){TO(e,t,n[t])}))}return e}function AO(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}wO(PO,"Component",(({model:e})=>{const{value:t}=e.useState();return r().createElement("div",{style:{display:"flex"}},r().createElement(yO,{label:"Search by Info",htmlFor:"search-box"}),r().createElement(Sn.Input,{id:"search-box",width:25,placeholder:"i.e. ^up",value:t,onChange:e.onChange}))}));const IO=["repeat(auto-fit, minmax(400px, 1fr))","repeat(3, 1fr)","2fr 1fr 1fr","auto"],VO=["unset","auto","350px repeat(4, 150px)","repeat(4, 1fr)","100%"],MO=["150px","250px","auto"];function FO(e){return new Ig(AO(RO({},e),{subTitle:"A CSS Grid Layout demo, isLazy is enabled to showcase lazy rendering of panels. Every 3rd panel is hidden to test the layout working properly.",getScene:()=>{const e=new tg({children:LO(10),templateColumns:IO[0],templateRows:VO[0],autoRows:MO[0],rowGap:2,isLazy:!0}),t=new um({label:"Panel count",value:"10",onChange:t=>{e.setState({children:LO(t)})}}),n=new $O({label:"Column template",value:IO[0],options:IO,onChange:t=>e.setState({templateColumns:t})}),r=new $O({label:"Row template",value:VO[0],options:VO,onChange:t=>e.setState({templateRows:t})}),a=new $O({label:"Auto rows",value:MO[0],options:MO,onChange:t=>e.setState({autoRows:t})});return new nh(AO(RO({},Yb()),{controls:[t,n,r,a],body:e}))}}))}function LO(e){return Array.from(Array(e),((e,t)=>new ng({body:Fb.stat().setTitle(`Panel ${t+1}`).setData(Kb({},{maxDataPoints:400})).build(),isHidden:t%3==0})))}class $O extends ae{constructor(...e){super(...e),TO(this,"onChange",(e=>{this.setState({value:e.value}),this.state.onChange(e.value)}))}}function NO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){NO(e,t,n[t])}))}return e}function zO(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function qO(e){return new Ig(zO(BO({},e),{subTitle:"Example of panels with actions and controls",getScene:()=>new nh(zO(BO({},Yb()),{key:"Flex layout embedded scene",body:new tg({templateColumns:"repeat(auto-fit, minmax(400px, 1fr))",autoRows:"320px",children:[new ng({body:Fb.timeseries().setTitle("Panel with sm button").setData(Kb()).setHeaderActions(r().createElement(Sn.Button,{size:"sm",variant:"secondary"},"Does nothing")).build()}),new ng({body:Fb.timeseries().setTitle("Panel with md button").setData(Kb()).setHeaderActions(r().createElement(Sn.Button,{size:"md",variant:"secondary"},"Does nothing")).build()}),new ng({body:Fb.timeseries().setTitle("Panel with select").setData(Kb()).setHeaderActions(r().createElement(Sn.Select,{options:[{label:"Option 1",value:"1"}],onChange:()=>{},value:"1"})).build()})]})}))}))}TO($O,"Component",(({model:e})=>{const{value:t,options:n,label:a}=e.useState(),o=n.map((e=>({label:e,value:e})));var i;const s=null!==(i=o.find((e=>e.value===t)))&&void 0!==i?i:n[0];return r().createElement("div",{style:{display:"flex"}},r().createElement(yO,{label:a}),r().createElement(Sn.Select,{value:s,options:o,onChange:e.onChange}))}));var HO=Object.defineProperty,WO=Object.getOwnPropertySymbols,UO=Object.prototype.hasOwnProperty,GO=Object.prototype.propertyIsEnumerable,QO=(e,t,n)=>t in e?HO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,KO=(e=>(e[e.dontHide=0]="dontHide",e[e.hideLabel=1]="hideLabel",e[e.hideVariable=2]="hideVariable",e))(KO||{});function YO(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function ZO(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){YO(o,r,a,i,s,"next",e)}function s(e){YO(o,r,a,i,s,"throw",e)}i(void 0)}))}}function XO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){XO(e,t,n[t])}))}return e}function eS(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function tS(t){return new Ig(eS(JO({},t),{subTitle:"Test of variables and adhoc filters with vertical layout",getScene:()=>new nh(eS(JO({},Yb()),{controls:[new ef({layout:"vertical"}),new Um,new cm({}),new xm({})],$variables:new of({variables:[new Tf({name:"server",query:"A.*",value:"server",text:"",delayMs:1e3,options:[],refresh:e.VariableRefresh.onTimeRangeChanged,description:"Server name"}),new Tf({name:"pod",query:"A.$server.*",value:"pod",delayMs:1e3,isMulti:!0,text:"",options:[]}),new Tf({name:"handler",query:"A.$server.$pod.*",value:"pod",delayMs:1e3,isMulti:!0,text:"",options:[],refresh:e.VariableRefresh.onTimeRangeChanged}),new il({name:"filters",hide:KO.hideLabel,layout:"vertical",applyMode:"manual",filters:[{key:"job",operator:"=",value:"grafana",condition:""}],getTagKeysProvider:function(){var e=ZO((function*(e,t){return yield new Promise((e=>setTimeout(e,200))),{replace:!0,values:[{text:"job"},{text:"instance"}]}}));return function(t,n){return e.apply(this,arguments)}}(),getTagValuesProvider:function(){var e=ZO((function*(e,t){return yield new Promise((e=>setTimeout(e,400))),{replace:!0,values:["A","B","C","D","E","F","grafana"].map((e=>({text:e})))}}));return function(t,n){return e.apply(this,arguments)}}()})]}),body:new Gm({direction:"column",children:[new Gm({children:[new Qm({body:Fb.timeseries().setTitle("handler: $handler").setData(Kb({alias:"handler: $handler"})).build()}),new Qm({body:Fb.text().setTitle("Interpolation").setOption("content","\n* server: $server\n* pod: $pod\n* handler: $handler\n\n          ").build()})]})]})}))}))}function nS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){nS(e,t,n[t])}))}return e}function aS(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function oS(e){return new Ig(aS(rS({},e),{subTitle:"Interactive table",getScene:()=>new nh(aS(rS({},Yb()),{$data:Kb(),body:new Gm({children:[new Qm({body:new iS({$data:Xb({expr:"sort_desc(avg without(job, instance) (rate(grafana_http_request_duration_seconds_sum[$__rate_interval]) * 1e3))"})})})]})}))}))}((e,t)=>{for(var n in t||(t={}))UO.call(t,n)&&QO(e,n,t[n]);if(WO)for(var n of WO(t))GO.call(t,n)&&QO(e,n,t[n])})({},{includeAll:!1,multi:!1,options:[],skipUrlSync:!1});class iS extends ae{}function sS({tableViz:e,row:n}){var a;const{expandedRows:o}=e.useState(),i=null===(a=o)||void 0===a?void 0:a.find((e=>e.state.key===n.handler));return(0,t.useEffect)((()=>{if(!i){const a=(r=n.handler,new Gm({key:r,height:300,children:[new Qm({body:Fb.timeseries().setTitle("Requests / s").setCustomFieldConfig("fillOpacity",6).setData(Jb({expr:`sum without(job, instance) (rate(grafana_http_request_duration_seconds_count{handler="${r}"}[$__rate_interval]))`,legendFormat:"{{method}} (status = {{status_code}})"})).build()})]}));var t;e.setState({expandedRows:[...null!==(t=e.state.expandedRows)&&void 0!==t?t:[],a]})}var r}),[n,e,i]),i?r().createElement(i.Component,{model:i}):null}function lS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uS(e){return new Ig((t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){lS(e,t,n[t])}))}return e}({},e),n=null!=(n={subTitle:"Test of repeating layout by variable",$timeRange:new Xe,getScene:()=>new nh({controls:[new ef({})],$variables:new of({variables:[new Tf({name:"server",query:"A.*",value:"server",text:"",description:"Server name",delayMs:1e3,includeAll:!0,defaultToAll:!0,isMulti:!0,options:[]})]}),body:new Hm({variableName:"server",body:new Gm({direction:"column",children:[]}),getLayoutChild:e=>function(e){return new Gm({minHeight:200,children:[new Qm({body:Fb.timeseries().setTitle(`server: ${e.value}`).setData(Kb({alias:`server: ${e.value}`})).build()}),new Qm({body:Fb.stat().setTitle("Max").setData(Kb({})).build()})]})}(e)})})})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t));var t,n}function cS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){cS(e,t,n[t])}))}return e}function pS(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function fS(e){const t=new Sp({name:"Global annotations",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"yellow",name:"New annotation",target:{lines:10,refId:"Anno",scenarioId:"slow_query",stringInput:"10s"}}});return new Ig(pS(dS({},e),{subTitle:"Shows how to see query state of a sub scene and cancel all sub scene queries",getScene:()=>new nh(pS(dS({},Yb()),{$data:new qp({layers:[t]}),$behaviors:[new Ut],$variables:new of({variables:[new Tf({name:"server",query:"A.*",value:"server",delayMs:1e3,options:[],refresh:ju.onTimeRangeChanged}),new Tf({name:"pod",query:"A.$server.*",value:"pod",delayMs:3e3,options:[],refresh:ju.onDashboardLoad})]}),controls:[new ef({}),new Gc,new Um,new cm({}),new xm({withText:!0,primary:!0})],body:new Gm({direction:"column",children:[new Qm({height:"320px",body:new tg({autoRows:"320px",children:[Fb.timeseries().setTitle("2s query").setData(Kb({scenarioId:"slow_query",stringInput:"2s"})).build(),Fb.timeseries().setTitle("3s query").setData(Kb({scenarioId:"slow_query",stringInput:"3s"})).build(),Fb.timeseries().setTitle("5s query").setData(Kb({scenarioId:"slow_query",stringInput:"5s"})).build()]})}),new Qm({body:hS("Inner scene1")})]})}))}))}function hS(e){const t=new Sp({name:"Nested annotations",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"red",name:"New annotation",target:{lines:10,refId:"Anno",scenarioId:"slow_query",stringInput:"10s"}}});return new im({title:e,canCollapse:!0,body:new tg({children:[Fb.timeseries().setTitle("2s query").setData(Kb({scenarioId:"slow_query",stringInput:"2s"})).build(),Fb.timeseries().setTitle("3s query").setData(Kb({scenarioId:"slow_query",stringInput:"3s"})).build(),Fb.timeseries().setTitle("5s query").setData(Kb({scenarioId:"slow_query",stringInput:"5s"})).build()]}),$timeRange:new Xe,$data:new qp({layers:[t]}),$behaviors:[new Ut],controls:[new Gc,new Um,new cm({}),new xm({withText:!0})]})}function mS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){mS(e,t,n[t])}))}return e}function bS(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function yS(e){return new Ig(bS(gS({},e),{subTitle:"A demo of data layers added and removed dynamically",getScene:()=>new nh(bS(gS({},Yb()),{controls:[new Gc,new vS({}),new Um,new cm({}),new xm({})],key:"Multiple annotations layers",$data:new qp({layers:[]}),body:new Gm({direction:"column",children:[new Gm({direction:"row",children:[new Qm({$data:Kb({}),body:new Fc({title:"Global annotations only",pluginId:"timeseries"})})]})]})}))}))}nS(iS,"Component",(({model:n})=>{const{data:a}=yu.getData(n).useState(),o=(0,t.useMemo)((()=>[{id:"handler",header:"Handler"},{id:"method",header:"Method"},{id:"status_code",header:"Status code"},{id:"Value",header:"Value"}]),[]),i=(0,t.useMemo)((()=>{if(!a||0===a.series.length)return[];const t=a.series[0];return new e.DataFrameView(t).toArray()}),[a]);return r().createElement(Sn.InteractiveTable,{columns:o,getRowId:e=>e.handler,data:i,renderExpandedRow:e=>r().createElement(sS,{tableViz:n,row:e})})}));class vS extends ae{constructor(...e){super(...e),mS(this,"onAdd",(()=>{const e=yu.getAncestor(this,nh).state.$data,t=e.state.layers.length+1,n=new Sp({name:"Annotation query "+t,query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:d.config.theme2.visualization.palette[t],name:"New annotation",target:{lines:15*Math.random(),refId:"Anno",scenarioId:"annotations"}}});e.setState({layers:[...e.state.layers,n]})})),mS(this,"onRemove",(()=>{const e=yu.getAncestor(this,nh).state.$data;e.setState({layers:e.state.layers.slice(0,-1)})}))}}function wS(e,t,...n){let r=!1;"undefined"!=typeof window&&(r="true"===localStorage.getItem("grafana.debug.scenes")),r&&console.log(`${e}: `,t,...n)}mS(vS,"Component",(({model:e})=>r().createElement(r().Fragment,null,r().createElement(Sn.Button,{onClick:e.onAdd,variant:"secondary"},"Add annotation layer"),r().createElement(Sn.Button,{onClick:e.onRemove,variant:"secondary"},"Remove annotation layer"))));var OS=Object.defineProperty,SS=Object.defineProperties,_S=Object.getOwnPropertyDescriptors,xS=Object.getOwnPropertySymbols,PS=Object.prototype.hasOwnProperty,jS=Object.prototype.propertyIsEnumerable,CS=(e,t,n)=>t in e?OS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class ES extends ae{addToScene(e){this.publishEvent(new Zf(e),!0),this.setState({children:[...this.state.children,e]}),wS("SceneContext",`Adding to scene: ${e.constructor.name} key: ${e.state.key}`);const t=e.activate();return()=>{wS("SceneContext",`Removing from scene: ${e.constructor.name} key: ${e.state.key}`),this.setState({children:this.state.children.filter((t=>t!==e))}),t()}}findByKey(e){return this.state.children.find((t=>t.state.key===e))}findVariable(e){const t=this.state.$variables;if(t)return t.getByName(e)}addVariable(e){let t=this.state.$variables;return this.publishEvent(new Zf(e),!0),t?t.setState({variables:[...t.state.variables,e]}):(t=new of({variables:[e]}),this.setState({$variables:t})),wS("SceneContext",`Adding variable: ${e.constructor.name} key: ${e.state.key}`),()=>{t.setState({variables:t.state.variables.filter((t=>t!==e))}),wS("SceneContext",`Removing variable: ${e.constructor.name} key: ${e.state.key}`)}}addChildContext(e){var t;this.publishEvent(new Zf(e),!0),this.setState({childContexts:[...null!=(t=this.state.childContexts)?t:[],e]}),wS("SceneContext",`Adding child context: ${e.constructor.name} key: ${e.state.key}`)}removeChildContext(e){var t;this.setState({childContexts:null==(t=this.state.childContexts)?void 0:t.filter((t=>e!==t))}),wS("SceneContext",`Remvoing child context: ${e.constructor.name} key: ${e.state.key}`)}constructor(e){var t,n,r,a;super((r=((e,t)=>{for(var n in t||(t={}))PS.call(t,n)&&CS(e,n,t[n]);if(xS)for(var n of xS(t))jS.call(t,n)&&CS(e,n,t[n]);return e})({},e),a={children:null!=(t=null==e?void 0:e.children)?t:[],childContexts:null!=(n=null==e?void 0:e.childContexts)?n:[]},SS(r,_S(a))))}}const DS=(0,t.createContext)(null);function kS({children:e,timeRange:n,withQueryController:a}){const o=(0,t.useContext)(DS),[i,s]=(0,t.useState)(),l=n;if((0,t.useEffect)((()=>{const e={children:[]};a&&(e.$behaviors=[new Ut]),l&&(e.$timeRange=new Xe(l));const t=new ES(e);o&&o.addChildContext(t);const n=t.activate();return s(t),()=>{n(),o&&o.removeChildContext(t)}}),[o,a]),!i)return null;const u=r().createElement(DS.Provider,{value:i},e);return o?u:r().createElement(th,{scene:i,updateUrlOnInit:!0,createBrowserHistorySteps:!0},u)}function TS(){const e=(0,t.useContext)(DS);if(!e)throw new Error("Cannot find a SceneContext");return e}function RS(){const e=TS(),t=yu.getTimeRange(e),{value:n}=t.useState();return[n,t]}function AS(e){const n=TS();return function({timeRange:e,variables:n=[]}){const r=TS(),[a,o]=(0,t.useState)();(0,t.useEffect)((()=>{const t=new k.Subscription;if(n&&n.length>0)for(const e of n){const n=yu.lookupVariable(e,r);n&&t.add(n.subscribeToEvent(rt,(()=>{o({variableName:n.state.name,variableValue:n.getValue()})})))}return e&&yu.getTimeRange(r).subscribeToState(((e,t)=>{e.value!==t.value&&o({timeRange:e.value})})),()=>t.unsubscribe()}),[r,e,...n])}(e),(0,t.useCallback)((e=>yu.interpolate(n,e)),[n])}function IS(e){const n=TS(),r=(0,t.useId)();let a=n.findByKey(r);return a||(a=new Pl({key:r,queries:e.queries,maxDataPoints:e.maxDataPoints,datasource:e.datasource,liveStreaming:e.liveStreaming,maxDataPointsFromWidth:e.maxDataPointsFromWidth})),(0,t.useEffect)((()=>n.addToScene(a)),[a,n]),(0,t.useEffect)((()=>{(0,be.isEqual)(a.state.queries,e.queries)||(a.setState({queries:e.queries}),a.runQueries())}),[a,e]),a}function VS(e){const[t,n]=RS();return r().createElement(Sn.TimeRangePicker,{isOnCanvas:!0,value:t,onChange:n.onTimeRangeChange,timeZone:n.getTimeZone(),onMoveBackward:()=>{},onMoveForward:()=>{},onZoom:()=>{},onChangeTimeZone:()=>{},onChangeFiscalYearStartMonth:()=>{}})}function MS({name:e,hideLabel:t,layout:n}){const a=TS(),o=yu.lookupVariable(e,a);return o?r().createElement(tf,{key:o.state.key,variable:o,hideLabel:t,layout:n}):r().createElement("div",null,"Variable ",e," not found")}function FS(e){var n=(0,t.useRef)();return(0,t.useEffect)((function(){n.current=e})),n.current}function LS(n){const{title:a,viz:o,dataProvider:i,headerActions:s}=n,l=TS(),u=(0,t.useId)(),c=FS(n);let d=l.findByKey(u);return d||(d=new Fc({key:u,title:a,pluginId:o.pluginId,pluginVersion:o.pluginVersion,options:o.options,fieldConfig:o.fieldConfig,$data:$S(i),headerActions:s})),(0,t.useEffect)((()=>l.addToScene(d)),[d,l]),(0,t.useEffect)((()=>{const t={};if(c){if(a!==c.title&&(t.title=a),s!==c.headerActions&&(t.headerActions=s),i!==c.dataProvider&&(t.$data=$S(i)),o!==c.viz&&o.pluginId===c.viz.pluginId){const n=d.getPlugin();if(n){const r=(0,e.getPanelOptionsWithDefaults)({plugin:n,currentOptions:o.options,currentFieldConfig:o.fieldConfig,isAfterPluginChange:!1});t.options=r.options,t.fieldConfig=r.fieldConfig,d.clearFieldConfigCache()}}Object.keys(t).length>0&&(d.setState(t),wS("VizPanel","Updating VizPanel state",t))}}),[d,a,s,o,i,c]),r().createElement(d.Component,{model:d})}function $S(e){return!e||e instanceof Ne?e:new Ip({source:e.getRef()})}var NS=Object.defineProperty,BS=Object.getOwnPropertySymbols,zS=Object.prototype.hasOwnProperty,qS=Object.prototype.propertyIsEnumerable,HS=(e,t,n)=>t in e?NS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,WS=(e,t)=>{for(var n in t||(t={}))zS.call(t,n)&&HS(e,n,t[n]);if(BS)for(var n of BS(t))qS.call(t,n)&&HS(e,n,t[n]);return e};function US(e){const n=TS(),a=(0,t.useId)(),o=FS(e);let i=n.findByKey(a);return i||(i=new xm(WS({key:a},e))),(0,t.useEffect)((()=>n.addToScene(i)),[i,n]),(0,t.useEffect)((()=>{const t={};o&&(e.refresh!==o.refresh&&(t.refresh=e.refresh),e.withText!==o.withText&&(t.withText=e.withText),i.setState(t))}),[i,e,o]),r().createElement(i.Component,{model:i})}function GS({name:e}){const t=TS(),n=function(e,t){for(let n=0;n<e.length;n++){const r=e[n].state.layers.find((e=>e.state.name===t));if(r)return r}}(yu.getDataLayers(t),e);return n?r().createElement(n.Component,{model:n}):r().createElement("div",null,"Annotation ",e," not found")}function QS({query:e,name:n,label:r,hide:a,initialValue:o,isMulti:i,includeAll:s,children:l}){const u=TS(),[c,d]=(0,t.useState)();let p=u.findVariable(n);return p||(p=new hf({name:n,label:r,query:e,value:o,isMulti:i,includeAll:s,hide:a})),(0,t.useEffect)((()=>{const e=u.addVariable(p);return d(!0),e}),[p,u,n]),(0,t.useEffect)((()=>{null==p||p.setState({label:r,query:e,hide:a,isMulti:i,includeAll:s})}),[a,s,i,r,e,p]),c?l:null}function KS({pluginId:e,regex:n,name:r,label:a,hide:o,initialValue:i,isMulti:s,includeAll:l,children:u}){const c=TS(),[d,p]=(0,t.useState)();let f=c.findVariable(r);return f||(f=new wf({pluginId:e,regex:n,name:r,label:a,value:i,isMulti:s,hide:o,includeAll:l})),(0,t.useEffect)((()=>{const e=c.addVariable(f);return p(!0),e}),[f,c,r]),(0,t.useEffect)((()=>{d&&(f.state.pluginId===e&&f.state.regex===n&&f.state.label===a&&f.state.hide===o&&f.state.includeAll===l||(f.setState({pluginId:e,regex:n,label:a,hide:o,includeAll:l}),f.refreshOptions()))}),[o,l,a,e,n,f,d]),d?u:null}function YS({query:e,name:n,datasource:r,label:a,hide:o,regex:i,refresh:s,sort:l,initialValue:u,isMulti:c,includeAll:d,children:p}){const f=TS(),[h,m]=(0,t.useState)();let g=f.findVariable(n);return g||(g=new pu({name:n,label:a,query:e,datasource:r,refresh:s,sort:l,regex:i,value:u,isMulti:c,hide:o,includeAll:d})),(0,t.useEffect)((()=>{const e=f.addVariable(g);return m(!0),e}),[g,f,n]),(0,t.useEffect)((()=>{h&&((0,be.isEqual)(g.state.query,e)&&(0,be.isEqual)(g.state.datasource,r)&&g.state.regex===i&&g.state.label===a&&g.state.hide===o&&g.state.includeAll===d&&g.state.refresh===s&&g.state.sort===l||(g.setState({label:a,query:e,datasource:r,refresh:s,sort:l,regex:i,hide:o,includeAll:d}),g.refreshOptions()))}),[r,o,d,a,e,s,i,l,g,h]),h?p:null}const ZS=(0,t.createContext)({breadcrumbs:[],addBreadcrumb:()=>{},removeBreadcrumb:()=>{}});function XS({children:e}){const[n,a]=(0,t.useState)([]);return r().createElement(ZS.Provider,{value:{breadcrumbs:n,addBreadcrumb:(0,t.useCallback)((e=>a((t=>[...t,e]))),[]),removeBreadcrumb:(0,t.useCallback)((e=>a((t=>t.filter((t=>t.url!==e.url))))),[])}},e)}function JS({text:n,path:r,extraKeys:a}){const{addBreadcrumb:i,removeBreadcrumb:s}=(0,t.useContext)(ZS),l=function(){const n=function(){const{search:e}=(0,o.useLocation)();return[(0,t.useMemo)((()=>(0,d.locationSearchToObject)(e||"")),[e]),(0,t.useCallback)(((e,t)=>d.locationService.partial(e,t)),[])]}()[0],r=function(){const e=TS();return yu.getVariables(e).useState().variables}(),[a,i]=RS();return(0,t.useCallback)(((t,a)=>{const o={};for(const e of r)if(e.urlSync&&!e.state.skipUrlSync){const t=e.urlSync.getUrlState();Object.assign(o,t)}if(i.urlSync){const e=i.urlSync.getUrlState();Object.assign(o,e)}if(a)for(const e of a)n[e]&&(o[e]=n[e]);return e.urlUtil.renderUrl(t,o)}),[r,n,i])}();return(0,t.useEffect)((()=>{const e={text:n,url:l(r,a)};return i(e),()=>{s(e)}}),[n,r,a,i,l,s]),null}function e_({name:e,query:n,children:r}){const a=TS(),[o,i]=(0,t.useState)();let s=function(e,t){const n=e.state.$data;if(n)return n.state.layers.find((e=>e.state.name===t))}(a,e);return s||(s=new Sp({name:e,query:n})),(0,t.useEffect)((()=>{const e=function(e,t){let n=e.state.$data;return n?n.setState({layers:[...n.state.layers,t]}):(n=new qp({layers:[t]}),e.setState({$data:n})),wS("SceneContext",`Adding annotation data layer: ${t.state.name} key: ${t.state.key}`),()=>{n.setState({layers:n.state.layers.filter((e=>e!==t))}),wS("SceneContext",`Removing annotation data layer: ${t.state.name} key: ${t.state.key}`)}}(a,s);return i(!0),e}),[a,e,s]),(0,t.useEffect)((()=>{}),[o]),o?r:null}var t_=Object.defineProperty,n_=Object.defineProperties,r_=Object.getOwnPropertyDescriptors,a_=Object.getOwnPropertySymbols,o_=Object.prototype.hasOwnProperty,i_=Object.prototype.propertyIsEnumerable,s_=(e,t,n)=>t in e?t_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class l_ extends nh{constructor(e){var t,n;super((t=((e,t)=>{for(var n in t||(t={}))o_.call(t,n)&&s_(e,n,t[n]);if(a_)for(var n of a_(t))i_.call(t,n)&&s_(e,n,t[n]);return e})({},e),n={context:new ES},n_(t,r_(n))))}}function u_(e){return r().createElement("div",{style:{display:"grid",flexGrow:1,gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gridAutoRows:"320px",columnGap:"8px",rowGap:"8px"}},e.children)}function c_({name:e}){const t=r().useRef(0);return t.current+=1,r().createElement("div",null,e," render count: ",t.current)}l_.Component=({model:e})=>r().createElement(DS.Provider,{value:e.state.context},r().createElement(nh.Component,{model:e}));const d_=u(`${s.ReactDemo}`),p_=Nb().setCustomFieldConfig("fillOpacity",6).build(),f_=Nb().setCustomFieldConfig("drawStyle",Oe.Bars).setCustomFieldConfig("fillOpacity",6).build(),h_=Nb().setCustomFieldConfig("fillOpacity",10).setCustomFieldConfig("lineWidth",3).setCustomFieldConfig("gradientMode",_e.Scheme).setColor({mode:Eu.ContinuousGrYlRd}).build();function m_({maxDataPoints:e,title:t,queryAlias:n}){const a=IS({queries:[{uid:"gdev-testdata",refId:"A",scenarioId:"random_walk",alias:null!=n?n:"env = $env"}],maxDataPoints:null!=e?e:20});return r().createElement(LS,{title:t,viz:p_,dataProvider:a})}function g_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b_(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){g_(e,t,n[t])}))}return e}function y_(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function v_(e){return new Ig(y_(b_({},e),{subTitle:"Testing using the hooks and plain react components from normal scene",getScene:()=>new l_(y_(b_({},Yb()),{key:"Flex layout embedded scene",body:new Gm({direction:"column",children:[new Qm({body:new Fc({title:"Graph",pluginId:"timeseries",$data:Kb({})})}),new Qm({body:new w_({})})]})}))}))}class w_ extends ae{}function O_(e,t){const n=t.state.$variables;if(!n)return t.parent?O_(e,t.parent):null;return n.getByName(e)||(t.parent?O_(e,t.parent):null)}function S_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}g_(w_,"Component",(({model:e})=>{const[t,n]=RS();return r().createElement(Sn.Stack,{direction:"column"},r().createElement("div",null,"Time hook: ",t.from.toString()),r().createElement(u_,null,r().createElement(m_,{title:"Visualization using React VizPanel with data from useQueryRunner"})))}));const __={state:Ie.Done,series:[],timeRange:(0,e.getDefaultTimeRange)()};function x_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class P_{getKeys(){return"function"==typeof this._keys?this._keys():this._keys}getUrlState(){return this._sceneObject.getUrlState()}updateFromUrl(e){this._sceneObject.updateFromUrl(e)}performBrowserHistoryAction(e){this._nextChangeShouldAddHistoryStep=!0,e(),this._nextChangeShouldAddHistoryStep=!1}shouldCreateHistoryStep(e){return this._nextChangeShouldAddHistoryStep}constructor(e,t){x_(this,"_sceneObject",void 0),x_(this,"_keys",void 0),x_(this,"_nextChangeShouldAddHistoryStep",void 0),this._sceneObject=e,this._nextChangeShouldAddHistoryStep=!1,this._keys=t.keys}}const j_=/^\d+[yYmMsSwWhHdD]$/;function C_(t){if("string"!=typeof t)return null;if(-1!==t.indexOf("now"))return t;if(j_.test(t))return t;if(8===t.length){const n=(0,e.toUtc)(t,"YYYYMMDD");if(n.isValid())return n.toISOString()}else if(15===t.length){const n=(0,e.toUtc)(t,"YYYYMMDDTHHmmss");if(n.isValid())return n.toISOString()}else if(19===t.length){const n=(0,e.toUtc)(t,"YYYY-MM-DD HH:mm:ss");if(n.isValid())return n.toISOString()}else if(24===t.length)return(0,e.toUtc)(t).toISOString();const n=parseInt(t,10);return isNaN(n)?null:(0,e.toUtc)(n).toISOString()}function E_(t,n,r,a,o){const i=o&&"now"===n;return{from:e.dateMath.parse(t,!1,r,a),to:e.dateMath.parse(i?"now-"+o:n,!0,r,a),raw:{from:t,to:n}}}function D_(t,n,r){return(0,e.isDateTime)(t)?t.isValid():e.dateMath.isMathString(t)?e.dateMath.isValid(t):(0,e.dateTimeParse)(t,{roundUp:n,timeZone:r}).isValid()}function k_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const T_=new class extends lv{getResultsStream(){const e={origin:this,data:this.state.data};return(0,k.of)(e)}constructor(e){super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){S_(e,t,n[t])}))}return e}({data:__},e))}},R_=new class extends lv{_onActivate(){if(!this.state.timeZone){const e=this.getTimeZoneSource();e!==this&&this._subs.add(e.subscribeToState(((t,n)=>{void 0!==t.timeZone&&t.timeZone!==n.timeZone&&this.setState({value:E_(this.state.from,this.state.to,e.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay)})})))}e.rangeUtil.isRelativeTimeRange(this.state.value.raw)&&this.refreshIfStale()}refreshIfStale(){var e,t,n,r;let a;void 0!==(null===(t=this.state)||void 0===t||null===(e=t.refreshOnActivate)||void 0===e?void 0:e.percent)&&(a=this.calculatePercentOfInterval(this.state.refreshOnActivate.percent)),void 0!==(null===(r=this.state)||void 0===r||null===(n=r.refreshOnActivate)||void 0===n?void 0:n.afterMs)&&(a=Math.min(this.state.refreshOnActivate.afterMs,null!=a?a:1/0)),void 0!==a&&this.refreshRange(a)}getTimeZoneSource(){if(!this.parent||!this.parent.parent)return this;return dv(this.parent.parent,(e=>{if(e.state.$timeRange&&e.state.$timeRange.state.timeZone)return e.state.$timeRange}))||this}refreshRange(t){var n;const r=E_(this.state.from,this.state.to,null!==(n=this.state.timeZone)&&void 0!==n?n:(0,e.getTimeZone)(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay);r.to.diff(this.state.value.to,"milliseconds")>=t&&this.setState({value:r})}calculatePercentOfInterval(e){const t=this.state.value.to.diff(this.state.value.from,"milliseconds");return Math.ceil(t/e)}getTimeZone(){if(this.state.timeZone)return this.state.timeZone;const t=this.getTimeZoneSource();return t!==this?t.state.timeZone:(0,e.getTimeZone)()}getUrlState(){const e=d.locationService.getSearchObject(),t={from:this.state.from,to:this.state.to};return this.state.timeZone&&(t.timezone=this.state.timeZone),e.time&&e["time.window"]&&(t.time=null,t["time.window"]=null),t}updateFromUrl(t){const n={};let r=C_(t.from),a=C_(t.to);if(t.time&&t["time.window"]){const n=function(t,n){const r=isNaN(Date.parse(t))?parseInt(t,10):Date.parse(t);let a;return a=n.match(/^\d+$/)&&parseInt(n,10)?parseInt(n,10):e.rangeUtil.intervalToMs(n),{from:(0,e.toUtc)(r-a/2).toISOString(),to:(0,e.toUtc)(r+a/2).toISOString()}}(Array.isArray(t.time)?t.time[0]:t.time,Array.isArray(t["time.window"])?t["time.window"][0]:t["time.window"]);n.from&&D_(n.from)&&(r=n.from),n.to&&D_(n.to)&&(a=n.to)}var o,i,s;if(r&&D_(r)&&(n.from=r),a&&D_(a)&&(n.to=a),"string"==typeof t.timezone&&(n.timeZone=""!==t.timezone?t.timezone:void 0),0!==Object.keys(n).length)return n.value=E_(null!==(o=n.from)&&void 0!==o?o:this.state.from,null!==(i=n.to)&&void 0!==i?i:this.state.to,null!==(s=n.timeZone)&&void 0!==s?s:this.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay),this.setState(n)}constructor(t={}){const n=t.from&&D_(t.from)?t.from:"now-6h",r=t.to&&D_(t.to)?t.to:"now",a=t.timeZone;var o;super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){k_(e,t,n[t])}))}return e}({from:n,to:r,timeZone:a,value:E_(n,r,a||(0,e.getTimeZone)(),t.fiscalYearStartMonth,t.UNSAFE_nowDelay),refreshOnActivate:null!==(o=t.refreshOnActivate)&&void 0!==o?o:{percent:10}},t)),k_(this,"_urlSync",new P_(this,{keys:["from","to","timezone","time","time.window"]})),k_(this,"onTimeRangeChange",(e=>{const t={};"string"==typeof e.raw.from?t.from=e.raw.from:t.from=e.raw.from.toISOString(),"string"==typeof e.raw.to?t.to=e.raw.to:t.to=e.raw.to.toISOString(),t.value=E_(t.from,t.to,this.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay),t.from===this.state.from&&t.to===this.state.to||this._urlSync.performBrowserHistoryAction((()=>{this.setState(t)}))})),k_(this,"onTimeZoneChange",(e=>{this._urlSync.performBrowserHistoryAction((()=>{this.setState({timeZone:e})}))})),k_(this,"onRefresh",(()=>{this.setState({value:E_(this.state.from,this.state.to,this.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay)}),this.publishEvent(new d.RefreshEvent,!0)})),this.addActivationHandler(this._onActivate.bind(this))}},A_=new class extends lv{getByName(e){}isVariableLoadingOrWaitingToUpdate(e){return!1}constructor(){super({variables:[]})}};function I_(e){var t;return null!==(t=dv(e,(e=>e.state.$timeRange)))&&void 0!==t?t:R_}class V_ extends e.BusEventWithPayload{}function M_(e){return"object"==typeof e&&"formatter"in e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(V_,"type","scene-variable-changed-value");let F_,L_={};function $_(e){return L_[e]||(L_[e]=(0,be.property)(e))}class N_{getValue(e){let{value:t}=this.state,n=t.value;return n=e?$_(e)(t.value):t.value,"string"===n||"number"===n||"boolean"===n?n:String(n)}getValueText(){const{value:e}=this.state;return null!=e.text?String(e.text):String(e)}constructor(e,t){!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"state",void 0),this.state={name:e,value:t,type:"scopedvar"}}}const B_=new e.Registry((()=>{const t=[{id:Re.Lucene,name:"Lucene",description:"Values are lucene escaped and multi-valued variables generate an OR expression",formatter:e=>"string"==typeof e?z_(e):Array.isArray(e)?0===e.length?"__empty__":"("+(0,be.map)(e,(e=>'"'+z_(e)+'"')).join(" OR ")+")":z_(`${e}`)},{id:Re.Raw,name:"raw",description:"Keep value as is",formatter:e=>String(e)},{id:Re.Regex,name:"Regex",description:"Values are regex escaped and multi-valued variables generate a (<value>|<value>) expression",formatter:t=>{if("string"==typeof t)return(0,e.escapeRegex)(t);if(Array.isArray(t)){const n=t.map((t=>"string"==typeof t?(0,e.escapeRegex)(t):(0,e.escapeRegex)(String(t))));return 1===n.length?n[0]:"("+n.join("|")+")"}return(0,e.escapeRegex)(`${t}`)}},{id:Re.Pipe,name:"Pipe",description:"Values are separated by | character",formatter:e=>"string"==typeof e?e:Array.isArray(e)?e.join("|"):`${e}`},{id:Re.Distributed,name:"Distributed",description:"Multiple values are formatted like variable=value",formatter:(e,t,n)=>"string"==typeof e?e:Array.isArray(e)?(e=(0,be.map)(e,((e,t)=>0!==t?n.state.name+"="+e:e)),e.join(",")):`${e}`},{id:Re.CSV,name:"Csv",description:"Comma-separated values",formatter:e=>"string"==typeof e?e:(0,be.isArray)(e)?e.join(","):String(e)},{id:Re.HTML,name:"HTML",description:"HTML escaping of values",formatter:t=>"string"==typeof t?e.textUtil.escapeHtml(t):(0,be.isArray)(t)?e.textUtil.escapeHtml(t.join(", ")):e.textUtil.escapeHtml(String(t))},{id:Re.JSON,name:"JSON",description:"JSON stringify value",formatter:e=>"string"==typeof e?e:JSON.stringify(e)},{id:Re.PercentEncode,name:"Percent encode",description:"Useful for URL escaping values",formatter:e=>(0,be.isArray)(e)?q_("{"+e.join(",")+"}"):q_(e)},{id:Re.SingleQuote,name:"Single quote",description:"Single quoted values",formatter:e=>{const t=new RegExp("'","g");if((0,be.isArray)(e))return(0,be.map)(e,(e=>`'${(0,be.replace)(e,t,"\\'")}'`)).join(",");let n="string"==typeof e?e:String(e);return`'${(0,be.replace)(n,t,"\\'")}'`}},{id:Re.DoubleQuote,name:"Double quote",description:"Double quoted values",formatter:e=>{const t=new RegExp('"',"g");if((0,be.isArray)(e))return(0,be.map)(e,(e=>`"${(0,be.replace)(e,t,'\\"')}"`)).join(",");let n="string"==typeof e?e:String(e);return`"${(0,be.replace)(n,t,'\\"')}"`}},{id:Re.SQLString,name:"SQL string",description:"SQL string quoting and commas for use in IN statements and other scenarios",formatter:Q_},{id:Re.Date,name:"Date",description:"Format date in different ways",formatter:(t,n)=>{let r=NaN;if("number"==typeof t?r=t:"string"==typeof t&&(r=parseInt(t,10)),isNaN(r))return"NaN";var a;const o=null!==(a=n[0])&&void 0!==a?a:"iso";switch(o){case"ms":return String(t);case"seconds":return`${Math.round(r/1e3)}`;case"iso":return(0,e.dateTime)(r).toISOString();default:return(n||[]).length>1?(0,e.dateTime)(r).format(n.join(":")):(0,e.dateTime)(r).format(o)}}},{id:Re.Glob,name:"Glob",description:"Format multi-valued variables using glob syntax, example {value1,value2}",formatter:e=>(0,be.isArray)(e)&&e.length>1?"{"+e.join(",")+"}":String(e)},{id:Re.Text,name:"Text",description:"Format variables in their text representation. Example in multi-variable scenario A + B + C.",formatter:(e,t,n)=>n.getValueText?n.getValueText():String(e)},{id:Re.QueryParam,name:"Query parameter",description:"Format variables as URL parameters. Example in multi-variable scenario A + B + C => var-foo=A&var-foo=B&var-foo=C.",formatter:(t,n,r)=>{if(r.urlSync){const t=r.urlSync.getUrlState();return e.urlUtil.toUrlParams(t)}return Array.isArray(t)?t.map((e=>U_(r.state.name,e))).join("&"):U_(r.state.name,t)}},{id:Re.UriEncode,name:"Percent encode as URI",description:"Useful for URL escaping values, taking into URI syntax characters",formatter:e=>(0,be.isArray)(e)?H_("{"+e.join(",")+"}"):H_(e)}];return t}));function z_(e){return!1===isNaN(+e)?e:e.replace(/([\!\*\+\-\=<>\s\&\|\(\)\[\]\{\}\^\~\?\:\\/"])/g,"\\$1")}function q_(e){return"object"==typeof e&&(e=String(e)),W_(encodeURIComponent(e))}const H_=e=>W_(encodeURI(String(e))),W_=e=>e.replace(/[!'()*]/g,(e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()));function U_(e,t){return`var-${e}=${q_(t)}`}const G_={"'":"''",'"':'\\"'};function Q_(e){const t=new RegExp("'|\"","g");var n;if((0,be.isArray)(e))return(0,be.map)(e,(e=>`'${(0,be.replace)(e,t,(e=>null!==(n=G_[e])&&void 0!==n?n:""))}'`)).join(",");let r="string"==typeof e?e:String(e);var a;return`'${(0,be.replace)(r,t,(e=>null!==(a=G_[e])&&void 0!==a?a:""))}'`}const K_="All",Y_="$__all",Z_=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;class X_{formatter(){return this._value}constructor(e){!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"_value",void 0),this._value=e}}function J_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ex{getValue(){const e=I_(this._sceneObject);return"__from"===this.state.name?e.state.value.from.valueOf():e.state.value.to.valueOf()}getValueText(){const t=I_(this._sceneObject);return"__from"===this.state.name?(0,e.dateTimeFormat)(t.state.value.from,{timeZone:t.getTimeZone()}):(0,e.dateTimeFormat)(t.state.value.to,{timeZone:t.getTimeZone()})}constructor(e,t){J_(this,"state",void 0),J_(this,"_sceneObject",void 0),this.state={name:e,type:"time_macro"},this._sceneObject=t}}class tx{getValue(){const e=Nj(this._sceneObject);if(e){var t;const n=null===(t=e.state.data)||void 0===t?void 0:t.request;return n?"__interval_ms"===this.state.name?n.intervalMs:n.interval:this.state.match}return this.state.match}constructor(e,t,n){J_(this,"state",void 0),J_(this,"_sceneObject",void 0),this.state={name:e,type:"time_macro",match:n},this._sceneObject=t}}function nx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class rx extends lv{validateAndUpdate(){return this.getValueOptions({}).pipe((0,k.map)((e=>(this.updateValueGivenNewOptions(e),{}))))}onCancel(){var e;this.setStateHelper({loading:!1}),null===(e=this.parent)||void 0===e||e.cancel(this)}updateValueGivenNewOptions(e){const{value:t,text:n,options:r}=this.state,a=this.getStateUpdateGivenNewOptions(e,t,n);this.interceptStateUpdateAfterValidation(a),this.setStateHelper(a),(a.value!==t||a.text!==n||this.hasAllValue()&&!(0,be.isEqual)(e,r))&&this.publishEvent(new V_(this),!0)}getStateUpdateGivenNewOptions(e,t,n){const r={options:e,loading:!1,value:t,text:n};if(0===e.length)return this.state.defaultToAll||this.state.includeAll?(r.value=Y_,r.text=K_):this.state.isMulti?(r.value=[],r.text=[]):(r.value="",r.text=""),r;if(this.hasAllValue())return this.state.includeAll||(r.value=e[0].value,r.text=e[0].label,this.state.isMulti&&(r.value=[r.value],r.text=[r.text])),r;if(this.state.isMulti){const a=(Array.isArray(t)?t:[t]).filter((t=>e.find((e=>e.value===t)))),o=a.map((t=>e.find((e=>e.value===t)).label));if(0===a.length){const t=this.getDefaultMultiState(e);r.value=t.value,r.text=t.text}else(0,be.isEqual)(a,t)||(r.value=a),(0,be.isEqual)(o,n)||(r.text=o);return r}let a=function(e,t,n){let r;for(const a of n){if(a.value===e)return a;a.label===t&&(r=a)}return r}(t,n,e);return a?(r.text=a.label,r.value=a.value):this.state.defaultToAll?(r.value=Y_,r.text=K_):(r.value=e[0].value,r.text=e[0].label),r}interceptStateUpdateAfterValidation(e){const t=e.value===Y_&&this.state.text===K_;this.skipNextValidation&&e.value!==this.state.value&&e.text!==this.state.text&&!t&&(e.value=this.state.value,e.text=this.state.text),this.skipNextValidation=!1}getValue(){return this.hasAllValue()?this.state.allValue?new ox(this.state.allValue,this):this.state.options.map((e=>e.value)):this.state.value}getValueText(){return this.hasAllValue()?K_:Array.isArray(this.state.text)?this.state.text.join(" + "):String(this.state.text)}hasAllValue(){const e=this.state.value;return e===Y_||Array.isArray(e)&&e[0]===Y_}getDefaultMultiState(e){return this.state.defaultToAll?{value:[Y_],text:[K_]}:e.length>0?{value:[e[0].value],text:[e[0].label]}:{value:[],text:[]}}changeValueTo(e,t){if(e!==this.state.value||t!==this.state.text){if(t||(t=Array.isArray(e)?e.map((e=>this.findLabelTextForValue(e))):this.findLabelTextForValue(e)),Array.isArray(e)){if(0===e.length){const n=this.getDefaultMultiState(this.state.options);e=n.value,t=n.text}e[e.length-1]===Y_?(e=[Y_],t=[K_]):e[0]===Y_&&e.length>1&&(e.shift(),Array.isArray(t)&&t.shift())}(0,be.isEqual)(e,this.state.value)&&(0,be.isEqual)(t,this.state.text)||(this.setStateHelper({value:e,text:t,loading:!1}),this.publishEvent(new V_(this),!0))}}findLabelTextForValue(e){if(e===Y_)return K_;const t=this.state.options.find((t=>t.value===e));if(t)return t.label;const n=this.state.options.find((t=>t.label===e));return n?n.label:e}setStateHelper(e){var t;t=e,this.setState(t)}getOptionsForSelect(){let e=this.state.options;return this.state.includeAll&&(e=[{value:Y_,label:K_},...e]),Array.isArray(this.state.value)||e.find((e=>e.value===this.state.value))||(e=[{value:this.state.value,label:String(this.state.text)},...e]),e}refreshOptions(){this.getValueOptions({}).subscribe((e=>{this.updateValueGivenNewOptions(e)}))}constructor(...e){super(...e),nx(this,"_urlSync",new ax(this)),nx(this,"skipNextValidation",void 0)}}class ax{getKey(){return`var-${this._sceneObject.state.name}`}getKeys(){return this._sceneObject.state.skipUrlSync?[]:[this.getKey()]}getUrlState(){if(this._sceneObject.state.skipUrlSync)return{};let e=null,t=this._sceneObject.state.value;return e=Array.isArray(t)?t.map(String):this._sceneObject.state.isMulti?[String(t)]:String(t),{[this.getKey()]:e}}updateFromUrl(e){let t=e[this.getKey()];null!=t&&(this._sceneObject.state.includeAll&&(t=function(e){return(0,be.isArray)(e)&&e[0]===K_?[Y_]:e===K_?Y_:e}(t)),this._sceneObject.state.allValue&&this._sceneObject.state.allValue===t&&(t=Y_),this._sceneObject.isActive||(this._sceneObject.skipNextValidation=!0),this._sceneObject.changeValueTo(t))}constructor(e){nx(this,"_sceneObject",void 0),this._sceneObject=e}}class ox{formatter(e){return e===Re.Text?K_:e===Re.PercentEncode?B_.get(Re.PercentEncode).formatter(this._value,[],this._variable):e===Re.QueryParam?B_.get(Re.QueryParam).formatter(K_,[],this._variable):this._value}constructor(e,t){nx(this,"_value",void 0),nx(this,"_variable",void 0),this._value=e,this._variable=t}}function ix(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sx(e,t={}){if(e.state.$variables)for(const n of e.state.$variables.state.variables)n.state.skipUrlSync||t[n.state.name]||(t[n.state.name]=n);return e.parent&&sx(e.parent,t),t}function lx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ux(t,n,r){return new Proxy({},{get:(a,o)=>{return"name"===o?t.name:"displayName"===o?(0,e.getFieldDisplayName)(t,n,r):"labels"===o||"formattedLabels"===o?t.labels?(i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){lx(e,t,n[t])}))}return e}({},t.labels),s=null!=(s={__values:Object.values(t.labels).sort().join(", "),toString:()=>(0,e.formatLabels)(t.labels,"",!0)})?s:{},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(s)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(s)).forEach((function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(s,e))})),i):"":void 0;var i,s}})}function cx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const dx=(0,e.getDisplayProcessor)();function px(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class fx{formatter(e){if(!e)return this._urlQueryParams;const t=e.split(":");if("exclude"===t[0]&&t.length>1){const e=new URLSearchParams(this._urlQueryParams);for(const n of t[1].split(","))e.delete(n);return`?${e}`}if("include"===t[0]&&t.length>1){const e=new URLSearchParams(this._urlQueryParams),n=t[1].split(",");for(const t of e.keys())n.includes(t)||e.delete(t);return`?${e}`}return this._urlQueryParams}constructor(e){px(this,"_urlQueryParams",void 0),this._urlQueryParams=e}}function hx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const mx=new Map([[e.DataLinkBuiltInVars.includeVars,class{getValue(){const e=sx(this._sceneObject),t=B_.get(Re.QueryParam),n=[];for(const r of Object.keys(e)){const a=e[r];if(a instanceof rx&&a.hasAllValue()&&!a.state.allValue){n.push(t.formatter(Y_,[],a));continue}const o=a.getValue();o&&(M_(o)?n.push(o.formatter(Re.QueryParam)):n.push(t.formatter(o,[],a)))}return new X_(n.join("&"))}getValueText(){return""}constructor(e,t){ix(this,"state",void 0),ix(this,"_sceneObject",void 0),this.state={name:e,type:"url_variable"},this._sceneObject=t}}],[e.DataLinkBuiltInVars.keepTime,class{getValue(){var t;const n=null===(t=I_(this._sceneObject).urlSync)||void 0===t?void 0:t.getUrlState();return new X_(e.urlUtil.toUrlParams(n))}getValueText(){return""}constructor(e,t){J_(this,"state",void 0),J_(this,"_sceneObject",void 0),this.state={name:e,type:"url_variable"},this._sceneObject=t}}],["__value",class{getValue(t){var n;const r=null===(n=this._scopedVars)||void 0===n?void 0:n.__dataContext;if(!r)return this._match;const{frame:a,rowIndex:o,field:i,calculatedValue:s}=r.value;if(s)switch(t){case"numeric":case"raw":return s.numeric;case"time":return"";default:return(0,e.formattedValueToString)(s)}if(null==o)return this._match;if("time"===t){const t=a.fields.find((t=>t.type===e.FieldType.time));return t?t.values.get(o):void 0}if(!i)return this._match;const l=i.values.get(o);if("raw"===t)return l;var u;const c=(null!==(u=i.display)&&void 0!==u?u:dx)(l);return"numeric"===t?c.numeric:(0,e.formattedValueToString)(c)}getValueText(){return""}constructor(e,t,n,r){cx(this,"_match",void 0),cx(this,"_scopedVars",void 0),cx(this,"state",void 0),this._match=n,this._scopedVars=r,this.state={name:e,type:"__value"}}}],["__data",class{getValue(t){var n;const r=null===(n=this._scopedVars)||void 0===n?void 0:n.__dataContext;if(!r||!t)return this._match;const{frame:a,rowIndex:o}=r.value;if(void 0===o||void 0===t)return this._match;const i={name:a.name,refId:a.refId,fields:(0,e.getFieldDisplayValuesProxy)({frame:a,rowIndex:o})};var s;return null!==(s=$_(t)(i))&&void 0!==s?s:""}getValueText(){return""}constructor(e,t,n,r){cx(this,"_match",void 0),cx(this,"_scopedVars",void 0),cx(this,"state",void 0),this._match=n,this._scopedVars=r,this.state={name:e,type:"__data"}}}],["__series",class{getValue(t){var n;const r=null===(n=this._scopedVars)||void 0===n?void 0:n.__dataContext;if(!r||!t)return this._match;if("name"!==t)return this._match;const{frame:a,frameIndex:o}=r.value;return(0,e.getFrameDisplayName)(a,o)}getValueText(){return""}constructor(e,t,n,r){cx(this,"_match",void 0),cx(this,"_scopedVars",void 0),cx(this,"state",void 0),this._match=n,this._scopedVars=r,this.state={name:e,type:"__series"}}}],["__field",class{getValue(e){var t;const n=null===(t=this._scopedVars)||void 0===t?void 0:t.__dataContext;if(!n||!e)return this._match;if(void 0===e||""===e)return this._match;const{frame:r,field:a,data:o}=n.value,i=ux(a,r,o);var s;return null!==(s=$_(e)(i))&&void 0!==s?s:""}getValueText(){return""}constructor(e,t,n,r){cx(this,"_match",void 0),cx(this,"_scopedVars",void 0),cx(this,"state",void 0),this._match=n,this._scopedVars=r,this.state={name:e,type:"__field"}}}],["__url",class{getValue(e){const t=d.locationService.getLocation();var n;const r=null!==(n=d.config.appSubUrl)&&void 0!==n?n:"";switch(null!=e?e:""){case"params":return new fx(t.search);case"path":return r+t.pathname;default:return r+t.pathname+t.search}}getValueText(){return""}constructor(e,t){px(this,"state",void 0),this.state={name:e,type:"url_macro"}}}],["__from",ex],["__to",ex],["__timezone",class{getValue(){const e=I_(this._sceneObject).getTimeZone();return"browser"===e?Intl.DateTimeFormat().resolvedOptions().timeZone:e}getValueText(){return this.getValue()}constructor(e,t){J_(this,"state",void 0),J_(this,"_sceneObject",void 0),this.state={name:e,type:"time_macro"},this._sceneObject=t}}],["__user",class{getValue(e){const t=d.config.bootData.user;switch(e){case"login":return t.login;case"email":return t.email;default:return String(t.id)}}getValueText(){return""}constructor(e,t){hx(this,"state",void 0),this.state={name:e,type:"user_macro"}}}],["__org",class{getValue(e){const t=d.config.bootData.user;return"name"===e?t.orgName:String(t.orgId)}getValueText(){return""}constructor(e,t){hx(this,"state",void 0),this.state={name:e,type:"org_macro"}}}],["__interval",tx],["__interval_ms",tx]]);function gx(e,t,n,r,a){return t&&"string"==typeof t?(Z_.lastIndex=0,t.replace(Z_,((t,o,i,s,l,u,c)=>{const d=o||i||l,p=s||c||r,f=function(e,t,n,r){if(n&&n.hasOwnProperty(e)){const t=n[e];if(t)return function(e,t){return F_?(F_.state.name=e,F_.state.value=t):F_=new N_(e,t),F_}(e,t)}const a=O_(e,r);if(a)return a;const o=mx.get(e);return o?new o(e,r,t,n):null}(d,t,n,e);if(!f)return a&&a.push({match:t,variableName:d,fieldPath:u,format:p,value:t,found:!1}),t;const h=function(e,t,n,r){if(null==n)return"";if(M_(n))return gx(e,n.formatter(r));if(Array.isArray(n)||"object"!=typeof n||(n=`${n}`),"function"==typeof r)return r(n,{name:t.state.name,type:t.state.type,multi:t.state.isMulti,includeAll:t.state.includeAll});let a=[];r?(a=r.split(":"),a.length>1?(r=a[0],a=a.slice(1)):a=[]):r=Re.Glob;let o=B_.getIfExists(r);return o||(console.error(`Variable format ${r} not found. Using glob format as fallback.`),o=B_.get(Re.Glob)),o.formatter(n,a,t)}(e,f,f.getValue(u),p);return a&&a.push({match:t,variableName:d,fieldPath:u,format:p,value:h,found:h!==t}),h}))):null!=t?t:""}function bx(e){return"isDataLayer"in e}function yx(e,t,...n){let r=!1;"undefined"!=typeof window&&(r="true"===localStorage.getItem("grafana.debug.scenes")),r&&console.log(`${e}: `,t,...n)}const vx=new Map;function wx(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function Ox(e,t){return Sx.apply(this,arguments)}function Sx(){var e;return e=function*(e,t){var n;if(null===(n=e)||void 0===n?void 0:n.uid){const t=vx.get(e.uid);if(t)return t}return e&&e.query?e:yield(0,d.getDataSourceSrv)().get(e,t)},Sx=function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){wx(o,r,a,i,s,"next",e)}function s(e){wx(o,r,a,i,s,"throw",e)}i(void 0)}))},Sx.apply(this,arguments)}class _x{recordCurrentDependencyValuesForSceneObject(e){if(this.clearValues(),e.variableDependency)for(const t of e.variableDependency.getNames()){const n=Wj.lookupVariable(t,e);n&&this._values.set(n.state.name,n.getValue())}}cloneAndRecordCurrentValuesForSceneObject(e){const t=new _x;return t.recordCurrentDependencyValuesForSceneObject(e),t}clearValues(){this._values.clear()}hasValues(){return!!this._values}recordCurrentValue(e){this._values.set(e.state.name,e.getValue())}hasRecordedValue(e){return this._values.has(e.state.name)}hasValueChanged(e){return!(!this._values.has(e.state.name)||cj(this._values.get(e.state.name),e.getValue()))}hasDependenciesChanged(e){if(!this._values)return!1;if(!e.variableDependency)return!1;for(const t of e.variableDependency.getNames()){const n=Wj.lookupVariable(t,e);if(!n)continue;const r=n.state.name;if(n&&this._values.has(r)&&!cj(this._values.get(r),n.getValue()))return!0}return!1}constructor(){!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"_values",new Map)}}function xx(e){return"object"==typeof e&&"getExtraQueries"in e}function Px(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const jx=(e,t)=>(0,k.of)(t),Cx=e=>t=>{var n,r;return t.pipe((0,k.mergeMap)((([t,...n])=>{const r=n.flatMap((n=>{var r,a;return null!==(a=null===(r=e.get(n.request.requestId))||void 0===r?void 0:r(t,n))&&void 0!==a?a:(0,k.of)(n)}));return(0,k.forkJoin)([(0,k.of)(t),...r])})),(0,k.map)((([e,...t])=>{return a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Px(e,t,n[t])}))}return e}({},e),o=null!=(o={series:[...e.series,...t.flatMap((e=>e.series))],annotations:[...null!==(n=e.annotations)&&void 0!==n?n:[],...t.flatMap((e=>null!==(r=e.annotations)&&void 0!==r?r:[]))]})?o:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(o)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(o,e))})),a;var a,o})))};function Ex(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ex(e,t,n[t])}))}return e}function kx(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}let Tx,Rx=new Set;function Ax(e){return t=>{const n=Wj.getQueryController(e.origin);return n?new k.Observable((r=>{e.cancel||(e.cancel=()=>r.complete()),n.queryStarted(e);let a=!1;const o=t.subscribe({next:t=>{a||t.state===Ie.Loading||(a=!0,n.queryCompleted(e)),r.next(t)},error:e=>r.error(e),complete:()=>{r.complete()}});return()=>{o.unsubscribe(),a||n.queryCompleted(e)}})):t}}const Ix=new Set;function Vx(e,t){const n=new In;let r=e;const a=[],o=1e4;return t&&(r=[{value:Y_,label:K_},...r]),e=>{if(""===e)return r.length>o?r.slice(0,o):r;if(0===a.length)for(let e=0;e<r.length;e++)a.push(r[e].label);const[t,i,s]=n.search(a,e),l=[];if(t){for(let e=0;e<t.length;e++){if(i&&s){const n=s[e];l.push(r[t[n]])}else l.push(r[t[e]]);if(l.length>o)return l}return l}return r.length>o?r.slice(0,o):r}}function Mx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Fx=()=>!0,Lx=e=>"$__all"!==e.value,$x=(e,t)=>e.length===t.filter(Lx).length?Sn.ToggleAllState.allSelected:0===e.length||1===e.length&&e[0]&&"$__all"===e[0].value?Sn.ToggleAllState.noneSelected:Sn.ToggleAllState.indeterminate;function Nx({model:e}){const{value:n,text:a,key:o,options:i,includeAll:s,isReadOnly:l}=e.useState(),[u,c]=(0,t.useState)(""),[d,p]=(0,t.useState)(!1),f=function(e,t){return{value:e,label:null!=t?t:String(e)}}(n,String(a)),h=(0,t.useMemo)((()=>Vx(i,s)),[i,s])(u);return r().createElement(Sn.Select,{id:o,isValidNewOption:e=>e.trim().length>0,placeholder:"Select value",width:"auto",disabled:l,value:f,inputValue:u,allowCustomValue:!0,virtualized:!0,filterOption:Fx,tabSelectsValue:!1,onInputChange:(t,{action:n})=>"input-change"===n?(c(t),e.onSearchChange&&e.onSearchChange(t),t):t,onOpenMenu:()=>{d&&c(String(a))},onCloseMenu:()=>{c("")},options:h,"data-testid":xn.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${n}`),onChange:t=>{e.changeValueTo(t.value,t.label),d!==t.__isNew__&&p(t.__isNew__)}})}function Bx({model:e}){const{value:n,options:a,key:o,maxVisibleValues:i,noValueOnClear:s,includeAll:l,isReadOnly:u}=e.useState(),c=(0,t.useMemo)((()=>(0,be.isArray)(n)?n:[n]),[n]),[d,p]=(0,t.useState)(c),[f,h]=(0,t.useState)(""),m=(0,t.useMemo)((()=>Vx(a,l)),[a,l]);(0,t.useEffect)((()=>{p(c)}),[c]);const g=a.length>0?"Select value":"",b=m(f);return r().createElement(Sn.MultiSelect,{id:o,placeholder:g,width:"auto",inputValue:f,disabled:u,value:d,noMultiValueWrap:!0,maxVisibleValues:null!=i?i:5,tabSelectsValue:!1,virtualized:!0,allowCustomValue:!0,toggleAllOptions:{enabled:!0,optionsFilter:Lx,determineToggleAllState:$x},options:b,closeMenuOnSelect:!1,components:{Option:zx},isClearable:!0,hideSelectedOptions:!1,onInputChange:(t,{action:n})=>"input-change"===n?(h(t),e.onSearchChange&&e.onSearchChange(t),t):"input-blur"===n?(h(""),""):f,onBlur:()=>{e.changeValueTo(d)},filterOption:Fx,"data-testid":xn.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${d}`),onChange:(t,n)=>{"clear"===n.action&&s&&e.changeValueTo([]),p(t.map((e=>e.value)))}})}const zx=({children:e,data:t,innerProps:n,innerRef:a,isFocused:o,isSelected:i,indeterminate:s,renderOptionLabel:l})=>{const{onMouseMove:u,onMouseOver:c}=n,d=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(n,["onMouseMove","onMouseOver"]),p=(0,Sn.useTheme2)(),f=(0,Sn.getSelectStyles)(p),h=(0,Sn.useStyles2)(qx);var m,g,b;return r().createElement("div",(g=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Mx(e,t,n[t])}))}return e}({ref:a,className:(0,Pn.cx)(f.option,o&&f.optionFocused)},d),b=null!=(b={"data-testid":"data-testid Select option",title:t.title})?b:{},Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(b)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(b)).forEach((function(e){Object.defineProperty(g,e,Object.getOwnPropertyDescriptor(b,e))})),g),r().createElement("div",{className:h.checkbox},r().createElement(Sn.Checkbox,{indeterminate:s,value:i})),r().createElement("div",{className:f.optionBody,"data-testid":xn.pages.Dashboard.SubMenu.submenuItemValueDropDownOptionTexts(null!==(m=t.label)&&void 0!==m?m:String(t.value))},r().createElement("span",null,e)))};zx.displayName="SelectMenuOptions";const qx=e=>({checkbox:(0,Pn.css)({marginRight:e.spacing(2)})});class Hx{getKey(){return`var-${this._sceneObject.state.name}`}getKeys(){return this._sceneObject.state.skipUrlSync?[]:[this.getKey()]}getUrlState(){return this._sceneObject.state.skipUrlSync?{}:{[this.getKey()]:(e=this._sceneObject.state.value,t=this._sceneObject.state.text,e=Array.isArray(e)?e:[e],t=Array.isArray(t)?t:[t],e.map(((e,n)=>{if(null==e)return"";e=String(e);let r=t[n];return r=null==r?e:String(r),wj(e,r)})))};var e,t}updateFromUrl(e){let t=e[this.getKey()];if(null!=t){this._sceneObject.isActive||(this._sceneObject.skipNextValidation=!0);const{values:e,texts:r}=(n=t,(n=Array.isArray(n)?n:[n]).reduce(((e,t)=>{const[n,r]=(null!=t?t:"").split(",");return e.values.push(vj(n)),e.texts.push(vj(null!=r?r:n)),e}),{values:[],texts:[]}));this._sceneObject.changeValueTo(e,r)}var n}constructor(e){!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"_sceneObject",void 0),this._sceneObject=e}}function Wx(e){const t=e.getRoot();return function(e){return"enrichFiltersRequest"in e}(t)?t.enrichFiltersRequest(e):null}function Ux(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function Gx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Qx=new WeakMap;class Kx{toString(){}get value(){return this}constructor(e){(function(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)})(this,Qx,{writable:!0,value:void 0}),Gx(this,"text","__sceneObject"),Gx(this,"valueOf",(()=>function(e,t){return t.get?t.get.call(e):t.value}(this,Ux(this,Qx,"get")))),function(e,t,n){(function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}})(e,Ux(e,t,"set"),n)}(this,Qx,e)}}function Yx(e){return function(e){const t=e.match(/^(\d+)\.(\d+)\.(\d+)/);if(!t)return!1;const n=parseInt(t[1],10),r=parseInt(t[2],10),a=parseInt(t[3],10);return 11===n?0===r&&a>=4||1===r&&a>=2||r>1:10===n?4===r&&a>=8||r>=5:n>11}(d.config.buildInfo.version)?new Kx(e):{value:e,text:"__sceneObject"}}function Zx(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function Xx(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){Zx(o,r,a,i,s,"next",e)}function s(e){Zx(o,r,a,i,s,"throw",e)}i(void 0)}))}}function Jx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Jx(e,t,n[t])}))}return e}class tP extends rx{validateAndUpdate(){return this.getValueOptions({}).pipe((0,k.map)((e=>(this._updateValueGivenNewOptions(e),{}))))}_updateValueGivenNewOptions(e){const{value:t,text:n}=this.state,r={options:e,loading:!1,value:null!=t?t:[],text:null!=n?n:[]};this.setState(r)}getValueOptions(e){return this.state.defaultOptions?(0,k.of)(this.state.defaultOptions.map((e=>({label:e.text,value:String(e.value),group:e.group})))):(this.setState({loading:!0,error:null}),(0,k.from)(Ox(this.state.datasource,{__sceneObject:Yx(this)})).pipe((0,k.mergeMap)((e=>(0,k.from)(this._getKeys(e)).pipe((0,k.tap)((e=>{Sj(e)&&this.setState({error:e.error.message})})),(0,k.map)((e=>Oj(e))),(0,k.take)(1),(0,k.mergeMap)((e=>{const t=e.map((e=>({label:e.text,value:e.value?String(e.value):e.text,group:e.group})));return(0,k.of)(t)})))))))}getDefaultMultiState(e){return{value:[],text:[]}}constructor(e){var t,n;super((t=eP({isMulti:!0,name:"",value:[],text:[],options:[],datasource:null,baseFilters:[],applyMode:"auto",layout:"horizontal",type:"groupby"},e),n=null!=(n={noValueOnClear:!0})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t)),Jx(this,"isLazy",!0),Jx(this,"_urlSync",new Hx(this));var r=this;Jx(this,"_getKeys",function(){var e=Xx((function*(e){var t,n;const a=yield null===(t=(n=r.state).getTagKeysProvider)||void 0===t?void 0:t.call(n,r,null);if(a&&a.replace)return a.values;var o,i;if(r.state.defaultOptions)return r.state.defaultOptions.concat(Oj(null!==(i=null===(o=a)||void 0===o?void 0:o.values)&&void 0!==i?i:[]));if(!e.getTagKeys)return[];const s=gj(r),l=r.state.baseFilters||[],u=Wj.getTimeRange(r).state.value,c=yield e.getTagKeys(eP({filters:l,queries:s,timeRange:u},Wx(r)));Sj(c)&&r.setState({error:c.error.message});let d=Oj(c);a&&(d=d.concat(Oj(a.values)));const p=r.state.tagKeyRegexFilter;return p&&(d=d.filter((e=>e.text.match(p)))),d}));return function(t){return e.apply(this,arguments)}}()),this.addActivationHandler((()=>(Ix.add(this),()=>Ix.delete(this))))}}Jx(tP,"Component",(function({model:e}){const{value:n,text:a,key:o,maxVisibleValues:i,noValueOnClear:s,options:l,includeAll:u}=e.useState(),c=(0,t.useMemo)((()=>{const e=(0,be.isArray)(n)?n:[n],t=(0,be.isArray)(a)?a:[a];var r;return e.map(((e,n)=>({value:e,label:String(null!==(r=t[n])&&void 0!==r?r:e)})))}),[n,a]),[d,p]=(0,t.useState)(!1),[f,h]=(0,t.useState)(!1),[m,g]=(0,t.useState)(""),[b,y]=(0,t.useState)(c),v=(0,t.useMemo)((()=>Vx(l,u)),[l,u]);(0,t.useEffect)((()=>{y(c)}),[c]);const w=(0,t.useMemo)((()=>_j(v(m).map(rP))),[v,m]);return r().createElement(Sn.MultiSelect,{"data-testid":`GroupBySelect-${o}`,id:o,placeholder:"Select value",width:"auto",inputValue:m,value:b,noMultiValueWrap:!0,maxVisibleValues:null!=i?i:5,tabSelectsValue:!1,virtualized:!0,options:w,filterOption:nP,closeMenuOnSelect:!1,isOpen:f,isClearable:!0,hideSelectedOptions:!1,isLoading:d,components:{Option:zx},onInputChange:(t,{action:n})=>"input-change"===n?(g(t),e.onSearchChange&&e.onSearchChange(t),t):"input-blur"===n?(g(""),""):m,onBlur:()=>{e.changeValueTo(b.map((e=>e.value)),b.map((e=>e.label)))},onChange:(t,n)=>{"clear"===n.action&&s&&e.changeValueTo([]),y(t)},onOpenMenu:Xx((function*(){p(!0),yield(0,k.lastValueFrom)(e.validateAndUpdate()),p(!1),h(!0)})),onCloseMenu:()=>{h(!1)}})}));const nP=()=>!0;function rP(e){const{label:t,value:n,group:r}=e,a={label:t,value:n};return r&&(a.group=r),a}function aP(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function oP(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){aP(o,r,a,i,s,"next",e)}function s(e){aP(o,r,a,i,s,"throw",e)}i(void 0)}))}}function iP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sP(e,t){return""!==e?{value:e,label:t||e}:null}const lP=()=>!0;function uP({filter:e,model:n}){var a;const o=(0,Sn.useStyles2)(cP),[i,s]=(0,t.useState)([]),[l,u]=(0,t.useState)([]),[c,d]=(0,t.useState)(!1),[p,f]=(0,t.useState)(!1),[h,m]=(0,t.useState)(!1),[g,b]=(0,t.useState)(!1),[y,v]=(0,t.useState)(!1),[w,O]=(0,t.useState)(""),[S,_]=(0,t.useState)(!1),[x,P]=(0,t.useState)(e.values?e.values.map(((t,n)=>{var r;return sP(t,null===(r=e.valueLabels)||void 0===r?void 0:r[n])})):[]),j=XP(e.operator),C=sP(e.key,e.keyLabel),E=sP(e.value,null===(a=e.valueLabels)||void 0===a?void 0:a[0]),D=(0,t.useMemo)((()=>function(e){const t=new In,n=[],r=1e4;return a=>{if(""===a)return e.length>r?e.slice(0,r):e;if(0===n.length)for(let t=0;t<e.length;t++){var o;n.push(null!==(o=e[t].label)&&void 0!==o?o:String(e[t].value))}const[i,s,l]=t.search(n,a),u=[];if(i){for(let t=0;t<i.length;t++){if(s&&l){const n=l[t];u.push(e[i[n]])}else u.push(e[i[t]]);if(u.length>r)return u}return u}return e.length>r?e.slice(0,r):e}}(l)),[l]),k=(0,t.useMemo)((()=>_j(D(w))),[D,w]),T={isMulti:!0,value:x,components:{Option:zx},hideSelectedOptions:!1,closeMenuOnSelect:!1,openMenuOnFocus:!1,onChange:e=>{P(e),e.some((e=>e.__isNew__))&&O("")},onBlur:()=>{var t,r;n._updateFilter(e,{value:null!==(r=null===(t=x[0])||void 0===t?void 0:t.value)&&void 0!==r?r:"",values:x.map((e=>e.value)),valueLabels:x.map((e=>e.label))})}},R=r().createElement(Sn.Select,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){iP(e,t,n[t])}))}return e}({virtualized:!0,allowCustomValue:!0,isValidNewOption:e=>e.trim().length>0,allowCreateWhileLoading:!0,formatCreateLabel:e=>`Use custom value: ${e}`,disabled:n.state.readOnly,className:(0,Pn.cx)(o.value,g?o.widthWhenOpen:void 0),width:"auto",value:E,filterOption:lP,placeholder:"Select value",options:k,inputValue:w,onInputChange:(e,{action:t})=>("input-change"===t&&O(e),e),onChange:t=>{n._updateFilter(e,{value:t.value,valueLabels:t.label?[t.label]:[t.value]}),S!==t.__isNew__&&_(t.__isNew__)},isOpen:g&&!p,isLoading:p,openMenuOnFocus:!0,onOpenMenu:oP((function*(){f(!0),b(!0);const t=yield n._getValuesFor(e);var r,a;f(!1),u(t),S&&O(null!==(a=null===(r=E)||void 0===r?void 0:r.label)&&void 0!==a?a:"")})),onCloseMenu:()=>{b(!1),O("")}},j&&T)),A=r().createElement(Sn.Select,{key:p?"loading":"loaded",disabled:n.state.readOnly,className:(0,Pn.cx)(o.key,h?o.widthWhenOpen:void 0),width:"auto",allowCustomValue:!0,value:C,placeholder:"Select label",options:_j(i),onChange:t=>{n._updateFilter(e,{key:t.value,keyLabel:t.label,value:"",valueLabels:[""],values:void 0}),P([])},autoFocus:""===e.key,isOpen:h&&!c,isLoading:c,onOpenMenu:oP((function*(){m(!0),d(!0);const t=yield n._getKeys(e.key);d(!1),s(t)})),onCloseMenu:()=>{m(!1)},onBlur:()=>{""===e.key&&n._removeFilter(e)},openMenuOnFocus:!0}),I=r().createElement(Sn.Select,{className:(0,Pn.cx)(o.operator,{[o.widthWhenOpen]:y}),value:e.operator,disabled:n.state.readOnly,options:n._getOperators(),onChange:t=>{const r=e.operator,a=t.value,o={operator:a};if(XP(r)&&!XP(a))o.value="",o.valueLabels=[""],o.values=void 0,P([]);else if(!XP(r)&&XP(a)&&e.value){var i,s;o.values=[e.value],P([{value:e.value,label:null!==(s=null===(i=e.valueLabels)||void 0===i?void 0:i[0])&&void 0!==s?s:e.value}])}n._updateFilter(e,o)},onOpenMenu:()=>{v(!0)},onCloseMenu:()=>{v(!1)}});if("vertical"===n.state.layout){if(e.key){var V;const t=r().createElement(yO,{layout:"vertical",label:null!==(V=e.key)&&void 0!==V?V:"",onRemove:()=>n._removeFilter(e)});return r().createElement(Sn.Field,{label:t,"data-testid":`AdHocFilter-${e.key}`,className:o.field},r().createElement("div",{className:o.wrapper},I,R))}return r().createElement(Sn.Field,{label:"Select label","data-testid":`AdHocFilter-${e.key}`,className:o.field},A)}var M;return r().createElement("div",{className:o.wrapper,"data-testid":`AdHocFilter-${e.key}`},A,I,R,r().createElement(Sn.Button,{variant:"secondary","aria-label":"Remove filter",title:"Remove filter",className:o.removeButton,icon:"times","data-testid":`AdHocFilter-remove-${null!==(M=e.key)&&void 0!==M?M:""}`,onClick:()=>n._removeFilter(e)}))}const cP=e=>({field:(0,Pn.css)({marginBottom:0}),wrapper:(0,Pn.css)({display:"flex","> *":{"&:not(:first-child)":{marginLeft:-1},"&:first-child":{borderTopRightRadius:0,borderBottomRightRadius:0},"&:last-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:first-child):not(:last-child)":{borderRadius:0},position:"relative",zIndex:0,"&:hover":{zIndex:1},"&:focus-within":{zIndex:2}}}),widthWhenOpen:(0,Pn.css)({minWidth:e.spacing(16)}),value:(0,Pn.css)({flexBasis:"content",flexShrink:1,minWidth:"90px"}),key:(0,Pn.css)({flexBasis:"content",minWidth:"90px",flexShrink:1}),operator:(0,Pn.css)({flexShrink:0,flexBasis:"content"}),removeButton:(0,Pn.css)({paddingLeft:e.spacing(1.5),paddingRight:e.spacing(1.5),borderLeft:"none",width:e.spacing(3),marginRight:e.spacing(1),boxSizing:"border-box",position:"relative",left:"1px"})});function dP({model:e,addFilterButtonText:t}){const{_wip:n}=e.useState();return n?r().createElement(uP,{filter:n,model:e}):r().createElement(Sn.Button,{variant:"secondary",icon:"plus",title:"Add filter","aria-label":"Add filter","data-testid":"AdHocFilter-add",onClick:()=>e._addWip()},t)}class pP{getKey(){return`var-${this._variable.state.name}`}getKeys(){return[this.getKey()]}getUrlState(){const e=this._variable.state.filters;if(0===e.length)return{[this.getKey()]:[""]};const t=e.filter(ZP).map((e=>function(e){const t=[wj(e.key,e.keyLabel),e.operator];var n;return XP(e.operator)?e.values.forEach(((n,r)=>{var a;t.push(wj(n,null===(a=e.valueLabels)||void 0===a?void 0:a[r]))})):t.push(wj(e.value,null===(n=e.valueLabels)||void 0===n?void 0:n[0])),t}(e).map(bj).join("|")));return{[this.getKey()]:t}}updateFromUrl(e){const t=e[this.getKey()];if(null==t)return;const n=function(e){if(Array.isArray(e))return e.map(fP).filter(hP);const t=fP(e);return null===t?[]:[t]}(t);this._variable.setState({filters:n})}constructor(e){!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"_variable",void 0),this._variable=e}}function fP(e){if("string"!=typeof e||0===e.length)return null;const[t,n,r,a,...o]=e.split("|").reduce(((e,t)=>{const[n,r]=t.split(",");return e.push(n,null!=r?r:n),e}),[]).map(vj);return{key:t,keyLabel:n,operator:r,value:o[0],values:XP(r)?o.filter(((e,t)=>t%2==0)):void 0,valueLabels:o.filter(((e,t)=>t%2==1)),condition:""}}function hP(e){return null!==e&&"string"==typeof e.key&&"string"==typeof e.value}function mP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const gP=(0,t.forwardRef)((function(e,n){var{children:a,active:o,addGroupBottomBorder:i,isMultiValueEdit:s,checked:l}=e,u=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,["children","active","addGroupBottomBorder","isMultiValueEdit","checked"]);const c=(0,Sn.useStyles2)(bP),d=(0,t.useId)();return r().createElement("div",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){mP(e,t,n[t])}))}return e}({ref:n,role:"option",id:d,"aria-selected":o,className:(0,Pn.cx)(c.option,o&&c.optionFocused,i&&c.groupBottomBorder)},u),r().createElement("div",{className:c.optionBody,"data-testid":`data-testid ad hoc filter option value ${a}`},r().createElement("span",null,s?r().createElement(Sn.Checkbox,{tabIndex:-1,checked:l,className:c.checkbox}):null,a)))})),bP=e=>({option:(0,Pn.css)({label:"grafana-select-option",top:0,left:0,width:"100%",position:"absolute",padding:e.spacing(1),display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer","&:hover":{background:e.colors.action.hover,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${e.colors.primary.border}`}}}),optionFocused:(0,Pn.css)({label:"grafana-select-option-focused",background:e.colors.action.focus,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${e.colors.primary.border}`}}),optionBody:(0,Pn.css)({label:"grafana-select-option-body",display:"flex",fontWeight:e.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),groupBottomBorder:(0,Pn.css)({borderBottom:`1px solid ${e.colors.border.weak}`}),checkbox:(0,Pn.css)({paddingRight:e.spacing(.5)}),multiValueApplyWrapper:(0,Pn.css)({position:"fixed",top:0,left:0,display:"flex",backgroundColor:e.colors.background.primary,color:e.colors.text.primary,boxShadow:e.shadows.z2,overflowY:"auto",zIndex:e.zIndex.dropdown,gap:e.spacing(1.5),padding:`${e.spacing(1.5)} ${e.spacing(1)}`})}),yP=()=>r().createElement(gP,{onClick:e=>e.stopPropagation()},"Loading options..."),vP=()=>r().createElement(gP,{onClick:e=>e.stopPropagation()},"No options found"),wP=({handleFetchOptions:e})=>r().createElement(gP,{onClick:e},"An error has occurred fetching labels. Click to retry"),OP=({onApply:e,floatingElement:t,maxOptionWidth:n,menuHeight:a})=>{var o,i;const s=(0,Sn.useStyles2)(bP),l=null===(o=t)||void 0===o?void 0:o.getBoundingClientRect();return r().createElement("div",{className:s.multiValueApplyWrapper,style:{width:`${n}px`,transform:`translate(${null===(i=l)||void 0===i?void 0:i.left}px,${l?l.top+a:0}px)`}},r().createElement(Sn.Button,{onClick:e,size:"sm",tabIndex:-1},"Apply"))},SP={key:"operator",operator:"value",value:"key"},_P=(e,t,n,r)=>xP(SP[e],t,"value"===e?n:void 0,r),xP=(e,t,n,r)=>{var a;t(e),null===(a=n)||void 0===a||a(),setTimeout((()=>{var e;return null===(e=r)||void 0===e?void 0:e.focus()}))},PP=({filterInputType:e,item:t,filter:n,setFilterMultiValues:r})=>{if("key"===e)return{key:t.value,keyLabel:t.label?t.label:t.value};if("value"===e)return{value:t.value,valueLabels:[t.label?t.label:t.value]};if("operator"===e){var a,o;if(XP(n.operator)&&!XP(t.value))return r([]),{operator:t.value,valueLabels:[(null===(a=n.valueLabels)||void 0===a?void 0:a[0])||(null===(o=n.values)||void 0===o?void 0:o[0])||n.value],values:void 0};if(XP(t.value)&&!XP(n.operator)){var i,s;const e=[(null===(i=n.valueLabels)||void 0===i?void 0:i[0])||(null===(s=n.values)||void 0===s?void 0:s[0])||n.value],a=[n.value];var l,u;return a[0]&&r([{value:a[0],label:null!==(u=null===(l=e)||void 0===l?void 0:l[0])&&void 0!==u?u:a[0]}]),{operator:t.value,valueLabels:e,values:a}}}return{[e]:t.value}},jP="Filter by label values",CP=(e,t,n,r)=>{return"key"===t?jP:"value"===t?n?"Edit values":(null===(a=e.valueLabels)||void 0===a?void 0:a[0])||"":e[t]&&!r?`${e[t]}`:jP;var a};function EP(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function DP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){DP(e,t,n[t])}))}return e}function TP(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const RP=(0,t.forwardRef)((function({filter:e,model:n,isAlwaysWip:a,handleChangeViewMode:o},i){var s,l,u,c,d,p,f,h;const[m,g]=(0,t.useState)(!1),[b,y]=(0,t.useState)([]),[v,w]=(0,t.useState)(!1),[O,S]=(0,t.useState)(!1),[_,x]=(0,t.useState)(""),[P,j]=(0,t.useState)(null),[C,E]=(0,t.useState)(a?"key":"value"),D=(0,Sn.useStyles2)(IP),[k,T]=(0,t.useState)([]),[R,A]=(0,t.useState)({}),I=(0,t.useRef)(null),V=XP((null===(s=e)||void 0===s?void 0:s.operator)||""),M=V&&"value"===C,F=(0,t.useId)(),L=(0,t.useRef)([]),$=(0,t.useRef)([]),N=(0,t.useMemo)((()=>function(e){const t=new In,n=[],r=1e4;return(a,o)=>{if(""===a)return e.length>r?e.slice(0,r):e;if("operator"===o){const t=[];for(let n=0;n<e.length;n++){var i;if((null===(i=e[n].label||e[n].value)||void 0===i?void 0:i.includes(a))&&(t.push(e[n]),t.length>r))return t}return t}if(0===n.length)for(let t=0;t<e.length;t++)n.push(e[t].label||e[t].value);const[s,l,u]=t.search(n,a),c=[];if(s){for(let t=0;t<s.length;t++){if(l&&u){const n=u[t];c.push(e[s[n]])}else c.push(e[s[t]]);if(c.length>r)return c}return c}return e.length>r?e.slice(0,r):e}}(b)),[b]),B=(0,t.useCallback)((()=>{a&&(n._addWip(),E("key"),x(""))}),[n,a]),z=(0,t.useCallback)(((e,t,n,r)=>{if(n.length){const r=[],a=[];n.forEach((e=>{var t;r.push(null!==(t=e.label)&&void 0!==t?t:e.value),a.push(e.value)})),e._updateFilter(t,{valueLabels:r,values:a,value:a[0]}),T([])}r||setTimeout((()=>{var e;return null===(e=U.domReference.current)||void 0===e?void 0:e.focus()}))}),[]),q=(0,t.useCallback)((e=>{T((t=>t.some((t=>t.value===e.value))?t.filter((t=>t.value!==e.value)):[...t,e]))}),[]),H=(0,t.useCallback)(((t,r,a)=>{var i;g(t),a&&["outside-press","escape-key"].includes(a)&&(M&&z(n,e,k),B(),null===(i=o)||void 0===i||i())}),[e,k,o,z,B,M,n]),W=(0,t.useMemo)((()=>[F,...k.map(((e,t)=>`${e.value}-${t}`))]),[F,k]),{refs:U,floatingStyles:G,context:Q,getReferenceProps:K,getFloatingProps:Y,getItemProps:Z}=(({open:e,onOpenChange:t,activeIndex:n,setActiveIndex:r,outsidePressIdsToIgnore:a,listRef:o,disabledIndicesRef:i})=>{const{refs:s,floatingStyles:l,context:u}=Ii({whileElementsMounted:Ya,open:e,onOpenChange:t,placement:"bottom-start",middleware:[io(10),so({padding:10}),lo({apply({availableHeight:e,availableWidth:t,elements:n}){n.floating.style.maxHeight=`${Math.min(300,e)}px`,n.floating.style.maxWidth=`${t}px`},padding:10})],strategy:"fixed"}),c=Ui(u,{role:"listbox"}),d=Ai(u,{outsidePress:e=>{if(e.currentTarget instanceof Element){const n=e.currentTarget;let r=n.id;var t;if("path"===n.nodeName&&(r=(null===(t=n.parentElement)||void 0===t?void 0:t.id)||""),a.includes(r))return!1}return!0}}),p=Hi(u,{listRef:o,activeIndex:n,onNavigate:r,virtual:!0,loop:!0,disabledIndices:i.current}),{getReferenceProps:f,getFloatingProps:h,getItemProps:m}=Li([c,d,p]);return{refs:s,floatingStyles:l,context:u,getReferenceProps:f,getFloatingProps:h,getItemProps:m}})({open:m,onOpenChange:H,activeIndex:P,setActiveIndex:j,outsidePressIdsToIgnore:W,listRef:L,disabledIndicesRef:$});(0,t.useImperativeHandle)(i,(()=>()=>{var e;return null===(e=U.domReference.current)||void 0===e?void 0:e.focus()}),[U.domReference]);const X=(0,t.useCallback)((e=>{T((t=>t.filter((t=>t.value!==e.value)))),setTimeout((()=>{var e;return null===(e=U.domReference.current)||void 0===e?void 0:e.focus()}))}),[U.domReference]),J=(e=>e.flatMap((e=>e.options?[e,...e.options]:[e])))(_j(N(_,C)));"operator"!==C&&_&&J.push({value:_.trim(),label:_.trim(),isCustom:!0});const ee=((e,t,n)=>{let r=182;const a=[],o=[];for(let t=0;t<e.length;t++){var i,s,l,u;a.push(null),(null===(i=e[t])||void 0===i?void 0:i.options)&&o.push(t);let n=null!==(u=null!==(l=e[t].label)&&void 0!==l?l:e[t].value)&&void 0!==u?u:"",c=8;8*n.length<6*((null===(s=e[t].description)||void 0===s?void 0:s.length)||0)&&(n=e[t].description,c=6);const d=(e[t].isCustom?n.length+18:n.length)*c+16;d>r&&(r=d)}return t.current=[...a],n.current=[...o],r})(J,L,$),te=(0,t.useCallback)(function(){var t,r=(t=function*(t){S(!1),w(!0),y([]);let r=[];try{var a;"key"===t?r=yield n._getKeys(null):"operator"===t?r=n._getOperators():"value"===t&&(r=yield n._getValuesFor(e)),y(r),(null===(a=r[0])||void 0===a?void 0:a.group)&&j(1)}catch(e){S(!0)}w(!1)},function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){EP(o,r,a,i,s,"next",e)}function s(e){EP(o,r,a,i,s,"throw",e)}i(void 0)}))});return function(e){return r.apply(this,arguments)}}(),[e,n]),ne=ss({count:J.length,getScrollElement:()=>U.floating.current,estimateSize:e=>J[e].description?60:38,overscan:5}),re=(0,t.useCallback)(((e,t)=>{"Backspace"!==e.key||_||(t?T((e=>{const t=[...e];return t.splice(-1,1),t})):"key"===C&&(n._removeLastFilter(),te(C)))}),[_,C,n,te]),ae=(0,t.useCallback)(((t,r)=>{var a,i;"Tab"!==t.key||t.shiftKey||(r&&(t.preventDefault(),z(n,e,k),null===(i=U.domReference.current)||void 0===i||i.focus()),null===(a=o)||void 0===a||a(),B())}),[e,k,o,z,B,n,U.domReference]),oe=(0,t.useCallback)(((t,r)=>{var a;"Tab"===t.key&&t.shiftKey&&(r&&(t.preventDefault(),z(n,e,k,!0)),null===(a=o)||void 0===a||a(),B())}),[e,k,o,z,B,n]),ie=(0,t.useCallback)(((t,r)=>{if("Enter"===t.key&&null!=P){if(!J[P])return;const t=J[P];r?q(t):(n._updateFilter(e,PP({filterInputType:C,item:t,filter:e,setFilterMultiValues:T})),_P(C,E,o,U.domReference.current),j(0)),x("")}}),[P,e,C,J,q,o,n,U.domReference]);var se;(0,t.useEffect)((()=>{m&&te(C)}),[m,C]),(0,t.useEffect)((()=>{if(!a){var t,n,r;if(E("value"),x(""),V&&(null===(n=e)||void 0===n||null===(t=n.values)||void 0===t?void 0:t.length)){const t=e.values.reduce(((t,n,r)=>{var a;return[...t,{label:(null===(a=e.valueLabels)||void 0===a?void 0:a[r])||n,value:n}]}),[]);T(t)}null===(r=U.domReference.current)||void 0===r||r.focus()}}),[]),(0,t.useEffect)((()=>{M&&k&&setTimeout((()=>A({})))}),[k,M]),(0,t.useLayoutEffect)((()=>{var e,t;null!==P&&ne.range&&(P>(null===(e=ne.range)||void 0===e?void 0:e.endIndex)||P<(null===(t=ne.range)||void 0===t?void 0:t.startIndex))&&ne.scrollToIndex(P)}),[P,ne]);const le=null!==(se=null===(l=e)||void 0===l?void 0:l.keyLabel)&&void 0!==se?se:null===(u=e)||void 0===u?void 0:u.key;return r().createElement("div",{className:D.comboboxWrapper},e?r().createElement("div",{className:D.pillWrapper},(null===(c=e)||void 0===c?void 0:c.key)?r().createElement("div",{className:(0,Pn.cx)(D.basePill,D.keyPill)},le):null,(null===(d=e)||void 0===d?void 0:d.key)&&(null===(p=e)||void 0===p?void 0:p.operator)&&"operator"!==C?r().createElement("div",{id:F,className:(0,Pn.cx)(D.basePill,D.operatorPill,F),role:"button","aria-label":"Edit filter operator",tabIndex:0,onClick:e=>{e.stopPropagation(),xP("operator",E,void 0,U.domReference.current)},onKeyDown:e=>{oe(e,V),"Enter"===e.key&&xP("operator",E,void 0,U.domReference.current)}},e.operator):null,r().createElement("div",{ref:I}),M?k.map(((e,t)=>r().createElement(AP,{key:`${e.value}-${t}`,item:e,index:t,handleRemoveMultiValue:X}))):null):null,r().createElement("input",TP(kP({},K({ref:U.setReference,onChange:function(e){const t=e.target.value;x(t),j(0)},value:_,placeholder:CP(e,C,M,a),"aria-autocomplete":"list",onKeyDown(e){m?("operator"===C&&oe(e),re(e,M),ae(e,M),ie(e,M)):g(!0)}})),{className:(0,Pn.cx)(D.inputStyle,{[D.loadingInputPadding]:!v}),onClick:e=>{e.stopPropagation(),g(!0)},onFocus:()=>{j(0),g(!0)}})),v?r().createElement(Sn.Spinner,{className:D.loadingIndicator,inline:!0}):null,r().createElement(Si,null,m&&r().createElement(Di,{context:Q,initialFocus:-1,visuallyHiddenDismiss:!0,modal:!1},r().createElement(r().Fragment,null,r().createElement("div",{style:TP(kP({},G),{width:`${O?366:ee}px`,transform:M?`translate(${(null===(f=I.current)||void 0===f?void 0:f.getBoundingClientRect().left)||0}px, ${((null===(h=U.domReference.current)||void 0===h?void 0:h.getBoundingClientRect().bottom)||0)+10}px )`:G.transform}),ref:U.setFloating,className:D.dropdownWrapper,tabIndex:-1},r().createElement("div",TP(kP({style:{height:`${ne.getTotalSize()||38}px`}},Y()),{tabIndex:-1}),v?r().createElement(yP,null):O?r().createElement(wP,{handleFetchOptions:()=>te(C)}):J.length||"operator"!==C&&_?ne.getVirtualItems().map((t=>{const a=J[t.index],i=t.index;if(a.options)return r().createElement("div",{key:`${a.label}+${i}`,className:(0,Pn.cx)(D.optionGroupLabel,D.groupTopBorder),style:{height:`${t.size}px`,transform:`translateY(${t.start}px)`}},r().createElement(Sn.Text,{weight:"bold",variant:"bodySmall",color:"secondary"},a.label));const s=J[t.index+1],l=s&&!s.group&&!s.options&&a.group;var u;return r().createElement(gP,TP(kP({},Z({key:`${a.value}-${i}`,ref(e){L.current[i]=e},onClick(t){var r;"value"!==C&&t.stopPropagation(),M?(t.preventDefault(),t.stopPropagation(),q(a),null===(r=U.domReference.current)||void 0===r||r.focus()):(n._updateFilter(e,PP({filterInputType:C,item:a,filter:e,setFilterMultiValues:T})),x(""),_P(C,E,o,U.domReference.current))}})),{active:P===i,addGroupBottomBorder:l,style:{height:`${t.size}px`,transform:`translateY(${t.start}px)`},"aria-setsize":J.length,"aria-posinset":t.index+1,isMultiValueEdit:M,checked:k.some((e=>e.value===a.value))}),r().createElement("span",null,a.isCustom?"Use custom value: ":""," ",null!==(u=a.label)&&void 0!==u?u:a.value),a.description?r().createElement("div",{className:D.descriptionText},a.description):null)})):r().createElement(vP,null))),M&&!v&&!O&&J.length?r().createElement(OP,{onApply:()=>{z(n,e,k)},floatingElement:U.floating.current,maxOptionWidth:ee,menuHeight:Math.min(ne.getTotalSize(),300)}):null))))})),AP=({item:e,handleRemoveMultiValue:t,index:n})=>{const a=(0,Sn.useStyles2)(IP);var o,i;return r().createElement("div",{className:(0,Pn.cx)(a.basePill,a.valuePill)},r().createElement("span",null," ",null!==(o=e.label)&&void 0!==o?o:e.value),r().createElement(Sn.Button,{onClick:n=>{n.stopPropagation(),n.preventDefault(),t(e)},onKeyDownCapture:n=>{"Enter"===n.key&&(n.preventDefault(),n.stopPropagation(),t(e))},fill:"text",size:"sm",variant:"secondary",className:a.removeButton,tooltip:`Remove filter value - ${null!==(i=e.label)&&void 0!==i?i:e.value}`},r().createElement(Sn.Icon,{name:"times",size:"md",id:`${e.value}-${n}`})))},IP=e=>({comboboxWrapper:(0,Pn.css)({display:"flex",flexWrap:"wrap"}),pillWrapper:(0,Pn.css)({display:"flex",alignItems:"center",flexWrap:"wrap"}),basePill:(0,Pn.css)(TP(kP({display:"flex",alignItems:"center",background:e.colors.action.disabledBackground,border:`1px solid ${e.colors.border.weak}`,padding:e.spacing(.125,1,.125,1),color:e.colors.text.primary,overflow:"hidden",whiteSpace:"nowrap",minHeight:e.spacing(2.75)},e.typography.bodySmall),{cursor:"pointer"})),keyPill:(0,Pn.css)({fontWeight:e.typography.fontWeightBold,cursor:"default"}),operatorPill:(0,Pn.css)({"&:hover":{background:e.colors.action.hover}}),valuePill:(0,Pn.css)({background:e.colors.action.selected,padding:e.spacing(.125,0,.125,1)}),dropdownWrapper:(0,Pn.css)({backgroundColor:e.colors.background.primary,color:e.colors.text.primary,boxShadow:e.shadows.z2,overflowY:"auto",zIndex:e.zIndex.dropdown}),inputStyle:(0,Pn.css)({paddingBlock:0,"&:focus":{outline:"none"}}),loadingIndicator:(0,Pn.css)({color:e.colors.text.secondary,marginLeft:e.spacing(.5)}),loadingInputPadding:(0,Pn.css)({paddingRight:e.spacing(2.5)}),optionGroupLabel:(0,Pn.css)({padding:e.spacing(1),position:"absolute",top:0,left:0,width:"100%"}),groupTopBorder:(0,Pn.css)({"&:not(:first-child)":{borderTop:`1px solid ${e.colors.border.weak}`}}),removeButton:(0,Pn.css)({marginInline:e.spacing(.5),height:"100%",padding:0,cursor:"pointer","&:hover":{color:e.colors.text.primary}}),descriptionText:(0,Pn.css)(TP(kP({},e.typography.bodySmall),{color:e.colors.text.secondary,paddingTop:e.spacing(.5)})),multiValueApply:(0,Pn.css)({position:"absolute",top:0,left:0,display:"flex"})});function VP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function MP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){VP(e,t,n[t])}))}return e}function FP({filter:e,model:n,readOnly:a,focusOnInputRef:o}){var i,s;const l=(0,Sn.useStyles2)(LP),[u,c]=(0,t.useState)(!0),[d,p]=(0,t.useState)(!1),f=(0,t.useRef)(null);var h;const m=null!==(h=e.keyLabel)&&void 0!==h?h:e.key,g=(null===(i=e.valueLabels)||void 0===i?void 0:i.join(", "))||(null===(s=e.values)||void 0===s?void 0:s.join(", "))||e.value,b=(0,t.useCallback)((e=>{var t;null===(t=e)||void 0===t||t.stopPropagation(),a||(p(!u),c(!u))}),[a,u]);if((0,t.useEffect)((()=>{var e;d&&(null===(e=f.current)||void 0===e||e.focus(),p(!1))}),[d]),u){const t=r().createElement("span",{className:l.pillText},m," ",e.operator," ",g);return r().createElement("div",{className:(0,Pn.cx)(l.combinedFilterPill,{[l.readOnlyCombinedFilter]:a}),onClick:b,onKeyDown:e=>{"Enter"===e.key&&b()},role:"button","aria-label":`Edit filter with key ${m}`,tabIndex:0,ref:f},g.length<20?t:r().createElement(Sn.Tooltip,{content:r().createElement("div",{className:l.tooltipText},g),placement:"top"},t),a?null:r().createElement(Sn.IconButton,{onClick:t=>{t.stopPropagation(),n._removeFilter(e),setTimeout((()=>{var e;return null===(e=o)||void 0===e?void 0:e()}))},onKeyDownCapture:t=>{"Enter"===t.key&&(t.preventDefault(),t.stopPropagation(),n._removeFilter(e),setTimeout((()=>{var e;return null===(e=o)||void 0===e?void 0:e()})))},name:"times",size:"md",className:l.removeButton,tooltip:`Remove filter with key ${m}`}))}return r().createElement(RP,{filter:e,model:n,handleChangeViewMode:b})}const LP=e=>{return{combinedFilterPill:(0,Pn.css)((t=MP({display:"flex",alignItems:"center",background:e.colors.action.selected,borderRadius:e.shape.radius.default,border:`1px solid ${e.colors.border.weak}`,padding:e.spacing(.125,0,.125,1),color:e.colors.text.primary,overflow:"hidden",whiteSpace:"nowrap",minHeight:e.spacing(2.75)},e.typography.bodySmall),n={fontWeight:e.typography.fontWeightBold,cursor:"pointer","&:hover":{background:e.colors.action.hover}},n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t)),readOnlyCombinedFilter:(0,Pn.css)({paddingRight:e.spacing(1),cursor:"text","&:hover":{background:e.colors.action.selected}}),removeButton:(0,Pn.css)({marginInline:e.spacing(.5),cursor:"pointer","&:hover":{color:e.colors.text.primary}}),pillText:(0,Pn.css)({maxWidth:"200px",width:"100%",textOverflow:"ellipsis",overflow:"hidden"}),tooltipText:(0,Pn.css)({textAlign:"center"})};var t,n},$P=(0,t.forwardRef)((function({model:e},n){const{_wip:a}=e.useState();return(0,t.useLayoutEffect)((()=>{a||e._addWip()}),[a]),r().createElement(RP,{model:e,filter:a,isAlwaysWip:!0,ref:n})})),NP=(0,t.memo)((function({model:e}){const{filters:n,readOnly:a}=e.useState(),o=(0,Sn.useStyles2)(BP),i=(0,t.useRef)();return r().createElement("div",{className:(0,Pn.cx)(o.comboboxWrapper,{[o.comboboxFocusOutline]:!a}),onClick:()=>{var e,t;null===(e=(t=i).current)||void 0===e||e.call(t)}},r().createElement(Sn.Icon,{name:"filter",className:o.filterIcon,size:"lg"}),n.map(((t,n)=>r().createElement(FP,{key:n,filter:t,model:e,readOnly:a,focusOnInputRef:i.current}))),a?null:r().createElement($P,{model:e,ref:i}))})),BP=e=>({comboboxWrapper:(0,Pn.css)({display:"flex",flexWrap:"wrap",alignItems:"center",columnGap:e.spacing(1),rowGap:e.spacing(.5),minHeight:e.spacing(4),backgroundColor:e.components.input.background,border:`1px solid ${e.colors.border.strong}`,borderRadius:e.shape.radius.default,paddingInline:e.spacing(1),paddingBlock:e.spacing(.5),flexGrow:1}),comboboxFocusOutline:(0,Pn.css)({"&:focus-within":{outline:"2px dotted transparent",outlineOffset:"2px",boxShadow:`0 0 0 2px ${e.colors.background.canvas}, 0 0 0px 4px ${e.colors.primary.main}`,transitionTimingFunction:"cubic-bezier(0.19, 1, 0.22, 1)",transitionDuration:"0.2s",transitionProperty:"outline, outline-offset, box-shadow",zIndex:2}}),filterIcon:(0,Pn.css)({color:e.colors.text.secondary,alignSelf:"center"})});function zP(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function qP(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){zP(o,r,a,i,s,"next",e)}function s(e){zP(o,r,a,i,s,"throw",e)}i(void 0)}))}}function HP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){HP(e,t,n[t])}))}return e}const UP=[{value:"=",description:"Equals"},{value:"!=",description:"Not equal"},{value:"=|",description:"One of. Use to filter on multiple values.",isMulti:!0},{value:"!=|",description:"Not one of. Use to exclude multiple values.",isMulti:!0},{value:"=~",description:"Matches regex"},{value:"!~",description:"Does not match regex"},{value:"<",description:"Less than"},{value:">",description:"Greater than"}];class GP extends lv{setState(e){let t=!1;e.filters&&e.filters!==this.state.filters&&!e.filterExpression&&(e.filterExpression=QP(this.state.expressionBuilder,e.filters),t=e.filterExpression!==this.state.filterExpression),super.setState(e),t&&this.publishEvent(new V_(this),!0)}getValue(){return this.state.filterExpression}_updateFilter(e,t){const{filters:n,_wip:r}=this.state;if(e===r)return void("value"in t&&""!==t.value?this.setState({filters:[...n,WP({},r,t)],_wip:void 0}):this.setState({_wip:WP({},e,t)}));const a=this.state.filters.map((n=>n===e?WP({},n,t):n));this.setState({filters:a})}_removeFilter(e){e!==this.state._wip?this.setState({filters:this.state.filters.filter((t=>t!==e))}):this.setState({_wip:void 0})}_removeLastFilter(){const e=this.state.filters.at(-1);e&&this._removeFilter(e)}_getKeys(e){var t=this;return qP((function*(){var n,r;const a=yield null===(n=(r=t.state).getTagKeysProvider)||void 0===n?void 0:n.call(r,t,e);if(a&&a.replace)return Oj(a.values).map(YP);if(t.state.defaultKeys)return t.state.defaultKeys.map(YP);const o=yield t._dataSourceSrv.get(t.state.datasource,t._scopedVars);if(!o||!o.getTagKeys)return[];var i;const s=t.state.filters.filter((t=>t.key!==e)).concat(null!==(i=t.state.baseFilters)&&void 0!==i?i:[]),l=Wj.getTimeRange(t).state.value,u=t.state.useQueriesAsFilterForOptions?gj(t):void 0,c=yield o.getTagKeys(WP({filters:s,queries:u,timeRange:l},Wx(t)));Sj(c)&&t.setState({error:c.error.message});let d=Oj(c);a&&(d=d.concat(Oj(a.values)));const p=t.state.tagKeyRegexFilter;return p&&(d=d.filter((e=>e.text.match(p)))),d.map(YP)}))()}_getValuesFor(e){var t=this;return qP((function*(){var n,r;const a=yield null===(n=(r=t.state).getTagValuesProvider)||void 0===n?void 0:n.call(r,t,e);if(a&&a.replace)return Oj(a.values).map(YP);const o=yield t._dataSourceSrv.get(t.state.datasource,t._scopedVars);if(!o||!o.getTagValues)return[];var i;const s=t.state.filters.filter((t=>t.key!==e.key)).concat(null!==(i=t.state.baseFilters)&&void 0!==i?i:[]),l=Wj.getTimeRange(t).state.value,u=t.state.useQueriesAsFilterForOptions?gj(t):void 0,c=yield o.getTagValues(WP({key:e.key,filters:s,timeRange:l,queries:u},Wx(t)));Sj(c)&&t.setState({error:c.error.message});let d=Oj(c);return a&&(d=d.concat(Oj(a.values))),d.map(YP)}))()}_addWip(){this.setState({_wip:{key:"",value:"",operator:"=",condition:""}})}_getOperators(){return(this.state.supportsMultiValueOperators?UP:UP.filter((e=>!e.isMulti))).map((({value:e,description:t})=>({label:e,value:e,description:t})))}constructor(e){var t,n;super(WP({type:"adhoc",name:null!==(t=e.name)&&void 0!==t?t:"Filters",filters:[],datasource:null,applyMode:"auto",filterExpression:null!==(n=e.filterExpression)&&void 0!==n?n:QP(e.expressionBuilder,e.filters)},e)),HP(this,"_scopedVars",{__sceneObject:Yx(this)}),HP(this,"_dataSourceSrv",(0,d.getDataSourceSrv)()),HP(this,"_urlSync",new pP(this)),"auto"===this.state.applyMode&&function(e){var t;if(e.addActivationHandler((()=>(Rx.add(e),()=>Rx.delete(e)))),Tx)return;const n=(0,d.getTemplateSrv)();(null===(t=n)||void 0===t?void 0:t.getAdhocFilters)?(Tx=n.getAdhocFilters,n.getAdhocFilters=function(e){if(0===Rx.size)return Tx.call(n);const t=(0,d.getDataSourceSrv)().getInstanceSettings(e);if(!t)return[];for(const e of Rx.values()){var r;if((null===(r=e.state.datasource)||void 0===r?void 0:r.uid)===t.uid)return e.state.filters}return[]}.bind(n)):console.log("Failed to patch getAdhocFilters")}(this)}}function QP(e,t){return(null!=e?e:pj)(null!=t?t:[])}HP(GP,"Component",(function({model:e}){const{filters:t,readOnly:n,addFilterButtonText:a}=e.useState(),o=(0,Sn.useStyles2)(KP);return"combobox"===e.state.layout?r().createElement(NP,{model:e}):r().createElement("div",{className:o.wrapper},t.map(((t,n)=>r().createElement(r().Fragment,{key:n},r().createElement(uP,{filter:t,model:e})))),!n&&r().createElement(dP,{model:e,key:"'builder",addFilterButtonText:a}))}));const KP=e=>({wrapper:(0,Pn.css)({display:"flex",flexWrap:"wrap",alignItems:"flex-end",columnGap:e.spacing(2),rowGap:e.spacing(1)})});function YP(e){const{text:t,value:n}=e,r={label:t,value:String(null!=n?n:t)};return"group"in e&&(r.group=e.group),r}function ZP(e){return""!==e.key&&""!==e.operator&&""!==e.value}function XP(e){const t=UP.find((t=>t.value===e));return!!t&&Boolean(t.isMulti)}function JP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ej{getMergedStream(e){(function(e,t){if(e.length!==t.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!0;return!1})(e,this._prevLayers)&&(this._resultsMap=new Map,this._prevLayers=e);const t=e.map((e=>e.getResultsStream())),n=[];for(const t of e)n.push(t.activate());return(0,k.merge)(t).pipe((0,k.mergeAll)(),(0,k.filter)((e=>this._resultsMap.get(e.origin.state.key)!==e)),(0,k.map)((e=>(this._resultsMap.set(e.origin.state.key,e),this._resultsMap.values()))),(0,k.finalize)((()=>{n.forEach((e=>e()))})))}constructor(){JP(this,"_resultsMap",new Map),JP(this,"_prevLayers",[])}}function tj(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function nj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){nj(e,t,n[t])}))}return e}function aj(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}let oj=100;function ij(){return"SQR"+oj++}class sj extends lv{getResultsStream(){return this._results}_onActivate(){if(this.isQueryModeAuto()){const e=Wj.getTimeRange(this),t=this.getClosestExtraQueryProviders();for(const e of t)this._subs.add(e.subscribeToState(((t,n)=>{e.shouldRerun(n,t,this.state.queries)&&this.runQueries()})));this.subscribeToTimeRangeChanges(e),this.shouldRunQueriesOnActivate()&&this.runQueries()}return this._dataLayersSub||this._handleDataLayers(),()=>this._onDeactivate()}_handleDataLayers(){const e=Wj.getDataLayers(this);0!==e.length&&(this._dataLayersSub=this._dataLayersMerger.getMergedStream(e).subscribe(this._onLayersReceived.bind(this)))}_onLayersReceived(t){var n,r,a;const o=Wj.getTimeRange(this),{dataLayerFilter:i}=this.state;let s,l=[],u=[];for(const n of t)for(let t of n.data.series){var c,d;(null===(c=t.meta)||void 0===c?void 0:c.dataTopic)===e.DataTopic.Annotations&&(l=l.concat(t)),(null===(d=t.meta)||void 0===d?void 0:d.dataTopic)===e.DataTopic.AlertStates&&(u=u.concat(t))}if((null===(n=i)||void 0===n?void 0:n.panelId)&&(l.length>0&&(l=function(e,t){if(!Array.isArray(e)||0===e.length)return e;const n=Array.from({length:e.length},(()=>new Set));let r=0;for(const o of e){for(let e=0;e<o.length;e++){if(n[r].has(e))continue;let i=!0;const s=o.fields.find((e=>"panelId"===e.name)),l=o.fields.find((e=>"source"===e.name));if(l){s&&"dashboard"===l.values[e].type&&(i=s.values[e]===t.panelId);const n=l.values[e].filter;if(n){var a;const e=(null!==(a=n.ids)&&void 0!==a?a:[]).includes(t.panelId);n.exclude?e&&(i=!1):e||(i=!1)}}i&&n[r].add(e)}r++}const o=[];r=0;for(const t of e){const e=n[r].size,a=[];for(const e of t.fields){const o=[];for(let a=0;a<t.length;a++)n[r].has(a)&&o.push(e.values[a]);a.push(kx(Dx({},e),{values:o}))}o.push(kx(Dx({},t),{fields:a,length:e})),r++}return o}(l,i)),u.length>0))for(const t of u){const n=new e.DataFrameView(t);for(const e of n)if(e.panelId===i.panelId){s=e;break}}if(uj(l)&&uj(this._layerAnnotations)&&(0,be.isEqual)(s,null===(r=this.state.data)||void 0===r?void 0:r.alertState))return;this._layerAnnotations=l;const p=this.state.data?this.state.data:aj(rj({},__),{timeRange:o.state.value});var f;this.setState({data:aj(rj({},p),{annotations:[...null!==(f=this._resultAnnotations)&&void 0!==f?f:[],...l],alertState:null!=s?s:null===(a=this.state.data)||void 0===a?void 0:a.alertState})})}onVariableUpdatesCompleted(){this.isQueryModeAuto()&&this.runQueries()}onAnyVariableChanged(e){this._adhocFiltersVar!==e&&this._groupByVar!==e&&this.isQueryModeAuto()&&(e instanceof GP&&this._isRelevantAutoVariable(e)&&this.runQueries(),e instanceof tP&&this._isRelevantAutoVariable(e)&&this.runQueries())}_isRelevantAutoVariable(e){var t,n,r;const a=null!==(r=this.state.datasource)&&void 0!==r?r:lj(this.state.queries);return"auto"===e.state.applyMode&&(null===(t=a)||void 0===t?void 0:t.uid)===(null===(n=e.state.datasource)||void 0===n?void 0:n.uid)}shouldRunQueriesOnActivate(){return this._variableValueRecorder.hasDependenciesChanged(this)?(yx("SceneQueryRunner","Variable dependency changed while inactive, shouldRunQueriesOnActivate returns true"),!0):!this.state.data||!!this._isDataTimeRangeStale(this.state.data)}_isDataTimeRangeStale(e){const t=Wj.getTimeRange(this).state.value,n=e.timeRange;return(t.from.unix()!==n.from.unix()||t.to.unix()!==n.to.unix())&&(yx("SceneQueryRunner","Data time range is stale"),!0)}_onDeactivate(){var e;this._querySub&&(this._querySub.unsubscribe(),this._querySub=void 0),this._dataLayersSub&&(this._dataLayersSub.unsubscribe(),this._dataLayersSub=void 0),null===(e=this._timeSub)||void 0===e||e.unsubscribe(),this._timeSub=void 0,this._timeSubRange=void 0,this._adhocFiltersVar=void 0,this._groupByVar=void 0,this._variableValueRecorder.recordCurrentDependencyValuesForSceneObject(this)}setContainerWidth(e){!this._containerWidth&&e>0?(this._containerWidth=e,this.state.maxDataPointsFromWidth&&!this.state.maxDataPoints&&setTimeout((()=>{this.isActive&&!this.state._hasFetchedData&&this.runQueries()}),0)):e>0&&(this._containerWidth=e)}isDataReadyToDisplay(){return Boolean(this.state._hasFetchedData)}subscribeToTimeRangeChanges(e){this._timeSubRange!==e&&(this._timeSub&&this._timeSub.unsubscribe(),this._timeSubRange=e,this._timeSub=e.subscribeToState((()=>{this.runWithTimeRange(e)})))}runQueries(){const e=Wj.getTimeRange(this);this.isQueryModeAuto()&&this.subscribeToTimeRangeChanges(e),this.runWithTimeRange(e)}getMaxDataPoints(){return this.state.maxDataPoints?this.state.maxDataPoints:this.state.maxDataPointsFromWidth&&null!==(e=this._containerWidth)&&void 0!==e?e:500;var e}cancelQuery(){var e;null===(e=this._querySub)||void 0===e||e.unsubscribe(),this._dataLayersSub&&(this._dataLayersSub.unsubscribe(),this._dataLayersSub=void 0),this.setState({data:aj(rj({},this.state.data),{state:Ie.Done})})}runWithTimeRange(e){var t,n=this;return(t=function*(){var t,r,a;if(!n.state.maxDataPoints&&n.state.maxDataPointsFromWidth&&!n._containerWidth)return;if(n._dataLayersSub||n._handleDataLayers(),null===(t=n._querySub)||void 0===t||t.unsubscribe(),n._variableDependency.hasDependencyInLoadingState())return yx("SceneQueryRunner","Variable dependency is in loading state, skipping query execution"),void n.setState({data:aj(rj({},null!==(a=n.state.data)&&void 0!==a?a:__),{state:Ie.Loading})});const{queries:o}=n.state;if(null===(r=o)||void 0===r?void 0:r.length)try{var i,s;const t=null!==(s=n.state.datasource)&&void 0!==s?s:lj(o),r=yield Ox(t,n._scopedVars);n.findAndSubscribeToAdHocFilters(null===(i=t)||void 0===i?void 0:i.uid);const a=(0,d.getRunRequest)(),{primary:l,secondaries:u,processors:c}=n.prepareRequests(e,r);yx("SceneQueryRunner","Starting runRequest",n.state.key);let p=a(r,l);if(u.length>0){const e=u.map((e=>a(r,e))),t=Cx(c);p=(0,k.forkJoin)([p,...e]).pipe(t)}p=p.pipe(Ax({type:"data",request:l,origin:n,cancel:()=>n.cancelQuery()})),n._querySub=p.subscribe(n.onDataReceived)}catch(e){console.error("PanelQueryRunner Error",e),n.onDataReceived(aj(rj({},__,n.state.data),{state:Ie.Error,errors:[(0,d.toDataQueryError)(e)]}))}else n._setNoDataState()},function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){tj(o,r,a,i,s,"next",e)}function s(e){tj(o,r,a,i,s,"throw",e)}i(void 0)}))})()}clone(e){const t=super.clone(e);var n;return this._resultAnnotations&&(t._resultAnnotations=this._resultAnnotations.map((e=>rj({},e)))),this._layerAnnotations&&(t._layerAnnotations=this._layerAnnotations.map((e=>rj({},e)))),t._variableValueRecorder=this._variableValueRecorder.cloneAndRecordCurrentValuesForSceneObject(this),t._containerWidth=this._containerWidth,t._results.next({origin:this,data:null!==(n=this.state.data)&&void 0!==n?n:__}),t}prepareRequests(t,n){const{minInterval:r,queries:a}=this.state;let o=rj({app:"scenes",requestId:ij(),timezone:t.getTimeZone(),range:t.state.value,interval:"1s",intervalMs:1e3,targets:(0,be.cloneDeep)(a),maxDataPoints:this.getMaxDataPoints(),scopedVars:this._scopedVars,startTime:Date.now(),liveStreaming:this.state.liveStreaming,rangeRaw:{from:t.state.from,to:t.state.to},cacheTimeout:this.state.cacheTimeout,queryCachingTTL:this.state.queryCachingTTL},function(e){const t=e.getRoot();return function(e){return"enrichDataRequest"in e}(t)?t.enrichDataRequest(e):null}(this));this._adhocFiltersVar&&(o.filters=this._adhocFiltersVar.state.filters.filter(ZP)),this._groupByVar&&(o.groupByKeys=this._groupByVar.state.value),o.targets=o.targets.map((e=>{var t;return e.datasource&&(e.datasource.uid===n.uid||(null===(t=n.meta)||void 0===t?void 0:t.mixed)||!d.isExpressionReference||(0,d.isExpressionReference)(e.datasource))||(e.datasource=n.getRef()),e}));const i=r?Bj(this,r):n.interval,s=e.rangeUtil.calculateInterval(t.state.value,o.maxDataPoints,i);o.scopedVars=Object.assign({},o.scopedVars,{__interval:{text:s.interval,value:s.interval},__interval_ms:{text:s.intervalMs.toString(),value:s.intervalMs}}),o.interval=s.interval,o.intervalMs=s.intervalMs;const l=t.state.value;let u=[],c=new Map;var p;for(const e of null!==(p=this.getClosestExtraQueryProviders())&&void 0!==p?p:[])for(const{req:t,processor:n}of e.getExtraQueries(o)){const e=ij();u.push(aj(rj({},t),{requestId:e})),c.set(e,null!=n?n:jx)}return o.range=l,{primary:o,secondaries:u,processors:c}}_combineDataLayers(e){return this._layerAnnotations&&this._layerAnnotations.length>0&&(e.annotations=(e.annotations||[]).concat(this._layerAnnotations)),this.state.data&&this.state.data.alertState&&(e.alertState=this.state.data.alertState),e}_setNoDataState(){this.state.data!==__&&this.setState({data:__})}getClosestExtraQueryProviders(){const e=new Map;return this.parent?(dv(this.parent,(t=>(xx(t)&&!e.has(t.constructor)&&e.set(t.constructor,t),t.forEachChild((t=>{xx(t)&&!e.has(t.constructor)&&e.set(t.constructor,t)})),null))),Array.from(e.values())):[]}findAndSubscribeToAdHocFilters(e){const t=function(e){for(const n of Rx.values()){var t;if((null===(t=n.state.datasource)||void 0===t?void 0:t.uid)===e)return n}}(e);this._adhocFiltersVar!==t&&(this._adhocFiltersVar=t,this._updateExplicitVariableDependencies());const n=function(e){for(const n of Ix.values()){var t;if((null===(t=n.state.datasource)||void 0===t?void 0:t.uid)===e)return n}}(e);this._groupByVar!==n&&(this._groupByVar=n,this._updateExplicitVariableDependencies())}_updateExplicitVariableDependencies(){const e=[];this._adhocFiltersVar&&e.push(this._adhocFiltersVar.state.name),this._groupByVar&&e.push(this._groupByVar.state.name),this._variableDependency.setVariableNames(e)}isQueryModeAuto(){var e;return"auto"===(null!==(e=this.state.runQueriesMode)&&void 0!==e?e:"auto")}constructor(t){super(t),nj(this,"_querySub",void 0),nj(this,"_dataLayersSub",void 0),nj(this,"_dataLayersMerger",new ej),nj(this,"_timeSub",void 0),nj(this,"_timeSubRange",void 0),nj(this,"_containerWidth",void 0),nj(this,"_variableValueRecorder",new _x),nj(this,"_results",new k.ReplaySubject(1)),nj(this,"_scopedVars",{__sceneObject:Yx(this)}),nj(this,"_layerAnnotations",void 0),nj(this,"_resultAnnotations",void 0),nj(this,"_adhocFiltersVar",void 0),nj(this,"_groupByVar",void 0),nj(this,"_variableDependency",new Pj(this,{statePaths:["queries","datasource"],onVariableUpdateCompleted:this.onVariableUpdatesCompleted.bind(this),onAnyVariableChanged:this.onAnyVariableChanged.bind(this)})),nj(this,"onDataReceived",(t=>{const n=(0,e.preProcessPanelData)(t,this.state.data);this._resultAnnotations=t.annotations;const r=this._combineDataLayers(n);let a=this.state._hasFetchedData;a||n.state===Ie.Loading||(a=!0),this.setState({data:r,_hasFetchedData:a}),this._results.next({origin:this,data:r})})),this.addActivationHandler((()=>this._onActivate()))}}function lj(e){var t,n;return null!==(n=null===(t=e.find((e=>null!==e.datasource)))||void 0===t?void 0:t.datasource)&&void 0!==n?n:void 0}function uj(e){if(!e)return!0;for(let t=0;t<e.length;t++)if(e[t].length>0)return!1;return!0}function cj(e,t){return e===t||(0,be.isEqual)(e,t)}function dj(e){try{return JSON.stringify(e,(()=>{const e=new WeakSet;return(t,n)=>{if("object"==typeof n&&null!==n){if(e.has(n))return;e.add(n)}return n}})())}catch(e){console.error(e)}return""}function pj(e){return e.map((e=>function(e){let t="",n=e.operator;var r;if("=|"===n)n="=~",t=null===(r=e.values)||void 0===r?void 0:r.map(hj).join("|");else if("!=|"===n){var a;n="!~",t=null===(a=e.values)||void 0===a?void 0:a.map(hj).join("|")}else t="=~"===n||"!~"===n?hj(e.value):fj(e.value);return`${e.key}${n}"${t}"`}(e))).join(",")}function fj(e){return e.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function hj(e){return fj(function(e){return e.replace(mj,"\\$&")}(e))}const mj=/[*+?()|\\.\[\]{}^$]/g;function gj(e){const t=function(e){const t={};for(const n of e)n.state.key&&(n.state.key in t||(t[n.state.key]=[]),t[n.state.key].push(n));return Object.values(t).flatMap((e=>{const t=e.filter((e=>e.isActive));return 0===t.length&&1===e.length?e:t}))}(Wj.findAllObjects(e.getRoot(),(e=>e instanceof sj))).filter((t=>{var n,r;return(null===(n=t.state.datasource)||void 0===n?void 0:n.uid)===(null===(r=e.state.datasource)||void 0===r?void 0:r.uid)}));if(0===t.length)return[];const n=[];return t.forEach((e=>{n.push(...e.state.queries)})),n}function bj(e){return null==e?"":/\|/g[Symbol.replace](e,"__gfp__")}function yj(e){return null==e?"":/,/g[Symbol.replace](e,"__gfc__")}function vj(e){return null==e?"":(e=/__gfp__/g[Symbol.replace](e,"|"),e=/__gfc__/g[Symbol.replace](e,","))}function wj(e,t){return t&&e!==t?[e,t].map(yj).join(","):yj(e)}function Oj(e){return Array.isArray(e)?e:e.data}function Sj(e){return!Array.isArray(e)&&Boolean(e.error)}function _j(e){const t=[],n=new Map;for(const r of e){const e=r.group;if(e){let a=n.get(e);a||(a=[],n.set(e,a),t.push({label:e,options:a})),a.push(r)}else t.push(r)}return t}function xj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Pj{hasDependencyOn(e){return this.getNames().has(e)}variableUpdateCompleted(t,n){const r=this.getNames();let a=!1;(r.has(t.state.name)||r.has(e.DataLinkBuiltInVars.includeVars))&&n&&(a=!0),yx("VariableDependencyConfig","variableUpdateCompleted",t.state.name,a,this._isWaitingForVariables),this._options.onAnyVariableChanged&&this._options.onAnyVariableChanged(t),this._options.onVariableUpdateCompleted&&(this._isWaitingForVariables||a)&&this._options.onVariableUpdateCompleted(),a&&(this._options.onReferencedVariableValueChanged&&this._options.onReferencedVariableValueChanged(t),this._options.onReferencedVariableValueChanged||this._options.onVariableUpdateCompleted||this._sceneObject.forceRender())}hasDependencyInLoadingState(){return Wj.hasVariableDependencyInLoadingState(this._sceneObject)?(this._isWaitingForVariables=!0,!0):(this._isWaitingForVariables=!1,!1)}getNames(){const e=this._state,t=this._state=this._sceneObject.state;if(!e)return this.scanStateForDependencies(this._state),this._dependencies;if(t!==e)if(this._statePaths){for(const n of this._statePaths)if("*"===n||t[n]!==e[n]){this.scanStateForDependencies(t);break}}else this.scanStateForDependencies(t);return this._dependencies}setVariableNames(e){this._options.variableNames=e,this.scanStateForDependencies(this._state)}setPaths(e){this._statePaths=e}scanStateForDependencies(e){if(this._dependencies.clear(),this.scanCount+=1,this._options.variableNames)for(const e of this._options.variableNames)this._dependencies.add(e);if(this._statePaths)for(const t of this._statePaths){if("*"===t){this.extractVariablesFrom(e);break}{const n=e[t];n&&this.extractVariablesFrom(n)}}}extractVariablesFrom(e){Z_.lastIndex=0;const t=("string"!=typeof e?dj(e):e).matchAll(Z_);if(t)for(const e of t){const[,t,n,,r]=e,a=t||n||r;this._dependencies.add(a)}}constructor(e,t){xj(this,"_sceneObject",void 0),xj(this,"_options",void 0),xj(this,"_state",void 0),xj(this,"_dependencies",void 0),xj(this,"_statePaths",void 0),xj(this,"_isWaitingForVariables",void 0),xj(this,"scanCount",void 0),this._sceneObject=e,this._options=t,this._dependencies=new Set,this._isWaitingForVariables=!1,this.scanCount=0,this._statePaths=t.statePaths}}const jj=e=>Boolean(e.metricFindQuery)&&!Boolean(e.variables),Cj=t=>{if(!t.variables)return!1;if(t.variables.getType()!==e.VariableSupportType.Standard)return!1;const n=t.variables;return"toDataQuery"in n&&Boolean(n.toDataQuery)},Ej=t=>{if(!t.variables)return!1;if(t.variables.getType()!==e.VariableSupportType.Custom)return!1;const n=t.variables;return"query"in n&&"editor"in n&&Boolean(n.query)&&Boolean(n.editor)};function Dj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Dj(e,t,n[t])}))}return e}function Tj(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}class Rj{getTarget(e){if(Cj(this.datasource))return this.datasource.variables.toDataQuery(function(e){var t;const n=null!==(t=e.state.query)&&void 0!==t?t:"";return"string"==typeof n?{query:n,refId:`variable-${e.state.name}`}:null==n.refId?Tj(kj({},n),{refId:`variable-${e.state.name}`}):e.state.query}(e));throw new Error("Couldn't create a target with supplied arguments.")}runRequest(e,t){return Cj(this.datasource)?this.datasource.variables.query?this._runRequest(this.datasource,t,this.datasource.variables.query.bind(this.datasource.variables)):this._runRequest(this.datasource,t):Vj()}constructor(e,t=(0,d.getRunRequest)()){Dj(this,"datasource",void 0),Dj(this,"_runRequest",void 0),this.datasource=e,this._runRequest=t}}class Aj{getTarget(e){if(jj(this.datasource))return e.state.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({variable:t,searchFilter:n},r){return jj(this.datasource)?(0,k.from)(this.datasource.metricFindQuery(t.state.query,Tj(kj({},r),{variable:{name:t.state.name,type:t.state.type},searchFilter:n}))).pipe((0,k.mergeMap)((t=>{if(!t||!t.length)return Vj();const n=t;return(0,k.of)({series:n,state:e.LoadingState.Done,timeRange:r.range})}))):Vj()}constructor(e){Dj(this,"datasource",void 0),this.datasource=e}}class Ij{getTarget(e){if(Ej(this.datasource))return e.state.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest(e,t){return Ej(this.datasource)?this.datasource.variables.query?this._runRequest(this.datasource,t,this.datasource.variables.query.bind(this.datasource.variables)):this._runRequest(this.datasource,t):Vj()}constructor(e,t=(0,d.getRunRequest)()){Dj(this,"datasource",void 0),Dj(this,"_runRequest",void 0),this.datasource=e,this._runRequest=t}}function Vj(){return(0,k.of)({state:e.LoadingState.Done,series:[],timeRange:(0,e.getDefaultTimeRange)()})}const Mj=(e,t)=>{const n=[];let r=null;t.lastIndex=0;do{r=t.exec(e),r&&n.push(r)}while(t.global&&r&&""!==r[0]&&void 0!==r[0]);return n};function Fj(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function Lj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class $j extends rx{getValueOptions(t){return this.state.query?(this.setState({loading:!0,error:null}),(0,k.from)(Ox(this.state.datasource,{__sceneObject:Yx(this)})).pipe((0,k.mergeMap)((n=>{const r=function(e){if(Cj(e))return new Rj(e,(0,d.getRunRequest)());if(jj(e))return new Aj(e);if(Ej(e))return new Ij(e);throw new Error(`Couldn't create a query runner for datasource ${e.type}`)}(n),a=r.getTarget(this),o=this.getRequest(a,t.searchFilter);return r.runRequest({variable:this,searchFilter:t.searchFilter},o).pipe(Ax({type:"variable",request:o,origin:this}),(0,k.filter)((t=>t.state===e.LoadingState.Done||t.state===e.LoadingState.Error)),(0,k.take)(1),(0,k.mergeMap)((t=>t.state===e.LoadingState.Error?(0,k.throwError)((()=>t.error)):(0,k.of)(t))),(t=>t.pipe((0,k.map)((t=>{const n=t.series;if(!n||!n.length)return[];if(function(t){if(!t)return!1;if(!t.length)return!0;const n=t[0];if((0,e.isDataFrame)(n))return!1;for(const e in n){if(!n.hasOwnProperty(e))continue;if(null!==n[e]&&"string"!=typeof n[e]&&"number"!=typeof n[e])continue;const t=e.toLowerCase();if("text"===t||"value"===t)return!0}return!1}(n))return n;if(0===n[0].fields.length)return[];const r=(0,e.getProcessedDataFrames)(n),a=[];let o=-1,i=-1,s=-1,l=-1;for(const t of r)for(let r=0;r<t.fields.length;r++){const a=t.fields[r],u=(0,e.getFieldDisplayName)(a,t,n).toLowerCase();a.type===e.FieldType.string&&-1===s&&(s=r),"text"===u&&a.type===e.FieldType.string&&-1===i&&(i=r),"value"===u&&a.type===e.FieldType.string&&-1===o&&(o=r),"expandable"!==u||a.type!==e.FieldType.boolean&&a.type!==e.FieldType.number||-1!==l||(l=r)}if(-1===s)throw new Error("Couldn't find any field of type string in the results.");for(const e of n)for(let t=0;t<e.length;t++){const n=-1!==l?e.fields[l].values.get(t):void 0,r=e.fields[s].values.get(t),u=-1!==i?e.fields[i].values.get(t):null,c=-1!==o?e.fields[o].values.get(t):null;-1!==o||-1!==i?-1!==o||-1===i?-1===o||-1!==i?a.push({text:u,value:c,expandable:n}):a.push({text:c,value:c,expandable:n}):a.push({text:u,value:u,expandable:n}):a.push({text:r,value:r,expandable:n})}return a})))),(0,k.mergeMap)((t=>{let n="";return this.state.regex&&(n=Wj.interpolate(this,this.state.regex,void 0,"regex")),(0,k.of)(((t,n,r)=>{let a,o=[];t&&(a=(0,e.stringToJsRegex)(t));for(let e=0;e<r.length;e++){const t=r[e];let n=void 0===t.text||null===t.text?t.value:t.text,g=void 0===t.value||null===t.value?t.text:t.value;if((0,be.isNumber)(g)&&(g=g.toString()),(0,be.isNumber)(n)&&(n=n.toString()),a){const e=Mj(g,a);if(!e.length)continue;const t=e.find((e=>e.groups&&e.groups.value)),r=e.find((e=>e.groups&&e.groups.text)),b=e.find((e=>e.length>1)),y=e.length>1&&b;if(t||r){var i,s,l,u,c,d,p,f,h,m;g=null!==(h=null===(s=t)||void 0===s||null===(i=s.groups)||void 0===i?void 0:i.value)&&void 0!==h?h:null===(u=r)||void 0===u||null===(l=u.groups)||void 0===l?void 0:l.text,n=null!==(m=null===(d=r)||void 0===d||null===(c=d.groups)||void 0===c?void 0:c.text)&&void 0!==m?m:null===(f=t)||void 0===f||null===(p=f.groups)||void 0===p?void 0:p.value}else{if(y){for(let t=0;t<e.length;t++){const n=e[t];o.push({label:n[1],value:n[1]})}continue}b&&(n=b[1],g=b[1])}}o.push({label:n,value:g})}return o=(0,be.uniqBy)(o,"value"),((t,n)=>{if(n===e.VariableSort.disabled)return t;const r=e=>{if(!e.text)return-1;const t=e.text.match(/.*?(\d+).*/);return!t||t.length<2?-1:parseInt(t[1],10)},a=e=>e.sort(((e,t)=>e.text?t.text?e.text.localeCompare(t.text,void 0,{numeric:!0}):1:-1));switch(n){case e.VariableSort.alphabeticalAsc:t=(0,be.sortBy)(t,"label");break;case e.VariableSort.alphabeticalDesc:t=(0,be.sortBy)(t,"label").reverse();break;case e.VariableSort.numericalAsc:t=(0,be.sortBy)(t,r);break;case e.VariableSort.numericalDesc:t=(t=(0,be.sortBy)(t,r)).reverse();break;case e.VariableSort.alphabeticalCaseInsensitiveAsc:t=(0,be.sortBy)(t,(e=>(0,be.toLower)(e.label)));break;case e.VariableSort.alphabeticalCaseInsensitiveDesc:t=(t=(0,be.sortBy)(t,(e=>(0,be.toLower)(e.label)))).reverse();break;case e.VariableSort.naturalAsc||7:t=a(t);break;case e.VariableSort.naturalDesc||8:t=(t=a(t)).reverse()}return t})(o,n)})(n,this.state.sort,t))})),(0,k.catchError)((e=>e.cancelled?(0,k.of)([]):(0,k.throwError)((()=>e)))))})))):(0,k.of)([])}getRequest(t,n){const r={__sceneObject:Yx(this)};n&&(r.__searchFilter={value:n,text:n});const a=Wj.getTimeRange(this).state.value;return{app:e.CoreApp.Dashboard,requestId:M(),timezone:"",range:a,interval:"",intervalMs:0,targets:[t],scopedVars:r,startTime:Date.now()}}constructor(t){super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Lj(e,t,n[t])}))}return e}({type:"query",name:"",value:"",text:"",options:[],datasource:null,regex:"",query:"",refresh:e.VariableRefresh.onDashboardLoad,sort:e.VariableSort.disabled},t)),Lj(this,"_variableDependency",new Pj(this,{statePaths:["regex","query","datasource"]})),Lj(this,"onSearchChange",(e=>{dj(this.state.query).indexOf("__searchFilter")>-1&&this._updateOptionsBasedOnSearchFilter(e)}));var n=this;Lj(this,"_updateOptionsBasedOnSearchFilter",(0,be.debounce)(function(){var e,t=(e=function*(e){const t=yield(0,k.lastValueFrom)(n.getValueOptions({searchFilter:e}));n.setState({options:t,loading:!1})},function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){Fj(o,r,a,i,s,"next",e)}function s(e){Fj(o,r,a,i,s,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),400))}}function Nj(e){var t;return null!==(t=dv(e,(e=>e.state.$data)))&&void 0!==t?t:T_}function Bj(e,t,n,r,a){return""===t||null==t?"":gx(e,t,n,r,a)}function zj(e,t,n,r){if(t(e))return e;let a=null;return e.forEachChild((e=>{if(e===n)return;let r=zj(e,t);r&&(a=r)})),a||(r&&e.parent?zj(e.parent,t,e,!0):null)}function qj(e,t){return zj(e,t,void 0,!0)}function Hj(e,t){const n=[];return e.forEachChild((e=>{t(e)&&n.push(e),n.push(...Hj(e,t))})),n}Lj($j,"Component",(({model:e})=>function(e){return e.state.isMulti?r().createElement(Bx,{model:e}):r().createElement(Nx,{model:e})}(e)));const Wj={getVariables:function(e){var t;return null!==(t=dv(e,(e=>e.state.$variables)))&&void 0!==t?t:A_},getData:Nj,getTimeRange:I_,getLayout:function(e){return dv(e,(e=>function(e){return"isDraggable"in e}(e)?e:void 0))||null},getDataLayers:function(e,t=!1){let n=e,r=[];for(;n;){const e=n.state.$data;if(e){if(bx(e)?r=r.concat(e):e.state.$data&&bx(e.state.$data)&&(r=r.concat(e.state.$data)),t&&r.length>0)break;n=n.parent}else n=n.parent}return r},interpolate:Bj,lookupVariable:O_,hasVariableDependencyInLoadingState:function(e){if(!e.variableDependency)return!1;for(const t of e.variableDependency.getNames()){if(e instanceof $j&&e.state.name===t){console.warn("Query variable is referencing itself");continue}const n=O_(t,e);if(n&&n.parent.isVariableLoadingOrWaitingToUpdate(n))return!0}return!1},findByKey:function(e,t){const n=qj(e,(e=>e.state.key===t));if(!n)throw new Error("Unable to find scene with key "+t);return n},findByKeyAndType:function(e,t,n){const r=qj(e,(e=>e.state.key===t));if(!r)throw new Error("Unable to find scene with key "+t);if(!(r instanceof n))throw new Error(`Found scene object with key ${t} does not match type ${n.name}`);return r},findObject:qj,findAllObjects:Hj,getAncestor:function(e,t){let n=e;for(;n;){if(n instanceof t)return n;n=n.parent}if(!n)throw new Error("Unable to find parent of type "+t.name);return n},findDescendents:function(e,t){function n(e){return e instanceof t}return Hj(e,n).filter(n)},getQueryController:function(e){let t=e;for(;t;){if(t.state.$behaviors)for(const e of t.state.$behaviors)if("isQueryController"in e)return e;t=t.parent}},getUrlSyncManager:function(e){let t=e;for(;t;){if("urlSyncManager"in t.state)return t.state.urlSyncManager;t=t.parent}}};class Uj extends e.BusEventWithPayload{}function Gj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qj(e){return new Ig((t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Gj(e,t,n[t])}))}return e}({},e),n=null!=(n={subTitle:"A simple demo stress testing url sync",$timeRange:new Xe,controls:[new cm({}),new xm({})],$data:Kb({},{maxDataPoints:50}),tabs:[new Ig({title:"First",url:`${e.url}/first`,getScene:()=>new nh({controls:[new ef({})],$variables:new of({variables:[new hf({name:"env",query:"test, dev, prod"})]}),body:new Gm({direction:"column",children:[new Qm({body:Fb.timeseries().setTitle("Fill height").build()}),new Qm({body:new Kj({})})]})})}),new Ig({title:"Second",url:`${e.url}/manual`,getScene:()=>new nh({controls:[new ef({})],$variables:new of({variables:[new hf({name:"env",query:"test, dev, prod"})]}),body:new Gm({direction:"column",children:[new Qm({body:Fb.timeseries().setTitle("Fill height").build()})]})})})]})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t));var t,n}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Uj,"type","new-scene-object-added");class Kj extends ae{addScene(){const e=new im({controls:[new Um,new ef({}),new cm({}),new xm({})],$timeRange:new Xe,$variables:new of({variables:[new hf({name:"env",query:"test, dev, prod",label:"env (local scene override)"})]}),$data:Kb({},{maxDataPoints:50}),title:"Nested scene added on parent activation",body:new Gm({direction:"column",children:[new Qm({body:Fb.timeseries().setTitle("Fill height").build()})]})});this.publishEvent(new Uj(e),!0),this.setState({scene:e})}constructor(e){super(e),Gj(this,"onToggle",(()=>{this.state.scene?this.setState({scene:void 0}):this.addScene()})),this.addActivationHandler((()=>{this.addScene()}))}}Gj(Kj,"Component",(({model:e})=>{const{scene:t}=e.useState();return r().createElement(Sn.Stack,{direction:"column",flex:"1"},r().createElement(Sn.Button,{variant:"secondary",onClick:e.onToggle},"Toggle sub view"),t&&r().createElement(t.Component,{model:t}))}));var Yj=f(362),Zj=Object.defineProperty,Xj=Object.defineProperties,Jj=Object.getOwnPropertyDescriptors,eC=Object.getOwnPropertySymbols,tC=Object.prototype.hasOwnProperty,nC=Object.prototype.propertyIsEnumerable,rC=(e,t,n)=>t in e?Zj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,aC=(e,t)=>{for(var n in t||(t={}))tC.call(t,n)&&rC(e,n,t[n]);if(eC)for(var n of eC(t))nC.call(t,n)&&rC(e,n,t[n]);return e},oC=(e,t)=>Xj(e,Jj(t));const iC=[{label:"1x",value:1},{label:"4x",value:4},{label:"10x",value:10}];class sC extends ae{constructor(e){super(aC({trainingLookbackFactorOptions:iC},e)),this._urlSync=new ze(this,{keys:["discoverSeasonalities","interval","trainingLookbackFactor"]})}getExtraQueries(t){var n;const r=[];if(this.state.interval){const{to:a,from:o}=t.range,i=a.diff(o),s=(0,e.dateTime)(a).subtract(null!=(n=this.state.trainingLookbackFactor)?n:4*i);r.push({req:oC(aC({},t),{range:{from:s,to:a,raw:{from:s,to:a}}}),processor:lC(this)})}return r}shouldRerun(e,t){const n=void 0!==e.interval,r=void 0!==t.interval;return!(t.pinned&&r||n===r&&e.trainingLookbackFactor===t.trainingLookbackFactor&&e.interval===t.interval&&e.discoverSeasonalities===t.discoverSeasonalities&&e.pinned===t.pinned)}getUrlState(){var e,t,n;return{interval:null==(e=this.state.interval)?void 0:e.toString(),discoverSeasonalities:null==(t=this.state.discoverSeasonalities)?void 0:t.toString(),trainingLookbackFactor:null==(n=this.state.trainingLookbackFactor)?void 0:n.toString()}}onIntervalChanged(e){this.setState({interval:e})}onDiscoverSeasonalitiesChanged(e){this.setState({discoverSeasonalities:e})}onFactorChanged(e){this.setState({trainingLookbackFactor:e})}onClearFactor(){this.setState({trainingLookbackFactor:void 0})}onPinnedChanged(e){this.setState({pinned:e})}setLatestData(e){this.latestData=e}updateFromUrl(e){if(!e.trainingLookbackFactor&&!e.interval)return;let t,n,r;"string"==typeof e.trainingLookbackFactor?t=parseInt(e.trainingLookbackFactor,10):e.trainingLookbackFactor instanceof Array&&(t=parseInt(e.trainingLookbackFactor[0],10)),"string"==typeof e.interval?n=parseInt(e.interval,10):e.interval instanceof Array&&(n=parseInt(e.interval[0],10)),"string"==typeof e.discoverSeasonalities?r="true"===e.discoverSeasonalities:e.discoverSeasonalities instanceof Array&&(r="true"===e.discoverSeasonalities[0]);const a={};t&&(iC.find((({value:e})=>e===t))?a.trainingLookbackFactor=t:a.trainingLookbackFactor=4),a.interval=n||.95,a.discoverSeasonalities=r||!1,this.setState(a)}}sC.Component=function({model:e}){const t=(0,Sn.useStyles2)(fC),{discoverSeasonalities:n,interval:a,pinned:o}=e.useState(),i=()=>{e.onIntervalChanged(void 0===a?.95:void 0),void 0!==a&&e.onPinnedChanged(!1)},s=void 0===a||o?(0,Pn.cx)(t.slider,t.disabled):t.slider;return r().createElement(Sn.ButtonGroup,null,r().createElement(Sn.ToolbarButton,{variant:"canvas",tooltip:"Enable baselining",onClick:e=>{e.stopPropagation(),e.preventDefault(),i()}},r().createElement(Sn.Checkbox,{label:" ",value:void 0!==a,onClick:i}),"Baseline"),r().createElement("div",{className:s},r().createElement(Sn.Slider,{onAfterChange:t=>{e.onIntervalChanged(t)},min:.01,max:.99,step:.01,value:null!=a?a:.95})),r().createElement(Sn.ToolbarButton,{variant:"canvas",disabled:void 0===a||o,tooltip:"Discover seasonalities",onClick:t=>{t.stopPropagation(),t.preventDefault(),e.onDiscoverSeasonalitiesChanged(!n)},isHighlighted:null!=n&&n,icon:"gf-interpolation-smooth",iconSize:"sm",iconOnly:!0,className:t.discoverSeasonalitiesButton}),r().createElement(Sn.ToolbarButton,{disabled:void 0===a,variant:"canvas",tooltip:"Pin baseline results",onClick:t=>{t.stopPropagation(),t.preventDefault(),e.onPinnedChanged(!o)},isHighlighted:null!=o&&o,icon:"gf-pin",iconSize:"sm",iconOnly:!0}))};const lC=t=>(n,r)=>{if(void 0===t.state.interval)return(0,k.of)(r);if(t.state.pinned&&t.latestData)return(0,k.of)(t.latestData);const{interval:a,discoverSeasonalities:o,onAnomalyDetected:i}=t.state,s=yu.getTimeRange(t),l=r.series.map((t=>{const n=function(t,n,r,a=!1,o,i){var s,l;const u=function(t){const n=t.fields.findIndex((t=>t.type===e.FieldType.time)),r=t.fields.findIndex((t=>t.type===e.FieldType.number));return!(t.fields.length<2||t.fields[0].values.length<10||-1===n||-1===r)&&{numFieldIdx:r,timeFieldIdx:n}}(t);if(!u)return t;const c=t.fields[u.numFieldIdx],d=t.fields[u.timeFieldIdx],p=d.values.at(-1)-d.values.at(0),f=d.values.at(1)-d.values.at(0),h=new Float64Array(c.values),m=a?Array.from((0,Yj.Cy)(h)):[],g=new Uint32Array([...cC(p,f,r),...m]);if(0===g.length)return t;const b=(0,Yj.BM)(g,{impute:!0});b.fit(h);const y=b.predictInSample(n);let v=Array.from(y.point),w=y.intervals?Array.from(y.intervals.lower):void 0,O=y.intervals?Array.from(y.intervals.upper):void 0,S=p/f+1,_=dC(S,f,d.values.at(0));if(void 0!==o){const{from:e,to:t}=o,r=_.findIndex((t=>t>=e.valueOf()));let a=_.findIndex((e=>e>=t.valueOf()));-1===a&&(a=_.length);const i=a-r;S=(t.valueOf()-e.valueOf())/f+1;const s=S-i;if(_=_.slice(r,a),v=v.slice(r,a),w=w?w.slice(r,a):void 0,O=O?O.slice(r,a):void 0,s>0){const e=b.predict(s,n);_=dC(S,f,_[0]),v=v.concat(Array.from(e.point)),w&&O&&e.intervals&&(w=w.concat(Array.from(e.intervals.lower)),O=O.concat(Array.from(e.intervals.upper)))}}if(void 0!==i&&w&&O)for(let e=0;e<v.length;e++){const t=v[e],n=w[e],r=O[e];t<n?i({direction:"lower",idx:e,time:_[e],field:c}):t>r&&i({direction:"upper",idx:e,time:_[e],field:c})}return{fields:pC(null!=(l=null!=(s=c.config.displayNameFromDS)?s:t.name)?l:c.name,d,_,v,w,O),length:_.length}}(t,a,void 0,o,s.state.value,i);return oC(aC({},t),{meta:oC(aC({},t.meta),{baseline:{isBaselineTrainingQuery:!0,origRefId:t.refId}}),refId:`${t.refId}-baseline-training`,fields:n.fields})})),u=oC(aC({},r),{series:l});return t.setLatestData(u),(0,k.of)(u)},uC=Object.values({hourly:36e5,daily:864e5,weekly:6048e5,yearly:31536e6});function cC(t,n,r){const a=(null!=r?r:[]).map((t=>(0,e.durationToMilliseconds)(t)));return uC.concat(a).filter((e=>e<t/2)).map((e=>Math.floor(e/n))).filter((e=>e>1))}function dC(e,t,n){return Array.from({length:e},((e,r)=>r*t+n))}function pC(t,n,r,a,o,i){const s=[oC(aC({},n),{values:r}),{name:`${t} - baseline`,type:e.FieldType.number,values:a,config:{displayNameFromDS:`${t} - baseline`,color:{fixedColor:"blue",mode:Eu.Fixed}}}];return o&&i&&(s.push({name:`${t} - lower`,type:e.FieldType.number,values:o,config:{displayNameFromDS:`${t} - lower`,color:{fixedColor:"blue",mode:Eu.Fixed},custom:{lineWidth:1,hideFrom:{viz:!1,tooltip:!1,legend:!0}}}}),s.push({name:`${t} - upper`,type:e.FieldType.number,values:i,config:{displayNameFromDS:`${t} - upper`,color:{fixedColor:"blue",mode:Eu.Fixed},custom:{fillBelowTo:`${t} - lower`,lineWidth:1,hideFrom:{viz:!1,tooltip:!1,legend:!0}}}})),s}function fC(e){return{disabled:Pn.css`
      & > div {
        opacity: 0.2;
      }
    `,slider:Pn.css`
      display: flex;
      width: 120px;
      align-items: center;
      border: 1px solid ${e.colors.secondary.border};
      & > div {
        .rc-slider {
          margin: auto 16px;
        }
        .rc-slider + div {
          display: none;
        }
      }
    `,discoverSeasonalitiesButton:Pn.css`
      padding-left: calc(1px / 8);
      padding-right: 1px;
    `}}var hC=Object.defineProperty,mC=Object.defineProperties,gC=Object.getOwnPropertyDescriptors,bC=Object.getOwnPropertySymbols,yC=Object.prototype.hasOwnProperty,vC=Object.prototype.propertyIsEnumerable,wC=(e,t,n)=>t in e?hC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,OC=(e,t)=>{for(var n in t||(t={}))yC.call(t,n)&&wC(e,n,t[n]);if(bC)for(var n of bC(t))vC.call(t,n)&&wC(e,n,t[n]);return e};const SC=[{label:"1x",value:1},{label:"4x",value:4},{label:"10x",value:10}];class _C extends ae{constructor(e){super(OC({lookbackFactorOptions:SC},e)),this._urlSync=new ze(this,{keys:["changepointLookbackFactor","changepointEnabled"]})}getExtraQueries(t){var n;const r=[];if(this.state.enabled){const{to:i,from:s}=t.range,l=i.diff(s),u=(0,e.dateTime)(i).subtract(null!=(n=this.state.lookbackFactor)?n:4*l);r.push({req:(a=OC({},t),o={range:{from:u,to:i,raw:{from:u,to:i}}},mC(a,gC(o))),processor:xC(this)})}var a,o;return r}shouldRerun(e,t){return e.enabled!==t.enabled}getUrlState(){var e,t;return{changepointLookbackFactor:null==(e=this.state.lookbackFactor)?void 0:e.toString(),changepointEnabled:null==(t=this.state.enabled)?void 0:t.toString()}}onEnabledChanged(e){this.setState({enabled:e})}onFactorChanged(e){this.setState({lookbackFactor:e})}onClearFactor(){this.setState({lookbackFactor:void 0})}updateFromUrl(e){if(!e.changepointLookbackFactor&&!e.changepointEnabled)return;let t,n;"string"==typeof e.changepointLookbackFactor?t=parseInt(e.changepointLookbackFactor,10):e.changepointLookbackFactor instanceof Array&&(t=parseInt(e.changepointLookbackFactor[0],10)),"string"==typeof e.changepointEnabled?n="true"===e.changepointEnabled:"number"==typeof e.changepointEnabled&&(n=1===e.changepointEnabled);const r={};t&&(SC.find((({value:e})=>e===t))?r.lookbackFactor=t:r.lookbackFactor=4),n&&(r.enabled=n),this.setState(r)}}_C.Component=function({model:e}){const{enabled:t}=e.useState(),n=t=>{e.onEnabledChanged(t)};return r().createElement(Sn.ButtonGroup,null,r().createElement(Sn.ToolbarButton,{variant:"canvas",tooltip:"Enable changepoint detection",onClick:e=>{e.stopPropagation(),e.preventDefault(),n(!t)}},r().createElement(Sn.Checkbox,{label:" ",value:null!=t&&t,onClick:()=>n(!t)}),"Changepoints"))};const xC=t=>(n,r)=>{const a=r.series.map((n=>function(t,n){const r=[],a=[],o=t.fields.find((t=>t.type===e.FieldType.time));if(!o)return{fields:[],length:0};for(const i of t.fields){if(i.type!==e.FieldType.number)continue;const t=Yj.BI.defaultArgpcp(),s=new Float64Array(i.values),l=t.detectChangepoints(s);for(const e of l.indices){const t=o.values[e+1];r.push(t),a.push("Changepoint detected"),null==n||n({idx:e+1,time:t,field:i})}}return{fields:[{name:"time",type:e.FieldType.time,values:r,config:{}},{name:"text",type:e.FieldType.string,values:a,config:{}}],length:r.length,meta:{dataTopic:ve.Annotations}}}(n,t.state.onChangepointDetected)));return(0,k.of)({timeRange:r.timeRange,series:[],state:r.state,annotations:a})};var PC=Object.defineProperty,jC=Object.defineProperties,CC=Object.getOwnPropertyDescriptors,EC=Object.getOwnPropertySymbols,DC=Object.prototype.hasOwnProperty,kC=Object.prototype.propertyIsEnumerable,TC=(e,t,n)=>t in e?PC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,RC=(e,t)=>{for(var n in t||(t={}))DC.call(t,n)&&TC(e,n,t[n]);if(EC)for(var n of EC(t))kC.call(t,n)&&TC(e,n,t[n]);return e},AC=(e,t)=>jC(e,CC(t));class IC extends ae{constructor(e){super(e),this._urlSync=new ze(this,{keys:["outlierSensitivity","outlierAddAnnotations"]})}onSensitivityChanged(e){this.setState({sensitivity:e})}onAddAnnotationsChanged(e){this.setState({addAnnotations:e})}onPinnedChanged(e){this.setState({pinned:e})}setLatestData(e){this.latestData=e}getExtraQueries(t){const{sensitivity:n}=this.state;return void 0===n?[]:[{req:AC(RC({},t),{targets:[]}),processor:(t,r)=>{var a,o,i;if(this.state.pinned&&void 0!==this.latestData)return(0,k.of)(this.latestData);const s=t.series,l=(0,e.outerJoinDataFrames)({frames:s});if(void 0===l)return(0,k.of)(t);void 0!==this.detector&&(null==(a=t.request)?void 0:a.requestId)===this.lastRequestId?this.detector.updateDetector({dbscan:{sensitivity:n}}):this.detector=function(t,n){const r=t.fields.filter((t=>t.type===e.FieldType.number)),a=r[0].values.length,o=new Float64Array(r.flatMap((e=>e.values)));return Yj.qh.dbscan({sensitivity:n}).preprocess(o,a)}(l,n),this.lastRequestId=null==(o=t.request)?void 0:o.requestId;const u=function(t,n,r,a,o){var i,s;const l=r.fields.filter((t=>t.type===e.FieldType.number)),u=r.fields[0].values.length,c=t.detect();if(void 0!==o){const e=0;for(const t of c.seriesResults)for(const n of t.outlierIntervals)o({series:e,start:r.fields[0].values[n.start],end:r.fields[0].values[null!=(i=n.end)?i:u-1]})}const d=1/Math.sqrt(1+(null!=(s=l.length)?s:0)/2),p=e.colorManipulator.alpha("#FFFFFF",d),f=[];if(a){const t=c.seriesResults.flatMap((e=>e.outlierIntervals.map((e=>r.fields[0].values[e.start])))),n=c.seriesResults.flatMap((e=>e.outlierIntervals.map((e=>{var t;return r.fields[0].values[null!=(t=e.end)?t:u-1]})))),a=c.seriesResults.flatMap(((e,t)=>e.outlierIntervals.map((e=>`Outlier detected in series ${l[t].name}`))));f.push({fields:[{name:"time",type:e.FieldType.time,values:t,config:{}},{name:"timeEnd",type:e.FieldType.time,values:n,config:{}},{name:"text",type:e.FieldType.string,values:a,config:{}},{name:"isRegion",type:e.FieldType.boolean,values:Array(t.length).fill(!0),config:{}}],length:t.length,meta:{dataTopic:ve.Annotations}})}return AC(RC({},n),{series:[AC(RC({},r),{fields:[r.fields[0],...r.fields.slice(1).map(((e,t)=>AC(RC({},e),{config:RC(RC({},e.config),c.outlyingSeries.includes(t)?{color:{fixedColor:"#f5b73d",mode:Eu.Fixed}}:{color:{fixedColor:p,mode:Eu.Fixed}})}))),{name:"clusterMin",type:e.FieldType.number,values:c.clusterBand.min,config:{displayNameFromDS:"Cluster Min",color:{fixedColor:"gray",mode:Eu.Fixed},custom:{lineWidth:0,hideFrom:{viz:!1,tooltip:!1,legend:!0}}}},{name:"clusterMax",type:e.FieldType.number,values:c.clusterBand.max,config:{displayNameFromDS:"Cluster Max",color:{fixedColor:"gray",mode:Eu.Fixed},custom:{fillBelowTo:"Cluster Min",lineWidth:0,hideFrom:{viz:!1,tooltip:!1,legend:!0}}}}]})],annotations:f})}(this.detector,t,l,null==(i=this.state.addAnnotations)||i,this.state.onOutlierDetected);return this.setLatestData(u),(0,k.of)(u)}}]}shouldRerun(e,t){return!t.pinned&&(e.sensitivity!==t.sensitivity||e.addAnnotations!==t.addAnnotations||e.pinned!==t.pinned)}getUrlState(){var e,t;return{outlierSensitivity:null==(e=this.state.sensitivity)?void 0:e.toString(),outlierAddAnnotations:null==(t=this.state.addAnnotations)?void 0:t.toString()}}updateFromUrl(e){if(!e.outlierSensitivity&&!e.outlierAddAnnotations)return;let t,n;"string"==typeof e.outlierSensitivity&&(t=parseFloat(e.outlierSensitivity)),"string"==typeof e.outlierAddAnnotations&&(n="true"===e.outlierAddAnnotations);const r={};r.sensitivity=t||.5,r.addAnnotations=n||!0,this.setState(r)}}function VC(e){return{disabled:Pn.css`
      & > div {
        opacity: 0.2;
      }
    `,slider:Pn.css`
      display: flex;
      width: 120px;
      align-items: center;
      border: 1px solid ${e.colors.secondary.border};
      & > div {
        .rc-slider {
          margin: auto 16px;
        }
        .rc-slider + div {
          display: none;
        }
      }
    `}}function MC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){MC(e,t,n[t])}))}return e}IC.Component=function({model:e}){const t=(0,Sn.useStyles2)(VC),{addAnnotations:n,pinned:a,sensitivity:o}=e.useState(),i=()=>{e.onSensitivityChanged(void 0===o?.5:void 0)},s=void 0===o||a?(0,Pn.cx)(t.slider,t.disabled):t.slider;return r().createElement(Sn.ButtonGroup,null,r().createElement(Sn.ToolbarButton,{variant:"canvas",tooltip:"Enable outlier detection",onClick:e=>{e.stopPropagation(),e.preventDefault(),i()}},r().createElement(Sn.Checkbox,{label:" ",value:void 0!==o,onClick:i}),"Outliers"),r().createElement("div",{className:s},r().createElement(Sn.Slider,{onAfterChange:t=>{e.onSensitivityChanged(t)},min:.01,max:.99,step:.01,value:null!=o?o:.5})),r().createElement(Sn.ToolbarButton,{disabled:void 0===o||a,variant:"canvas",tooltip:"Add outlier annotations",onClick:t=>{t.stopPropagation(),t.preventDefault(),e.onAddAnnotationsChanged(!(null==n||n))},isHighlighted:null==n||n,icon:"ellipsis-v",iconSize:"sm",iconOnly:!0}),r().createElement(Sn.ToolbarButton,{disabled:void 0===o,variant:"canvas",tooltip:"Pin outlier detection results",onClick:t=>{t.stopPropagation(),t.preventDefault(),e.onPinnedChanged(!a)},isHighlighted:null!=a&&a,icon:"gf-pin",iconSize:"sm",iconOnly:!0}))},(0,Yj.ZP)().then((()=>console.debug("Grafana ML initialized")));const LC=[112,118,132,129,121,135,148,148,136,119,104,118,115,126,141,135,125,149,170,170,158,133,114,140,145,150,178,163,172,178,199,199,184,162,146,166,171,180,193,181,183,218,230,242,209,191,172,194,196,196,236,235,229,243,264,272,237,211,180,201,204,188,235,227,234,264,302,293,259,229,203,229,242,233,267,269,270,315,364,347,312,274,237,278,284,277,317,313,318,374,413,405,355,306,271,306,315,301,356,348,355,422,465,467,404,347,305,336,340,318,362,348,363,435,491,505,404,359,310,337,360,342,406,396,420,472,548,559,463,407,362,405,417,391,419,461,472,535,622,606,508,461,390,432,1e4,10001,1e4,10000.2].join(","),$C=[13067.3,13130.5,13198.4,13254.2,13303.7,13353.9,13409.3,13459.2,13504.5,13552.6,13614.3,13669.5,13722.6,13772.1,13832,13862.6,13893,13926.8,13968.9,14004.7,14033.1,14066,14110.1,14155.6,14192.2,14231.7,14281.5,14330.3,14359.3,14396.6,14430.8,14478.4,14515.7,14554.9,14602.5,14646.4,14695.4,14746.6,14807.4,14874.4,14923.3,14988.7,15054.1,15121.7,15184.2,15239.3,15288.9,15346.2,15393.5,15439,15483.5,15531.5,15579.4,15628.5,15677.3,15736.7,15788.3,15839.7,15900.6,15961.5,16018.3,16076.9,16139,16203,16263.3,16327.9,16398.9,16478.3,16538.2,16621.6,16697,16777.2,16833.1,16891.6,16956.8,17026.3,17085.4,17106.9,17169.4,17239.4,17292,17354.2,17414.2,17447.3,17482.6,17526,17568.7,17627.1,17661.5].join(","),NC=[10,7.4,7.166666666666667,8.666666666666666,6,7,7,8.857142857142858,14,11,15.714285714285714,14,15.833333333333334,12.833333333333334,14.714285714285714,13.833333333333334,16.5,13.833333333333334,12.5,11.285714285714286,11.2,9.5,14,13.833333333333334,12.25,12.666666666666666,12.857142857142858,14.833333333333334,14.125,14.714285714285714,16.2,16,16.285714285714285,18,17.428571428571427,16.625,16.666666666666668,15.6,14,15.428571428571429,15.25,15.875,15.333333333333334,16.285714285714285,17.333333333333332,19.166666666666668,14.428571428571429,13.666666666666666,15.6,15.857142857142858,17.714285714285715,20,20.5,17.428571428571427,16.857142857142858,16.875,17.857142857142858,20.8,19.428571428571427].join(","),BC=[Array.from({length:100},(()=>100*Math.random())),Array.from({length:100},(()=>100*Math.random())),[...Array.from({length:49},(()=>100*Math.random())),...Array.from({length:2},(()=>1e3*Math.random())),...Array.from({length:49},(()=>100*Math.random()))]];function zC(e,t){return new Pl(FC({queries:[{refId:"A",datasource:l,scenarioId:"predictable_csv_wave",csvWave:[FC({timeStep:600,valuesCSV:"0,0,0.5,1,2,2,1,1,0.5,0.3"},e)]}]},t))}function qC(e){return new Ig((t=FC({},e),n=null!=(n={subTitle:"Time series demos",getScene:()=>new nh({$data:zC({},{maxDataPointsFromWidth:!1}),$timeRange:new Xe({from:"now-48h",to:"now"}),controls:[new Um,new cm({}),new Nm({key:"top"})],key:"Flex layout embedded scene",body:new Gm({direction:"column",children:[new Gm({direction:"row",wrap:"wrap",children:[new Qm({minWidth:"100%",minHeight:300,body:Fb.timeseries().setTitle("Outlier data").setData(new Pl({queries:BC.map(((e,t)=>({refId:String.fromCharCode(65+t),datasource:l,scenarioId:"predictable_csv_wave",csvWave:[{timeStep:600,valuesCSV:e.join(",")}]}))),maxDataPointsFromWidth:!0})).setHeaderActions([new IC({sensitivity:.5})]).build()}),new Qm({minWidth:"100%",minHeight:300,body:Fb.timeseries().setTitle("Simple wave").setData(zC({},{maxDataPointsFromWidth:!0})).setHeaderActions([new sC({interval:.95})]).build()}),new Qm({minWidth:"100%",minHeight:300,body:Fb.timeseries().setTitle("Spikey data with changepoints").setData(zC({valuesCSV:LC},{maxDataPointsFromWidth:!0})).setHeaderActions([new sC({}),new _C({enabled:!0})]).build()}),new Qm({minWidth:"100%",minHeight:300,body:Fb.timeseries().setTitle("Realistic repeated series").setData(zC({valuesCSV:NC},{maxDataPointsFromWidth:!0})).setHeaderActions([new sC({interval:.95})]).build()}),new Qm({minWidth:"100%",minHeight:300,body:Fb.timeseries().setTitle("Sawtooth data").setData(zC({valuesCSV:$C},{maxDataPointsFromWidth:!0})).setHeaderActions([new sC({interval:.95})]).build()})]})]})})})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t));var t,n}function HC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){HC(e,t,n[t])}))}return e}function UC(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function GC(e){return new Ig(UC(WC({},e),{subTitle:"Illustrating how events traverse the scene graph",getScene:()=>{const e=Array.from("ABC"),t=new QC({key:"parentScene",children:[...e.map((e=>new QC({key:e}))),new QC({key:"SUB",children:e.map((e=>new QC({key:`SUB-${e}`})))})]});return new nh({key:"The Embedded Scene",body:t})}}))}class QC extends ae{constructor(e){const t=e.$behaviors||[],n=e.children||[];super(UC(WC({},e),{children:n,$behaviors:[...t,KC]}))}}HC(QC,"Component",(function({model:e}){var n,a;const{key:o,children:i,recentEvent:s}=e.useState(),[l,u]=r().useState(!1);(0,t.useEffect)((()=>e.subscribeToEvent(YC,(e=>{u(!0),setTimeout((()=>u(!1)),500)})).unsubscribe),[e,u]);const c=(0,Sn.useTheme2)(),d=null===(n=e.parent)||void 0===n?void 0:n.useState();return r().createElement("div",{style:{border:`${c.colors.border.strong} 4px solid`,borderRadius:8,padding:4,margin:8}},r().createElement("h2",null,"I am: ",r().createElement("em",null,o)),r().createElement("h4",null,"My parent is: ",r().createElement("em",null,null===(a=d)||void 0===a?void 0:a.key)),r().createElement(Sn.Stack,{direction:"column",alignItems:"flex-start"},r().createElement(Sn.Button,{fullWidth:!1,onClick:()=>e.publishEvent(new YC(`Bubble by ${o}`),!0)},"Bubble"),r().createElement(Sn.Button,{onClick:()=>e.publishEvent(new YC(`Non-bubble by ${o}`),!1)},"Non-Bubble"),r().createElement(Sn.Button,{onClick:()=>e.setState({recentEvent:""})},"Clear"),r().createElement(Sn.Button,{onClick:()=>yu.findDescendents(e,QC).forEach((e=>e.setState({recentEvent:""})))},"Clear Descendents")),r().createElement("div",{style:{margin:4,border:`${c.colors.border.weak} solid 2px`,transitionDuration:"200ms",background:l?c.colors.action.selected:c.colors.background.primary,transform:l?"scale(1.0, 1.5)":""}},s&&r().createElement(r().Fragment,null,r().createElement("h3",null,"Event:"),r().createElement("h5",null,s))),i.length>0&&r().createElement("div",{style:{border:`${c.colors.border.medium} 3px solid`,borderRadius:4,padding:4,margin:4,display:"inline-block"}},"Children of ",o,":",r().createElement(Sn.Stack,null,i.map((e=>r().createElement(e.Component,{key:e.state.key,model:e}))))))}));const KC=e=>{e.subscribeToEvent(YC,(t=>{e.setState({recentEvent:t.payload})}))};class YC extends e.BusEventWithPayload{}function ZC(){return[{title:"Flex layout",getPage:xy},{title:"Responsive layout",getPage:Pv},{title:"Panel menu",getPage:Wy},{title:"Panel context",getPage:By},{title:"Repeat layout by series",getPage:Ky},{title:"Repeat layout by variable",getPage:uS},{title:"Grid layout",getPage:Dy},{title:"Grid with rows",getPage:Ay},{title:"Lazy load",getPage:Fy},{title:"Variables",getPage:Tv},{title:"Adhoc filters",getPage:Kw},{title:"Group by (static)",getPage:eO},{title:"Group by (datasource)",getPage:aO},{title:"With drilldowns",getPage:Kv},{title:"Query editor",getPage:Ov},{title:"Dynamic page",getPage:yy},{title:"Runtime panel plugin",getPage:ry},{title:"Runtime data source plugin",getPage:fw},{title:"Behaviors demo",getPage:my},{title:"Time zones demo",getPage:Zv},{title:"Split layout",getPage:ow},{title:"Query cancellation",getPage:uw},{title:"Cursor sync",getPage:Bw},{title:"Time range comparison",getPage:Fw},{title:"Data layers",getPage:Ww},{title:"Dynamic data layers",getPage:yS},{title:"Transformations",getPage:lO},{title:"Dynamic panel options and field config",getPage:fO},{title:"Data filtering",getPage:_O},{title:"Docs examples",getPage:Vw},{title:"Nested scenes and variables",getPage:kO},{title:"CSS Grid Layout",getPage:FO},{title:"Panel header actions",getPage:qO},{title:"Vertical controls layout",getPage:tS},{title:"Interactive table with expandable rows",getPage:oS},{title:"Query controller demo",getPage:fS},{title:"Interop with hooks and context",getPage:v_},{title:"Url sync test",getPage:Qj},{title:"Machine Learning",getPage:qC},{title:"Events on the Scene Graph",getPage:GC}].sort(((e,t)=>e.title.localeCompare(t.title)))}function XC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JC(){return new gg({name:"scenes-demos-app",urlSyncOptions:{updateUrlOnInit:!0,createBrowserHistorySteps:!0},pages:[new Ig({title:"Demos",key:"SceneAppPage Demos",url:u(s.Demos),preserveUrlKeys:[],getScene:()=>new nh({key:"Demos EmbeddedScene",body:new tE}),drilldowns:[{routePath:`${c(":demo")}`,getPage:(e,t)=>{const n=ZC(),a=decodeURIComponent(e.params.demo),o=n.find((e=>nE(e.title)===a));return o?o.getPage({title:o.title,url:`${c(nE(o.title))}`,getParentPage:()=>t}):(i=e.url,new Ig({title:"Demo not found",subTitle:"So sorry sir but the demo cannot be found.",url:i,getScene:()=>new nh({body:new Gm({direction:"column",children:[new Qm({body:new xg({component:()=>r().createElement("div",{style:{fontSize:50}},"😭")})})]})})}));var i}}]})]})}HC(YC,"type","example-event");const eE=()=>{const e=function(e){const t=yg.get(e);if(t)return t;const n=e();return yg.set(e,n),n}(JC);return r().createElement(e.Component,{model:e})};class tE extends ae{updateLayout(){const{searchQuery:e,body:t}=this.state,n=[],a=new RegExp(e,"i");for(const t of ZC())e&&!t.title.match(a)||n.push(new xg({reactNode:r().createElement(Sn.Card,{key:t.title,href:c(nE(t.title))},r().createElement(Sn.Card.Heading,null,t.title))}));t.setState({children:n})}constructor(){super({body:new tg({children:[],templateColumns:"repeat(auto-fit, minmax(400px, 1fr))",autoRows:"unset"}),searchQuery:""}),XC(this,"onSearchChange",(e=>{this.setState({searchQuery:e.currentTarget.value}),this.updateLayout()})),this.addActivationHandler((()=>this.updateLayout()))}}function nE(e){const t=e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"");return encodeURIComponent(t)}XC(tE,"Component",(({model:e})=>{const{body:t,searchQuery:n}=e.useState(),a=(0,Sn.useStyles2)(rE);return d.config.datasources[l.uid]?r().createElement("div",{className:a.root},r().createElement(Sn.Input,{value:n,placeholder:"Search",onChange:e.onSearchChange}),r().createElement(t.Component,{model:t})):r().createElement(Sn.Alert,{title:`Missing ${l.uid} datasource`},"These demos depend on ",r().createElement("b",null,"testdata")," datasource: ",r().createElement("code",null,JSON.stringify(l)),". See"," ",r().createElement("a",{href:"https://github.com/grafana/grafana/tree/main/devenv#set-up-your-development-environment"},"https://github.com/grafana/grafana/tree/main/devenv#set-up-your-development-environment")," ","for more details.")}));const rE=e=>({root:(0,Pn.css)({display:"flex",flexGrow:1,flexDirection:"column",alignSelf:"baseline",gap:e.spacing(2)})});function aE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class oE extends ae{constructor(...e){super(...e),aE(this,"onChange",(e=>{this.setState({value:e}),this.state.onChange(e)}))}}function iE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}aE(oE,"Component",(({model:e})=>{const{options:t,value:n}=e.useState();return r().createElement(Sn.RadioButtonGroup,{options:t,value:n,onChange:e.onChange})}));class sE extends ae{constructor(...e){super(...e),iE(this,"onChange",(e=>{this.setState({value:e.currentTarget.value})}))}}function lE(t){const n={id:e.ValueMatcherID.regex,options:{value:t}};return{id:e.DataTransformerID.filterByValue,options:{type:"include",match:"all",filters:[{fieldName:"handler",config:n}]}}}function uE(t){return()=>n=>n.pipe((0,k.map)((n=>n.filter((n=>(0,e.getFrameDisplayName)(n).toLowerCase().includes(t.toLowerCase()))))))}function cE(t,n){return e.urlUtil.renderUrl(t,n)}function dE(){return new of({variables:[new pu({name:"instance",datasource:{uid:"gdev-prometheus"},query:{query:"label_values(grafana_http_request_duration_seconds_sum, instance)",refId:"A"}})]})}function pE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){pE(e,t,n[t])}))}return e}function hE(){const t=new sE({value:""}),n=Xb({expr:"sort_desc(avg without(job, instance) (rate(grafana_http_request_duration_seconds_sum[$__rate_interval]) * 1e3)) "}),a=new Jp({$data:n,transformations:[lE("")]});a.addActivationHandler((()=>{const e=t.subscribeToState((e=>{a.setState({transformations:[lE(e.value)]}),a.reprocessTransformations()}));return()=>e.unsubscribe()}));const o=Fb.table().setTitle("Handlers").setData(a).setOption("footer",{enablePagination:!0}).setOverrides((e=>e.matchFieldsWithNameByRegex(".*").overrideFilterable(!1).matchFieldsWithName("Time").overrideCustomFieldConfig("hidden",!0).matchFieldsWithName("Value").overrideDisplayName("Duration (Avg)").matchFieldsWithName("handler").overrideLinks([{title:"Go to handler drilldown view",url:"",onBuildUrl:()=>{const e=d.locationService.getSearchObject();return cE(u("grafana-monitoring/handlers/${__value.text:percentencode}"),e)}}]))).build(),i=new Pl({datasource:{uid:"gdev-prometheus"},queries:[{refId:"A",expr:"topk(20, avg without(job, instance) (rate(grafana_http_request_duration_seconds_sum[$__rate_interval])) * 1e3)",range:!0,format:"time_series",legendFormat:"{{method}} {{handler}} (status = {{status_code}})",maxDataPoints:500}]}),s=new Jp({$data:i,transformations:[uE("")]});s.addActivationHandler((()=>{const e=t.subscribeToState((e=>{s.setState({transformations:[uE(e.value)]}),s.reprocessTransformations()}));return()=>e.unsubscribe()}));const l=new qm({$data:s,body:new Gm({direction:"column",children:[]}),getLayoutChild:(t,n,a)=>{return new Qm({key:`panel-${a}`,minHeight:200,$data:new Ne({data:(o=fE({},t),i={series:[n]},i=null!=i?i:{},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(i)).forEach((function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(i,e))})),o)}),body:new Gm({direction:"row",key:`row-${a}`,children:[new Qm({key:`flex1-${a}`,body:Fb.timeseries().setTitle((0,e.getFrameDisplayName)(n)).setOption("legend",{showLegend:!1}).setHeaderActions(r().createElement(Sn.LinkButton,{fill:"text",size:"sm",icon:"arrow-right",href:mE(n.fields[1].labels.handler)},"Details")).build()}),new Qm({key:`flex2-${a}`,width:200,body:Fb.stat().setTitle("Last").setOption("graphMode",Ce.None).setOption("textMode",Ee.Value).setDisplayName("Last").build()})]})});var o,i}}),c=new Gm({children:[new Qm({body:o})]}),p=new oE({options:[{value:"table",label:"Table"},{value:"graphs",label:"Graphs"}],value:"table",onChange:e=>{"table"===e?c.setState({children:[new Qm({body:o})]}):c.setState({children:[l]})}});return new nh({$variables:dE(),$data:n,$timeRange:new Xe({from:"now-1h",to:"now"}),controls:[new ef({}),t,new Um,p,new cm({isOnCanvas:!0}),new xm({isOnCanvas:!0})],body:c})}function mE(e){const t=d.locationService.getSearchObject();return cE(u(`grafana-monitoring/handlers/${encodeURIComponent(e)}`),t)}function gE(e){const t=Jb({expr:`avg without(job, instance) (rate(grafana_http_request_duration_seconds_sum{handler="${e}"}[$__rate_interval])) * 1e3`,legendFormat:"{{method}} {{handler}} (status = {{status_code}})"}),n=Jb({expr:`sum without(job, instance) (rate(grafana_http_request_duration_seconds_count{handler="${e}"}[$__rate_interval])) `,legendFormat:"{{method}} {{handler}} (status = {{status_code}})"});return new nh({$variables:dE(),$timeRange:new Xe({from:"now-1h",to:"now"}),controls:[new ef({}),new Um,new cm({isOnCanvas:!0}),new xm({isOnCanvas:!0})],body:new Gm({direction:"column",children:[new Qm({body:Fb.timeseries().setData(t).setTitle("Request duration avg (ms)").build()}),new Qm({body:Fb.timeseries().setData(n).setTitle("Request count/s").build()})]})})}function bE(){return new nh({$variables:dE(),$timeRange:new Xe({from:"now-1h",to:"now"}),controls:[new ef({}),new Um,new cm({isOnCanvas:!0}),new xm({isOnCanvas:!0})],body:new Gm({direction:"column",children:[new Qm({height:150,body:new Gm({children:[new Qm({body:yE("grafana_stat_totals_dashboard","Dashboards")}),new Qm({body:yE("grafana_stat_total_users","Users")}),new Qm({body:yE("sum(grafana_stat_totals_datasource)","Data sources")}),new Qm({body:yE("grafana_stat_total_service_account_tokens","Service account tokens")})]})}),new Qm({body:Fb.timeseries().setData(new Pl({datasource:{uid:"gdev-prometheus"},queries:[{refId:"A",expr:'sum(go_memory_classes_total_bytes{job="grafana", instance=~"$instance"})',range:!0,format:"time_series",maxDataPoints:500}]})).setTitle("Memory usage").setOption("legend",{showLegend:!1}).setUnit("bytes").setMin(0).setCustomFieldConfig("lineWidth",2).setCustomFieldConfig("fillOpacity",6).build()}),new Qm({body:Fb.timeseries().setData(new Pl({datasource:{uid:"gdev-prometheus"},queries:[{refId:"A",expr:'sum(go_goroutines{job="grafana", instance=~"$instance"})',range:!0,format:"time_series",maxDataPoints:500}]})).setOption("legend",{showLegend:!1}).setMin(0).setCustomFieldConfig("lineWidth",2).setCustomFieldConfig("fillOpacity",6).setTitle("Go routines").build()})]})})}function yE(t,n){return Fb.stat().setData(Xb({expr:t})).setTitle(n).setColor({fixedColor:"text",mode:e.FieldColorModeId.Fixed}).build()}function vE(){const e=new Pl({datasource:{uid:"gdev-loki"},queries:[{refId:"A",expr:'{job="grafana"} | logfmt | __error__=``',queryType:"range",maxDataPoints:5e3}]});return new nh({$variables:dE(),$timeRange:new Xe({from:"now-1h",to:"now"}),controls:[new ef({}),new Um,new cm({isOnCanvas:!0}),new xm({isOnCanvas:!0})],body:new Gm({direction:"column",children:[new Qm({body:Fb.logs().setTitle("").setData(e).setOption("showTime",!0).setOption("showLabels",!1).setOption("showCommonLabels",!1).setOption("wrapLogMessage",!0).setOption("prettifyLogMessage",!1).setOption("enableLogDetails",!0).setOption("dedupStrategy",Ae.none).setOption("sortOrder",we.Descending).build()})]})})}function wE(){const e=Fb.table().setData(Xb({expr:"sort_desc(avg without(job, instance) (rate(grafana_http_request_duration_seconds_sum[$__rate_interval]) * 1e3)) "})).setTitle("Handlers").setOption("footer",{enablePagination:!0}).setOverrides((e=>e.matchFieldsWithNameByRegex(".*").overrideFilterable(!1).matchFieldsWithName("Time").overrideCustomFieldConfig("hidden",!0).matchFieldsWithName("Value").overrideDisplayName("Duration (Avg)").matchFieldsWithName("handler").overrideLinks([{title:"Go to handler drilldown view",url:u("grafana-monitoring/traffic?handler=${__value.text:percentencode}")}]))).build();return new nh({$variables:dE(),$timeRange:new Xe({from:"now-1h",to:"now"}),controls:[new ef({}),new Um,new cm({isOnCanvas:!0}),new xm({isOnCanvas:!0})],body:new Gm({$behaviors:[new OE],children:[new Qm({body:e})]})})}iE(sE,"Component",(({model:e})=>{const{value:t}=e.useState();return r().createElement(Sn.Input,{width:25,placeholder:"Search...",value:t,onChange:e.onChange})}));class OE extends ae{onHandlerChanged(e){const t=this.getLayout();null==e?t.setState({children:t.state.children.slice(0,1)}):t.setState({children:[t.state.children[0],this.getDrilldownView(e)]})}getDrilldownView(e){return new Qm({key:"drilldown-flex",body:Fb.timeseries().setData(Jb({expr:`rate(grafana_http_request_duration_seconds_sum{handler="${e}"}[$__rate_interval]) * 1e3`})).setTitle(`Handler: ${e} details`).setHeaderActions(r().createElement(Sn.Button,{size:"sm",variant:"secondary",icon:"times",onClick:()=>this.setState({handler:void 0})})).build()})}getUrlState(){return{handler:this.state.handler}}updateFromUrl(e){"string"!=typeof e.handler&&void 0!==e.handler||this.setState({handler:e.handler})}getLayout(){if(this.parent instanceof Gm)return this.parent;throw new Error("Invalid parent")}constructor(){super({}),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"_urlSync",new ze(this,{keys:["handler"]})),this.addActivationHandler((()=>{this._subs.add(this.subscribeToState((e=>this.onHandlerChanged(e.handler)))),this.onHandlerChanged(this.state.handler)}))}}function SE(e,t){const n=decodeURIComponent(e.params.handler),r=u(`grafana-monitoring/handlers/${encodeURIComponent(n)}`);return new Ig({title:n,subTitle:"A grafana http handler is responsible for service a specific API request",url:r,getParentPage:()=>t,getScene:()=>gE(n),tabs:[new Ig({title:"Metrics",url:r,getScene:()=>gE(n),preserveUrlKeys:["from","to","var-instance"]}),new Ig({title:"Logs",url:r+"/logs",getScene:()=>function(e){const t=new Pl({datasource:{uid:"gdev-loki"},queries:[{refId:"A",expr:`{job="grafana"} | logfmt | handler=\`${e}\` | __error__=\`\``,queryType:"range",maxDataPoints:5e3}]});return new nh({$variables:dE(),$timeRange:new Xe({from:"now-1h",to:"now"}),controls:[new ef({}),new Um,new cm({isOnCanvas:!0}),new xm({isOnCanvas:!0})],body:new Gm({direction:"column",children:[new Qm({body:Fb.logs().setData(t).setTitle("").setOption("showTime",!0).setOption("showLabels",!1).setOption("showCommonLabels",!1).setOption("wrapLogMessage",!0).setOption("prettifyLogMessage",!1).setOption("enableLogDetails",!0).setOption("dedupStrategy",Ae.none).setOption("sortOrder",we.Descending).build()})]})})}(n),preserveUrlKeys:["from","to","var-instance"]})]})}const _E=function(){const e=(0,t.useMemo)((()=>new gg({pages:[new Ig({title:"Grafana Monitoring",subTitle:"A custom app with embedded scenes to monitor your Grafana server",url:u("grafana-monitoring"),hideFromBreadcrumbs:!1,getScene:bE,tabs:[new Ig({title:"Overview",url:u("grafana-monitoring"),getScene:bE,preserveUrlKeys:["from","to","var-instance"]}),new Ig({title:"HTTP handlers",url:u("grafana-monitoring/handlers"),getScene:hE,preserveUrlKeys:["from","to","var-instance"],drilldowns:[{routePath:u("grafana-monitoring/handlers/:handler"),getPage:SE}]}),new Ig({title:"Traffic",url:u("grafana-monitoring/traffic"),getScene:wE,preserveUrlKeys:["from","to","var-instance"]}),new Ig({title:"Logs",url:u("grafana-monitoring/logs"),getScene:vE,preserveUrlKeys:["from","to","var-instance"]})]})]})),[]);return r().createElement(e.Component,{model:e})};function xE({title:e,subTitle:n,children:a}){const o={text:e},{breadcrumbs:i}=(0,t.useContext)(ZS);if(i.length>0){let t=o;for(const n of i){if(n.text===e)break;t.parentItem={text:n.text,url:n.url}}}return r().createElement(d.PluginPage,{pageNav:o,subTitle:n,actions:r().createElement(PE,null)},a)}function PE(){return r().createElement(r().Fragment,null,r().createElement(MS,{name:"env"}),r().createElement(VS,null),r().createElement(US,{withText:!0}))}function jE(){const n=["Slow query","Random walk"].map(e.toOption),[a,o]=(0,t.useState)("Random walk"),i=IS({queries:(0,t.useMemo)((()=>function(e){return"Random walk"===e?[{refId:"A",scenarioId:"random_walk",alias:"random walk"}]:[{refId:"A",scenarioId:"slow_query",alias:"Slow query",stringInput:"2s"}]}(a)),[a]),maxDataPoints:100,datasource:l});return r().createElement(xE,{title:"Dynamic queriues",subTitle:"Rebuild queries based on some user input / state"},r().createElement(Sn.Stack,{direction:"column"},r().createElement(Sn.Stack,null,r().createElement(Sn.Field,{label:"Query scenario"},r().createElement(Sn.Select,{value:a,options:n,onChange:e=>o(e.value)}))),r().createElement(u_,null,r().createElement(LS,{title:a,dataProvider:i,viz:p_}))))}function CE(){return r().createElement(xE,{title:"Repeat by variable",subTitle:"Has a nested variable scope with a new variable which we repeat some viz panels by"},r().createElement(QS,{name:"panels",query:"10, 20, 30, 40, 50",initialValue:["10"],isMulti:!0},r().createElement(Sn.Stack,{direction:"column"},r().createElement(MS,{name:"panels"}),r().createElement(EE,null))))}function EE(){const[e,t]=function(e){const t=TS(),n=yu.lookupVariable("panels",t);if(!n)return[void 0,!1];n.useState();const r=n.parent.isVariableLoadingOrWaitingToUpdate(n);let a=n.getValue();return null==a?[void 0,r]:(Array.isArray(a)||(a=[a]),[a,r])}();return t||!e?r().createElement("div",null,"Waiting for variable"):r().createElement(u_,null,e.map((e=>r().createElement(m_,{key:e,title:`${e} data points`,maxDataPoints:parseInt(e,10)}))))}function DE(){const[e,n]=(0,t.useState)(p_),a=kE.find((t=>t.value===e)),o=IS({queries:TE,maxDataPoints:50,datasource:l}),i=r().createElement(Sn.RadioButtonGroup,{value:e,options:kE,onChange:n,size:"sm"});return r().createElement(xE,{title:"Dynamic visualisation",subTitle:"Rebuild queries based on some user input / state"},r().createElement(Sn.Stack,{direction:"column"},r().createElement(u_,null,r().createElement(LS,{title:a.label,dataProvider:o,viz:e,headerActions:i}))))}const kE=[{label:"Graph",value:p_},{label:"Bars",value:f_},{label:"Gradient graph",value:h_}],TE=[{refId:"A",scenarioId:"random_walk",alias:"env = $env"}];function RE(){const[e,t]=r().useState(void 0),[n,a]=r().useState(KO.dontHide),[o,i]=r().useState("/[ACDFG]/"),[s,l]=r().useState(!0),[u,c]=r().useState(Cu.alphabeticalAsc);return r().createElement(xE,{title:"Dynamic variables",subTitle:"Variables added via react rendering"},r().createElement(QS,{name:"job",query:"A, B, C",initialValue:"A"},r().createElement(Sn.Stack,{direction:"column"},r().createElement(Sn.Stack,null,r().createElement(MS,{name:"job"})),r().createElement(u_,null,r().createElement(m_,{title:"Testing job = $job",queryAlias:"job = $job"})))),r().createElement(KS,{name:"dsVar",pluginId:"grafana-testdata-datasource",regex:e},r().createElement(Sn.Stack,{direction:"column"},r().createElement(Sn.Stack,null,r().createElement(MS,{name:"dsVar"}),r().createElement(Sn.Button,{variant:"secondary",onClick:()=>t("/gdev-*/")},"Change regex"),r().createElement(Sn.Button,{variant:"secondary",onClick:()=>t(void 0)},"No regex")),r().createElement(u_,null,r().createElement(m_,{title:"Testing datasource = $dsVar",queryAlias:"datasource = $dsVar"})))),r().createElement(YS,{name:"job2",initialValue:"A",query:{query:"*",refId:"A"},datasource:{uid:"gdev-testdata"},regex:o,hide:n,refresh:ju.onTimeRangeChanged,includeAll:s,sort:u},r().createElement(Sn.Stack,{direction:"column"},r().createElement(Sn.Stack,null,r().createElement(MS,{name:"job2"}),r().createElement(Sn.Button,{variant:"secondary",onClick:()=>a(KO.hideLabel)},"Hide label"),r().createElement(Sn.Button,{variant:"secondary",onClick:()=>a(KO.hideVariable)},"Hide variable"),r().createElement(Sn.Button,{variant:"secondary",onClick:()=>a(KO.dontHide)},"Unhide variable"),r().createElement(Sn.Button,{variant:"secondary",onClick:()=>i("/[BF]/")},"Change regex"),r().createElement(Sn.Button,{variant:"secondary",onClick:()=>i(void 0)},"No regex"),r().createElement(Sn.Button,{variant:"secondary",onClick:()=>l(!1)},"Remove include all"),r().createElement(Sn.Button,{variant:"secondary",onClick:()=>c(Cu.alphabeticalAsc)},"Sort asc"),r().createElement(Sn.Button,{variant:"secondary",onClick:()=>c(Cu.alphabeticalDesc)},"Sort desc")),r().createElement(u_,null,r().createElement(m_,{title:"Testing job2 = $job2",queryAlias:"job2 = $job2"})))))}function AE(){return r().createElement(xE,{title:"Nested context",subTitle:"Nested contexts with different time ranges and variables"},r().createElement(Sn.Stack,{direction:"column"},r().createElement(u_,null,r().createElement(m_,{title:"Global"})),r().createElement(IE,null),r().createElement(kS,{timeRange:{from:"now-10m",to:"now"}},r().createElement(QS,{name:"job",query:"jobA-${env}, jobB-${env}, jobC-${env}"},r().createElement(Sn.Stack,{direction:"column"},r().createElement(Sn.Stack,{direction:"row",justifyContent:"flex-end"},r().createElement(MS,{name:"job"}),r().createElement(VS,null)),r().createElement(u_,null,r().createElement(m_,{title:"Nested time range",queryAlias:"job = $job"})))))))}function IE(){const e=(0,Sn.useTheme2)();return r().createElement("div",{style:{height:1,width:"100%",flexGrow:1,borderTop:`1px solid ${e.colors.border.weak}`,margin:"8px 0"}})}function VE(){return r().createElement(xE,{title:"Interpolation hook",subTitle:"Testing a hook that makes any component re-render when variable or time range change"},r().createElement(Sn.Stack,{direction:"column"},r().createElement(c_,{name:"Page"}),r().createElement(ME,null)))}const ME=r().memo((()=>{const e=AS({variables:["env"],timeRange:!0});return r().createElement(Sn.Stack,{direction:"column",gap:2},r().createElement(c_,{name:"Memozied component"}),r().createElement("div",null,"$env: ",e("$env")),r().createElement("div",null,"__url_time_range: ",e("$__url_time_range")),r().createElement(Sn.Stack,null,r().createElement(Sn.Button,{variant:"secondary",onClick:()=>{d.locationService.partial({someParam:"1"})}},"Update query param"),r().createElement(Sn.Button,{variant:"secondary",onClick:()=>{d.locationService.partial({"var-env":"prod"})}},"Set env var to prod via url")))}));function FE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function LE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){FE(e,t,n[t])}))}return e}function $E(){return r().createElement(xE,{title:"Repeat by series",subTitle:"Repeats visualizations returned by a single query"},r().createElement(QS,{name:"series",label:"Series count",query:"1,2,5,10,20,30",initialValue:"3"},r().createElement(Sn.Stack,{direction:"column"},r().createElement(MS,{name:"series"}),r().createElement(NE,null))))}ME.displayName="PageBody";const NE=r().memo((()=>{const t=AS({variables:["series"]}),n=IS({queries:[{uid:"gdev-testdata",refId:"A",scenarioId:"random_walk",alias:"__server_names",seriesCount:parseInt(t("$series"),10)}],maxDataPoints:50}),{data:a}=n.useState();return a?r().createElement(u_,null,a.series.map(((t,n)=>{const o=(0,e.getFrameDisplayName)(t,n),i=new Ne({data:(s=LE({},a),l={series:[t]},l=null!=l?l:{},Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(l)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(l)).forEach((function(e){Object.defineProperty(s,e,Object.getOwnPropertyDescriptor(l,e))})),s)});var s,l;return r().createElement(LS,{key:o,title:o,viz:p_,dataProvider:i})}))):null}));function BE(){return r().createElement(XS,null,r().createElement(JS,{text:"Drilldown demo",path:`${d_}/drilldown`}),r().createElement(o.Switch,null,r().createElement(o.Route,{path:`${d_}/drilldown`,component:zE,exact:!0}),r().createElement(o.Route,{path:`${d_}/drilldown/lib/:lib`,component:qE})))}function zE(){const e=IS({queries:[{scenarioId:"csv_file",refId:"A",csvFileName:"js_libraries.csv"}],datasource:l});return r().createElement(xE,{title:"Drilldown demo",subTitle:"The top level page (for the demo)"},r().createElement(u_,null,r().createElement(LS,{title:"JS Libraries",dataProvider:e,viz:HE})))}function qE(){const e=(0,o.useParams)().lib;return r().createElement(xE,{title:`Library: ${e}`,subTitle:"Library details drilldown page"},r().createElement(u_,null,r().createElement(m_,{title:`${e} trends`})))}NE.displayName="RepeatPanelBySeries";const HE=$b().setOverrides((e=>e.matchFieldsWithName("Library").overrideLinks([{title:"Go to library details",url:"${__url.path}/lib/${__value.text}${__url.params}"}]))).build();function WE(){return r().createElement(xE,{title:"Annotations",subTitle:"Annotation demo page"},r().createElement(e_,{name:"GlobalAnno",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"green",name:"New annotation",target:{lines:11,refId:"Anno",scenarioId:"annotations"}}},r().createElement(Sn.Stack,{direction:"column",gap:2},r().createElement(kS,null,r().createElement(Sn.Stack,{direction:"column"},r().createElement(e_,{name:"AnnoLayer1",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"yellow",name:"New annotation",target:{lines:10,refId:"Anno",scenarioId:"annotations"}}},r().createElement(e_,{name:"AnnoLayer3",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"blue",name:"New annotation",target:{lines:3,refId:"Anno",scenarioId:"annotations"}}},r().createElement(Sn.Stack,{direction:"row"},r().createElement(GS,{name:"GlobalAnno"}),r().createElement(GS,{name:"AnnoLayer1"}),r().createElement(GS,{name:"AnnoLayer3"})),r().createElement(u_,null,r().createElement(m_,{title:"Plain graph 1"})))))),r().createElement(kS,null,r().createElement(e_,{name:"AnnoLayer2",query:{datasource:{type:"testdata",uid:"gdev-testdata"},enable:!0,iconColor:"red",name:"New annotation",target:{lines:15,refId:"Anno",scenarioId:"annotations"}}},r().createElement(GS,{name:"AnnoLayer2"}),r().createElement(u_,null,r().createElement(m_,{title:"Plain graph 2"}),r().createElement(m_,{title:"Plain graph 3"}),r().createElement(m_,{title:"Plain graph 4"})))))))}function UE(){const[n,a]=(0,t.useState)(e.ReducerID.mean),o=IS({queries:[{uid:"gdev-testdata",refId:"A",scenarioId:"random_walk",alias:"foo"}],maxDataPoints:20}),i={mode:"windowFunctions",window:{windowSize:10,windowSizeMode:"percentage",windowAlignment:"center",field:"foo",reducer:n}},s=function(e){const n=TS(),r=(0,t.useId)();let a=n.findByKey(r);return a||(a=new Jp({key:r,$data:new Ip({source:e.data.getRef()}),transformations:e.transformations})),(0,t.useEffect)((()=>n.addToScene(a)),[a,n]),(0,t.useEffect)((()=>{(0,be.isEqual)(a.state.transformations,e.transformations)||(a.setState({transformations:e.transformations}),a.reprocessTransformations())}),[a,e.transformations]),a}({transformations:[{id:e.DataTransformerID.calculateField,options:i}],data:o});var l;return r().createElement(xE,{title:"Transformations",subTitle:"Transformations demo page"},r().createElement(Sn.Select,{onChange:t=>a(null!==(l=t.value)&&void 0!==l?l:e.ReducerID.mean),value:n,options:[{label:"mean",value:e.ReducerID.mean},{label:"variance",value:e.ReducerID.variance}]}),r().createElement(Sn.Stack,{direction:"column",gap:2},r().createElement(u_,null,r().createElement(LS,{title:"Viz with transformations",viz:p_,dataProvider:s}))))}function GE(){return r().createElement(kS,{timeRange:{from:"now-1h",to:"now"},withQueryController:!0},r().createElement(QS,{name:"env",query:"dev, test, prod",initialValue:"dev"},r().createElement(o.Switch,null,r().createElement(o.Route,{path:`${d_}`,component:QE,exact:!0}),r().createElement(o.Route,{path:`${d_}/repeat-by-variable`,component:CE}),r().createElement(o.Route,{path:`${d_}/repeat-by-series`,component:$E}),r().createElement(o.Route,{path:`${d_}/dynamic-queries`,component:jE}),r().createElement(o.Route,{path:`${d_}/dynamic-viz`,component:DE}),r().createElement(o.Route,{path:`${d_}/dynamic-vars`,component:RE}),r().createElement(o.Route,{path:`${d_}/nested-context`,component:AE}),r().createElement(o.Route,{path:`${d_}/interpolation-hook`,component:VE}),r().createElement(o.Route,{path:`${d_}/drilldown`,component:BE}),r().createElement(o.Route,{path:`${d_}/annotations`,component:WE}),r().createElement(o.Route,{path:`${d_}/transformations`,component:UE}))))}function QE(){return r().createElement(xE,{title:"Home",subTitle:"Welcome to the React first demos"},r().createElement(Sn.Stack,{direction:"column",gap:2},r().createElement(u_,null,r().createElement(m_,{title:"Welcome",maxDataPoints:50})),r().createElement("h2",null,"Examples"),r().createElement(Sn.TextLink,{href:`${d_}/repeat-by-variable`},"Repeat by variable"),r().createElement(Sn.TextLink,{href:`${d_}/repeat-by-series`},"Repeat by series"),r().createElement(Sn.TextLink,{href:`${d_}/dynamic-queries`},"Dynamic queries"),r().createElement(Sn.TextLink,{href:`${d_}/dynamic-viz`},"Dynamic visualization"),r().createElement(Sn.TextLink,{href:`${d_}/dynamic-vars`},"Dynamic variables"),r().createElement(Sn.TextLink,{href:`${d_}/nested-context`},"Nested contexts"),r().createElement(Sn.TextLink,{href:`${d_}/interpolation-hook`},"Interpolation hook"),r().createElement(Sn.TextLink,{href:`${d_}/drilldown`},"Drilldown demo"),r().createElement(Sn.TextLink,{href:`${d_}/annotations`},"Annotations demo page"),r().createElement(Sn.TextLink,{href:`${d_}/drilldown?from=now-5m&to=now&var-env=prod`},"Link with time range and variables"),r().createElement(Sn.TextLink,{href:`${d_}/transformations`},"Transformation demo")))}const KE=()=>t.createElement(o.Switch,null,t.createElement(o.Route,{path:u(`${s.Demos}`),component:eE}),t.createElement(o.Route,{path:u(`${s.GrafanaMonitoring}`),component:_E}),t.createElement(o.Route,{path:u(`${s.ReactDemo}`),component:GE}),t.createElement(o.Redirect,{to:u(s.Demos)}));class YE extends t.PureComponent{render(){return t.createElement(a.Provider,{value:this.props},t.createElement(KE,null))}}const ZE=(new e.AppPlugin).setRootPage(YE)})(),h})()));
//# sourceMappingURL=module.js.map