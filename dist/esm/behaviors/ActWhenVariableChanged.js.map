{"version":3,"file":"ActWhenVariableChanged.js","sources":["../../../src/behaviors/ActWhenVariableChanged.ts"],"sourcesContent":["import { SceneObjectBase } from '../core/SceneObjectBase';\nimport { SceneObjectState } from '../core/types';\nimport { SceneVariable } from '../variables/types';\nimport { VariableDependencyConfig } from '../variables/VariableDependencyConfig';\n\ninterface ActWhenVariableChangedState extends SceneObjectState {\n  // The name of the variable to subscribe to changes to.\n  variableName: string;\n  /**\n   * The handler to run when a variable changes.\n   * @param variable The variable that changed\n   * @param behavior The behavior instance where this onChange handler added to.\n   *  You can use this to access the parent SceneObject where this behavior exists.\n   *  You can also use this with the sceneGraph util functions to find objects from this scene graph location.\n   * @returns Return a cancellation function if you do anything async like issue a query.\n   */\n  onChange: (variable: SceneVariable, behavior: ActWhenVariableChanged) => (() => void) | void;\n}\n\n/**\n * This behavior will run an effect function when specified variables change\n */\n\nexport class ActWhenVariableChanged extends SceneObjectBase<ActWhenVariableChangedState> {\n  private _runningEffect: null | (() => void) = null;\n\n  protected _variableDependency = new VariableDependencyConfig(this, {\n    variableNames: [this.state.variableName],\n    onReferencedVariableValueChanged: this._onVariableChanged.bind(this),\n  });\n\n  private _onVariableChanged(variable: SceneVariable): void {\n    const effect = this.state.onChange;\n\n    if (this._runningEffect) {\n      this._runningEffect();\n      this._runningEffect = null;\n    }\n\n    const cancellation = effect(variable, this);\n    if (cancellation) {\n      this._runningEffect = cancellation;\n    }\n  }\n}\n"],"names":[],"mappings":";;;AAuBO,MAAM,+BAA+B,eAA6C,CAAA;AAAA,EAAlF,WAAA,GAAA;AAAA,IAAA,KAAA,CAAA,GAAA,SAAA,CAAA,CAAA;AACL,IAAA,IAAA,CAAQ,cAAsC,GAAA,IAAA,CAAA;AAE9C,IAAU,IAAA,CAAA,mBAAA,GAAsB,IAAI,wBAAA,CAAyB,IAAM,EAAA;AAAA,MACjE,aAAe,EAAA,CAAC,IAAK,CAAA,KAAA,CAAM,YAAY,CAAA;AAAA,MACvC,gCAAkC,EAAA,IAAA,CAAK,kBAAmB,CAAA,IAAA,CAAK,IAAI,CAAA;AAAA,KACpE,CAAA,CAAA;AAAA,GAAA;AAAA,EAEO,mBAAmB,QAA+B,EAAA;AACxD,IAAM,MAAA,MAAA,GAAS,KAAK,KAAM,CAAA,QAAA,CAAA;AAE1B,IAAA,IAAI,KAAK,cAAgB,EAAA;AACvB,MAAA,IAAA,CAAK,cAAe,EAAA,CAAA;AACpB,MAAA,IAAA,CAAK,cAAiB,GAAA,IAAA,CAAA;AAAA,KACxB;AAEA,IAAM,MAAA,YAAA,GAAe,MAAO,CAAA,QAAA,EAAU,IAAI,CAAA,CAAA;AAC1C,IAAA,IAAI,YAAc,EAAA;AAChB,MAAA,IAAA,CAAK,cAAiB,GAAA,YAAA,CAAA;AAAA,KACxB;AAAA,GACF;AACF;;;;"}