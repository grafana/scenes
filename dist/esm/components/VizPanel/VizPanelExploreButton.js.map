{"version":3,"file":"VizPanelExploreButton.js","sources":["../../../../src/components/VizPanel/VizPanelExploreButton.tsx"],"sourcesContent":["import React from 'react';\n\nimport { LinkButton } from '@grafana/ui';\nimport { DataQuery } from '@grafana/schema';\nimport { useAsync } from 'react-use';\nimport { SceneComponentProps, SceneObjectState } from '../../core/types';\nimport { SceneObjectBase } from '../../core/SceneObjectBase';\nimport { sceneGraph } from '../../core/sceneGraph';\nimport { getExploreURL } from '../../utils/explore';\nimport { useReturnToPrevious } from '@grafana/runtime';\n\nexport interface ExploreButtonOptions {\n  // Callback to hook in tracking / analytics\n  onClick?: () => void;\n\n  // Callback to modify interpolated query before passing it to explore\n  transform?: (query: DataQuery) => DataQuery;\n\n  // Title and href for the return to previous button\n  returnToPrevious?: {\n    title: string;\n    href?: string;\n  };\n}\n\ninterface ExploreButtonState extends SceneObjectState {\n  options: ExploreButtonOptions;\n}\n\nexport class VizPanelExploreButton extends SceneObjectBase<ExploreButtonState> {\n  static Component = VizPanelExploreButtonComponent;\n\n  public constructor(options: ExploreButtonOptions = {}) {\n    super({ options });\n  }\n}\n\nfunction VizPanelExploreButtonComponent({ model }: SceneComponentProps<VizPanelExploreButton>) {\n  const { options } = model.useState();\n\n  const { data } = sceneGraph.getData(model).useState();\n\n  const { from, to } = sceneGraph.getTimeRange(model).useState();\n\n  const { value: exploreLink } = useAsync(\n    async () => (data ? getExploreURL(data, model, { from, to }, options.transform) : ''),\n    [data, model, from, to]\n  );\n\n  const returnToPrevious = useReturnToPrevious();\n\n  if (exploreLink) {\n    return (\n      <LinkButton\n        key=\"explore\"\n        icon=\"compass\"\n        size=\"sm\"\n        variant=\"secondary\"\n        href={exploreLink}\n        onClick={() => {\n          if (options.returnToPrevious) {\n            returnToPrevious(options.returnToPrevious.title, options.returnToPrevious.href);\n          }\n          options.onClick?.();\n        }}\n      >\n        Explore\n      </LinkButton>\n    );\n  }\n  return null;\n}\n"],"names":[],"mappings":";;;;;;;;AA6BO,MAAM,8BAA8B,eAAoC,CAAA;AAAA,EAGtE,WAAA,CAAY,OAAgC,GAAA,EAAI,EAAA;AACrD,IAAM,KAAA,CAAA,EAAE,SAAS,CAAA,CAAA;AAAA,GACnB;AACF,CAAA;AANa,qBAAA,CACJ,SAAY,GAAA,8BAAA,CAAA;AAOrB,SAAS,8BAAA,CAA+B,EAAE,KAAA,EAAqD,EAAA;AAC7F,EAAA,MAAM,EAAE,OAAA,EAAY,GAAA,KAAA,CAAM,QAAS,EAAA,CAAA;AAEnC,EAAA,MAAM,EAAE,IAAK,EAAA,GAAI,WAAW,OAAQ,CAAA,KAAK,EAAE,QAAS,EAAA,CAAA;AAEpD,EAAM,MAAA,EAAE,MAAM,EAAG,EAAA,GAAI,WAAW,YAAa,CAAA,KAAK,EAAE,QAAS,EAAA,CAAA;AAE7D,EAAM,MAAA,EAAE,KAAO,EAAA,WAAA,EAAgB,GAAA,QAAA;AAAA,IAC7B,YAAa,IAAO,GAAA,aAAA,CAAc,IAAM,EAAA,KAAA,EAAO,EAAE,IAAA,EAAM,EAAG,EAAA,EAAG,OAAQ,CAAA,SAAS,CAAI,GAAA,EAAA;AAAA,IAClF,CAAC,IAAA,EAAM,KAAO,EAAA,IAAA,EAAM,EAAE,CAAA;AAAA,GACxB,CAAA;AAEA,EAAA,MAAM,mBAAmB,mBAAoB,EAAA,CAAA;AAE7C,EAAA,IAAI,WAAa,EAAA;AACf,IAAA,uBACG,KAAA,CAAA,aAAA,CAAA,UAAA,EAAA;AAAA,MACC,GAAI,EAAA,SAAA;AAAA,MACJ,IAAK,EAAA,SAAA;AAAA,MACL,IAAK,EAAA,IAAA;AAAA,MACL,OAAQ,EAAA,WAAA;AAAA,MACR,IAAM,EAAA,WAAA;AAAA,MACN,SAAS,MAAM;AA3DvB,QAAA,IAAA,EAAA,CAAA;AA4DU,QAAA,IAAI,QAAQ,gBAAkB,EAAA;AAC5B,UAAA,gBAAA,CAAiB,OAAQ,CAAA,gBAAA,CAAiB,KAAO,EAAA,OAAA,CAAQ,iBAAiB,IAAI,CAAA,CAAA;AAAA,SAChF;AACA,QAAA,CAAA,EAAA,GAAA,OAAA,CAAQ,OAAR,KAAA,IAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,IAAA,CAAA,OAAA,CAAA,CAAA;AAAA,OACF;AAAA,KAAA,EACD,SAED,CAAA,CAAA;AAAA,GAEJ;AACA,EAAO,OAAA,IAAA,CAAA;AACT;;;;"}