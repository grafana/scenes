{"version":3,"file":"templateProxies.js","sources":["../../../../src/variables/macros/templateProxies.ts"],"sourcesContent":["import { Field, DataFrame, getFieldDisplayName, formatLabels } from '@grafana/data';\n\n/**\n * This object is created often, and only used when tmplates exist.  Using a proxy lets us delay\n * calculations of the more complex structures (label names) until they are actually used\n */\nexport function getTemplateProxyForField(field: Field, frame?: DataFrame, frames?: DataFrame[]): any {\n  return new Proxy(\n    {}, // This object shows up in test snapshots\n    {\n      get: (obj, key) => {\n        if (key === 'name') {\n          return field.name;\n        }\n\n        if (key === 'displayName') {\n          return getFieldDisplayName(field, frame, frames);\n        }\n\n        if (key === 'labels' || key === 'formattedLabels') {\n          // formattedLabels deprecated\n          if (!field.labels) {\n            return '';\n          }\n          return {\n            ...field.labels,\n            __values: Object.values(field.labels).sort().join(', '),\n            toString: () => {\n              return formatLabels(field.labels!, '', true);\n            },\n          };\n        }\n        return undefined;\n      },\n    }\n  );\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAMgB,SAAA,wBAAA,CAAyB,KAAc,EAAA,KAAA,EAAmB,MAA2B,EAAA;AACnG,EAAA,OAAO,IAAI,KAAA;AAAA,IACT,EAAC;AAAA,IACD;AAAA,MACE,GAAA,EAAK,CAAC,GAAA,EAAK,GAAQ,KAAA;AACjB,QAAA,IAAI,QAAQ,MAAQ,EAAA;AAClB,UAAA,OAAO,KAAM,CAAA,IAAA,CAAA;AAAA,SACf;AAEA,QAAA,IAAI,QAAQ,aAAe,EAAA;AACzB,UAAO,OAAA,mBAAA,CAAoB,KAAO,EAAA,KAAA,EAAO,MAAM,CAAA,CAAA;AAAA,SACjD;AAEA,QAAI,IAAA,GAAA,KAAQ,QAAY,IAAA,GAAA,KAAQ,iBAAmB,EAAA;AAEjD,UAAI,IAAA,CAAC,MAAM,MAAQ,EAAA;AACjB,YAAO,OAAA,EAAA,CAAA;AAAA,WACT;AACA,UAAO,OAAA,aAAA,CAAA,cAAA,CAAA,EAAA,EACF,MAAM,MADJ,CAAA,EAAA;AAAA,YAEL,QAAA,EAAU,OAAO,MAAO,CAAA,KAAA,CAAM,MAAM,CAAE,CAAA,IAAA,EAAO,CAAA,IAAA,CAAK,IAAI,CAAA;AAAA,YACtD,UAAU,MAAM;AACd,cAAA,OAAO,YAAa,CAAA,KAAA,CAAM,MAAS,EAAA,EAAA,EAAI,IAAI,CAAA,CAAA;AAAA,aAC7C;AAAA,WACF,CAAA,CAAA;AAAA,SACF;AACA,QAAO,OAAA,KAAA,CAAA,CAAA;AAAA,OACT;AAAA,KACF;AAAA,GACF,CAAA;AACF;;;;"}