{"version":3,"file":"getOptionSearcher.js","sources":["../../../../src/variables/components/getOptionSearcher.ts"],"sourcesContent":["import { VariableValueOption } from '../types';\nimport uFuzzy from '@leeoniya/ufuzzy';\nimport { ALL_VARIABLE_TEXT, ALL_VARIABLE_VALUE } from '../constants';\n\nexport function getOptionSearcher(\n  options: VariableValueOption[],\n  includeAll: boolean | undefined,\n) {\n  const ufuzzy = new uFuzzy();\n  let allOptions = options;\n  const haystack: string[] = [];\n  const limit = 10000;\n\n  if (includeAll) {\n    allOptions = [{ value: ALL_VARIABLE_VALUE, label: ALL_VARIABLE_TEXT }, ...allOptions];\n  }\n\n  return (search: string) => {\n    if (search === '') {\n      if (allOptions.length > limit) {\n        return allOptions.slice(0, limit);\n      } else {\n        return allOptions;\n      }\n    }\n\n    if (haystack.length === 0) {\n      for (let i = 0; i < allOptions.length; i++) {\n        haystack.push(allOptions[i].label);\n      }\n    }\n\n    const [idxs, info, order] = ufuzzy.search(haystack, search);\n    const filteredOptions: VariableValueOption[] = [];\n\n    if (idxs) {\n      for (let i = 0; i < idxs.length; i++) {\n        if (info && order) {\n          const idx = order[i];\n          filteredOptions.push(allOptions[idxs[idx]]);\n        } else {\n          filteredOptions.push(allOptions[idxs[i]]);\n        }\n\n        if (filteredOptions.length > limit) {\n          return filteredOptions;\n        }\n      }\n\n      return filteredOptions;\n    }\n\n    if (allOptions.length > limit) {\n      return allOptions.slice(0, limit);\n    }\n\n    return allOptions;\n  };\n}\n"],"names":[],"mappings":";;;AAIgB,SAAA,iBAAA,CACd,SACA,UACA,EAAA;AACA,EAAM,MAAA,MAAA,GAAS,IAAI,MAAO,EAAA,CAAA;AAC1B,EAAA,IAAI,UAAa,GAAA,OAAA,CAAA;AACjB,EAAA,MAAM,WAAqB,EAAC,CAAA;AAC5B,EAAA,MAAM,KAAQ,GAAA,GAAA,CAAA;AAEd,EAAA,IAAI,UAAY,EAAA;AACd,IAAa,UAAA,GAAA,CAAC,EAAE,KAAO,EAAA,kBAAA,EAAoB,OAAO,iBAAkB,EAAA,EAAG,GAAG,UAAU,CAAA,CAAA;AAAA,GACtF;AAEA,EAAA,OAAO,CAAC,MAAmB,KAAA;AACzB,IAAA,IAAI,WAAW,EAAI,EAAA;AACjB,MAAI,IAAA,UAAA,CAAW,SAAS,KAAO,EAAA;AAC7B,QAAO,OAAA,UAAA,CAAW,KAAM,CAAA,CAAA,EAAG,KAAK,CAAA,CAAA;AAAA,OAC3B,MAAA;AACL,QAAO,OAAA,UAAA,CAAA;AAAA,OACT;AAAA,KACF;AAEA,IAAI,IAAA,QAAA,CAAS,WAAW,CAAG,EAAA;AACzB,MAAA,KAAA,IAAS,CAAI,GAAA,CAAA,EAAG,CAAI,GAAA,UAAA,CAAW,QAAQ,CAAK,EAAA,EAAA;AAC1C,QAAS,QAAA,CAAA,IAAA,CAAK,UAAW,CAAA,CAAA,CAAA,CAAG,KAAK,CAAA,CAAA;AAAA,OACnC;AAAA,KACF;AAEA,IAAM,MAAA,CAAC,MAAM,IAAM,EAAA,KAAK,IAAI,MAAO,CAAA,MAAA,CAAO,UAAU,MAAM,CAAA,CAAA;AAC1D,IAAA,MAAM,kBAAyC,EAAC,CAAA;AAEhD,IAAA,IAAI,IAAM,EAAA;AACR,MAAA,KAAA,IAAS,CAAI,GAAA,CAAA,EAAG,CAAI,GAAA,IAAA,CAAK,QAAQ,CAAK,EAAA,EAAA;AACpC,QAAA,IAAI,QAAQ,KAAO,EAAA;AACjB,UAAA,MAAM,MAAM,KAAM,CAAA,CAAA,CAAA,CAAA;AAClB,UAAgB,eAAA,CAAA,IAAA,CAAK,UAAW,CAAA,IAAA,CAAK,GAAK,CAAA,CAAA,CAAA,CAAA;AAAA,SACrC,MAAA;AACL,UAAgB,eAAA,CAAA,IAAA,CAAK,UAAW,CAAA,IAAA,CAAK,CAAG,CAAA,CAAA,CAAA,CAAA;AAAA,SAC1C;AAEA,QAAI,IAAA,eAAA,CAAgB,SAAS,KAAO,EAAA;AAClC,UAAO,OAAA,eAAA,CAAA;AAAA,SACT;AAAA,OACF;AAEA,MAAO,OAAA,eAAA,CAAA;AAAA,KACT;AAEA,IAAI,IAAA,UAAA,CAAW,SAAS,KAAO,EAAA;AAC7B,MAAO,OAAA,UAAA,CAAW,KAAM,CAAA,CAAA,EAAG,KAAK,CAAA,CAAA;AAAA,KAClC;AAEA,IAAO,OAAA,UAAA,CAAA;AAAA,GACT,CAAA;AACF;;;;"}