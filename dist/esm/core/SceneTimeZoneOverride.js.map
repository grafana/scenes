{"version":3,"file":"SceneTimeZoneOverride.js","sources":["../../../src/core/SceneTimeZoneOverride.tsx"],"sourcesContent":["import { TimeZone } from '@grafana/schema';\nimport { SceneTimeRangeLike, SceneTimeRangeState } from './types';\nimport { SceneTimeRangeTransformerBase } from './SceneTimeRangeTransformerBase';\nimport { getDefaultTimeRange } from '@grafana/data';\nimport { evaluateTimeRange } from '../utils/evaluateTimeRange';\n\ninterface SceneTimeZoneOverrideState extends SceneTimeRangeState {\n  timeZone: TimeZone;\n}\n\nexport class SceneTimeZoneOverride\n  extends SceneTimeRangeTransformerBase<SceneTimeZoneOverrideState>\n  implements SceneTimeRangeLike\n{\n  public constructor(state: Omit<SceneTimeZoneOverrideState, 'from' | 'to' | 'value'>) {\n    super({\n      ...state,\n      timeZone: state.timeZone,\n      // We set a default time range here. It will be overwritten on activation based on ancestor time range.\n      from: 'now-6h',\n      to: 'now',\n      value: getDefaultTimeRange(),\n    });\n  }\n\n  protected ancestorTimeRangeChanged(timeRange: SceneTimeRangeState): void {\n    this.setState({\n      ...timeRange,\n      timeZone: this.state.timeZone,\n      value: evaluateTimeRange(\n        timeRange.from,\n        timeRange.to,\n        this.state.timeZone,\n        timeRange.fiscalYearStartMonth,\n        timeRange.UNSAFE_nowDelay\n      ),\n    });\n  }\n\n  public getTimeZone(): TimeZone {\n    return this.state.timeZone;\n  }\n\n  public onTimeZoneChange(timeZone: string): void {\n    this.setState({\n      timeZone,\n      value: evaluateTimeRange(\n        this.state.from,\n        this.state.to,\n        this.state.timeZone,\n        this.getAncestorTimeRange().state.fiscalYearStartMonth,\n        this.state.UNSAFE_nowDelay\n      ),\n    });\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAUO,MAAM,8BACH,6BAEV,CAAA;AAAA,EACS,YAAY,KAAkE,EAAA;AACnF,IAAA,KAAA,CAAM,iCACD,KADC,CAAA,EAAA;AAAA,MAEJ,UAAU,KAAM,CAAA,QAAA;AAAA,MAEhB,IAAM,EAAA,QAAA;AAAA,MACN,EAAI,EAAA,KAAA;AAAA,MACJ,OAAO,mBAAoB,EAAA;AAAA,KAC5B,CAAA,CAAA,CAAA;AAAA,GACH;AAAA,EAEU,yBAAyB,SAAsC,EAAA;AACvE,IAAK,IAAA,CAAA,QAAA,CAAS,iCACT,SADS,CAAA,EAAA;AAAA,MAEZ,QAAA,EAAU,KAAK,KAAM,CAAA,QAAA;AAAA,MACrB,KAAO,EAAA,iBAAA;AAAA,QACL,SAAU,CAAA,IAAA;AAAA,QACV,SAAU,CAAA,EAAA;AAAA,QACV,KAAK,KAAM,CAAA,QAAA;AAAA,QACX,SAAU,CAAA,oBAAA;AAAA,QACV,SAAU,CAAA,eAAA;AAAA,OACZ;AAAA,KACD,CAAA,CAAA,CAAA;AAAA,GACH;AAAA,EAEO,WAAwB,GAAA;AAC7B,IAAA,OAAO,KAAK,KAAM,CAAA,QAAA,CAAA;AAAA,GACpB;AAAA,EAEO,iBAAiB,QAAwB,EAAA;AAC9C,IAAA,IAAA,CAAK,QAAS,CAAA;AAAA,MACZ,QAAA;AAAA,MACA,KAAO,EAAA,iBAAA;AAAA,QACL,KAAK,KAAM,CAAA,IAAA;AAAA,QACX,KAAK,KAAM,CAAA,EAAA;AAAA,QACX,KAAK,KAAM,CAAA,QAAA;AAAA,QACX,IAAA,CAAK,oBAAqB,EAAA,CAAE,KAAM,CAAA,oBAAA;AAAA,QAClC,KAAK,KAAM,CAAA,eAAA;AAAA,OACb;AAAA,KACD,CAAA,CAAA;AAAA,GACH;AACF;;;;"}